#Overall and Cause Specific Excess Mortality Related to Social Inequalities in Mexico
#Any question regarding analysis contact Neftali Eduardo Antonio-Villa, Carlos Alberto Fermin Martinez or Omar Yaxmehen Bello-Chavolla
#Disclaimer: 

#### Library management ####
setwd("/Users/nefoantonio/OneDrive - UNIVERSIDAD NACIONAL AUTÓNOMA DE MÉXICO/PROYECTOS/INGER/Exceso de Mortalidad")
setwd("~/OneDrive - UNIVERSIDAD NACIONAL AUT?NOMA DE M?XICO/Exceso de Mortalidad/")

require(pacman)
pacman::p_load(tidyverse,stringr,icd10es,haven,readxl,na.tools,
               parallel,pbmcapply,ggthemes,ggalt,ggpubr,circlize,data.table,devtools,janitor,
               networkD3,tidyverse,ggmap,sp,tmap,raster,rgdal,tigris,rasterVis,RColorBrewer,viridisLite,rmapshaper,
               ggsflabel,biscale,cowplot,tricolore,overlap,lme4,grid,gridExtra,treemapify,raster)
theme_set(theme_bw())
#### Demographic Dataset Coding#####
#Load shape datasets at municipal and state level
load("Bases/gde3.rda")
geom_df_mun<-ms_simplify(gde3, keep = 0.01, keep_shapes = T)%>% sf::st_transform(crs = "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0",stringsAsFactors=FALSE)
geom_df_mun<-geom_df_mun%>%mutate(id.mun=paste0(str_pad(CVE_ENT, 2,pad = "0"),str_pad(CVE_MUN,3, pad="0")))

geom_df_ent <-  sf::st_read(dsn="shapes", layer="areas_geoestadisticas_estatales")  %>% sf::st_transform(crs = "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0",stringsAsFactors=FALSE)
geom_df_ent<-ms_simplify(geom_df_ent, keep = 0.01, keep_shapes = T)
geom_df_ent$id.ent<-geom_df_ent$CVE_ENT

#SLI dataset (ESTADO)
marg.ent<-read_excel("Bases/margindicadores_estado_2020.xlsx")
marg.ent$id.ent<-as.character(marg.ent$Clave)
marg.ent.1<-marg.ent%>%dplyr::select(id.ent,marg,pop,marg_cat)

#SLI dataset (MUNICIPIO)
marg.mun<-read_excel("Bases/margindicadores_municipio_2020.xlsx")
marg.mun.1<-marg.mun%>%mutate(Clave2=as.character(CLAVE_MUN),
                     id.mun=str_pad(Clave2, 5,pad = "0"))%>%
  dplyr::select(id.mun,marg,pop,marg_cat)

#Population datasets
Pob_conapo1<- read_xlsx("Bases/base_municipios_final_datos_01.xlsx")
Pob_conapo2<- read_xlsx("Bases/base_municipios_final_datos_02.xlsx")
Pob_conapo<- rbind(Pob_conapo1, Pob_conapo2)
Pob_conapo$id.mun<-str_pad(Pob_conapo$CLAVE, 5,pad = "0")
Pob_conapo.2<-Pob_conapo
Pob_conapo<-Pob_conapo
Pob_conapo$id.ent<-as.character(Pob_conapo$CLAVE_ENT)
Pob_conapo$id.ent<-str_pad(Pob_conapo$id.ent, 2,pad = "0")
names(Pob_conapo)[7]<-"Year"

#Urban Population density dataset
dmu<-read.csv("Bases/dmu_camas.csv")
#Estatal
dmu.ent<-dmu%>%
  mutate(CVE_ENT=str_pad(CVE_ENT, 2,pad = "0"))%>%
  rename(id.ent="CVE_ENT")%>%
  group_by(id.ent)%>% 
  summarise(tot_camas = sum(tot_camas),
            dmu= sum(dmu,na.rm=T))%>%
  left_join(marg.ent.1,by="id.ent")%>%
  mutate(dmu_camas=(tot_camas/pop)*100000)%>% 
  dplyr::select(id.ent, dmu_camas,dmu)
#Municipal  
dmu.mun<-dmu%>%
  mutate(id.mun=paste0(str_pad(CVE_ENT, 2,pad = "0"),str_pad(CVE_MUN,3, pad="0")))%>%
  left_join(marg.mun.1,by="id.mun")%>%
  mutate(dmu_camas=(tot_camas/pop)*100000)%>% 
  dplyr::select(id.mun, dmu_camas, dmu)

#DISLI DATASETS
#DISLI Entidad
dmu.cuadrantes.ent<-data.frame(marg.ent.1$id.ent)
dmu.cuadrantes.ent<-dmu.cuadrantes.ent%>%rename(id.ent="marg.ent.1.id.ent")
dmu.cuadrantes.ent<-dmu.cuadrantes.ent%>%
  left_join(dmu.ent,by="id.ent")%>%
  left_join(marg.ent.1,by="id.ent")%>%
  mutate(DISLI=lm(marg~dmu+dmu_camas, data = dmu.cuadrantes.ent)$residuals)


# Se normaliza el Indice
dmu.cuadrantes.ent$DISLI.NOMR <- (dmu.cuadrantes.ent$DISLI - mean(dmu.cuadrantes.ent$DISLI)) / sd(dmu.cuadrantes.ent$DISLI)

dmu.cuadrantes.ent$y <- 100 / (max(dmu.cuadrantes.ent$DISLI.NOMR) - min(dmu.cuadrantes.ent$DISLI.NOMR)) * 
  (dmu.cuadrantes.ent$DISLI.NOMR - min(dmu.cuadrantes.ent$DISLI.NOMR))

dmu.cuadrantes.ent$intervalo[dmu.cuadrantes.ent$y<=10] <- 1
dmu.cuadrantes.ent$intervalo[dmu.cuadrantes.ent$y>10 & dmu.cuadrantes.ent$y<=20] <- 2
dmu.cuadrantes.ent$intervalo[dmu.cuadrantes.ent$y>20 & dmu.cuadrantes.ent$y<=30] <- 3
dmu.cuadrantes.ent$intervalo[dmu.cuadrantes.ent$y>30 & dmu.cuadrantes.ent$y<=40] <- 4
dmu.cuadrantes.ent$intervalo[dmu.cuadrantes.ent$y>40 & dmu.cuadrantes.ent$y<=50] <- 5
dmu.cuadrantes.ent$intervalo[dmu.cuadrantes.ent$y>50 & dmu.cuadrantes.ent$y<=60] <- 6
dmu.cuadrantes.ent$intervalo[dmu.cuadrantes.ent$y>60 & dmu.cuadrantes.ent$y<=70] <- 7
dmu.cuadrantes.ent$intervalo[dmu.cuadrantes.ent$y>70 & dmu.cuadrantes.ent$y<=80] <- 8
dmu.cuadrantes.ent$intervalo[dmu.cuadrantes.ent$y>80 & dmu.cuadrantes.ent$y<=90] <- 9
dmu.cuadrantes.ent$intervalo[dmu.cuadrantes.ent$y>90 & dmu.cuadrantes.ent$y<=100] <- 10

table(dmu.cuadrantes.ent$intervalo)
cumsum(sqrt(table(dmu.cuadrantes.ent$intervalo)))[9]/10

1*cumsum(sqrt(table(dmu.cuadrantes.ent$intervalo)))[9]/10
2*cumsum(sqrt(table(dmu.cuadrantes.ent$intervalo)))[9]/10
3*cumsum(sqrt(table(dmu.cuadrantes.ent$intervalo)))[9]/10
4*cumsum(sqrt(table(dmu.cuadrantes.ent$intervalo)))[9]/10


# Se define el grado de rezago social a través de la técnica de Dalenius-Hodges

dmu.cuadrantes.ent$QUINTILES.DISLI.ENT.2[dmu.cuadrantes.ent$DISLI<=-0.7342218] <- 1
dmu.cuadrantes.ent$QUINTILES.DISLI.ENT.2[dmu.cuadrantes.ent$DISLI>-0.7342218 & dmu.cuadrantes.ent$DISLI<=-0.2984445] <- 2
dmu.cuadrantes.ent$QUINTILES.DISLI.ENT.2[dmu.cuadrantes.ent$DISLI>-0.2984445 & dmu.cuadrantes.ent$DISLI<=0.2086100] <- 3
dmu.cuadrantes.ent$QUINTILES.DISLI.ENT.2[dmu.cuadrantes.ent$DISLI>0.2086100 & dmu.cuadrantes.ent$DISLI<=0.8681185] <- 4
dmu.cuadrantes.ent$QUINTILES.DISLI.ENT.2[dmu.cuadrantes.ent$DISLI>0.8681185] <- 5


#DISLI Municipio
dmu.cuadrantes.mun<-data.frame(marg.mun.1$id.mun)
dmu.cuadrantes.mun<-dmu.cuadrantes.mun%>%rename(id.mun="marg.mun.1.id.mun")
dmu.cuadrantes.mun<-dmu.cuadrantes.mun%>%
  left_join(dmu.mun,by="id.mun")%>%
  dplyr::mutate(dmu_camas = replace_na(dmu_camas, 0))%>%
  dplyr::mutate(dmu = replace_na(dmu, 0))%>%
  left_join(marg.mun.1,by="id.mun")%>%
  mutate(DISLI=lm(marg~dmu+dmu_camas+pop, data = dmu.cuadrantes.mun)$residuals)

# Se normaliza el ??ndice
dmu.cuadrantes.mun$DISLI.NOMR <- (dmu.cuadrantes.mun$DISLI - mean(dmu.cuadrantes.mun$DISLI)) / sd(dmu.cuadrantes.mun$DISLI)

dmu.cuadrantes.mun$y <- 100 / (max(dmu.cuadrantes.mun$DISLI.NOMR) - min(dmu.cuadrantes.mun$DISLI.NOMR)) * 
  (dmu.cuadrantes.mun$DISLI.NOMR - min(dmu.cuadrantes.mun$DISLI.NOMR))

dmu.cuadrantes.mun$intervalo[dmu.cuadrantes.mun$y<=10] <- 1
dmu.cuadrantes.mun$intervalo[dmu.cuadrantes.mun$y>10 & dmu.cuadrantes.mun$y<=20] <- 2
dmu.cuadrantes.mun$intervalo[dmu.cuadrantes.mun$y>20 & dmu.cuadrantes.mun$y<=30] <- 3
dmu.cuadrantes.mun$intervalo[dmu.cuadrantes.mun$y>30 & dmu.cuadrantes.mun$y<=40] <- 4
dmu.cuadrantes.mun$intervalo[dmu.cuadrantes.mun$y>40 & dmu.cuadrantes.mun$y<=50] <- 5
dmu.cuadrantes.mun$intervalo[dmu.cuadrantes.mun$y>50 & dmu.cuadrantes.mun$y<=60] <- 6
dmu.cuadrantes.mun$intervalo[dmu.cuadrantes.mun$y>60 & dmu.cuadrantes.mun$y<=70] <- 7
dmu.cuadrantes.mun$intervalo[dmu.cuadrantes.mun$y>70 & dmu.cuadrantes.mun$y<=80] <- 8
dmu.cuadrantes.mun$intervalo[dmu.cuadrantes.mun$y>80 & dmu.cuadrantes.mun$y<=90] <- 9
dmu.cuadrantes.mun$intervalo[dmu.cuadrantes.mun$y>90 & dmu.cuadrantes.mun$y<=100] <- 10

1*cumsum(sqrt(table(dmu.cuadrantes.mun$intervalo)))[10]/10
2*cumsum(sqrt(table(dmu.cuadrantes.mun$intervalo)))[10]/10
3*cumsum(sqrt(table(dmu.cuadrantes.mun$intervalo)))[10]/10
4*cumsum(sqrt(table(dmu.cuadrantes.mun$intervalo)))[10]/10

# Se define el grado de rezago social a través de la técnica de Dalenius-Hodges

quantile(dmu.cuadrantes.mun$DISLI,c(0.05,0.15,0.35,0.75))
quantile(dmu.cuadrantes.mun$DISLI,c(0.10,0.40,0.70))

dmu.cuadrantes.mun$QUINTILES.DISLI.MUN[dmu.cuadrantes.mun$DISLI<=-0.9630604] <- 1
dmu.cuadrantes.mun$QUINTILES.DISLI.MUN[dmu.cuadrantes.mun$DISLI>-0.9630604 & dmu.cuadrantes.mun$DISLI<=-0.4041777] <- 2
dmu.cuadrantes.mun$QUINTILES.DISLI.MUN[dmu.cuadrantes.mun$DISLI>-0.4041777 & dmu.cuadrantes.mun$DISLI<=0.2421365] <- 3
dmu.cuadrantes.mun$QUINTILES.DISLI.MUN[dmu.cuadrantes.mun$DISLI>0.2421365] <- 4

dmu.cuadrantes.mun %>% 
  group_by(QUINTILES.DISLI.MUN) %>% 
  tally(pop) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))

#Population Estimator by DISLI Dataset ESTADO

#2016
Pob_edad_cuadrante_2016_entidad_parcial<- Pob_conapo %>% 
  filter(Year == 2016 ) %>% 
  left_join(marg.ent.1,by="id.ent")%>%
  left_join(dmu.cuadrantes.ent %>% dplyr::select(c("id.ent","QUINTILES.DISLI.ENT")), by=c("id.ent")) %>%
  group_by(id.ent,QUINTILES.DISLI.ENT, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2016_entidad_total<- Pob_conapo %>% 
  filter(Year == 2016) %>% 
  left_join(marg.ent.1,by="id.ent")%>%
  left_join(dmu.cuadrantes.ent %>% dplyr::select(c("id.ent","QUINTILES.DISLI.ENT")), by=c("id.ent")) %>%
  group_by(QUINTILES.DISLI.ENT,EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)

#2017
Pob_edad_cuadrante_2017_entidad_parcial<- Pob_conapo %>% 
  filter(Year == 2017 ) %>% 
  left_join(marg.ent.1,by="id.ent")%>%
  left_join(dmu.cuadrantes.ent %>% dplyr::select(c("id.ent","QUINTILES.DISLI.ENT")), by=c("id.ent")) %>%
  group_by(id.ent,QUINTILES.DISLI.ENT, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>%
  mutate(Weight = POB/sum(POB))


Pob_edad_cuadrante_2017_entidad_total<- Pob_conapo %>% 
  filter(Year == 2017) %>% 
  left_join(marg.ent.1,by="id.ent")%>%
  left_join(dmu.cuadrantes.ent %>% dplyr::select(c("id.ent","QUINTILES.DISLI.ENT")), by=c("id.ent")) %>%
  group_by(QUINTILES.DISLI.ENT,EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)

#2018
Pob_edad_cuadrante_2018_entidad_parcial<- Pob_conapo %>% 
  filter(Year == 2018 ) %>% 
  left_join(marg.ent.1,by="id.ent")%>%
  left_join(dmu.cuadrantes.ent %>% dplyr::select(c("id.ent","QUINTILES.DISLI.ENT")), by=c("id.ent")) %>%
  group_by(id.ent,QUINTILES.DISLI.ENT, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2018_entidad_total<- Pob_conapo %>% 
  filter(Year == 2018) %>% 
  left_join(marg.ent.1,by="id.ent")%>%
  left_join(dmu.cuadrantes.ent %>% dplyr::select(c("id.ent","QUINTILES.DISLI.ENT")), by=c("id.ent")) %>%
  group_by(QUINTILES.DISLI.ENT,EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)

#2019
Pob_edad_cuadrante_2019_entidad_parcial<- Pob_conapo %>% 
  filter(Year == 2019 ) %>% 
  left_join(marg.ent.1,by="id.ent")%>%
  left_join(dmu.cuadrantes.ent %>% dplyr::select(c("id.ent","QUINTILES.DISLI.ENT")), by=c("id.ent")) %>%
  group_by(id.ent,QUINTILES.DISLI.ENT, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2019_entidad_total<- Pob_conapo %>% 
  filter(Year == 2019) %>% 
  left_join(marg.ent.1,by="id.ent")%>%
  left_join(dmu.cuadrantes.ent %>% dplyr::select(c("id.ent","QUINTILES.DISLI.ENT")), by=c("id.ent")) %>%
  group_by(QUINTILES.DISLI.ENT,EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)

#2020
Pob_edad_cuadrante_2020_entidad<- Pob_conapo %>% 
  filter(Year == 2020 ) %>% 
  left_join(marg.ent.1,by="id.ent")%>%
  left_join(dmu.cuadrantes.ent %>% dplyr::select(c("id.ent","QUINTILES.DISLI.ENT")), by=c("id.ent")) %>%
  group_by(id.ent,QUINTILES.DISLI.ENT, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>%
  mutate(Weight = POB/sum(POB))

Pob_edad_anual_2020<- Pob_conapo %>% 
  filter(Year == 2020) %>% 
  left_join(marg.ent.1,by="id.ent")%>%
  left_join(dmu.cuadrantes.ent %>% dplyr::select(c("id.ent","QUINTILES.DISLI.ENT")), by=c("id.ent")) %>%
  group_by(QUINTILES.DISLI.ENT,EDAD_QUIN) %>% 
  tally(POB) 

#Population Estimator by DISLI Dataset MUNICIPIO

#2016

Pob_edad_cuadrante_2016_municipio_parcial<- Pob_conapo %>% 
  filter(Year == 2016 ) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  group_by(id.mun, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  left_join(dmu.cuadrantes.mun %>% dplyr::select(c("id.mun","QUINTILES.DISLI.MUN")), by=c("id.mun")) %>%
  group_by(id.mun, QUINTILES.DISLI.MUN, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))%>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2016_municipio_total<- Pob_conapo %>% 
  filter(Year == 2016) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  left_join(dmu.cuadrantes.mun %>% dplyr::select(c("id.mun","QUINTILES.DISLI.MUN")), by=c("id.mun")) %>%
  group_by(QUINTILES.DISLI.MUN,EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2016_total<- Pob_conapo %>% 
  filter(Year == 2016) %>% 
  left_join(dmu.cuadrantes.mun,by="id.mun")%>%
  group_by(QUINTILES.DISLI.MUN) %>% 
  tally(POB) %>%
  rename(POB = n)


#2017

Pob_edad_cuadrante_2017_municipio_parcial<- Pob_conapo %>% 
  filter(Year == 2017 ) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  group_by(id.mun, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  left_join(dmu.cuadrantes.mun %>% dplyr::select(c("id.mun","QUINTILES.DISLI.MUN")), by=c("id.mun")) %>%
  group_by(id.mun, QUINTILES.DISLI.MUN, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))%>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2017_municipio_total<- Pob_conapo %>% 
  filter(Year == 2017) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  left_join(dmu.cuadrantes.mun %>% dplyr::select(c("id.mun","QUINTILES.DISLI.MUN")), by=c("id.mun")) %>%
  group_by(QUINTILES.DISLI.MUN,EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2017_total<- Pob_conapo %>% 
  filter(Year == 2017) %>% 
  left_join(dmu.cuadrantes.mun,by="id.mun")%>%
  group_by(QUINTILES.DISLI.MUN) %>% 
  tally(POB) %>%
  rename(POB = n)


#2018 

Pob_edad_cuadrante_2018_municipio_parcial<- Pob_conapo %>% 
  filter(Year == 2018 ) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  group_by(id.mun, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  left_join(dmu.cuadrantes.mun %>% dplyr::select(c("id.mun","QUINTILES.DISLI.MUN")), by=c("id.mun")) %>%
  group_by(id.mun, QUINTILES.DISLI.MUN, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))%>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2018_municipio_total<- Pob_conapo %>% 
  filter(Year == 2018) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  left_join(dmu.cuadrantes.mun %>% dplyr::select(c("id.mun","QUINTILES.DISLI.MUN")), by=c("id.mun")) %>%
  group_by(QUINTILES.DISLI.MUN,EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2018_total<- Pob_conapo %>% 
  filter(Year == 2018) %>% 
  left_join(dmu.cuadrantes.mun,by="id.mun")%>%
  group_by(QUINTILES.DISLI.MUN) %>% 
  tally(POB) %>%
  rename(POB = n)


#2019
Pob_edad_cuadrante_2019_municipio_parcial<- Pob_conapo %>% 
  filter(Year == 2019 ) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  group_by(id.mun, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  left_join(dmu.cuadrantes.mun %>% dplyr::select(c("id.mun","QUINTILES.DISLI.MUN")), by=c("id.mun")) %>%
  group_by(id.mun, QUINTILES.DISLI.MUN, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))%>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2019_municipio_total<- Pob_conapo %>% 
  filter(Year == 2019) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  left_join(dmu.cuadrantes.mun %>% dplyr::select(c("id.mun","QUINTILES.DISLI.MUN")), by=c("id.mun")) %>%
  group_by(QUINTILES.DISLI.MUN,EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2019_total<- Pob_conapo %>% 
  filter(Year == 2019) %>% 
  left_join(dmu.cuadrantes.mun,by="id.mun")%>%
  group_by(QUINTILES.DISLI.MUN) %>% 
  tally(POB) %>%
  rename(POB = n)

#2020
Pob_edad_cuadrante_2020_municipio_parcial<- Pob_conapo %>% 
  filter(Year == 2020 ) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  group_by(id.mun, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  left_join(dmu.cuadrantes.mun %>% dplyr::select(c("id.mun","QUINTILES.DISLI.MUN")), by=c("id.mun")) %>%
  group_by(id.mun, QUINTILES.DISLI.MUN, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_cuadrante_2020_municipio_total<- Pob_conapo %>% 
  filter(Year == 2020) %>% 
  left_join(marg.mun.1,by="id.mun")%>%
  left_join(dmu.cuadrantes.mun %>% dplyr::select(c("id.mun","QUINTILES.DISLI.MUN")), by=c("id.mun")) %>%
  group_by(QUINTILES.DISLI.MUN,EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))

Pob_edad_cuadrante_2020_total<- Pob_conapo %>% 
  filter(Year == 2020) %>% 
  left_join(dmu.cuadrantes.mun,by="id.mun")%>%
  group_by(QUINTILES.DISLI.MUN) %>% 
  tally(POB) %>%
  rename(POB = n)

geom_df.mun<-geom_df_mun%>%left_join(dmu.cuadrantes.mun,by = "id.mun")
geom_df.ent<-geom_df_ent%>%left_join(dmu.cuadrantes.ent,by = "id.ent")

#Population Estimator by Entidad

#2016
Pob_edad_2016_entidad_parcial<- Pob_conapo %>% 
  filter(Year == 2016) %>%
  group_by(id.ent, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  group_by(id.ent, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_2016_entidad_total<- Pob_conapo %>% 
  filter(Year == 2016) %>% 
  group_by(EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))

#2017
Pob_edad_2017_entidad_parcial<- Pob_conapo %>% 
  filter(Year == 2017) %>%
  group_by(id.ent, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  group_by(id.ent, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_2017_entidad_total<- Pob_conapo %>% 
  filter(Year == 2017) %>% 
  group_by(EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))


#2018
Pob_edad_2018_entidad_parcial<- Pob_conapo %>% 
  filter(Year == 2018) %>%
  group_by(id.ent, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  group_by(id.ent, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_2018_entidad_total<- Pob_conapo %>% 
  filter(Year == 2018) %>% 
  group_by(EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))


#2019
Pob_edad_2019_entidad_parcial<- Pob_conapo %>% 
  filter(Year == 2019) %>%
  group_by(id.ent, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  group_by(id.ent, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_2019_entidad_total<- Pob_conapo %>% 
  filter(Year == 2019) %>% 
  group_by(EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))

#2020

Pob_edad_2020_entidad_parcial<- Pob_conapo %>% 
  filter(Year == 2020) %>%
  group_by(id.ent, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  group_by(id.ent, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_2020_entidad_total<- Pob_conapo %>% 
  filter(Year == 2020) %>% 
  group_by(EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)%>%
  mutate(Weight = POB/sum(POB))


#Population Estimator by Municipality

#2016
Pob_edad_2016_municipio_parcial<- Pob_conapo %>% 
  filter(Year == 2016) %>%
  group_by(id.mun, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  group_by(id.mun, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_2016_municipio_total<- Pob_conapo %>% 
  filter(Year == 2016) %>% 
  group_by(EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)

#2017
Pob_edad_2017_municipio_parcial<- Pob_conapo %>% 
  filter(Year == 2017) %>%
  group_by(id.mun, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  group_by(id.mun, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_2017_municipio_total<- Pob_conapo %>% 
  filter(Year == 2017) %>% 
  group_by(EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)


#2018
Pob_edad_2018_municipio_parcial<- Pob_conapo %>% 
  filter(Year == 2018) %>%
  group_by(id.mun, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  group_by(id.mun, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_2018_municipio_total<- Pob_conapo %>% 
  filter(Year == 2018) %>% 
  group_by(EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)

#2019
Pob_edad_2019_municipio_parcial<- Pob_conapo %>% 
  filter(Year == 2019) %>%
  group_by(id.mun, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  group_by(id.mun, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_2019_municipio_total<- Pob_conapo %>% 
  filter(Year == 2019) %>% 
  group_by(EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)

#2020
Pob_edad_2020_municipio_parcial<- Pob_conapo %>% 
  filter(Year == 2020) %>%
  group_by(id.mun, EDAD_QUIN) %>%
  tally(POB) %>% 
  rename(POB = n) %>% 
  group_by(id.mun, EDAD_QUIN) %>% 
  summarise(POB = sum(POB))

Pob_edad_2020_municipio_total<- Pob_conapo %>% 
  filter(Year == 2020) %>% 
  group_by(EDAD_QUIN) %>% 
  tally(POB) %>%
  rename(POB = n)

#### 2020 Dataset#####

mort_2020 <- read.csv("conjunto_de_datos_defunciones_registradas_2020.CSV")
mort_2020$id.ent<-paste0(str_pad(mort_2020$ent_ocurr, 2,pad = "0"))
mort_2020$id.mun<-paste0(str_pad(mort_2020$ent_ocurr, 2,pad = "0"),str_pad(mort_2020$mun_ocurr,3, pad="0"))

mort_2020$FECHA_DEFUNCION<-as.Date(paste0(as.numeric(mort_2020$dia_ocurr),"-",as.numeric(mort_2020$mes_ocurr),"-",as.numeric(mort_2020$anio_ocur)),format = "%d-%m-%Y")
mort_2020<-cbind(mort_2020,data.frame(matrix(unlist(strsplit(as.character(mort_2020$edad), split = "(?=[0-9])", perl = TRUE)), nrow=length(strsplit(as.character(mort_2020$edad), split = "(?=[0-9])", perl = TRUE)), byrow=TRUE)))

mort_2020$X3[mort_2020$X1=="1"]<-"0"
mort_2020$X3[mort_2020$X1=="2"]<-"0"
mort_2020$X3[mort_2020$X1=="3"]<-"0"

mort_2020$X4[mort_2020$X1=="1"]<-"0"
mort_2020$X4[mort_2020$X1=="2"]<-"0"
mort_2020$X4[mort_2020$X1=="3"]<-"0"

mort_2020$edad<-as.numeric(paste0(str_pad(mort_2020$X2, 1),str_pad(mort_2020$X3, 1),str_pad(mort_2020$X4,1)))
mort_2020$edad[mort_2020$edad==998]<-NA

mort_2020<-mort_2020%>%
  filter(mes_ocurr!=99)%>%
  filter(anio_ocur!=9999)%>%
  rename("EDAD"=edad, "SEXO"=sexo, "ESTADO_DEFUNCION"=ent_ocurr,"MUNICIPIO"=mun_ocurr, 
         "CONTEXTO_DEFUNCION"=sitio_ocur,"CAUSA_MUERTE_ICD_10_CATEGORIA_1"=causa_def)%>%
  mutate(Year=data.table::year(FECHA_DEFUNCION),MES=data.table::month(FECHA_DEFUNCION))%>%
  filter(Year=="2020")%>%
  filter(MES!=99)%>%
  mutate(FECHA_DEFUNCION=as.character(FECHA_DEFUNCION))%>%
  mutate(FECHA_DEFUNCION=as.Date(FECHA_DEFUNCION))%>%
  mutate(Year=data.table::year(FECHA_DEFUNCION),MES=data.table::month(FECHA_DEFUNCION))

#Recoding dataset

mort_2020$ICD_10_1.CHAPTER<-str_extract(strsplit(mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1,NULL), "[A-Z]+" )
mort_2020$ICD_10_1.CODE<-as.numeric(substr(str_extract(strsplit(mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1, split = "(?<=[a-zA-Z])\\s*(?=[0-9])", perl = TRUE),"([[:digit:]]+)"),start=1,stop=2))

# COVID-19 #
mort_2020$COVID.NEUM<-NULL; mort_2020$COVID.NEUM[with(mort_2020, (mort_2020$MES>=4 & ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=12&ICD_10_1.CODE<=18)))]<-1 #Pneumonia
mort_2020$COVID.INFL<-NULL; mort_2020$COVID.INFL[with(mort_2020, (mort_2020$MES>=4 & ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=9&ICD_10_1.CODE<=11)))]<-1 #Influenza
mort_2020$COVID.IRIN<-NULL; mort_2020$COVID.IRIN[with(mort_2020, (mort_2020$MES>=4 & ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==22)))]<-1 #Unspecified acute lower respiratory infection
mort_2020$COVID.OTRA<-NULL; mort_2020$COVID.OTRA[with(mort_2020, (mort_2020$MES>=4 & ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=86)|
                                                                                                                (ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other
mort_2020$COVID<-NULL
mort_2020$COVID[mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1=="U071" | 
                  mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1=="U072" | 
                  mort_2020$COVID.NEUM==1 | 
                  mort_2020$COVID.INFL==1 | 
                  mort_2020$COVID.IRIN==1 | 
                  mort_2020$COVID.OTRA==1]<-1
mort_2020$COVID<-na.tools::na.replace(mort_2020$COVID,0)

#ICD-10 Coding
#Preventable mortality specific causes

mort_2020$INTE.DIS[(mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=09))]<-1 #Enfermedades infecciosas intestinales
mort_2020$DI.TE.PO[(mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE==35 | mort_2020$ICD_10_1.CODE==36 | mort_2020$ICD_10_1.CODE==80))]<-1
mort_2020$WHO.COUG[(mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE==37))]<-1
mort_2020$MENINGOC[(mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE==39))]<-1
mort_2020$SEPS.STR[(mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE>=40 & mort_2020$ICD_10_1.CODE<=41))]<-1
mort_2020$HAE.INFL[(mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE==49))]<-1
mort_2020$SEX.INFE[(mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE>=50 & mort_2020$ICD_10_1.CODE<=64))]<-1
mort_2020$VARICELL[(mort_2020$ICD_10_1.CHAPTER=="B" & (mort_2020$ICD_10_1.CODE==1))]<-1
mort_2020$MEASLESS[(mort_2020$ICD_10_1.CHAPTER=="B" & (mort_2020$ICD_10_1.CODE==5))]<-1
mort_2020$RUBELLAA[(mort_2020$ICD_10_1.CHAPTER=="B" & (mort_2020$ICD_10_1.CODE==6))]<-1 
mort_2020$VIRA.HEP[(mort_2020$ICD_10_1.CHAPTER=="B" & (mort_2020$ICD_10_1.CODE>=15 & mort_2020$ICD_10_1.CODE<=19))]<-1 
mort_2020$HIV.AIDS[(mort_2020$ICD_10_1.CHAPTER=="B" & (mort_2020$ICD_10_1.CODE>=20 & mort_2020$ICD_10_1.CODE<=24))]<-1 
mort_2020$MALARIAS[(mort_2020$ICD_10_1.CHAPTER=="B" & (mort_2020$ICD_10_1.CODE>=50 & mort_2020$ICD_10_1.CODE<=54))]<-1 
mort_2020$HAEM.MEN[(mort_2020$ICD_10_1.CHAPTER=="G" & (mort_2020$ICD_10_1.CODE==0))]<-1 
mort_2020$TUBERCUL[((mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE>=15 & mort_2020$ICD_10_1.CODE<=19))|
                      (mort_2020$ICD_10_1.CHAPTER=="B" & (mort_2020$ICD_10_1.CODE==90))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==65)))]<-1
mort_2020$UPG.CANC[(mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=16))]<-1
mort_2020$LIV.CANC[(mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==22))]<-1
mort_2020$LUN.CANC[(mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE>=33 & mort_2020$ICD_10_1.CODE<=34))]<-1
mort_2020$MESOTHEL[(mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==45))]<-1
mort_2020$MELANOMA[(mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==43))]<-1
mort_2020$BLA.CANC[(mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==67))]<-1
mort_2020$CER.CANC[(mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==53))]<-1
mort_2020$NUT.ANEM[(mort_2020$ICD_10_1.CHAPTER=="D" & (mort_2020$ICD_10_1.CODE>=50 & mort_2020$ICD_10_1.CODE<=53))]<-1
mort_2020$DIA.MELL[(mort_2020$ICD_10_1.CHAPTER=="E" & (mort_2020$ICD_10_1.CODE>=10 & mort_2020$ICD_10_1.CODE<=14))]<-1
mort_2020$AOR.ANEU[(mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE==71))]<-1
mort_2020$HYP.DISE[((mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE>=10 & mort_2020$ICD_10_1.CODE<=13))|
                      (mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE==15)))]<-1
mort_2020$ISH.HEAR[(mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE>=20 & mort_2020$ICD_10_1.CODE<=25))]<-1
mort_2020$CER.VASC[(mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE>=60 & mort_2020$ICD_10_1.CODE<=69))]<-1
mort_2020$ATH.DISE[(mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE==70 & mort_2020$ICD_10_1.CODE==73))]<-1
mort_2020$INFLUENZ[(mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE>=9 & mort_2020$ICD_10_1.CODE<=11))]<-1
mort_2020$PNE.STRE[(mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE>=13 & mort_2020$ICD_10_1.CODE<=14))]<-1
mort_2020$CHR.RESP[(mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE>=40 & mort_2020$ICD_10_1.CODE<=44))]<-1
mort_2020$LUN.DISE[((mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE>=60 & mort_2020$ICD_10_1.CODE<=64))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==66 & mort_2020$ICD_10_1.CODE<=70))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==82))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==92)))]<-1
mort_2020$TET.NEON[(mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE==33))]<-1
mort_2020$OBS.TETA[(mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE==34))]<-1
mort_2020$CER.CONG[((mort_2020$ICD_10_1.CHAPTER=="Q" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=1))|
                      (mort_2020$ICD_10_1.CHAPTER=="Q" & (mort_2020$ICD_10_1.CODE==5)))]<-1
mort_2020$TRAN.ACC[(mort_2020$ICD_10_1.CHAPTER=="V" & (mort_2020$ICD_10_1.CODE>=1 & mort_2020$ICD_10_1.CODE<=99))]<-1
mort_2020$ACCI.INJ[((mort_2020$ICD_10_1.CHAPTER=="W" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=39))|
                      (mort_2020$ICD_10_1.CHAPTER=="X" & (mort_2020$ICD_10_1.CODE>=49 & mort_2020$ICD_10_1.CODE<=59)))]<-1
mort_2020$INTE.HAR[(mort_2020$ICD_10_1.CHAPTER=="X" & (mort_2020$ICD_10_1.CODE>=66 & mort_2020$ICD_10_1.CODE<=84))]<-1
mort_2020$ASSA.LES[((mort_2020$ICD_10_1.CHAPTER=="X" & (mort_2020$ICD_10_1.CODE>=86 & mort_2020$ICD_10_1.CODE<=99))|
                      (mort_2020$ICD_10_1.CHAPTER=="Y" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=9)))]<-1
mort_2020$ALCH.DIS[((mort_2020$ICD_10_1.CHAPTER=="E" & (mort_2020$ICD_10_1.CODE==24))|
                      (mort_2020$ICD_10_1.CHAPTER=="F" & (mort_2020$ICD_10_1.CODE==10))|
                      (mort_2020$ICD_10_1.CHAPTER=="G" & (mort_2020$ICD_10_1.CODE==31))|
                      (mort_2020$ICD_10_1.CHAPTER=="G" & (mort_2020$ICD_10_1.CODE==62))|
                      (mort_2020$ICD_10_1.CHAPTER=="G" & (mort_2020$ICD_10_1.CODE==72))|
                      (mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE==42))|
                      (mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE==29))|
                      (mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE==70))|
                      (mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE==85))|
                      (mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE==86))|
                      (mort_2020$ICD_10_1.CHAPTER=="R" & (mort_2020$ICD_10_1.CODE==78))|
                      (mort_2020$ICD_10_1.CHAPTER=="X" & (mort_2020$ICD_10_1.CODE==45))|
                      (mort_2020$ICD_10_1.CHAPTER=="X" & (mort_2020$ICD_10_1.CODE==65))|
                      (mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE>=73 & mort_2020$ICD_10_1.CODE<=74))|
                      (mort_2020$ICD_10_1.CHAPTER=="Y" & (mort_2020$ICD_10_1.CODE==15)))]<-1
mort_2020$DRUG.REL[((mort_2020$ICD_10_1.CHAPTER=="F" & (mort_2020$ICD_10_1.CODE>=11 & mort_2020$ICD_10_1.CODE<=16))|
                      (mort_2020$ICD_10_1.CHAPTER=="F" & (mort_2020$ICD_10_1.CODE>=18 & mort_2020$ICD_10_1.CODE<=19))|
                      (mort_2020$ICD_10_1.CHAPTER=="X" & (mort_2020$ICD_10_1.CODE>=40 & mort_2020$ICD_10_1.CODE<=44))|
                      (mort_2020$ICD_10_1.CHAPTER=="X" & (mort_2020$ICD_10_1.CODE==85))|
                      (mort_2020$ICD_10_1.CHAPTER=="Y" & (mort_2020$ICD_10_1.CODE>=10 & mort_2020$ICD_10_1.CODE<=14))|
                      (mort_2020$ICD_10_1.CHAPTER=="X" & (mort_2020$ICD_10_1.CODE>=60 & mort_2020$ICD_10_1.CODE<=64)))]<-1

mort_2020$RESP.FAL[(mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==96))]<-1 #RESPIRATORY FAILLURE
mort_2020$FLUID.DI[(mort_2020$ICD_10_1.CHAPTER=="E" & (mort_2020$ICD_10_1.CODE==87))]<-1 #Other disorders of fluid, electrolyte and acid-base balance
mort_2020$SHOCK.AN[(mort_2020$ICD_10_1.CHAPTER=="R" & (mort_2020$ICD_10_1.CODE==57))]<-1 #Shock, not elsewhere classified

#Preventable mortality final coding

mort_2020$PREVENT<-NULL
mort_2020$PREVENT[((mort_2020$COVID==0) & (mort_2020$EDAD>=0 & mort_2020$EDAD<=74) & (mort_2020$INTE.DIS==1|
                                                                 mort_2020$DI.TE.PO==1|
                                                                 mort_2020$WHO.COUG==1|
                                                                 mort_2020$MENINGOC==1|
                                                                 mort_2020$SEPS.STR==1|
                                                                 mort_2020$HAE.INFL==1|
                                                                 mort_2020$SEX.INFE==1|
                                                                 mort_2020$VARICELL==1|
                                                                 mort_2020$MEASLESS==1|
                                                                 mort_2020$RUBELLAA==1|
                                                                 mort_2020$VIRA.HEP==1|
                                                                 mort_2020$HIV.AIDS==1|
                                                                 mort_2020$MALARIAS==1|
                                                                 mort_2020$HAEM.MEN==1|
                                                                 mort_2020$TUBERCUL==1|
                                                                 mort_2020$UPG.CANC==1|
                                                                 mort_2020$LIV.CANC==1|
                                                                 mort_2020$LUN.CANC==1|
                                                                 mort_2020$MESOTHEL==1|
                                                                 mort_2020$MELANOMA==1|
                                                                 mort_2020$BLA.CANC==1|
                                                                 mort_2020$CER.CANC==1|
                                                                 mort_2020$NUT.ANEM==1|
                                                                 mort_2020$DIA.MELL==1|
                                                                 mort_2020$AOR.ANEU==1|
                                                                 mort_2020$HYP.DISE==1|
                                                                 mort_2020$ISH.HEAR==1|
                                                                 mort_2020$CER.VASC==1|
                                                                 mort_2020$ATH.DISE==1|
                                                                 mort_2020$INFLUENZ==1|
                                                                 mort_2020$PNE.STRE==1|
                                                                 mort_2020$CHR.RESP==1|
                                                                 mort_2020$LUN.DISE==1|
                                                                 mort_2020$TET.NEON==1|
                                                                 mort_2020$OBS.TETA==1|
                                                                 mort_2020$CER.CONG==1|
                                                                 mort_2020$TRAN.ACC==1|
                                                                 mort_2020$ACCI.INJ==1|
                                                                 mort_2020$INTE.HAR==1|
                                                                 mort_2020$ASSA.LES==1|
                                                                 mort_2020$ALCH.DIS==1|
                                                                 mort_2020$DRUG.REL==1|
                                                                 mort_2020$RESP.FAL==1|
                                                                 mort_2020$FLUID.DI==1|
                                                                 mort_2020$SHOCK.AN==1))]<-1

#Treatable mortality specific causes

mort_2020$TUBERCUL[((mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE>=15 & mort_2020$ICD_10_1.CODE<=19))|
                      (mort_2020$ICD_10_1.CHAPTER=="B" & (mort_2020$ICD_10_1.CODE==90))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==65)))]<-1
mort_2020$FIE.SCAR[((mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE==38)))]<-1
mort_2020$SEPSIS.A[((mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE>=40 & mort_2020$ICD_10_1.CODE<=41)))]<-1
mort_2020$CELLULIS[((mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE==46))|
                      (mort_2020$ICD_10_1.CHAPTER=="L" & (mort_2020$ICD_10_1.CODE==3)))]<-1
mort_2020$LEGIONEL[((mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE==48)))]<-1
mort_2020$STRE.ENT[((mort_2020$ICD_10_1.CHAPTER=="A" & (mort_2020$ICD_10_1.CODE==49)))]<-1
mort_2020$MENINGIS[((mort_2020$ICD_10_1.CHAPTER=="G" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=3)))]<-1
mort_2020$CERV.CAN[((mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==53)))]<-1
mort_2020$COLO.CAN[((mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE>=18 & mort_2020$ICD_10_1.CODE<=21)))]<-1
mort_2020$BREA.CAN[((mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==50)))]<-1
mort_2020$UTER.CAN[((mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE>=54 & mort_2020$ICD_10_1.CODE<=55)))]<-1
mort_2020$TEST.CAN[((mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==62)))]<-1
mort_2020$THYR.CAN[((mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==73)))]<-1
mort_2020$HODG.CAN[((mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==81)))]<-1
mort_2020$LYMP.CAN[((mort_2020$ICD_10_1.CHAPTER=="C" & (mort_2020$ICD_10_1.CODE==91)))]<-1
mort_2020$BENI.CAN[((mort_2020$ICD_10_1.CHAPTER=="D" & (mort_2020$ICD_10_1.CODE>=10 & mort_2020$ICD_10_1.CODE<=36)))]<-1
mort_2020$DIA.MELL[(mort_2020$ICD_10_1.CHAPTER=="E" & (mort_2020$ICD_10_1.CODE>=10 & mort_2020$ICD_10_1.CODE<=14))]<-1
mort_2020$THRO.DIS[(mort_2020$ICD_10_1.CHAPTER=="E" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=7))]<-1
mort_2020$ADRE.DIS[(mort_2020$ICD_10_1.CHAPTER=="E" & (mort_2020$ICD_10_1.CODE>=24 & mort_2020$ICD_10_1.CODE<=27))]<-1
mort_2020$EPIL.DIS[(mort_2020$ICD_10_1.CHAPTER=="G" & (mort_2020$ICD_10_1.CODE>=40 & mort_2020$ICD_10_1.CODE<=41))]<-1
mort_2020$AOR.ANEU[(mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE==71))]<-1
mort_2020$HYP.DISE[((mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE>=10 & mort_2020$ICD_10_1.CODE<=13))|
                      (mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE==15)))]<-1
mort_2020$ISH.HEAR[(mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE>=20 & mort_2020$ICD_10_1.CODE<=25))]<-1
mort_2020$CER.VASC[(mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE>=60 & mort_2020$ICD_10_1.CODE<=69))]<-1
mort_2020$ATH.DISE[(mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE==70 & mort_2020$ICD_10_1.CODE==73))]<-1
mort_2020$RHE.DISE[(mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=9))]<-1
mort_2020$VEN.TROM[((mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE==26))|
                      (mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE==80))| 
                      (mort_2020$ICD_10_1.CHAPTER=="I" & (mort_2020$ICD_10_1.CODE==82)))]<-1
mort_2020$UPP.RESP[((mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=6))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE>=30 & mort_2020$ICD_10_1.CODE<=39)))]<-1
mort_2020$PNEU.UNS[((mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==12))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==15))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==16))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==17))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==18)))]<-1
mort_2020$AC.LOW.R[((mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==20 & mort_2020$ICD_10_1.CODE<=22)))]<-1
mort_2020$ASTH.BRO[((mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==45 & mort_2020$ICD_10_1.CODE<=47)))]<-1
mort_2020$SIRA.RES[((mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==80)))]<-1
mort_2020$PUL.EDEM[((mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==81)))]<-1
mort_2020$ABS.LUNG[((mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==85))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==86)))]<-1
mort_2020$OTH.PLER[((mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==90))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==93))|
                      (mort_2020$ICD_10_1.CHAPTER=="J" & (mort_2020$ICD_10_1.CODE==94)))]<-1
mort_2020$GAS.DUOD[((mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE>=25 & mort_2020$ICD_10_1.CODE<=28)))]<-1
mort_2020$APPENDIC[((mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE>=35 & mort_2020$ICD_10_1.CODE<=38)))]<-1
mort_2020$ABDO.HER[((mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE>=40 & mort_2020$ICD_10_1.CODE<=46)))]<-1
mort_2020$CHOLELIT[((mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE>=80 & mort_2020$ICD_10_1.CODE<=81)))]<-1
mort_2020$OTH.GALB[((mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE>=82 & mort_2020$ICD_10_1.CODE<=83)))]<-1
mort_2020$ACU.PANC[((mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE==85)))]<-1
mort_2020$OTH.PANC[((mort_2020$ICD_10_1.CHAPTER=="K" & (mort_2020$ICD_10_1.CODE==86)))]<-1
mort_2020$NEPH.NEP[((mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=7)))]<-1
mort_2020$OBS.UROP[((mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE==13))|
                      (mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE>=20 & mort_2020$ICD_10_1.CODE<=21))|
                      (mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE==35)))]<-1
mort_2020$REN.FAIL[((mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE>=17 & mort_2020$ICD_10_1.CODE<=19)))]<-1
mort_2020$REN.COLI[((mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE==23)))]<-1
mort_2020$TUB.DISF[((mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE==25)))]<-1
mort_2020$UNF.NEFP[((mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE>=26 & mort_2020$ICD_10_1.CODE<=27)))]<-1
mort_2020$INF.GENU[((mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE==34))|
                      (mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE==70))|
                      (mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE==73))|
                      (mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE==75))|
                      (mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE==76)))]<-1
mort_2020$PROS.HYP[((mort_2020$ICD_10_1.CHAPTER=="N" & (mort_2020$ICD_10_1.CODE==40)))]<-1
mort_2020$PRE.CHIL[((mort_2020$ICD_10_1.CHAPTER=="O" & (mort_2020$ICD_10_1.CODE>=0 & mort_2020$ICD_10_1.CODE<=99)))]<-1
mort_2020$CONG.CVD[((mort_2020$ICD_10_1.CHAPTER=="Q" & (mort_2020$ICD_10_1.CODE>=20 & mort_2020$ICD_10_1.CODE<=28)))]<-1
mort_2020$DRUGS.AE[((mort_2020$ICD_10_1.CHAPTER=="Y" & (mort_2020$ICD_10_1.CODE>=40 & mort_2020$ICD_10_1.CODE<=59)))]<-1
mort_2020$QX.DR.AE[((mort_2020$ICD_10_1.CHAPTER=="Y" & (mort_2020$ICD_10_1.CODE>=60 & mort_2020$ICD_10_1.CODE<=69))|
                      (mort_2020$ICD_10_1.CHAPTER=="Y" & (mort_2020$ICD_10_1.CODE>=83 & mort_2020$ICD_10_1.CODE<=84)))]<-1
mort_2020$MD.DR.AE[((mort_2020$ICD_10_1.CHAPTER=="Y" & (mort_2020$ICD_10_1.CODE>=70 & mort_2020$ICD_10_1.CODE<=82)))]<-1


#Treatable mortality final coding 

mort_2020$TREATAB<-NULL
mort_2020$TREATAB[((mort_2020$COVID==0) & (mort_2020$EDAD>=0 & mort_2020$EDAD<=74) & (mort_2020$TUBERCUL==1|
                                                                 mort_2020$FIE.SCAR==1|
                                                                 mort_2020$SEPSIS.A==1|
                                                                 mort_2020$CELLULIS==1|
                                                                 mort_2020$LEGIONEL==1|
                                                                 mort_2020$STRE.ENT==1|
                                                                 mort_2020$MENINGIS==1|
                                                                 mort_2020$COLO.CAN==1|
                                                                 mort_2020$CERV.CAN==1|
                                                                 mort_2020$BREA.CAN==1|
                                                                 mort_2020$UTER.CAN==1|
                                                                 mort_2020$TEST.CAN==1|
                                                                 mort_2020$THYR.CAN==1|
                                                                 mort_2020$HODG.CAN==1|
                                                                 mort_2020$LYMP.CAN==1|
                                                                 mort_2020$BENI.CAN==1|
                                                                 mort_2020$DIA.MELL==1|
                                                                 mort_2020$THRO.DIS==1|
                                                                 mort_2020$ADRE.DIS==1|
                                                                 mort_2020$EPIL.DIS==1|
                                                                 mort_2020$AOR.ANEU==1|
                                                                 mort_2020$HYP.DISE==1|
                                                                 mort_2020$ISH.HEAR==1|
                                                                 mort_2020$CER.VASC==1|
                                                                 mort_2020$ATH.DISE==1|
                                                                 mort_2020$RHE.DISE==1|
                                                                 mort_2020$VEN.TROM==1|
                                                                 mort_2020$UPP.RESP==1|
                                                                 mort_2020$PNEU.UNS==1|
                                                                 mort_2020$AC.LOW.R==1|
                                                                 mort_2020$ASTH.BRO==1|
                                                                 mort_2020$SIRA.RES==1|
                                                                 mort_2020$PUL.EDEM==1|
                                                                 mort_2020$ABS.LUNG==1|
                                                                 mort_2020$OTH.PLER==1|
                                                                 mort_2020$GAS.DUOD==1|
                                                                 mort_2020$APPENDIC==1|
                                                                 mort_2020$ABDO.HER==1|
                                                                 mort_2020$CHOLELIT==1|
                                                                 mort_2020$OTH.GALB==1|
                                                                 mort_2020$ACU.PANC==1|
                                                                 mort_2020$OTH.PANC==1|
                                                                 mort_2020$NEPH.NEP==1|
                                                                 mort_2020$OBS.UROP==1|
                                                                 mort_2020$REN.FAIL==1|
                                                                 mort_2020$REN.COLI==1|
                                                                 mort_2020$TUB.DISF==1|
                                                                 mort_2020$UNF.NEFP==1|
                                                                 mort_2020$INF.GENU==1|
                                                                 mort_2020$PROS.HYP==1|
                                                                 mort_2020$PRE.CHIL==1|
                                                                 mort_2020$CONG.CVD==1|
                                                                 mort_2020$DRUGS.AE==1|
                                                                 mort_2020$QX.DR.AE==1|
                                                                 mort_2020$MD.DR.AE==1))]<-1
#Final coding

mort_2020$TREA.PREV<-NULL
mort_2020$TREA.PREV[mort_2020$TREATAB==1 & (is.na(mort_2020$PREVENT) & !is.na(mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1))]<-1
mort_2020$TREA.PREV[mort_2020$PREVENT==1 & (is.na(mort_2020$TREATAB) & !is.na(mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1))]<-2
mort_2020$TREA.PREV[mort_2020$TREATAB==1 & mort_2020$PREVENT==1]<-3
mort_2020$TREA.PREV[(!is.na(mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1)) & (is.na(mort_2020$TREATAB) & is.na(mort_2020$PREVENT))]<-4



#Cause Specific Mortality

mort_2020$ICD_10_1.SUB<-as.numeric(substring(mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1,4))

## Intestinal Infectious Diseases ##
mort_2020$EII.COLE<-NULL; mort_2020$EII.COLE[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==0))]<-1 #Cholera
mort_2020$EII.TIPA<-NULL; mort_2020$EII.TIPA[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==1))]<-1 #Typhoid and paratyphoid fever
mort_2020$EII.SHIG<-NULL; mort_2020$EII.SHIG[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==3))]<-1 #Shigellosis
mort_2020$EII.TOXI<-NULL; mort_2020$EII.TOXI[with(mort_2020, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==2|ICD_10_1.CODE==5)))]<-1 #Food poisoning
mort_2020$EII.AMEB<-NULL; mort_2020$EII.AMEB[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==6))]<-1 #Amebiasis
mort_2020$EII.OTRA<-NULL; mort_2020$EII.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==4|ICD_10_1.CODE==7|ICD_10_1.CODE==8)))]<-1 #Other GI infection
mort_2020$EII.PRES<-NULL; mort_2020$EII.PRES[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==9))]<-1 #Presumed GI infection

## Tuberculosis ##
mort_2020$TUB.PULM<-NULL; mort_2020$TUB.PULM[with(mort_2020,(ICD_10_1.CHAPTER=="A" & #Pulmonary TB
                                                               ((ICD_10_1.CODE==15 & (ICD_10_1.SUB<=3|ICD_10_1.SUB==7|ICD_10_1.SUB==9))|
                                                                  (ICD_10_1.CODE==16 & (ICD_10_1.SUB<=2|ICD_10_1.SUB==7|ICD_10_1.SUB==9)) ) ))]<-1 
mort_2020$TUB.RESP<-NULL; mort_2020$TUB.RESP[with(mort_2020,(ICD_10_1.CHAPTER=="A" & #Other respiratory TB
                                                               ((ICD_10_1.CODE==15 & (ICD_10_1.SUB==4|ICD_10_1.SUB==5|ICD_10_1.SUB==6|ICD_10_1.SUB==8))|
                                                                  (ICD_10_1.CODE==16 & (ICD_10_1.SUB==3|ICD_10_1.SUB==4|ICD_10_1.SUB==5|ICD_10_1.SUB==8)))))]<-1 
mort_2020$TUB.NERV<-NULL; mort_2020$TUB.NERV[with(mort_2020, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==17) ))]<-1 #Nervous System TB
mort_2020$TUB.IPGM<-NULL; mort_2020$TUB.IPGM[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==3))]<-1 #Intestinal/peritoneal Tb
mort_2020$TUB.BONE<-NULL; mort_2020$TUB.BONE[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==0))]<-1 #Bone and joint Tb
mort_2020$TUB.URIN<-NULL; mort_2020$TUB.URIN[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==1))]<-1 #Genitourinary Tb
mort_2020$TUB.OTRA<-NULL; mort_2020$TUB.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="A" & #Other Tb
                                                                ((ICD_10_1.CODE==18 & (ICD_10_1.SUB==2|ICD_10_1.SUB>=4))|(ICD_10_1.CODE==19)) )) ]<-1

## Other bacterial diseases ##
mort_2020$BAC.PEST<-NULL; mort_2020$BAC.PEST[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==20))]<-1 #Plague (peste)
mort_2020$BAC.BRUS<-NULL; mort_2020$BAC.BRUS[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==23))]<-1 #Brusellosis
mort_2020$BAC.LEPR<-NULL; mort_2020$BAC.LEPR[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==30))]<-1 #Leprosy
mort_2020$BAC.DIFT<-NULL; mort_2020$BAC.DIFT[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==36))]<-1 #Diphtheria
mort_2020$BAC.PERT<-NULL; mort_2020$BAC.PERT[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==37))]<-1 #Pertussis
mort_2020$BAC.PYOG<-NULL; mort_2020$BAC.PYOG[with(mort_2020, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==38|ICD_10_1.CODE==46)))]<-1 #Scarlet fever, erysipelas
mort_2020$BAC.MENI<-NULL; mort_2020$BAC.MENI[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==39))]<-1 #Meningococcal disease
mort_2020$BAC.TETA<-NULL; mort_2020$BAC.TETA[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==35))]<-1 #Tetanus
mort_2020$BAC.SEPS<-NULL; mort_2020$BAC.SEPS[with(mort_2020, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==40|ICD_10_1.CODE==41) ))]<-1 #Sepsis
mort_2020$BAC.OTRA<-NULL; mort_2020$BAC.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="A" &
                                                                (ICD_10_1.CODE==21|ICD_10_1.CODE==22|(ICD_10_1.CODE>=24&ICD_10_1.CODE<=28)|
                                                                   ICD_10_1.CODE==31|ICD_10_1.CODE==32|(ICD_10_1.CODE>=42&ICD_10_1.CODE<=44)|
                                                                   ICD_10_1.CODE==48|ICD_10_1.CODE==49)))]<-1 #Other

## Sexually transmitted diseases ##
mort_2020$ETS.SIF1<-NULL; mort_2020$ETS.SIF1[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==50))]<-1 #Congenital syphilis
mort_2020$ETS.SIF2<-NULL; mort_2020$ETS.SIF2[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==51))]<-1 #Early syphilis
mort_2020$ETS.SIF3<-NULL; mort_2020$ETS.SIF3[with(mort_2020, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==52|ICD_10_1.CODE==53)))]<-1 #Other syphilis
mort_2020$ETS.GONO<-NULL; mort_2020$ETS.GONO[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==54))]<-1 #Gonorrhea
mort_2020$ETS.CLAM<-NULL; mort_2020$ETS.CLAM[with(mort_2020, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==55|ICD_10_1.CODE==56)))]<-1 #Chlamydia
mort_2020$ETS.OTRA<-NULL; mort_2020$ETS.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE>=57&ICD_10_1.CODE<=64)))]<-1 #Other STD



## Viral diseases ##
mort_2020$VIR.POLI<-NULL; mort_2020$VIR.POLI[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==80))]<-1 #Acute Poliomyelitis
mort_2020$VIR.VIRU<-NULL; mort_2020$VIR.VIRU[with(mort_2020, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==3|ICD_10_1.CODE==4)))]<-1 #Smallpox (viruela)
mort_2020$VIR.SARA<-NULL; mort_2020$VIR.SARA[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==5))]<-1 #Measles
mort_2020$VIR.RUBE<-NULL; mort_2020$VIR.RUBE[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==6))]<-1 #Rubella
mort_2020$VIR.FIAM<-NULL; mort_2020$VIR.FIAM[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==95))]<-1 #Yellow fever
mort_2020$VIR.DENG<-NULL; mort_2020$VIR.DENG[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==90))]<-1 #Dengue fever
mort_2020$VIR.DHEM<-NULL; mort_2020$VIR.DHEM[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==91))]<-1 #Dengue hemorragic fever
mort_2020$VIR.VIH1<-NULL; mort_2020$VIR.VIH1[with(mort_2020, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=24)))]<-1 #HIV infection
mort_2020$VIR.EVTA<-NULL; mort_2020$VIR.EVTA[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE==85&ICD_10_1.SUB==2)| #Arthropod-Borne Viral Encephalitis
                                                                                         ICD_10_1.CODE==83|ICD_10_1.CODE==84|ICD_10_1.CODE==86)))]<-1 
mort_2020$VIR.HEPB<-NULL; mort_2020$VIR.HEPB[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==16))]<-1 #Acute Hepatitis B
mort_2020$VIR.HEPO<-NULL; mort_2020$VIR.HEPO[with(mort_2020, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==15| #Other viral hepatitis
                                                                                         (ICD_10_1.CODE>=17&ICD_10_1.CODE<=19))))]<-1 
mort_2020$VIR.RABI<-NULL; mort_2020$VIR.RABI[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==82))]<-1 #Rabies
mort_2020$VIR.TRAC<-NULL; mort_2020$VIR.TRAC[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==71))]<-1 #Trachoma (??)


#Other arthropod-borne viral fevers and viral hemorrhagic fevers
mort_2020$VIR.OFAH<-NULL; mort_2020$VIR.OFAH[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE>=92&ICD_10_1.CODE<=94)|
                                                                                         (ICD_10_1.CODE>=96&ICD_10_1.CODE<=99))))]<-1 
mort_2020$VIR.HERP<-NULL; mort_2020$VIR.HERP[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==0))]<-1 #Herpes simplex infections
mort_2020$VIR.VRHZ<-NULL; mort_2020$VIR.VRHZ[with(mort_2020, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==1|ICD_10_1.CODE==2) ))]<-1 #Chickenpox or herpes zoster
mort_2020$VIR.PARO<-NULL; mort_2020$VIR.PARO[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==26))]<-1 #Mumps
mort_2020$VIR.OCLA<-NULL; mort_2020$VIR.OCLA[with(mort_2020, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==70|ICD_10_1.CODE==74)))]<-1 #Other chlamydia infections (??)
mort_2020$VIR.OTRA<-NULL; mort_2020$VIR.OTRA[with(mort_2020, ((ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE==85&(ICD_10_1.SUB==0|ICD_10_1.SUB==1|ICD_10_1.SUB==8))|
                                                                                          ICD_10_1.CODE==81|(ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)))|
                                                                (ICD_10_1.CHAPTER=="B" & ((ICD_10_1.CODE>=7&ICD_10_1.CODE<=9)|ICD_10_1.CODE==25|
                                                                                            (ICD_10_1.CODE>=27&ICD_10_1.CODE<=34)))))]<-1 #Other viral diseases


## Rickettsiosis and Protozoan Infections ##
mort_2020$RPI.TIFP<-NULL; mort_2020$RPI.TIFP[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==75 & ICD_10_1.SUB==0))]<-1 #Louse-borne epidemic thypus
mort_2020$RPI.OTIF<-NULL; mort_2020$RPI.OTIF[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==75 & ICD_10_1.SUB!=0))]<-1 #Other thypus
mort_2020$RPI.ORIC<-NULL; mort_2020$RPI.ORIC[with(mort_2020, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE>=77&ICD_10_1.CODE<=79) ))]<-1 #Other rickettsiosis
mort_2020$RPI.PALU<-NULL; mort_2020$RPI.PALU[with(mort_2020, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=54) ))]<-1 #Malaria
mort_2020$RPI.LEIS<-NULL; mort_2020$RPI.LEIS[with(mort_2020, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==55) ))]<-1 #Leishmaniasis
mort_2020$RPI.TRIP<-NULL; mort_2020$RPI.TRIP[with(mort_2020, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==56|ICD_10_1.CODE==57) ))]<-1 #Trypanosomiasis

## Parasitic worms, Mycosis and Other infectious diseases ##
mort_2020$PMO.ESPI<-NULL; mort_2020$PMO.ESPI[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE>=65&ICD_10_1.CODE<=67)|
                                                                                         ICD_10_1.CODE==69)))]<-1 #Other spirochetal diseases (Not syphilis)
mort_2020$PMO.FIRE<-NULL; mort_2020$PMO.FIRE[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==68))]<-1 #Relapsing fevers
mort_2020$PMO.MICO<-NULL; mort_2020$PMO.MICO[with(mort_2020, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=49) ))]<-1 #Mycosis 
mort_2020$PMO.SCHI<-NULL; mort_2020$PMO.SCHI[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==65))]<-1 #Schistosomiasis
mort_2020$PMO.TREM<-NULL; mort_2020$PMO.TREM[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==66))]<-1 #Other fluke (trematoda) infections
mort_2020$PMO.ECHI<-NULL; mort_2020$PMO.ECHI[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==67))]<-1 #Echinococcosis
mort_2020$PMO.DRAC<-NULL; mort_2020$PMO.DRAC[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==72))]<-1 #Dracunculiasis
mort_2020$PMO.ONCH<-NULL; mort_2020$PMO.ONCH[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==73))]<-1 #Onchocerciasis
mort_2020$PMO.FILA<-NULL; mort_2020$PMO.FILA[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==74))]<-1 #Filariasis
mort_2020$PMO.ANNE<-NULL; mort_2020$PMO.ANNE[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==76))]<-1 #Ancylostomiasis or Necatoriasis
mort_2020$PMO.HELM<-NULL; mort_2020$PMO.HELM[with(mort_2020, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==75|(ICD_10_1.CODE>=68&ICD_10_1.CODE<=71)|
                                                                                         (ICD_10_1.CODE>=77&ICD_10_1.CODE<=83))))]<-1 #Other Helminthiases
mort_2020$PMO.OTRA<-NULL; mort_2020$PMO.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==99|(ICD_10_1.CODE>=58&ICD_10_1.CODE<=64)|
                                                                                         (ICD_10_1.CODE>=85&ICD_10_1.CODE<=89)| 
                                                                                         (ICD_10_1.CODE>=95&ICD_10_1.CODE<=97))))]<-1 #Other infectious/parasitic disease

## Sequelae of infectious diseases ##
mort_2020$SEI.TUBE<-NULL; mort_2020$SEI.TUBE[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==90))]<-1 #Tuberculosis sequelae
mort_2020$SEI.POLI<-NULL; mort_2020$SEI.POLI[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==91))]<-1 #Poliomyelitis sequelae
mort_2020$SEI.LEPR<-NULL; mort_2020$SEI.LEPR[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==92))]<-1 #Leprosy sequelae
mort_2020$SEI.OTRA<-NULL; mort_2020$SEI.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==94))]<-1 #Sequelae from other infections

## Malignant neoplasms 1: lip, oral cavity and pharynx ##
mort_2020$NM1.LCBF<-NULL; mort_2020$NM1.LCBF[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=14)))]<-1

## Malignant neoplasms 2: digestive organs ##
mort_2020$NM2.ESOF<-NULL; mort_2020$NM2.ESOF[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==15))]<-1 #Esophagus
mort_2020$NM2.STOM<-NULL; mort_2020$NM2.STOM[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==16))]<-1 #Stomach
mort_2020$NM2.INDE<-NULL; mort_2020$NM2.INDE[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==17))]<-1 #Small intestine
mort_2020$NM2.COLO<-NULL; mort_2020$NM2.COLO[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==18))]<-1 #Colon
mort_2020$NM2.RECT<-NULL; mort_2020$NM2.RECT[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=19&ICD_10_1.CODE<=21)))]<-1 #Rectosigmoid junction, Rectum, Anus and anal canal
mort_2020$NM2.HIGA<-NULL; mort_2020$NM2.HIGA[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==22))]<-1 #Liver and intrahepatic bile ducts
mort_2020$NM2.PANC<-NULL; mort_2020$NM2.PANC[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==25))]<-1 #Pancreas
mort_2020$NM2.OTRO<-NULL; mort_2020$NM2.OTRO[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==23|ICD_10_1.CODE==24|ICD_10_1.CODE==26)))]<-1 #Other

## Malignant neoplasms 3: respiratory and intrathoracic organs ##
mort_2020$NM3.LARI<-NULL; mort_2020$NM3.LARI[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==32))]<-1 #Larynx
mort_2020$NM3.TBPU<-NULL; mort_2020$NM3.TBPU[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==33|ICD_10_1.CODE==34)))]<-1 #Trachea, bronchus and lung
mort_2020$NM3.OTRO<-NULL; mort_2020$NM3.OTRO[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==30|ICD_10_1.CODE==31|
                                                                                         (ICD_10_1.CODE>=37&ICD_10_1.CODE<=39))))]<-1 #Other

## Malignant neoplasms 4: bone, articular cartilage, skin, soft tissues and breast ##
mort_2020$NM4.BONE<-NULL; mort_2020$NM4.BONE[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==40|ICD_10_1.CODE==41)))]<-1 #Bone and articular cartilage
mort_2020$NM4.MELA<-NULL; mort_2020$NM4.MELA[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==43))]<-1 #Malignant melanoma of skin
mort_2020$NM4.SKIN<-NULL; mort_2020$NM4.SKIN[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==44))]<-1 #Other malignant neoplasm of skin
mort_2020$NM4.MAMA<-NULL; mort_2020$NM4.MAMA[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==50))]<-1 #Breast
mort_2020$NM4.SOFT<-NULL; mort_2020$NM4.SOFT[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=45&ICD_10_1.CODE<=49)))]<-1 #Mesothelial and soft tissue

## Malignant neoplasms 5: genitourinary organs ##
mort_2020$NM5.CERV<-NULL; mort_2020$NM5.CERV[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==53))]<-1 #Cervix uteri
mort_2020$NM5.PLAC<-NULL; mort_2020$NM5.PLAC[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==58))]<-1 #Placenta
mort_2020$NM5.UTER<-NULL; mort_2020$NM5.UTER[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==54|ICD_10_1.CODE==55)))]<-1 #Uterus
mort_2020$NM5.OVAR<-NULL; mort_2020$NM5.OVAR[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==56))]<-1 #Ovary
mort_2020$NM5.VAGI<-NULL; mort_2020$NM5.VAGI[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==51|ICD_10_1.CODE==52)))]<-1 #Vulva and vagina
mort_2020$NM5.OTFE<-NULL; mort_2020$NM5.OTFE[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==57))]<-1 #Other and unspecified (female)
mort_2020$NM5.PROS<-NULL; mort_2020$NM5.PROS[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==61))]<-1 #Prostate
mort_2020$NM5.TEST<-NULL; mort_2020$NM5.TEST[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==62))]<-1 #Testis
mort_2020$NM5.OTMA<-NULL; mort_2020$NM5.OTMA[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==60|ICD_10_1.CODE==63)))]<-1 #Other and unspecified (male)
mort_2020$NM5.VEJI<-NULL; mort_2020$NM5.VEJI[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==67))]<-1 #Bladder
mort_2020$NM5.OTUR<-NULL; mort_2020$NM5.OTUR[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ((ICD_10_1.CODE>=64&ICD_10_1.CODE<=66)|
                                                                                         ICD_10_1.CODE==68)))]<-1 #Other urinary tract neoplasms


## Malignant neoplasms 6: other organs and unspecified sites ##
mort_2020$NM6.ENCF<-NULL; mort_2020$NM6.ENCF[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==71))]<-1 #Brain
mort_2020$NM6.MENI<-NULL; mort_2020$NM6.MENI[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==70|ICD_10_1.CODE==72)))]<-1 #Meninges and other SNC
mort_2020$NM6.OJOA<-NULL; mort_2020$NM6.OJOA[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==69))]<-1 #Eyes and adnexa
mort_2020$NM6.OTRO<-NULL; mort_2020$NM6.OTRO[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=73&ICD_10_1.CODE<=80)))]<-1 #Other and unspecified

## Malignant neoplasms 7: lymphoid, hematopoietic and related tissue ##
mort_2020$NM7.ENHO<-NULL; mort_2020$NM7.ENHO[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==81))]<-1 #Hodgkin lymphoma
mort_2020$NM7.NOHO<-NULL; mort_2020$NM7.NOHO[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=82&ICD_10_1.CODE<=85)))]<-1 #Non-Hodgkin lymphoma
mort_2020$NM7.MMCP<-NULL; mort_2020$NM7.MMCP[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==90))]<-1 #Multiple myeloma and plasmatic cell neoplasms
mort_2020$NM7.LEUC<-NULL; mort_2020$NM7.LEUC[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=91&ICD_10_1.CODE<=95)))]<-1 #Leukemias
mort_2020$NM7.OTRO<-NULL; mort_2020$NM7.OTRO[with(mort_2020, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==88|ICD_10_1.CODE==96)))]<-1 #Other


## Malignant neoplasms 8: multiple primary tumors ##
mort_2020$NM8.MUPT<-NULL; mort_2020$NM8.MUPT[with(mort_2020, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==97))]<-1

## In situ neoplasms ##
mort_2020$NIS.CERV<-NULL; mort_2020$NIS.CERV[with(mort_2020, (ICD_10_1.CHAPTER=="D" & ICD_10_1.CODE==6))]<-1 #Cervix uteri
mort_2020$NIS.OTRO<-NULL; mort_2020$NIS.OTRO[with(mort_2020, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=5)| #Other in situ neoplasms
                                                                                         (ICD_10_1.CODE>=7&ICD_10_1.CODE<=9))))]<-1

## Benign neoplasms ##
mort_2020$NBE.SKIN<-NULL; mort_2020$NBE.SKIN[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==22|ICD_10_1.CODE==23) ))]<-1 #Skin
mort_2020$NBE.MAMA<-NULL; mort_2020$NBE.MAMA[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==24)))]<-1 #Breast
mort_2020$NBE.LEIO<-NULL; mort_2020$NBE.LEIO[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==25)))]<-1 #Leiomyoma of uterus
mort_2020$NBE.OVAR<-NULL; mort_2020$NBE.OVAR[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==27)))]<-1 #Ovary
mort_2020$NBE.URIN<-NULL; mort_2020$NBE.URIN[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==30)))]<-1 #Urinary tract
mort_2020$NBE.CSNC<-NULL; mort_2020$NBE.CSNC[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==33)))]<-1 #Brain and other CNS sites
mort_2020$NBE.TIRO<-NULL; mort_2020$NBE.TIRO[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==34)))]<-1 #Thyroid
mort_2020$NBE.OTRO<-NULL; mort_2020$NBE.OTRO[with(mort_2020, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=21)|ICD_10_1.CODE==26|
                                                                                         ICD_10_1.CODE==28|ICD_10_1.CODE==29|ICD_10_1.CODE==31|
                                                                                         ICD_10_1.CODE==32|ICD_10_1.CODE==35|ICD_10_1.CODE==36)))]<-1 #Other


## Neoplasms of uncertain behaviour ##
mort_2020$NCI.UNCB<-NULL; mort_2020$NCI.UNCB[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=37&ICD_10_1.CODE<=48)))]<-1

## Diseases of the blood and blood-forming organs and certain disorders involving the immune mechanism ##
mort_2020$SAN.ADFE<-NULL; mort_2020$SAN.ADFE[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==50)))]<-1 #Iron deficiency anemia
mort_2020$SAN.AOTR<-NULL; mort_2020$SAN.AOTR[with(mort_2020, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=51&ICD_10_1.CODE<=62)|ICD_10_1.CODE==64)))]<-1 #Other anemias
mort_2020$SAN.INMU<-NULL; mort_2020$SAN.INMU[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=89)))]<-1 #Immunity disorders
mort_2020$SAN.OTRA<-NULL; mort_2020$SAN.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=65&ICD_10_1.CODE<=76)))]<-1 #Other

## Endocrine and metabolic diseases ##
mort_2020$END.DEYO<-NULL; mort_2020$END.DEYO[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)))]<-1 #Iodine deficiency thyroid disorders
mort_2020$END.TTOX<-NULL; mort_2020$END.TTOX[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==5)))]<-1 #Thyrotoxicosis
mort_2020$END.TOTR<-NULL; mort_2020$END.TOTR[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==3|ICD_10_1.CODE==4|ICD_10_1.CODE==6|
                                                                                         ICD_10_1.CODE==7) ))]<-1 #Other thyroid disorders
mort_2020$END.DIAB<-NULL; mort_2020$END.DIAB[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=14)))]<-1 #Type 2 diabetes mellitus
mort_2020$END.LIPO<-NULL; mort_2020$END.LIPO[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==78)))]<-1 #Metabolism disorders and dyslipidemia
mort_2020$END.OBES<-NULL; mort_2020$END.OBES[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==66)))]<-1 #Obesity
mort_2020$END.DEPL<-NULL; mort_2020$END.DEPL[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==86)))]<-1 #Volume depletion
mort_2020$END.SQHA<-NULL; mort_2020$END.SQHA[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==68)))]<-1 #Sequelae of hyperalimentation
mort_2020$END.OTRA<-NULL; mort_2020$END.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="E" & ((ICD_10_1.CODE>=15&ICD_10_1.CODE<=34)|ICD_10_1.CODE==65|
                                                                                         ICD_10_1.CODE==67|(ICD_10_1.CODE>=70&ICD_10_1.CODE<=77)|
                                                                                         (ICD_10_1.CODE>=79&ICD_10_1.CODE<=85)|
                                                                                         (ICD_10_1.CODE>=87&ICD_10_1.CODE<=88))))]<-1 #Other


## Malnutrition and other nutritional deficiencies ##
mort_2020$NUT.KWAS<-NULL; mort_2020$NUT.KWAS[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==40|ICD_10_1.CODE==42) ))]<-1 #Kwashiorkor
mort_2020$NUT.MARA<-NULL; mort_2020$NUT.MARA[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==41) ))]<-1 #Nutritional marasmus
mort_2020$NUT.PROT<-NULL; mort_2020$NUT.PROT[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=43&ICD_10_1.CODE<=46)))]<-1 #Other protein-calorie malnutrition
mort_2020$NUT.VITA<-NULL; mort_2020$NUT.VITA[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==50) ))]<-1 #Vitamin A deficiency
mort_2020$NUT.VITO<-NULL; mort_2020$NUT.VITO[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=51&ICD_10_1.CODE<=56)))]<-1 #Other vitamin deficiencies
mort_2020$NUT.SECD<-NULL; mort_2020$NUT.SECD[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==64) ))]<-1 #Sequelae of malnutrition
mort_2020$NUT.OTRA<-NULL; mort_2020$NUT.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=63)))]<-1 #Other nutritional deficiencies


## Mental, Behavioral and Neurodevelopmental disorders ##
mort_2020$MEN.DEME<-NULL; mort_2020$MEN.DEME[with(mort_2020, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE==1|ICD_10_1.CODE==3)))]<-1 #Dementia
mort_2020$MEN.SDAL<-NULL; mort_2020$MEN.SDAL[with(mort_2020, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==10 & ICD_10_1.SUB==2))]<-1 #Alcohol dependence syndrome
mort_2020$MEN.OTAL<-NULL; mort_2020$MEN.OTAL[with(mort_2020, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==10 & ICD_10_1.SUB!=2))]<-1 #Other alcohol related disorders
mort_2020$MEN.TMSP<-NULL; mort_2020$MEN.TMSP[with(mort_2020, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=11&ICD_10_1.CODE<=19)))]<-1 #Mental and behavioral disorders due to other psychoactive substances use
mort_2020$MEN.ESQU<-NULL; mort_2020$MEN.ESQU[with(mort_2020, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=29)))]<-1 #Schizophrenia, schizotypal, delusional, and other non-mood psychotic disorders
mort_2020$MEN.HUMO<-NULL; mort_2020$MEN.HUMO[with(mort_2020, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=39)))]<-1 #Mood [affective] disorders
mort_2020$MEN.ESTR<-NULL; mort_2020$MEN.ESTR[with(mort_2020, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=48)))]<-1 #Anxiety, dissociative, stress-related, somatoform and other nonpsychotic mental disorders
mort_2020$MEN.FISI<-NULL; mort_2020$MEN.FISI[with(mort_2020, (ICD_10_1.CHAPTER=="F" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=59)&
                                                                                         (ICD_10_1.CODE!=53) )))]<-1 #Behavioral syndromes associated with physiological disturbances and physical factors
mort_2020$MEN.RETR<-NULL; mort_2020$MEN.RETR[with(mort_2020, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=70&ICD_10_1.CODE<=79)))]<-1 #Intellectual disabilities
mort_2020$MEN.OTRO<-NULL; mort_2020$MEN.OTRO[with(mort_2020, (ICD_10_1.CHAPTER=="F" & ((ICD_10_1.CODE>=4&ICD_10_1.CODE<=9)|(ICD_10_1.CODE>=60&ICD_10_1.CODE<=69)|
                                                                                         (ICD_10_1.CODE>=80&ICD_10_1.CODE<=99))))]<-1 #Other mental and behavioral disorders



## Diseases of the nervous system ##
mort_2020$NER.MENI<-NULL; mort_2020$NER.MENI[with(mort_2020, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==0|ICD_10_1.CODE==3)))]<-1 #Meningitis
mort_2020$NER.ISNC<-NULL; mort_2020$NER.ISNC[with(mort_2020, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=4&ICD_10_1.CODE<=9)))]<-1 #Other inflammatory diseases of the central nervous system
mort_2020$NER.PARK<-NULL; mort_2020$NER.PARK[with(mort_2020, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==20)))]<-1 #Parkinson's disease
mort_2020$NER.ALZH<-NULL; mort_2020$NER.ALZH[with(mort_2020, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==30)))]<-1 #Alzheimer's disease
mort_2020$NER.ESCM<-NULL; mort_2020$NER.ESCM[with(mort_2020, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==35)))]<-1 #Multiple sclerosis
mort_2020$NER.PALS<-NULL; mort_2020$NER.PALS[with(mort_2020, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=83)))]<-1 #Cerebral palsy and other paralytic syndromes
mort_2020$NER.EPIL<-NULL; mort_2020$NER.EPIL[with(mort_2020, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=41)))]<-1 #Epilepsy and recurrent seizures
mort_2020$NER.MIGR<-NULL; mort_2020$NER.MIGR[with(mort_2020, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=43&ICD_10_1.CODE<=44)))]<-1 #Migraine and other headache syndromes
mort_2020$NER.IQCT<-NULL; mort_2020$NER.IQCT[with(mort_2020, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==45)))]<-1 #Transient cerebral ischemic attacks and related syndromes
mort_2020$NER.SNPE<-NULL; mort_2020$NER.SNPE[with(mort_2020, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=59)))]<-1 #Nerve, nerve root and plexus disorders
mort_2020$NER.OTRA<-NULL; mort_2020$NER.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="G" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=12)|(ICD_10_1.CODE>=21&ICD_10_1.CODE<=25)|
                                                                                         (ICD_10_1.CODE==31)|(ICD_10_1.CODE==36)|(ICD_10_1.CODE==37)|(ICD_10_1.CODE==47)|
                                                                                         (ICD_10_1.CODE>=60&ICD_10_1.CODE<=62)|(ICD_10_1.CODE>=64&ICD_10_1.CODE<=72)|
                                                                                         (ICD_10_1.CODE>=90&ICD_10_1.CODE<=93)|(ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other



## Diseases of the eye and adnexa ##
mort_2020$EYE.PARP<-NULL; mort_2020$EYE.PARP[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Eyelid inflammation
mort_2020$EYE.ESCL<-NULL; mort_2020$EYE.ESCL[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=15&ICD_10_1.CODE<=19)))]<-1 #Disorders of sclera and cornea
mort_2020$EYE.GLAU<-NULL; mort_2020$EYE.GLAU[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==40)))]<-1 #Glaucoma
mort_2020$EYE.CATA<-NULL; mort_2020$EYE.CATA[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=25&ICD_10_1.CODE<=26)))]<-1 #Cataracts
mort_2020$EYE.CRIS<-NULL; mort_2020$EYE.CRIS[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==27)))]<-1 #Other disorders of lens
mort_2020$EYE.RETI<-NULL; mort_2020$EYE.RETI[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==33)))]<-1 #Retinal detachments and breaks
mort_2020$EYE.CEGU<-NULL; mort_2020$EYE.CEGU[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==54)))]<-1 #Blindness and low vision
mort_2020$EYE.CONJ<-NULL; mort_2020$EYE.CONJ[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==10)))]<-1 #Conjunctivitis
mort_2020$EYE.OTCO<-NULL; mort_2020$EYE.OTCO[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==11)))]<-1 #Other disorders of conjunctiva
mort_2020$EYE.LAGR<-NULL; mort_2020$EYE.LAGR[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==4)))]<-1 #Disorders of lacrimal system
mort_2020$EYE.ESTR<-NULL; mort_2020$EYE.ESTR[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=49&ICD_10_1.CODE<=50)))]<-1 #Strabismus
mort_2020$EYE.BINO<-NULL; mort_2020$EYE.BINO[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==51)))]<-1 #Other disorders of binocular movement
mort_2020$EYE.REFR<-NULL; mort_2020$EYE.REFR[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==52)))]<-1 #Disorders of refraction and accommodation
mort_2020$EYE.OTRA<-NULL; mort_2020$EYE.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE==2)|(ICD_10_1.CODE==5)|(ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)|
                                                                                         (ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)|(ICD_10_1.CODE>=34&ICD_10_1.CODE<=35)|
                                                                                         (ICD_10_1.CODE>=43&ICD_10_1.CODE<=44)|(ICD_10_1.CODE>=46&ICD_10_1.CODE<=47)|
                                                                                         (ICD_10_1.CODE==53)|(ICD_10_1.CODE==59)|
                                                                                         (ICD_10_1.CODE>=55&ICD_10_1.CODE<=57))))]<-1 #Other

## Diseases of the ear and mastoid process ##
mort_2020$EAR.OMTM<-NULL; mort_2020$EAR.OMTM[with(mort_2020, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE==65)|(ICD_10_1.CODE==66)| #Otitis media, disorders of Eustachian tube and mastoiditis
                                                                                         (ICD_10_1.CODE>=68&ICD_10_1.CODE<=70))))]<-1
mort_2020$EAR.OTOM<-NULL; mort_2020$EAR.OTOM[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=71&ICD_10_1.CODE<=74)))]<-1 #Other middle ear disorders
mort_2020$EAR.SORD<-NULL; mort_2020$EAR.SORD[with(mort_2020, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=91)))]<-1 #Hearing loss
mort_2020$EAR.OTRA<-NULL; mort_2020$EAR.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE>=60&ICD_10_1.CODE<=61)|(ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)|
                                                                                         (ICD_10_1.CODE>=92&ICD_10_1.CODE<=93)|(ICD_10_1.CODE==83)|(ICD_10_1.CODE==95))))]<-1 #Other


##  Diseases of the circulatory system 1: acute rheumatic fever and chronic rheumatic heart diseases ##
mort_2020$SC1.FIRE<-NULL; mort_2020$SC1.FIRE[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)))]<-1 #Acute rheumatic fever
mort_2020$SC1.CRHD<-NULL; mort_2020$SC1.CRHD[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=5&ICD_10_1.CODE<=9)))]<-1 #Chronic rheumatic heart diseases


## Diseases of the circulatory system 2: hypertensive diseases ##
mort_2020$SC2.ECHI<-NULL; mort_2020$SC2.ECHI[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==11|ICD_10_1.CODE==13)))]<-1 #Hypertensive heart disease
mort_2020$SC2.HTES<-NULL; mort_2020$SC2.HTES[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==10)))]<-1 #Essential (primary) hypertension
mort_2020$SC2.OTRA<-NULL; mort_2020$SC2.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==12)))]<-1 #Other


## Diseases of the circulatory system 3: ischemic heart diseases ##
mort_2020$SC3.IAMC<-NULL; mort_2020$SC3.IAMC[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==21|ICD_10_1.CODE==22)))]<-1 #Acute myocardial infarction
mort_2020$SC3.OTRA<-NULL; mort_2020$SC3.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=23&ICD_10_1.CODE<=25)|
                                                                                         ICD_10_1.CODE==20)))]<-1 #Other

## Diseases of the circulatory system 4: diseases of pulmonary circulation and other heart diseases ##
mort_2020$SC4.EMBP<-NULL; mort_2020$SC4.EMBP[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==26)))]<-1 #Pulmonary embolism
mort_2020$SC4.CARR<-NULL; mort_2020$SC4.CARR[with(mort_2020, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=45)| #Conduction disorders and arrhythmia
                                                                                         (ICD_10_1.CODE>=47&ICD_10_1.CODE<=49))))]<-1
mort_2020$SC4.PARO<-NULL; mort_2020$SC4.PARO[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==46)))]<-1 #Cardiac arrest
mort_2020$SC4.HEFA<-NULL; mort_2020$SC4.HEFA[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==50)))]<-1 #Heart failure
mort_2020$SC4.OTRA<-NULL; mort_2020$SC4.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=27&ICD_10_1.CODE<=31)|(ICD_10_1.CODE>=33&ICD_10_1.CODE<=38)|
                                                                                         ICD_10_1.CODE==40|ICD_10_1.CODE==42|ICD_10_1.CODE==51)))]<-1  #Other


## Diseases of the circulatory system 5: cerebrovascular diseases ##
mort_2020$SC5.HEMS<-NULL; mort_2020$SC5.HEMS[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==60)))]<-1 #Subarachnoid hemorrhage
mort_2020$SC5.HEMI<-NULL; mort_2020$SC5.HEMI[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=61&ICD_10_1.CODE<=62)))]<-1 #Intracerebral and other intracranial hemorrhage
mort_2020$SC5.ISQC<-NULL; mort_2020$SC5.ISQC[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==63)))]<-1 #Cerebral infarction
mort_2020$SC5.EVCN<-NULL; mort_2020$SC5.EVCN[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==64)))]<-1 #Unspecified (hemorrhagic vs isquemic)
mort_2020$SC5.ATSC<-NULL; mort_2020$SC5.ATSC[with(mort_2020, (ICD_10_1.CHAPTER=="I" & ICD_10_1.CODE==67 & ICD_10_1.SUB==2))]<-1 #Cerebral atherosclerosis
mort_2020$SC5.SEQC<-NULL; mort_2020$SC5.SEQC[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==69)))]<-1 #Sequelae of cerebrovascular disease
mort_2020$SC5.OTRA<-NULL; mort_2020$SC5.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==65|ICD_10_1.CODE==66| #Other
                                                                                         (ICD_10_1.CODE==67&ICD_10_1.SUB!=2)) ))]<-1


## Diseases of the circulatory system 6: other diseases of the circulatory system ##
mort_2020$SC6.ATER<-NULL; mort_2020$SC6.ATER[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==70)))]<-1 #Atherosclerosis
mort_2020$SC6.OEVP<-NULL; mort_2020$SC6.OEVP[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==73)))]<-1 #Other peripheral vascular diseases
mort_2020$SC6.ETAR<-NULL; mort_2020$SC6.ETAR[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==74)))]<-1 #Arterial embolism and thrombosis
mort_2020$SC6.OTAR<-NULL; mort_2020$SC6.OTAR[with(mort_2020, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=71&ICD_10_1.CODE<=72)| #Other diseases of arteries, arterioles and capillaries
                                                                                         (ICD_10_1.CODE>=77&ICD_10_1.CODE<=78))))]<-1
mort_2020$SC6.ETVE<-NULL; mort_2020$SC6.ETVE[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=82)))]<-1 #Phlebitis, trombophlebitis, other venous embolism and thrombosis
mort_2020$SC6.VARI<-NULL; mort_2020$SC6.VARI[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==83)))]<-1 #Varicose veins of lower extremities
mort_2020$SC6.HMRR<-NULL; mort_2020$SC6.HMRR[with(mort_2020, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==84)))]<-1 #Hemorrhoids
mort_2020$SC6.OTRA<-NULL; mort_2020$SC6.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=85&ICD_10_1.CODE<=97)| #Other
                                                                                         ICD_10_1.CODE==99)))]<-1


## Respiratory tract diseases 1: acute upper respiratory infections and other diseases of upper respiratory tract ##
mort_2020$ER1.FAAG<-NULL; mort_2020$ER1.FAAG[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==2)))]<-1 #Acute pharyngitis
mort_2020$ER1.TOAG<-NULL; mort_2020$ER1.TOAG[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==3)))]<-1 #Acute tonsillitis
mort_2020$ER1.LTAG<-NULL; mort_2020$ER1.LTAG[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==4)))]<-1 #Acute laryngitis and tracheitis
mort_2020$ER1.OTAG<-NULL; mort_2020$ER1.OTAG[with(mort_2020, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)| #Other acute upper respiratory infections
                                                                                         (ICD_10_1.CODE>=5&ICD_10_1.CODE<=6))))]<-1
mort_2020$ER1.PNSD<-NULL; mort_2020$ER1.PNSD[with(mort_2020, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE==33)| #Nasal polyp and deviated nasal septum
                                                                                         (ICD_10_1.CODE==34&ICD_10_1.SUB==2))))]<-1 
mort_2020$ER1.RNPC<-NULL; mort_2020$ER1.RNPC[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)))]<-1 #Chronic rhinitis, nasopharyngitis and pharyngitis
mort_2020$ER1.SINC<-NULL; mort_2020$ER1.SINC[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==32)))]<-1 #Chronic sinusitis
mort_2020$ER1.TADC<-NULL; mort_2020$ER1.TADC[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==35)))]<-1 #Chronic diseases of tonsils and adenoids
mort_2020$ER1.ONSN<-NULL; mort_2020$ER1.ONSN[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==34&(ICD_10_1.SUB!=2&ICD_10_1.SUB!=9))))]<-1 #Other disorders of nose and nasal sinuses
mort_2020$ER1.OTRA<-NULL; mort_2020$ER1.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=36&ICD_10_1.CODE<=39)))]<-1 #Other


## Respiratory tract diseases 2: other respiratory tract diseases ##
mort_2020$ER2.BRAG<-NULL; mort_2020$ER2.BRAG[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Acute bronchitis and bronchiolitis
mort_2020$ER2.NEUM<-NULL; mort_2020$ER2.NEUM[with(mort_2020, (mort_2020$MES<4 & ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=12&ICD_10_1.CODE<=18)))]<-1 #Pneumonia
mort_2020$ER2.INFL<-NULL; mort_2020$ER2.INFL[with(mort_2020, (mort_2020$MES<4 & ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=9&ICD_10_1.CODE<=11)))]<-1 #Influenza
mort_2020$ER2.BCNE<-NULL; mort_2020$ER2.BCNE[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=43)))]<-1 #Chronic and unspecified bronchitis, emphysema
mort_2020$ER2.ASMA<-NULL; mort_2020$ER2.ASMA[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=45&ICD_10_1.CODE<=46)))]<-1 #Asthma
mort_2020$ER2.BREC<-NULL; mort_2020$ER2.BREC[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==47)))]<-1 #Bronchiectasis
mort_2020$ER2.EPOC<-NULL; mort_2020$ER2.EPOC[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==44)))]<-1 #Chronic obstructive pulmonary disease
mort_2020$ER2.NMCS<-NULL; mort_2020$ER2.NMCS[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=65)))]<-1 #Pneumoconiosis
mort_2020$ER2.OTAE<-NULL; mort_2020$ER2.OTAE[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=66&ICD_10_1.CODE<=70)))]<-1 #Other pulmonary diseases due to external agents
mort_2020$ER2.PLEU<-NULL; mort_2020$ER2.PLEU[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=94)))]<-1 #Pleural conditions
mort_2020$ER2.IRIN<-NULL; mort_2020$ER2.IRIN[with(mort_2020, (mort_2020$MES<4 & ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==22)))]<-1 #Unspecified acute lower respiratory infection
mort_2020$ER2.OTRA<-NULL; mort_2020$ER2.OTRA[with(mort_2020, (mort_2020$MES<4 & ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=86)|
                                                                                         (ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other


## Diseases of the digestive system 1: oral cavity and salivary glands ##
mort_2020$SD1.CARI<-NULL; mort_2020$SD1.CARI[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==2)))]<-1 #Dental caries
mort_2020$SD1.OTDI<-NULL; mort_2020$SD1.OTDI[with(mort_2020, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)| #Other disorders of teeth and supporting structures
                                                                                         (ICD_10_1.CODE>=3&ICD_10_1.CODE<=8))))]<-1
mort_2020$SD1.OTJA<-NULL; mort_2020$SD1.OTJA[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==10)))]<-1 #Other diseases of jaw
mort_2020$SD1.OTRA<-NULL; mort_2020$SD1.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=11&ICD_10_1.CODE<=14)|ICD_10_1.CODE==9)))]<-1 #Other


## Diseases of the digestive system 2: esophagus, stomach, intestines, hernia ##
mort_2020$SD2.ESOF<-NULL; mort_2020$SD2.ESOF[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=22)))]<-1 #Diseases of esophagus
mort_2020$SD2.GDIS<-NULL; mort_2020$SD2.GDIS[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==29)))]<-1 #Gastritis and duodenitis
mort_2020$SD2.GDUL<-NULL; mort_2020$SD2.GDUL[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=25&ICD_10_1.CODE<=27)))]<-1 #Gastric and duodenal ulcer
mort_2020$SD2.OTGD<-NULL; mort_2020$SD2.OTGD[with(mort_2020, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)|ICD_10_1.CODE==28)))]<-1 #Other diseases of stomach and duodenum
mort_2020$SD2.APEN<-NULL; mort_2020$SD2.APEN[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=38)))]<-1 #Diseases of appendix
mort_2020$SD2.INHE<-NULL; mort_2020$SD2.INHE[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==40)))]<-1 #Inguinal hernia
mort_2020$SD2.OTHE<-NULL; mort_2020$SD2.OTHE[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=41&ICD_10_1.CODE<=46)))]<-1 #Other hernias
mort_2020$SD2.CRCU<-NULL; mort_2020$SD2.CRCU[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=51)))]<-1 #Crohn's disease and ulcerative colitis
mort_2020$SD2.PIIO<-NULL; mort_2020$SD2.PIIO[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==56)))]<-1 #Paralytic ileus and intestinal obstruction without hernia
mort_2020$SD2.EDDI<-NULL; mort_2020$SD2.EDDI[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==57)))]<-1 #Diverticular disease of intestine
mort_2020$SD2.SIIO<-NULL; mort_2020$SD2.SIIO[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=59)))]<-1 #Irritable bowel syndrome and other functional intestinal disorders


## Diseases of the digestive system 3: liver and other parts of digestive system ##
mort_2020$SD3.ALLD<-NULL; mort_2020$SD3.ALLD[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==70)))]<-1 #Alcoholic liver disease
mort_2020$SD3.OTLI<-NULL; mort_2020$SD3.OTLI[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=71&ICD_10_1.CODE<=76)))]<-1 #Other diseases of liver
mort_2020$SD3.COLE<-NULL; mort_2020$SD3.COLE[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)))]<-1 #Cholelithiasis and cholecystitis
mort_2020$SD3.OTIP<-NULL; mort_2020$SD3.OTIP[with(mort_2020, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=52&ICD_10_1.CODE<=55)|
                                                                                         ICD_10_1.CODE>=60&ICD_10_1.CODE<=66)))]<-1 #Other diseases of intestines and peritoneum
mort_2020$SD3.PANC<-NULL; mort_2020$SD3.PANC[with(mort_2020, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Acute pancreatitis and other diseases of pancreas
mort_2020$SD3.OTRA<-NULL; mort_2020$SD3.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=82&ICD_10_1.CODE<=83)|
                                                                                         ICD_10_1.CODE>=87&ICD_10_1.CODE<=93)))]<-1 #Other diseases of digestive system



## Diseases of the skin and subcutaneous tissue ##
mort_2020$PTS.IPTS<-NULL; mort_2020$PTS.IPTS[with(mort_2020, (ICD_10_1.CHAPTER=="L" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=8)))]<-1 #Infections of the skin and subcutaneous tissue
mort_2020$PTS.DEEC<-NULL; mort_2020$PTS.DEEC[with(mort_2020, (ICD_10_1.CHAPTER=="L" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=30)))]<-1 #Dermatitis and eczema
mort_2020$PTS.OTRA<-NULL; mort_2020$PTS.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="L" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=13)|(ICD_10_1.CODE>=40&ICD_10_1.CODE<=44)|
                                                                                         (ICD_10_1.CODE>=50&ICD_10_1.CODE<=53)|(ICD_10_1.CODE>=55&ICD_10_1.CODE<=60)|
                                                                                         (ICD_10_1.CODE>=63&ICD_10_1.CODE<=85)|(ICD_10_1.CODE>=87&ICD_10_1.CODE<=98))))]<-1 #Other


## Diseases of the musculoskeletal system and connective tissue ##
mort_2020$MOC.PAIN<-NULL; mort_2020$MOC.PAIN[with(mort_2020, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=5&ICD_10_1.CODE<=6)|(ICD_10_1.CODE==8)|
                                                                                         (ICD_10_1.CODE>=10&ICD_10_1.CODE<=13))))]<-1 #Inflammatory polyarthropathies
mort_2020$MOC.OSAR<-NULL; mort_2020$MOC.OSAR[with(mort_2020, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=15&ICD_10_1.CODE<=19)))]<-1 #Osteoarthritis
mort_2020$MOC.ADOL<-NULL; mort_2020$MOC.ADOL[with(mort_2020, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Acquired deformities of limbs
mort_2020$MOC.OTAR<-NULL; mort_2020$MOC.OTAR[with(mort_2020, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)| 
                                                                                         (ICD_10_1.CODE>=22&ICD_10_1.CODE<=25))))]<-1 #Other joint disorders
mort_2020$MOC.SCTD<-NULL; mort_2020$MOC.SCTD[with(mort_2020, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=35)))]<-1 #Systemic connective tissue disorders
mort_2020$MOC.IVDD<-NULL; mort_2020$MOC.IVDD[with(mort_2020, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=51)))]<-1 #Intervertebral disc disorders
mort_2020$MOC.OTDO<-NULL; mort_2020$MOC.OTDO[with(mort_2020, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=40&ICD_10_1.CODE<=48)| 
                                                                                         (ICD_10_1.CODE>=53&ICD_10_1.CODE<=54))))]<-1 #Other dorsopathies
mort_2020$MOC.SOFT<-NULL; mort_2020$MOC.SOFT[with(mort_2020, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=60&ICD_10_1.CODE<=62)|(ICD_10_1.CODE>=65&ICD_10_1.CODE<=67)|
                                                                                         (ICD_10_1.CODE>=70&ICD_10_1.CODE<=72)|(ICD_10_1.CODE>=75&ICD_10_1.CODE<=79))))]<-1 #Soft tissue disorders
mort_2020$MOC.BONE<-NULL; mort_2020$MOC.BONE[with(mort_2020, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)|(ICD_10_1.CODE==83&ICD_10_1.SUB!=0)|
                                                                                         (ICD_10_1.CODE>=84&ICD_10_1.CODE<=85))))]<-1 #Disorders of bone density and structure
mort_2020$MOC.OMIE<-NULL; mort_2020$MOC.OMIE[with(mort_2020, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE==86)))]<-1 #Osteomyelitis
mort_2020$MOC.OTRA<-NULL; mort_2020$MOC.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)|
                                                                                         (ICD_10_1.CODE>=91&ICD_10_1.CODE<=99))))]<-1 #Other



## Diseases of the genitourinary system 1: urinary system ##
mort_2020$GU1.NFRI<-NULL; mort_2020$GU1.NFRI[with(mort_2020, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Acute and rapidly progressive nephritic syndrome
mort_2020$GU1.OTGL<-NULL; mort_2020$GU1.OTGL[with(mort_2020, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=2&ICD_10_1.CODE<=8)))]<-1 #Other glomerular diseases
mort_2020$GU1.ACKF<-NULL; mort_2020$GU1.ACKF[with(mort_2020, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=17&ICD_10_1.CODE<=19)))]<-1 #Acute kidney failure and chronic kidney disease
mort_2020$GU1.RTID<-NULL; mort_2020$GU1.RTID[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=12)|ICD_10_1.CODE==15)))]<-1 #Renal tubulo-interstitial diseases
mort_2020$GU1.OTTU<-NULL; mort_2020$GU1.OTTU[with(mort_2020, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=13&ICD_10_1.CODE<=14)))]<-1 #Other renal tubulo-interstitial diseases
mort_2020$GU1.LITO<-NULL; mort_2020$GU1.LITO[with(mort_2020, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Urolithiasis
mort_2020$GU1.RECO<-NULL; mort_2020$GU1.RECO[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==23))]<-1 #Unspecified renal colic
mort_2020$GU1.CIST<-NULL; mort_2020$GU1.CIST[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==30))]<-1 #Cystitis
mort_2020$GU1.OTRA<-NULL; mort_2020$GU1.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=25&ICD_10_1.CODE<=29)|(ICD_10_1.CODE>=31&ICD_10_1.CODE<=39))))]<-1 #Other


## Diseases of the genitourinary system 2: male genital organs ##
mort_2020$GU2.HIPR<-NULL; mort_2020$GU2.HIPR[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==40))]<-1 #Benign prostatic hyperplasia
mort_2020$GU2.OTPR<-NULL; mort_2020$GU2.OTPR[with(mort_2020, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=41&ICD_10_1.CODE<=42)))]<-1 #Other disorders of prostate
mort_2020$GU2.HCEC<-NULL; mort_2020$GU2.HCEC[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==43))]<-1 #Hydrocele and spermatocele
mort_2020$GU2.PREP<-NULL; mort_2020$GU2.PREP[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==47))]<-1 #Disorders of prepuce
mort_2020$GU2.MINF<-NULL; mort_2020$GU2.MINF[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==46))]<-1 #Male infertility
mort_2020$GU2.OTRA<-NULL; mort_2020$GU2.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=45)|(ICD_10_1.CODE>=48&ICD_10_1.CODE<=50))))]<-1 #Other



## Diseases of the genitourinary system 3: breast disorders ##
mort_2020$GU3.MAMA<-NULL; mort_2020$GU3.MAMA[with(mort_2020, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=64)))]<-1 #Disorders of breast


## Diseases of the genitourinary system 4: female genital organs ##
mort_2020$GU4.SAOO<-NULL; mort_2020$GU4.SAOO[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==70))]<-1 #Salpingitis and oophoritis
mort_2020$GU4.IDCU<-NULL; mort_2020$GU4.IDCU[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==72))]<-1 #Inflammatory disease of cervix uteri
mort_2020$GU4.OTVV<-NULL; mort_2020$GU4.OTVV[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=75&ICD_10_1.CODE<=76)|ICD_10_1.CODE==71)))]<-1 #Other diseases of uterus, vagina and vulva
mort_2020$GU4.OTPI<-NULL; mort_2020$GU4.OTPI[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==73))]<-1 #Other female pelvic inflammatory diseases
mort_2020$GU4.ENDM<-NULL; mort_2020$GU4.ENDM[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==80))]<-1 #Endometriosis
mort_2020$GU4.FPRO<-NULL; mort_2020$GU4.FPRO[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==81))]<-1 #Female genital prolapse
mort_2020$GU4.NOFB<-NULL; mort_2020$GU4.NOFB[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==83))]<-1 #Noninflammatory disorders of ovary, fallopian tube and broad ligament
mort_2020$GU4.MENS<-NULL; mort_2020$GU4.MENS[with(mort_2020, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=91&ICD_10_1.CODE<=92)))]<-1 #Disorders of menstruation
mort_2020$GU4.MNOP<-NULL; mort_2020$GU4.MNOP[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==95))]<-1 #Menopausal and other perimenopausal disorders
mort_2020$GU4.FINF<-NULL; mort_2020$GU4.FINF[with(mort_2020, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==97))]<-1 #Female infertility
mort_2020$GU4.OTRA<-NULL; mort_2020$GU4.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE==82|(ICD_10_1.CODE>=84&ICD_10_1.CODE<=90)|
                                                                                         (ICD_10_1.CODE>=93&ICD_10_1.CODE<=94)|ICD_10_1.CODE==96|ICD_10_1.CODE==98)))]<-1 #Other


## Obstetrics 1: direct obstetric causes (abortion) ##
mort_2020$OB1.SPON<-NULL; mort_2020$OB1.SPON[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==3))]<-1 #Spontaneous abortion
mort_2020$OB1.INDU<-NULL; mort_2020$OB1.INDU[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==4))]<-1 #Complications following (induced) termination of pregnancy
mort_2020$OB1.OTRA<-NULL; mort_2020$OB1.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)|(ICD_10_1.CODE>=5&ICD_10_1.CODE<=8))))]<-1 #Other abortion


## Obstetrics 2: direct obstetric causes (pregnancy and puerperium, except abortion) ##
mort_2020$OB2.EPHD<-NULL; mort_2020$OB2.EPHD[with(mort_2020, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=16)))]<-1 #Edema, proteinuria and hypertensive disorders in pregnancy, childbirth and the puerperium
mort_2020$OB2.HEMP<-NULL; mort_2020$OB2.HEMP[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=46)|
                                                                                         ICD_10_1.CODE==20)))]<-1 #Hemorrhage in early pregnancy, placenta previa, abruptio placentae, antepartum hemorrhage
mort_2020$OB2.FACD<-NULL; mort_2020$OB2.FACD[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=30&ICD_10_1.CODE<=43)|ICD_10_1.CODE==47|
                                                                                         ICD_10_1.CODE==48)))]<-1 #Maternal care related to the fetus and amniotic cavity and possible delivery problems
mort_2020$OB2.IGUT<-NULL; mort_2020$OB2.IGUT[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==23))]<-1 #Infections of genitourinary tract in pregnancy
mort_2020$OB2.DMIP<-NULL; mort_2020$OB2.DMIP[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==24))]<-1 #Diabetes mellitus in pregnancy
mort_2020$OB2.OBSL<-NULL; mort_2020$OB2.OBSL[with(mort_2020, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=64&ICD_10_1.CODE<=66)))]<-1 #Obstructed labor 
mort_2020$OB2.PPHE<-NULL; mort_2020$OB2.PPHE[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==72))]<-1 #Postpartum hemorrhage
mort_2020$OB2.SOPI<-NULL; mort_2020$OB2.SOPI[with(mort_2020, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Sepsis and other puerperal infections
mort_2020$OB2.PUER<-NULL; mort_2020$OB2.PUER[with(mort_2020, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=87&ICD_10_1.CODE<=92)))]<-1 #Other complications of the puerperium
mort_2020$OB2.OTPL<-NULL; mort_2020$OB2.OTPL[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=21&ICD_10_1.CODE<=22)|(ICD_10_1.CODE>=25&ICD_10_1.CODE<=29)|(ICD_10_1.CODE>=60&ICD_10_1.CODE<=63)|
                                                                                         (ICD_10_1.CODE>=67&ICD_10_1.CODE<=71)|(ICD_10_1.CODE>=73&ICD_10_1.CODE<=75))))]<-1 #Other complications of pregnancy and labor
mort_2020$OB2.OBTE<-NULL; mort_2020$OB2.OBTE[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==34))]<-1 #Obstetrical tetanus
mort_2020$OB2.BEPU<-NULL; mort_2020$OB2.BEPU[with(mort_2020, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==53))]<-1 #Mental and behavioral disorders associated with the puerperium
mort_2020$OB2.OMLC<-NULL; mort_2020$OB2.OMLC[with(mort_2020, (ICD_10_1.CHAPTER=="M" & ICD_10_1.CODE==83 & ICD_10_1.SUB==0))]<-1 #Puerperal osteomalacia
mort_2020$OB2.OTDC<-NULL; mort_2020$OB2.OTDC[with(mort_2020, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=96&ICD_10_1.CODE<=97)))]<-1 #Other direct obstetric causes
mort_2020$OB2.ODUC<-NULL; mort_2020$OB2.ODUC[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==95))]<-1 #Obstetric death of unspecified cause


## Obstetrics 3: delivery ##
mort_2020$OB3.SSDE<-NULL; mort_2020$OB3.SSDE[with(mort_2020, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==80))]<-1 #Single spontaneous delivery
mort_2020$OB3.OTDE<-NULL; mort_2020$OB3.OTDE[with(mort_2020, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=81&ICD_10_1.CODE<=84)))]<-1 #Other delivery


## Obstetrics 4: indirect obstetric causes ##
mort_2020$OB4.INOC<-NULL; mort_2020$OB4.INOC[with(mort_2020, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=98&ICD_10_1.CODE<=99)))]<-1 #Indirect obstetric causes


## Certain conditions originating in the perinatal period ##
mort_2020$NEO.NAMC<-NULL; mort_2020$NEO.NAMC[with(mort_2020, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE==0|ICD_10_1.CODE==4)))]<-1 #Newborn affected by maternal conditions
mort_2020$NEO.NAOC<-NULL; mort_2020$NEO.NAOC[with(mort_2020, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=1&ICD_10_1.CODE<=3)))]<-1 #Newborn affected by obstetric complications
mort_2020$NEO.GMGW<-NULL; mort_2020$NEO.GMGW[with(mort_2020, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE==5|ICD_10_1.CODE==7)))]<-1 #Slow fetal growth, fetal malnutrition, short gestation and low birth weight
mort_2020$NEO.BITR<-NULL; mort_2020$NEO.BITR[with(mort_2020, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=15)))]<-1 #Birth trauma
mort_2020$NEO.HIAS<-NULL; mort_2020$NEO.HIAS[with(mort_2020, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Intrauterine hypoxia and birth asphyxia 
mort_2020$NEO.SDRN<-NULL; mort_2020$NEO.SDRN[with(mort_2020, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=22&ICD_10_1.CODE<=28)))]<-1 #Respiratory distress of newborn and other perinatal respiratory disorders
mort_2020$NEO.INFE<-NULL; mort_2020$NEO.INFE[with(mort_2020, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=37)))]<-1 #Congenital viral, bacterial and parasitic diseases
mort_2020$NEO.OTIN<-NULL; mort_2020$NEO.OTIN[with(mort_2020, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=38&ICD_10_1.CODE<=39)))]<-1 #Other infections specific to the perinatal period
mort_2020$NEO.HDNB<-NULL; mort_2020$NEO.HDNB[with(mort_2020, (ICD_10_1.CHAPTER=="P" & ICD_10_1.CODE==55))]<-1 #Hemolytic disease of newborn
mort_2020$NEO.TENE<-NULL; mort_2020$NEO.TENE[with(mort_2020, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==33))]<-1 #Tetanus neonatorum
mort_2020$NEO.OTRA<-NULL; mort_2020$NEO.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="P" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=54)|(ICD_10_1.CODE>=56&ICD_10_1.CODE<=74)|
                                                                                         (ICD_10_1.CODE>=76&ICD_10_1.CODE<=96)|(ICD_10_1.CODE==8)|(ICD_10_1.CODE==29))))]<-1 #Other


## Congenital malformations, deformations and chromosomal abnormalities ##
mort_2020$CON.ANEN<-NULL; mort_2020$CON.ANEN[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==0))]<-1 #Anencephaly and similar malformations
mort_2020$CON.HIDR<-NULL; mort_2020$CON.HIDR[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==3))]<-1 #Congenital hydrocephalus
mort_2020$CON.SBIF<-NULL; mort_2020$CON.SBIF[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==5))]<-1 #Spina bifida
mort_2020$CON.OTNS<-NULL; mort_2020$CON.OTNS[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=1&ICD_10_1.CODE<=2)|(ICD_10_1.CODE==4)|
                                                                                         (ICD_10_1.CODE>=6&ICD_10_1.CODE<=7))))]<-1 #Other congenital malformations of the nervous system
mort_2020$CON.CIRC<-NULL; mort_2020$CON.CIRC[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=28)))]<-1 #Congenital malformations of the circulatory system
mort_2020$CON.CLCP<-NULL; mort_2020$CON.CLCP[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=37)))]<-1 #Cleft lip and cleft palate
mort_2020$CON.CINT<-NULL; mort_2020$CON.CINT[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==41))]<-1 #Congenital absence, atresia and stenosis of small intestine
mort_2020$CON.OTDS<-NULL; mort_2020$CON.OTDS[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=38&ICD_10_1.CODE<=40)|
                                                                                         (ICD_10_1.CODE>=42&ICD_10_1.CODE<=45))))]<-1 #Other congenital malformations of the digestive system 
mort_2020$CON.TEST<-NULL; mort_2020$CON.TEST[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==53))]<-1 #Undescended and ectopic testicle
mort_2020$CON.OTGU<-NULL; mort_2020$CON.OTGU[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=52)|
                                                                                         (ICD_10_1.CODE>=54&ICD_10_1.CODE<=64))))]<-1 #Other congenital malformations of genitourinary system
mort_2020$CON.DHIP<-NULL; mort_2020$CON.DHIP[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==65))]<-1 #Congenital deformities of hip
mort_2020$CON.FEET<-NULL; mort_2020$CON.FEET[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==66))]<-1 #Congenital deformities of feet
mort_2020$CON.OTMS<-NULL; mort_2020$CON.OTMS[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=67&ICD_10_1.CODE<=79)))]<-1 #Other congenital malformations and deformations of the musculoskeletal system
mort_2020$CON.OTRA<-NULL; mort_2020$CON.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=18)|(ICD_10_1.CODE>=30&ICD_10_1.CODE<=34)|
                                                                                         (ICD_10_1.CODE>=80&ICD_10_1.CODE<=89))))]<-1 #Other congenital malformations
mort_2020$CON.CROM<-NULL; mort_2020$CON.CROM[with(mort_2020, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=99)))]<-1 #Chromosomal abnormalities, not elsewhere classified


## Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified ##
mort_2020$NCL.FEVU<-NULL; mort_2020$NCL.FEVU[with(mort_2020, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==50))]<-1 #Fever of other and unknown origin
mort_2020$NCL.CAAB<-NULL; mort_2020$NCL.CAAB[with(mort_2020, (ICD_10_1.CHAPTER=="R" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Cardiac abnormalities
mort_2020$NCL.RAOR<-NULL; mort_2020$NCL.RAOR[with(mort_2020, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==33))]<-1 #Retention of urine
mort_2020$NCL.ABPP<-NULL; mort_2020$NCL.ABPP[with(mort_2020, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==10))]<-1 #Abdominal and pelvic pain
mort_2020$NCL.ARPD<-NULL; mort_2020$NCL.ARPD[with(mort_2020, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==54))]<-1 #Age-related physical debility
mort_2020$NCL.SIDS<-NULL; mort_2020$NCL.SIDS[with(mort_2020, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==95))]<-1 #Sudden infant death syndrome
mort_2020$NCL.REAR<-NULL; mort_2020$NCL.REAR[with(mort_2020, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==9 & ICD_10_1.SUB==2))]<-1 #Respiratory arrest
mort_2020$NCL.OTRA<-NULL; mort_2020$NCL.OTRA[with(mort_2020, (ICD_10_1.CHAPTER=="R" & ((ICD_10_1.CODE==9&(ICD_10_1.SUB==0|ICD_10_1.SUB==1|ICD_10_1.SUB==3|ICD_10_1.SUB==8))|
                                                                                         (ICD_10_1.CODE>=2&ICD_10_1.CODE<=8)|(ICD_10_1.CODE>=11&ICD_10_1.CODE<=32)|
                                                                                         (ICD_10_1.CODE>=34&ICD_10_1.CODE<=49)|(ICD_10_1.CODE>=51&ICD_10_1.CODE<=53)|
                                                                                         (ICD_10_1.CODE>=55&ICD_10_1.CODE<=94)|(ICD_10_1.CODE>=96&ICD_10_1.CODE<=99))))]<-1 #Other



## External causes of mortality 1: transport accidents ##
mort_2020$EX1.RAIL<-NULL; mort_2020$EX1.RAIL[with(mort_2020, (ICD_10_1.CHAPTER=="V" & ((ICD_10_1.CODE==5)|(ICD_10_1.CODE==15)|(ICD_10_1.CODE==80&ICD_10_1.SUB==6)|
                                                                                         (ICD_10_1.CODE==81&ICD_10_1.SUB!=1)) ))]<-1 #Railway accidents
mort_2020$EX1.MOTO<-NULL; mort_2020$EX1.MOTO[with(mort_2020, (ICD_10_1.CHAPTER=="V" &  (((ICD_10_1.CODE>=2&ICD_10_1.CODE<=4) & (ICD_10_1.SUB==1|ICD_10_1.SUB==9))|
                                                                                          ((ICD_10_1.CODE==9) & (ICD_10_1.SUB==2|ICD_10_1.SUB==3|ICD_10_1.SUB==9))|
                                                                                          ((ICD_10_1.CODE>=12&ICD_10_1.CODE<=14) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE==19) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=6))|
                                                                                          ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=28) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE>=29&ICD_10_1.CODE<=79) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE==80) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=5))|
                                                                                          ((ICD_10_1.CODE>=81&ICD_10_1.CODE<=82) & (ICD_10_1.SUB==1))|
                                                                                          ((ICD_10_1.CODE>=83&ICD_10_1.CODE<=86) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=3))|
                                                                                          ((ICD_10_1.CODE==87) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=8))|
                                                                                          ((ICD_10_1.CODE==89) & (ICD_10_1.SUB==2|ICD_10_1.SUB==9))) ))]<-1 #Motor vehicle traffic accidents
mort_2020$EX1.LAND<-NULL; mort_2020$EX1.LAND[with(mort_2020, (ICD_10_1.CHAPTER=="V" & ((ICD_10_1.CODE==1)|(ICD_10_1.CODE==6)|(ICD_10_1.CODE==10)|(ICD_10_1.CODE==11)|
                                                                                         (ICD_10_1.CODE>=16&ICD_10_1.CODE<=18)|(ICD_10_1.CODE==19&ICD_10_1.SUB==3)|
                                                                                         ((ICD_10_1.CODE==80) & (ICD_10_1.SUB<=2|ICD_10_1.SUB>=7))|
                                                                                         ((ICD_10_1.CODE==82) & (ICD_10_1.SUB>=2&ICD_10_1.SUB<=9))|
                                                                                         ((ICD_10_1.CODE==89) & (ICD_10_1.SUB==1|ICD_10_1.SUB==3)) )))]<-1 #Other land transport accidents
mort_2020$EX1.WATE<-NULL; mort_2020$EX1.WATE[with(mort_2020, (ICD_10_1.CHAPTER=="V" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=94)))]<-1 #Water transport accidents
mort_2020$EX1.AIRS<-NULL; mort_2020$EX1.AIRS[with(mort_2020, (ICD_10_1.CHAPTER=="V" & (ICD_10_1.CODE>=95&ICD_10_1.CODE<=97)))]<-1 #Air and space transport accidents
mort_2020$EX1.OTRO<-NULL; mort_2020$EX1.OTRO[with(mort_2020, (ICD_10_1.CHAPTER=="V" & (((ICD_10_1.CODE>=2&ICD_10_1.CODE<=4) & (ICD_10_1.SUB==0))|
                                                                                         ((ICD_10_1.CODE==9) & (ICD_10_1.SUB==0|ICD_10_1.SUB==1))|
                                                                                         ((ICD_10_1.CODE>=12&ICD_10_1.CODE<=14) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=2))|
                                                                                         ((ICD_10_1.CODE==19) & (ICD_10_1.SUB<=2|ICD_10_1.SUB>=8))|
                                                                                         ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=28) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=2))|
                                                                                         ((ICD_10_1.CODE>=29&ICD_10_1.CODE<=79) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=3))|
                                                                                         ((ICD_10_1.CODE>=83&ICD_10_1.CODE<=86) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=9))|
                                                                                         (ICD_10_1.CODE==82&ICD_10_1.SUB==0)|(ICD_10_1.CODE==87&ICD_10_1.SUB==9)|
                                                                                         (ICD_10_1.CODE==88)|(ICD_10_1.CODE==89&ICD_10_1.SUB==0)|
                                                                                         (ICD_10_1.CODE>=98&ICD_10_1.CODE<=99))))]<-1 #Other



## External causes of mortality 2: falls ##
mort_2020$EX2.FALL<-NULL; mort_2020$EX2.FALL[with(mort_2020, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=19)))]<-1 #Falls


## External causes of mortality 3: other accidents ##
mort_2020$EX3.ENVI<-NULL; mort_2020$EX3.ENVI[with(mort_2020, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=53&ICD_10_1.CODE<=64)) | 
                                                    (ICD_10_1.CHAPTER=="X" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=39)|(ICD_10_1.CODE>=50&ICD_10_1.CODE<=57))))]<-1 #Accidents caused by environmental factors
mort_2020$EX3.DROW<-NULL; mort_2020$EX3.DROW[with(mort_2020, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=65&ICD_10_1.CODE<=74)))]<-1 #Accidental non-transport drowning and submersion
mort_2020$EX3.FBNO<-NULL; mort_2020$EX3.FBNO[with(mort_2020, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE==44)))]<-1 #Foreign body entering into or through eye or natural orifice
mort_2020$EX3.MACH<-NULL; mort_2020$EX3.MACH[with(mort_2020, (ICD_10_1.CHAPTER=="W" & ((ICD_10_1.CODE>=23&ICD_10_1.CODE<=31)|ICD_10_1.CODE==35|
                                                                                         ICD_10_1.CODE==37|ICD_10_1.CODE==38|ICD_10_1.CODE==41|
                                                                                         (ICD_10_1.CODE>=45&ICD_10_1.CODE<=46))))]<-1 #Accidents caused by machinery or sharp instruments
mort_2020$EX3.FREG<-NULL; mort_2020$EX3.FREG[with(mort_2020, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=32&ICD_10_1.CODE<=34)))]<-1 #Accidents caused by firearms and guns
mort_2020$EX3.SEQA<-NULL; mort_2020$EX3.SEQA[with(mort_2020, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Sequelae of transport accidents and other accidents

mort_2020$EX3.OTRA<-NULL; mort_2020$EX3.OTRA[with(mort_2020, ((ICD_10_1.CHAPTER=="W" & ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=22)|ICD_10_1.CODE==36|ICD_10_1.CODE==39|ICD_10_1.CODE==40|ICD_10_1.CODE==42|
                                                                                          ICD_10_1.CODE==43|(ICD_10_1.CODE>=49&ICD_10_1.CODE<=52)|(ICD_10_1.CODE>=75&ICD_10_1.CODE<=99)))|
                                                                (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=59)) ))]<-1 #Other



## External causes of mortality 4: exposure to smoke, fire and flames ##
mort_2020$EX4.SMFF<-NULL; mort_2020$EX4.SMFF[with(mort_2020, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=9)))]<-1 #Exposure to smoke, fire and flames


## External causes of mortality 5: accidental poisoning and substance exposition ##
mort_2020$EX5.APDM<-NULL; mort_2020$EX5.APDM[with(mort_2020, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=44)))]<-1 #Accidental poisoning by drugs, medicaments and biological substances
mort_2020$EX5.APSL<-NULL; mort_2020$EX5.APSL[with(mort_2020, (ICD_10_1.CHAPTER=="X" & ((ICD_10_1.CODE>=45&ICD_10_1.CODE<=49)&(ICD_10_1.CODE!=47))))]<-1 #Accidental poisoning by other solid or liquid substances
mort_2020$EX5.APGV<-NULL; mort_2020$EX5.APGV[with(mort_2020, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE==47)))]<-1 #Accidental poisoning by other gases and vapours

## External causes of mortality 6: suicide ##
mort_2020$EX6.SUIC<-NULL; mort_2020$EX6.SUIC[with(mort_2020, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=84)))]<-1 #Intentional self-harm


## External causes of mortality 7: homicide ##
mort_2020$EX7.ASSA<-NULL; mort_2020$EX7.ASSA[with(mort_2020, ((ICD_10_1.CHAPTER=="X"&ICD_10_1.CODE>=85)|(ICD_10_1.CHAPTER=="Y"&ICD_10_1.CODE<=9)))]<-1 #Assault


## External causes of mortality 8: other violent causes of death ##
mort_2020$EX8.EOUI<-NULL; mort_2020$EX8.EOUI[with(mort_2020, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=34)))]<-1 #Event of undetermined intent
mort_2020$EX8.OWAR<-NULL; mort_2020$EX8.OWAR[with(mort_2020, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE==36)))]<-1 #Operations of war
mort_2020$EX8.LEGI<-NULL; mort_2020$EX8.LEGI[with(mort_2020, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE==35)))]<-1 #Legal intervention


## External causes of mortality 9: other external causes of mortality ##
mort_2020$EX9.DRUG<-NULL; mort_2020$EX9.DRUG[with(mort_2020, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=59)))]<-1 #Drugs, medicaments and biological substances causing adverse effects in therapeutic use
mort_2020$EX9.MSDV<-NULL; mort_2020$EX9.MSDV[with(mort_2020, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=84)))]<-1 #Misadventures to patients during surgical and medical care
mort_2020$EX9.SQEX<-NULL; mort_2020$EX9.SQEX[with(mort_2020, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)))]<-1 #Sequelae of external causes of morbidity and mortality


# COVID-19 #
mort_2020$COV.CONF<-NULL; mort_2020$COV.CONF[with(mort_2020, (ICD_10_1.CHAPTER=="U" & ICD_10_1.CODE==7 & ICD_10_1.SUB==1))]<-1 #Confirmed COVID-19
mort_2020$COV.SUSP<-NULL; mort_2020$COV.SUSP[with(mort_2020, (ICD_10_1.CHAPTER=="U" & ICD_10_1.CODE==7 & ICD_10_1.SUB==2))]<-1 #Suspected COVID-19

#Merge Datasets

mort_2020<-mort_2020 %>%left_join(dmu.cuadrantes.mun,by="id.mun")%>%
  rename(DMU_MUN=dmu)%>%
  rename(DMU_CAMAS_MUN=dmu_camas)%>%
  left_join(dmu.ent, by="id.ent")%>%
  rename(DMU_CAMAS_ENT=dmu_camas)%>%
  rename(DMU_ENT=dmu)

mort_2020$AVOIDABLE<-NULL
mort_2020$AVOIDABLE[mort_2020$TREA.PREV==1]<-1
mort_2020$AVOIDABLE[mort_2020$TREA.PREV==2]<-1
mort_2020$AVOIDABLE[mort_2020$TREA.PREV==3]<-1
mort_2020$AVOIDABLE[mort_2020$TREA.PREV==4]<-0

#Individual Risk Factors
mort_2020$RESPIRATORIO<-NULL
mort_2020$RESPIRATORIO[with(mort_2020, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=99)))]<-1

mort_2020$NO_COVID<-NULL
mort_2020$NO_COVID[mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1=="U071" | mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1=="U072"]<-0
mort_2020$NO_COVID[mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1!="U071" & mort_2020$CAUSA_MUERTE_ICD_10_CATEGORIA_1!="U072"]<-1

mort_2020$NO_COVID<-NULL
mort_2020$NO_COVID[mort_2020$COVID==0]<-1
mort_2020$NO_COVID[mort_2020$COVID==1]<-0
mort_2020$NO_COVID<-na.tools::na.replace(mort_2020$NO_COVID,0)

mort_2020$SEXO[mort_2020$SEXO==9]<-NA
mort_2020$SEXO_REC<-NULL
mort_2020$SEXO_REC[mort_2020$SEXO==1]<-0
mort_2020$SEXO_REC[mort_2020$SEXO==2]<-1
mort_2020$SEXO_REC<-factor(mort_2020$SEXO_REC,labels = c("Male","Female"))

mort_2020$OCUPACION_REC<-NULL
mort_2020$OCUPACION_REC[mort_2020$ocupacion==1 | mort_2020$ocupacion==2]<-1
mort_2020$OCUPACION_REC[mort_2020$ocupacion==3 | mort_2020$ocupacion==4 | mort_2020$ocupacion==5 | mort_2020$ocupacion==9]<-2
mort_2020$OCUPACION_REC[mort_2020$ocupacion==6 | mort_2020$ocupacion==7 | mort_2020$ocupacion==8 ]<-3
mort_2020$OCUPACION_REC[mort_2020$ocupacion==10 | mort_2020$ocupacion==11]<-4
mort_2020$OCUPACION_REC[mort_2020$ocupacion==99 | mort_2020$ocupacion==98]<-5
mort_2020$OCUPACION_REC[mort_2020$ocupacion==97]<-NA
mort_2020$OCUPACION_REC<-factor(mort_2020$OCUPACION_REC,labels = c("Office and proffesional workers","Laboreur","Craftmen and Farmers","Unemployed","Non-Specified"))

mort_2020$ESCOLARIDAD_REC<-NULL
mort_2020$ESCOLARIDAD_REC[mort_2020$escolarida==1 | mort_2020$escolarida==2 | mort_2020$escolarida==3 | mort_2020$escolarida==4 | mort_2020$escolarida==99]<-4 #Sin Escolaridad hasta Primaria
mort_2020$ESCOLARIDAD_REC[mort_2020$escolarida==5 | mort_2020$escolarida==6]<-3
mort_2020$ESCOLARIDAD_REC[mort_2020$escolarida==7 | mort_2020$escolarida==8]<-2
mort_2020$ESCOLARIDAD_REC[mort_2020$escolarida==9 | mort_2020$escolarida==10]<-1
mort_2020$ESCOLARIDAD_REC[mort_2020$escolarida==88]<-NA
mort_2020$ESCOLARIDAD_REC<-factor(mort_2020$ESCOLARIDAD_REC,labels = c("Collegue or Higher", "Bachellor  Only", "High-School Only", "Primary of None Education"))

mort_2020$ATENCION_MEDICA_REC<-NULL
mort_2020$ATENCION_MEDICA_REC[mort_2020$asist_medi==1]<-0
mort_2020$ATENCION_MEDICA_REC[mort_2020$asist_medi==2]<-1
mort_2020$ATENCION_MEDICA_REC[mort_2020$asist_medi==9]<-NA
mort_2020$ATENCION_MEDICA_REC<-factor(mort_2020$ATENCION_MEDICA_REC,labels = c("Medical Assistance","Without Medical Assistance"))

mort_2020$TIPO_SS<-NULL
mort_2020$TIPO_SS[mort_2020$derechohab==8]<-1
mort_2020$TIPO_SS[mort_2020$derechohab==2 | mort_2020$derechohab==3 |  mort_2020$derechohab==4 |  mort_2020$derechohab==5 |  mort_2020$derechohab==6 |  mort_2020$derechohab==7 |  mort_2020$derechohab==9]<-2
mort_2020$TIPO_SS[mort_2020$derechohab==1]<-3
mort_2020$TIPO_SS[mort_2020$derechohab==99]<-4
mort_2020$TIPO_SS<-factor(mort_2020$TIPO_SS,labels = c("Private Social Security","Public Social Security","Without Social Security",  "Unespecified"))

mort_2020$LENGUA_IND<-NULL
mort_2020$LENGUA_IND[mort_2020$lengua==1]<-1
mort_2020$LENGUA_IND[mort_2020$lengua==2]<-0
mort_2020$LENGUA_IND[mort_2020$lengua==8]<-0
mort_2020$LENGUA_IND[mort_2020$lengua==9]<-0
mort_2020$LENGUA_IND<-factor(mort_2020$LENGUA_IND,labels = c("Non-Indigenous","Indigenous"))

mort_2020$MARG_CAT<-mort_2020$QUINTILES.DISLI.MUN
mort_2020$MARG_CAT<-factor(mort_2020$MARG_CAT,levels = c("Muy bajo","Bajo","Medio","Alto","Muy alto"),
                           labels = c("Very-Low Social Lag","Low Social Lag","Moderate Social Lag","High Social Lag","Very-High Social Lag"))

mort_2020$DMU_CAMAS_MUN_REC<-NULL
mort_2020$DMU_CAMAS_MUN_REC[mort_2020$DMU_CAMAS_MUN>=100]<-1
mort_2020$DMU_CAMAS_MUN_REC[mort_2020$DMU_CAMAS_MUN<100]<-2
mort_2020$DMU_CAMAS_MUN_REC[is.na(mort_2020$DMU_CAMAS_MUN)]<-2
mort_2020$DMU_CAMAS_MUN_REC<-factor(mort_2020$DMU_CAMAS_MUN_REC,
                                    labels  = c("Adequate-Hospital Beds Available","Low-Hospital Beds Available"))

mort_2020$EDO_CIVIL<-NULL
mort_2020$EDO_CIVIL[mort_2020$edo_civil==4 | mort_2020$edo_civil==5]<-1
mort_2020$EDO_CIVIL[mort_2020$edo_civil==2 | mort_2020$edo_civil==3 | mort_2020$edo_civil==6]<-2
mort_2020$EDO_CIVIL[mort_2020$edo_civil==1]<-3
mort_2020$EDO_CIVIL[mort_2020$edo_civil==8 | mort_2020$edo_civil==9]<-4
mort_2020$EDO_CIVIL<-factor(mort_2020$EDO_CIVIL,labels = c("Married or Consensual Union", "Divorced, Widowed or Separated","Single", "Non-Specified"))

mort_2020$MUERTE_CONTEXTO<-NULL
mort_2020$MUERTE_CONTEXTO[mort_2020$presunto==4 | mort_2020$presunto==8]<-1
mort_2020$MUERTE_CONTEXTO[mort_2020$presunto==1]<-2
mort_2020$MUERTE_CONTEXTO[mort_2020$presunto==2 | mort_2020$presunto==5]<-3
mort_2020$MUERTE_CONTEXTO[mort_2020$presunto==3]<-4
mort_2020$MUERTE_CONTEXTO<-factor(mort_2020$MUERTE_CONTEXTO,labels = c("Natural Death or Non-Applicable","Accidental Death","Homicide or War-Related Death", "Suicide"))

mort_2020$TRABAJO_DEATH<-NULL
mort_2020$TRABAJO_DEATH[mort_2020$ocurr_trab==2 | mort_2020$ocurr_trab==8 | mort_2020$ocurr_trab==9]<-1
mort_2020$TRABAJO_DEATH[mort_2020$ocurr_trab==1 ]<-2
mort_2020$TRABAJO_DEATH<-factor(mort_2020$TRABAJO_DEATH,labels = c("Non-Work-Related Death","Work-Related Death"))

mort_2020$CONTEXTO<-NULL
mort_2020$CONTEXTO[mort_2020$CONTEXTO_DEFUNCION %in% c(1,2,3,4,5,6,7,8,9)]<-1
mort_2020$CONTEXTO[mort_2020$CONTEXTO_DEFUNCION %in% c(10,11,12,99)]<-2
mort_2020$CONTEXTO[mort_2020$CONTEXTO_DEFUNCION %in% c(99)]<-3

#### 2019 Dataset####
mort_2019 <- read.csv("Bases/Bases Federales Defuncion 2015-2016/Defunciones_2019.CSV")
mort_2019$id.ent<-paste0(str_pad(mort_2019$ent_ocurr, 2,pad = "0"))
mort_2019$id.mun<-paste0(str_pad(mort_2019$ent_ocurr, 2,pad = "0"),str_pad(mort_2019$mun_ocurr,3, pad="0"))

mort_2019$FECHA_DEFUNCION<-as.Date(paste0(as.numeric(mort_2019$dia_ocurr),"-",as.numeric(mort_2019$mes_ocurr),"-",as.numeric(mort_2019$anio_ocur)),format = "%d-%m-%Y")
mort_2019<-cbind(mort_2019,data.frame(matrix(unlist(strsplit(as.character(mort_2019$edad), split = "(?=[0-9])", perl = TRUE)), nrow=length(strsplit(as.character(mort_2019$edad), split = "(?=[0-9])", perl = TRUE)), byrow=TRUE)))

mort_2019$X3[mort_2019$X1=="1"]<-"0"
mort_2019$X3[mort_2019$X1=="2"]<-"0"
mort_2019$X3[mort_2019$X1=="3"]<-"0"

mort_2019$X4[mort_2019$X1=="1"]<-"0"
mort_2019$X4[mort_2019$X1=="2"]<-"0"
mort_2019$X4[mort_2019$X1=="3"]<-"0"


mort_2019$edad<-as.numeric(paste0(str_pad(mort_2019$X2, 1),str_pad(mort_2019$X3, 1),str_pad(mort_2019$X4,1)))
mort_2019$edad[mort_2019$edad==998]<-NA

mort_2019<-mort_2019%>%
  filter(mes_ocurr!=99)%>%
  filter(anio_ocur!=9999)%>%
  rename("EDAD"=edad, "SEXO"=sexo, "ESTADO_DEFUNCION"=ent_ocurr,"MUNICIPIO"=mun_ocurr, 
         "CONTEXTO_DEFUNCION"=sitio_ocur,"CAUSA_MUERTE_ICD_10_CATEGORIA_1"=causa_def)%>%
  mutate(Year=data.table::year(FECHA_DEFUNCION),MES=data.table::month(FECHA_DEFUNCION))%>%
  filter(Year=="2019")%>%
  filter(MES!=99)%>%
  mutate(FECHA_DEFUNCION=as.character(FECHA_DEFUNCION))%>%
  mutate(FECHA_DEFUNCION=as.Date(FECHA_DEFUNCION))%>%
  mutate(Year=data.table::year(FECHA_DEFUNCION),MES=data.table::month(FECHA_DEFUNCION))

mort_2019$ICD_10_1.CHAPTER<-str_extract(strsplit(mort_2019$CAUSA_MUERTE_ICD_10_CATEGORIA_1,NULL), "[A-Z]+" )
mort_2019$ICD_10_1.CODE<-as.numeric(substr(str_extract(strsplit(mort_2019$CAUSA_MUERTE_ICD_10_CATEGORIA_1, split = "(?<=[a-zA-Z])\\s*(?=[0-9])", perl = TRUE),"([[:digit:]]+)"),start=1,stop=2))

#ICD-10 Coding

#Preventable mortality specific causes
mort_2019$INTE.DIS[(mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=09))]<-1
mort_2019$DI.TE.PO[(mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE==35 | mort_2019$ICD_10_1.CODE==36 | mort_2019$ICD_10_1.CODE==80))]<-1
mort_2019$WHO.COUG[(mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE==37))]<-1
mort_2019$MENINGOC[(mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE==39))]<-1
mort_2019$SEPS.STR[(mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE>=40 & mort_2019$ICD_10_1.CODE<=41))]<-1
mort_2019$HAE.INFL[(mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE==49))]<-1
mort_2019$SEX.INFE[(mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE>=50 & mort_2019$ICD_10_1.CODE<=64))]<-1
mort_2019$VARICELL[(mort_2019$ICD_10_1.CHAPTER=="B" & (mort_2019$ICD_10_1.CODE==1))]<-1
mort_2019$MEASLESS[(mort_2019$ICD_10_1.CHAPTER=="B" & (mort_2019$ICD_10_1.CODE==5))]<-1
mort_2019$RUBELLAA[(mort_2019$ICD_10_1.CHAPTER=="B" & (mort_2019$ICD_10_1.CODE==6))]<-1 
mort_2019$VIRA.HEP[(mort_2019$ICD_10_1.CHAPTER=="B" & (mort_2019$ICD_10_1.CODE>=15 & mort_2019$ICD_10_1.CODE<=19))]<-1 
mort_2019$HIV.AIDS[(mort_2019$ICD_10_1.CHAPTER=="B" & (mort_2019$ICD_10_1.CODE>=20 & mort_2019$ICD_10_1.CODE<=24))]<-1 
mort_2019$MALARIAS[(mort_2019$ICD_10_1.CHAPTER=="B" & (mort_2019$ICD_10_1.CODE>=50 & mort_2019$ICD_10_1.CODE<=54))]<-1 
mort_2019$HAEM.MEN[(mort_2019$ICD_10_1.CHAPTER=="G" & (mort_2019$ICD_10_1.CODE==0))]<-1 
mort_2019$TUBERCUL[((mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE>=15 & mort_2019$ICD_10_1.CODE<=19))|
                      (mort_2019$ICD_10_1.CHAPTER=="B" & (mort_2019$ICD_10_1.CODE==90))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==65)))]<-1
mort_2019$UPG.CANC[(mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=16))]<-1
mort_2019$LIV.CANC[(mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==22))]<-1
mort_2019$LUN.CANC[(mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE>=33 & mort_2019$ICD_10_1.CODE<=34))]<-1
mort_2019$MESOTHEL[(mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==45))]<-1
mort_2019$MELANOMA[(mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==43))]<-1
mort_2019$BLA.CANC[(mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==67))]<-1
mort_2019$CER.CANC[(mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==53))]<-1
mort_2019$NUT.ANEM[(mort_2019$ICD_10_1.CHAPTER=="D" & (mort_2019$ICD_10_1.CODE>=50 & mort_2019$ICD_10_1.CODE<=53))]<-1
mort_2019$DIA.MELL[(mort_2019$ICD_10_1.CHAPTER=="E" & (mort_2019$ICD_10_1.CODE>=10 & mort_2019$ICD_10_1.CODE<=14))]<-1
mort_2019$AOR.ANEU[(mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE==71))]<-1
mort_2019$HYP.DISE[((mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE>=10 & mort_2019$ICD_10_1.CODE<=13))|
                      (mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE==15)))]<-1
mort_2019$ISH.HEAR[(mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE>=20 & mort_2019$ICD_10_1.CODE<=25))]<-1
mort_2019$CER.VASC[(mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE>=60 & mort_2019$ICD_10_1.CODE<=69))]<-1
mort_2019$ATH.DISE[(mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE==70 & mort_2019$ICD_10_1.CODE==73))]<-1
mort_2019$INFLUENZ[(mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE>=9 & mort_2019$ICD_10_1.CODE<=11))]<-1
mort_2019$PNE.STRE[(mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE>=13 & mort_2019$ICD_10_1.CODE<=14))]<-1
mort_2019$CHR.RESP[(mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE>=40 & mort_2019$ICD_10_1.CODE<=44))]<-1
mort_2019$LUN.DISE[((mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE>=60 & mort_2019$ICD_10_1.CODE<=64))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==66 & mort_2019$ICD_10_1.CODE<=70))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==82))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==92)))]<-1
mort_2019$TET.NEON[(mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE==33))]<-1
mort_2019$OBS.TETA[(mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE==34))]<-1
mort_2019$CER.CONG[((mort_2019$ICD_10_1.CHAPTER=="Q" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=1))|
                      (mort_2019$ICD_10_1.CHAPTER=="Q" & (mort_2019$ICD_10_1.CODE==5)))]<-1
mort_2019$TRAN.ACC[(mort_2019$ICD_10_1.CHAPTER=="V" & (mort_2019$ICD_10_1.CODE>=1 & mort_2019$ICD_10_1.CODE<=99))]<-1
mort_2019$ACCI.INJ[((mort_2019$ICD_10_1.CHAPTER=="W" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=39))|
                      (mort_2019$ICD_10_1.CHAPTER=="X" & (mort_2019$ICD_10_1.CODE>=49 & mort_2019$ICD_10_1.CODE<=59)))]<-1
mort_2019$INTE.HAR[(mort_2019$ICD_10_1.CHAPTER=="X" & (mort_2019$ICD_10_1.CODE>=66 & mort_2019$ICD_10_1.CODE<=84))]<-1
mort_2019$ASSA.LES[((mort_2019$ICD_10_1.CHAPTER=="X" & (mort_2019$ICD_10_1.CODE>=86 & mort_2019$ICD_10_1.CODE<=99))|
                      (mort_2019$ICD_10_1.CHAPTER=="Y" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=9)))]<-1
mort_2019$ALCH.DIS[((mort_2019$ICD_10_1.CHAPTER=="E" & (mort_2019$ICD_10_1.CODE==24))|
                      (mort_2019$ICD_10_1.CHAPTER=="F" & (mort_2019$ICD_10_1.CODE==10))|
                      (mort_2019$ICD_10_1.CHAPTER=="G" & (mort_2019$ICD_10_1.CODE==31))|
                      (mort_2019$ICD_10_1.CHAPTER=="G" & (mort_2019$ICD_10_1.CODE==62))|
                      (mort_2019$ICD_10_1.CHAPTER=="G" & (mort_2019$ICD_10_1.CODE==72))|
                      (mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE==42))|
                      (mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE==29))|
                      (mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE==70))|
                      (mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE==85))|
                      (mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE==86))|
                      (mort_2019$ICD_10_1.CHAPTER=="R" & (mort_2019$ICD_10_1.CODE==78))|
                      (mort_2019$ICD_10_1.CHAPTER=="X" & (mort_2019$ICD_10_1.CODE==45))|
                      (mort_2019$ICD_10_1.CHAPTER=="X" & (mort_2019$ICD_10_1.CODE==65))|
                      (mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE>=73 & mort_2019$ICD_10_1.CODE<=74))|
                      (mort_2019$ICD_10_1.CHAPTER=="Y" & (mort_2019$ICD_10_1.CODE==15)))]<-1
mort_2019$DRUG.REL[((mort_2019$ICD_10_1.CHAPTER=="F" & (mort_2019$ICD_10_1.CODE>=11 & mort_2019$ICD_10_1.CODE<=16))|
                      (mort_2019$ICD_10_1.CHAPTER=="F" & (mort_2019$ICD_10_1.CODE>=18 & mort_2019$ICD_10_1.CODE<=19))|
                      (mort_2019$ICD_10_1.CHAPTER=="X" & (mort_2019$ICD_10_1.CODE>=40 & mort_2019$ICD_10_1.CODE<=44))|
                      (mort_2019$ICD_10_1.CHAPTER=="X" & (mort_2019$ICD_10_1.CODE==85))|
                      (mort_2019$ICD_10_1.CHAPTER=="Y" & (mort_2019$ICD_10_1.CODE>=10 & mort_2019$ICD_10_1.CODE<=14))|
                      (mort_2019$ICD_10_1.CHAPTER=="X" & (mort_2019$ICD_10_1.CODE>=60 & mort_2019$ICD_10_1.CODE<=64)))]<-1

mort_2019$RESP.FAL[(mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==96))]<-1 #RESPIRATORY FAILLURE
mort_2019$FLUID.DI[(mort_2019$ICD_10_1.CHAPTER=="E" & (mort_2019$ICD_10_1.CODE==87))]<-1 #Other disorders of fluid, electrolyte and acid-base balance
mort_2019$SHOCK.AN[(mort_2019$ICD_10_1.CHAPTER=="R" & (mort_2019$ICD_10_1.CODE==57))]<-1 #Shock, not elsewhere classified

#Preventable mortality final coding

mort_2019$PREVENT<-NULL
mort_2019$PREVENT[((mort_2019$EDAD>=0 & mort_2019$EDAD<=74) & (mort_2019$INTE.DIS==1|
                                                                 mort_2019$DI.TE.PO==1|
                                                                 mort_2019$WHO.COUG==1|
                                                                 mort_2019$MENINGOC==1|
                                                                 mort_2019$SEPS.STR==1|
                                                                 mort_2019$HAE.INFL==1|
                                                                 mort_2019$SEX.INFE==1|
                                                                 mort_2019$VARICELL==1|
                                                                 mort_2019$MEASLESS==1|
                                                                 mort_2019$RUBELLAA==1|
                                                                 mort_2019$VIRA.HEP==1|
                                                                 mort_2019$HIV.AIDS==1|
                                                                 mort_2019$MALARIAS==1|
                                                                 mort_2019$HAEM.MEN==1|
                                                                 mort_2019$TUBERCUL==1|
                                                                 mort_2019$UPG.CANC==1|
                                                                 mort_2019$LIV.CANC==1|
                                                                 mort_2019$LUN.CANC==1|
                                                                 mort_2019$MESOTHEL==1|
                                                                 mort_2019$MELANOMA==1|
                                                                 mort_2019$BLA.CANC==1|
                                                                 mort_2019$CER.CANC==1|
                                                                 mort_2019$NUT.ANEM==1|
                                                                 mort_2019$DIA.MELL==1|
                                                                 mort_2019$AOR.ANEU==1|
                                                                 mort_2019$HYP.DISE==1|
                                                                 mort_2019$ISH.HEAR==1|
                                                                 mort_2019$CER.VASC==1|
                                                                 mort_2019$ATH.DISE==1|
                                                                 mort_2019$INFLUENZ==1|
                                                                 mort_2019$PNE.STRE==1|
                                                                 mort_2019$CHR.RESP==1|
                                                                 mort_2019$LUN.DISE==1|
                                                                 mort_2019$TET.NEON==1|
                                                                 mort_2019$OBS.TETA==1|
                                                                 mort_2019$CER.CONG==1|
                                                                 mort_2019$TRAN.ACC==1|
                                                                 mort_2019$ACCI.INJ==1|
                                                                 mort_2019$INTE.HAR==1|
                                                                 mort_2019$ASSA.LES==1|
                                                                 mort_2019$ALCH.DIS==1|
                                                                 mort_2019$DRUG.REL==1|
                                                                 mort_2019$RESP.FAL==1|
                                                                 mort_2019$FLUID.DI==1|
                                                                 mort_2019$SHOCK.AN==1))]<-1

#Treatable mortality specific causes

mort_2019$TUBERCUL[((mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE>=15 & mort_2019$ICD_10_1.CODE<=19))|
                      (mort_2019$ICD_10_1.CHAPTER=="B" & (mort_2019$ICD_10_1.CODE==90))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==65)))]<-1
mort_2019$FIE.SCAR[((mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE==38)))]<-1
mort_2019$SEPSIS.A[((mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE>=40 & mort_2019$ICD_10_1.CODE<=41)))]<-1
mort_2019$CELLULIS[((mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE==46))|
                      (mort_2019$ICD_10_1.CHAPTER=="L" & (mort_2019$ICD_10_1.CODE==3)))]<-1
mort_2019$LEGIONEL[((mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE==48)))]<-1
mort_2019$STRE.ENT[((mort_2019$ICD_10_1.CHAPTER=="A" & (mort_2019$ICD_10_1.CODE==49)))]<-1
mort_2019$MENINGIS[((mort_2019$ICD_10_1.CHAPTER=="G" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=3)))]<-1
mort_2019$CERV.CAN[((mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==53)))]<-1
mort_2019$COLO.CAN[((mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE>=18 & mort_2019$ICD_10_1.CODE<=21)))]<-1
mort_2019$BREA.CAN[((mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==50)))]<-1
mort_2019$UTER.CAN[((mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE>=54 & mort_2019$ICD_10_1.CODE<=55)))]<-1
mort_2019$TEST.CAN[((mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==62)))]<-1
mort_2019$THYR.CAN[((mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==73)))]<-1
mort_2019$HODG.CAN[((mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==81)))]<-1
mort_2019$LYMP.CAN[((mort_2019$ICD_10_1.CHAPTER=="C" & (mort_2019$ICD_10_1.CODE==91)))]<-1
mort_2019$BENI.CAN[((mort_2019$ICD_10_1.CHAPTER=="D" & (mort_2019$ICD_10_1.CODE>=10 & mort_2019$ICD_10_1.CODE<=36)))]<-1
mort_2019$DIA.MELL[(mort_2019$ICD_10_1.CHAPTER=="E" & (mort_2019$ICD_10_1.CODE>=10 & mort_2019$ICD_10_1.CODE<=14))]<-1
mort_2019$THRO.DIS[(mort_2019$ICD_10_1.CHAPTER=="E" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=7))]<-1
mort_2019$ADRE.DIS[(mort_2019$ICD_10_1.CHAPTER=="E" & (mort_2019$ICD_10_1.CODE>=24 & mort_2019$ICD_10_1.CODE<=27))]<-1
mort_2019$EPIL.DIS[(mort_2019$ICD_10_1.CHAPTER=="G" & (mort_2019$ICD_10_1.CODE>=40 & mort_2019$ICD_10_1.CODE<=41))]<-1
mort_2019$AOR.ANEU[(mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE==71))]<-1
mort_2019$HYP.DISE[((mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE>=10 & mort_2019$ICD_10_1.CODE<=13))|
                      (mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE==15)))]<-1
mort_2019$ISH.HEAR[(mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE>=20 & mort_2019$ICD_10_1.CODE<=25))]<-1
mort_2019$CER.VASC[(mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE>=60 & mort_2019$ICD_10_1.CODE<=69))]<-1
mort_2019$ATH.DISE[(mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE==70 & mort_2019$ICD_10_1.CODE==73))]<-1
mort_2019$RHE.DISE[(mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=9))]<-1
mort_2019$VEN.TROM[((mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE==26))|
                      (mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE==80))| 
                      (mort_2019$ICD_10_1.CHAPTER=="I" & (mort_2019$ICD_10_1.CODE==82)))]<-1
mort_2019$UPP.RESP[((mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=6))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE>=30 & mort_2019$ICD_10_1.CODE<=39)))]<-1
mort_2019$PNEU.UNS[((mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==12))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==15))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==16))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==17))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==18)))]<-1
mort_2019$AC.LOW.R[((mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==20 & mort_2019$ICD_10_1.CODE<=22)))]<-1
mort_2019$ASTH.BRO[((mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==45 & mort_2019$ICD_10_1.CODE<=47)))]<-1
mort_2019$SIRA.RES[((mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==80)))]<-1
mort_2019$PUL.EDEM[((mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==81)))]<-1
mort_2019$ABS.LUNG[((mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==85))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==86)))]<-1
mort_2019$OTH.PLER[((mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==90))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==93))|
                      (mort_2019$ICD_10_1.CHAPTER=="J" & (mort_2019$ICD_10_1.CODE==94)))]<-1
mort_2019$GAS.DUOD[((mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE>=25 & mort_2019$ICD_10_1.CODE<=28)))]<-1
mort_2019$APPENDIC[((mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE>=35 & mort_2019$ICD_10_1.CODE<=38)))]<-1
mort_2019$ABDO.HER[((mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE>=40 & mort_2019$ICD_10_1.CODE<=46)))]<-1
mort_2019$CHOLELIT[((mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE>=80 & mort_2019$ICD_10_1.CODE<=81)))]<-1
mort_2019$OTH.GALB[((mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE>=82 & mort_2019$ICD_10_1.CODE<=83)))]<-1
mort_2019$ACU.PANC[((mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE==85)))]<-1
mort_2019$OTH.PANC[((mort_2019$ICD_10_1.CHAPTER=="K" & (mort_2019$ICD_10_1.CODE==86)))]<-1
mort_2019$NEPH.NEP[((mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=7)))]<-1
mort_2019$OBS.UROP[((mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE==13))|
                      (mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE>=20 & mort_2019$ICD_10_1.CODE<=21))|
                      (mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE==35)))]<-1
mort_2019$REN.FAIL[((mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE>=17 & mort_2019$ICD_10_1.CODE<=19)))]<-1
mort_2019$REN.COLI[((mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE==23)))]<-1
mort_2019$TUB.DISF[((mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE==25)))]<-1
mort_2019$UNF.NEFP[((mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE>=26 & mort_2019$ICD_10_1.CODE<=27)))]<-1
mort_2019$INF.GENU[((mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE==34))|
                      (mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE==70))|
                      (mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE==73))|
                      (mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE==75))|
                      (mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE==76)))]<-1
mort_2019$PROS.HYP[((mort_2019$ICD_10_1.CHAPTER=="N" & (mort_2019$ICD_10_1.CODE==40)))]<-1
mort_2019$PRE.CHIL[((mort_2019$ICD_10_1.CHAPTER=="O" & (mort_2019$ICD_10_1.CODE>=0 & mort_2019$ICD_10_1.CODE<=99)))]<-1
mort_2019$CONG.CVD[((mort_2019$ICD_10_1.CHAPTER=="Q" & (mort_2019$ICD_10_1.CODE>=20 & mort_2019$ICD_10_1.CODE<=28)))]<-1
mort_2019$DRUGS.AE[((mort_2019$ICD_10_1.CHAPTER=="Y" & (mort_2019$ICD_10_1.CODE>=40 & mort_2019$ICD_10_1.CODE<=59)))]<-1
mort_2019$QX.DR.AE[((mort_2019$ICD_10_1.CHAPTER=="Y" & (mort_2019$ICD_10_1.CODE>=60 & mort_2019$ICD_10_1.CODE<=69))|
                      (mort_2019$ICD_10_1.CHAPTER=="Y" & (mort_2019$ICD_10_1.CODE>=83 & mort_2019$ICD_10_1.CODE<=84)))]<-1
mort_2019$MD.DR.AE[((mort_2019$ICD_10_1.CHAPTER=="Y" & (mort_2019$ICD_10_1.CODE>=70 & mort_2019$ICD_10_1.CODE<=82)))]<-1


#Treatable mortality final coding 

mort_2019$TREATAB<-NULL
mort_2019$TREATAB[((mort_2019$EDAD>=0 & mort_2019$EDAD<=74) & (mort_2019$TUBERCUL==1|
                                                                 mort_2019$FIE.SCAR==1|
                                                                 mort_2019$SEPSIS.A==1|
                                                                 mort_2019$CELLULIS==1|
                                                                 mort_2019$LEGIONEL==1|
                                                                 mort_2019$STRE.ENT==1|
                                                                 mort_2019$MENINGIS==1|
                                                                 mort_2019$COLO.CAN==1|
                                                                 mort_2019$CERV.CAN==1|
                                                                 mort_2019$BREA.CAN==1|
                                                                 mort_2019$UTER.CAN==1|
                                                                 mort_2019$TEST.CAN==1|
                                                                 mort_2019$THYR.CAN==1|
                                                                 mort_2019$HODG.CAN==1|
                                                                 mort_2019$LYMP.CAN==1|
                                                                 mort_2019$BENI.CAN==1|
                                                                 mort_2019$DIA.MELL==1|
                                                                 mort_2019$THRO.DIS==1|
                                                                 mort_2019$ADRE.DIS==1|
                                                                 mort_2019$EPIL.DIS==1|
                                                                 mort_2019$AOR.ANEU==1|
                                                                 mort_2019$HYP.DISE==1|
                                                                 mort_2019$ISH.HEAR==1|
                                                                 mort_2019$CER.VASC==1|
                                                                 mort_2019$ATH.DISE==1|
                                                                 mort_2019$RHE.DISE==1|
                                                                 mort_2019$VEN.TROM==1|
                                                                 mort_2019$UPP.RESP==1|
                                                                 mort_2019$PNEU.UNS==1|
                                                                 mort_2019$AC.LOW.R==1|
                                                                 mort_2019$ASTH.BRO==1|
                                                                 mort_2019$SIRA.RES==1|
                                                                 mort_2019$PUL.EDEM==1|
                                                                 mort_2019$ABS.LUNG==1|
                                                                 mort_2019$OTH.PLER==1|
                                                                 mort_2019$GAS.DUOD==1|
                                                                 mort_2019$APPENDIC==1|
                                                                 mort_2019$ABDO.HER==1|
                                                                 mort_2019$CHOLELIT==1|
                                                                 mort_2019$OTH.GALB==1|
                                                                 mort_2019$ACU.PANC==1|
                                                                 mort_2019$OTH.PANC==1|
                                                                 mort_2019$NEPH.NEP==1|
                                                                 mort_2019$OBS.UROP==1|
                                                                 mort_2019$REN.FAIL==1|
                                                                 mort_2019$REN.COLI==1|
                                                                 mort_2019$TUB.DISF==1|
                                                                 mort_2019$UNF.NEFP==1|
                                                                 mort_2019$INF.GENU==1|
                                                                 mort_2019$PROS.HYP==1|
                                                                 mort_2019$PRE.CHIL==1|
                                                                 mort_2019$CONG.CVD==1|
                                                                 mort_2019$DRUGS.AE==1|
                                                                 mort_2019$QX.DR.AE==1|
                                                                 mort_2019$MD.DR.AE==1))]<-1
#Final coding

mort_2019$TREA.PREV<-NULL
mort_2019$TREA.PREV[mort_2019$TREATAB==1 & (is.na(mort_2019$PREVENT) & !is.na(mort_2019$CAUSA_MUERTE_ICD_10_CATEGORIA_1))]<-1
mort_2019$TREA.PREV[mort_2019$PREVENT==1 & (is.na(mort_2019$TREATAB) & !is.na(mort_2019$CAUSA_MUERTE_ICD_10_CATEGORIA_1))]<-2
mort_2019$TREA.PREV[mort_2019$TREATAB==1 & mort_2019$PREVENT==1]<-3
mort_2019$TREA.PREV[(!is.na(mort_2019$CAUSA_MUERTE_ICD_10_CATEGORIA_1)) & (is.na(mort_2019$TREATAB) & is.na(mort_2019$PREVENT))]<-4

#Cause specific mortality 

mort_2019$ICD_10_1.SUB<-as.numeric(substring(mort_2019$CAUSA_MUERTE_ICD_10_CATEGORIA_1,4))

## Intestinal Infectious Diseases ##
mort_2019$EII.COLE<-NULL; mort_2019$EII.COLE[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==0))]<-1 #Cholera
mort_2019$EII.TIPA<-NULL; mort_2019$EII.TIPA[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==1))]<-1 #Typhoid and paratyphoid fever
mort_2019$EII.SHIG<-NULL; mort_2019$EII.SHIG[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==3))]<-1 #Shigellosis
mort_2019$EII.TOXI<-NULL; mort_2019$EII.TOXI[with(mort_2019, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==2|ICD_10_1.CODE==5)))]<-1 #Food poisoning
mort_2019$EII.AMEB<-NULL; mort_2019$EII.AMEB[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==6))]<-1 #Amebiasis
mort_2019$EII.OTRA<-NULL; mort_2019$EII.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==4|ICD_10_1.CODE==7|ICD_10_1.CODE==8)))]<-1 #Other GI infection
mort_2019$EII.PRES<-NULL; mort_2019$EII.PRES[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==9))]<-1 #Presumed GI infection

## Tuberculosis ##
mort_2019$TUB.PULM<-NULL; mort_2019$TUB.PULM[with(mort_2019,(ICD_10_1.CHAPTER=="A" & #Pulmonary TB
                                                               ((ICD_10_1.CODE==15 & (ICD_10_1.SUB<=3|ICD_10_1.SUB==7|ICD_10_1.SUB==9))|
                                                                  (ICD_10_1.CODE==16 & (ICD_10_1.SUB<=2|ICD_10_1.SUB==7|ICD_10_1.SUB==9)) ) ))]<-1 
mort_2019$TUB.RESP<-NULL; mort_2019$TUB.RESP[with(mort_2019,(ICD_10_1.CHAPTER=="A" & #Other respiratory TB
                                                               ((ICD_10_1.CODE==15 & (ICD_10_1.SUB==4|ICD_10_1.SUB==5|ICD_10_1.SUB==6|ICD_10_1.SUB==8))|
                                                                  (ICD_10_1.CODE==16 & (ICD_10_1.SUB==3|ICD_10_1.SUB==4|ICD_10_1.SUB==5|ICD_10_1.SUB==8)))))]<-1 
mort_2019$TUB.NERV<-NULL; mort_2019$TUB.NERV[with(mort_2019, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==17) ))]<-1 #Nervous System TB
mort_2019$TUB.IPGM<-NULL; mort_2019$TUB.IPGM[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==3))]<-1 #Intestinal/peritoneal Tb
mort_2019$TUB.BONE<-NULL; mort_2019$TUB.BONE[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==0))]<-1 #Bone and joint Tb
mort_2019$TUB.URIN<-NULL; mort_2019$TUB.URIN[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==1))]<-1 #Genitourinary Tb
mort_2019$TUB.OTRA<-NULL; mort_2019$TUB.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="A" & #Other Tb
                                                                ((ICD_10_1.CODE==18 & (ICD_10_1.SUB==2|ICD_10_1.SUB>=4))|(ICD_10_1.CODE==19)) )) ]<-1

## Other bacterial diseases ##
mort_2019$BAC.PEST<-NULL; mort_2019$BAC.PEST[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==20))]<-1 #Plague (peste)
mort_2019$BAC.BRUS<-NULL; mort_2019$BAC.BRUS[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==23))]<-1 #Brusellosis
mort_2019$BAC.LEPR<-NULL; mort_2019$BAC.LEPR[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==30))]<-1 #Leprosy
mort_2019$BAC.DIFT<-NULL; mort_2019$BAC.DIFT[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==36))]<-1 #Diphtheria
mort_2019$BAC.PERT<-NULL; mort_2019$BAC.PERT[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==37))]<-1 #Pertussis
mort_2019$BAC.PYOG<-NULL; mort_2019$BAC.PYOG[with(mort_2019, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==38|ICD_10_1.CODE==46)))]<-1 #Scarlet fever, erysipelas
mort_2019$BAC.MENI<-NULL; mort_2019$BAC.MENI[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==39))]<-1 #Meningococcal disease
mort_2019$BAC.TETA<-NULL; mort_2019$BAC.TETA[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==35))]<-1 #Tetanus
mort_2019$BAC.SEPS<-NULL; mort_2019$BAC.SEPS[with(mort_2019, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==40|ICD_10_1.CODE==41) ))]<-1 #Sepsis
mort_2019$BAC.OTRA<-NULL; mort_2019$BAC.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="A" &
                                                                (ICD_10_1.CODE==21|ICD_10_1.CODE==22|(ICD_10_1.CODE>=24&ICD_10_1.CODE<=28)|
                                                                   ICD_10_1.CODE==31|ICD_10_1.CODE==32|(ICD_10_1.CODE>=42&ICD_10_1.CODE<=44)|
                                                                   ICD_10_1.CODE==48|ICD_10_1.CODE==49)))]<-1 #Other

## Sexually transmitted diseases ##
mort_2019$ETS.SIF1<-NULL; mort_2019$ETS.SIF1[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==50))]<-1 #Congenital syphilis
mort_2019$ETS.SIF2<-NULL; mort_2019$ETS.SIF2[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==51))]<-1 #Early syphilis
mort_2019$ETS.SIF3<-NULL; mort_2019$ETS.SIF3[with(mort_2019, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==52|ICD_10_1.CODE==53)))]<-1 #Other syphilis
mort_2019$ETS.GONO<-NULL; mort_2019$ETS.GONO[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==54))]<-1 #Gonorrhea
mort_2019$ETS.CLAM<-NULL; mort_2019$ETS.CLAM[with(mort_2019, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==55|ICD_10_1.CODE==56)))]<-1 #Chlamydia
mort_2019$ETS.OTRA<-NULL; mort_2019$ETS.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE>=57&ICD_10_1.CODE<=64)))]<-1 #Other STD



## Viral diseases ##
mort_2019$VIR.POLI<-NULL; mort_2019$VIR.POLI[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==80))]<-1 #Acute Poliomyelitis
mort_2019$VIR.VIRU<-NULL; mort_2019$VIR.VIRU[with(mort_2019, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==3|ICD_10_1.CODE==4)))]<-1 #Smallpox (viruela)
mort_2019$VIR.SARA<-NULL; mort_2019$VIR.SARA[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==5))]<-1 #Measles
mort_2019$VIR.RUBE<-NULL; mort_2019$VIR.RUBE[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==6))]<-1 #Rubella
mort_2019$VIR.FIAM<-NULL; mort_2019$VIR.FIAM[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==95))]<-1 #Yellow fever
mort_2019$VIR.DENG<-NULL; mort_2019$VIR.DENG[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==90))]<-1 #Dengue fever
mort_2019$VIR.DHEM<-NULL; mort_2019$VIR.DHEM[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==91))]<-1 #Dengue hemorragic fever
mort_2019$VIR.VIH1<-NULL; mort_2019$VIR.VIH1[with(mort_2019, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=24)))]<-1 #HIV infection
mort_2019$VIR.EVTA<-NULL; mort_2019$VIR.EVTA[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE==85&ICD_10_1.SUB==2)| #Arthropod-Borne Viral Encephalitis
                                                                                         ICD_10_1.CODE==83|ICD_10_1.CODE==84|ICD_10_1.CODE==86)))]<-1 
mort_2019$VIR.HEPB<-NULL; mort_2019$VIR.HEPB[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==16))]<-1 #Acute Hepatitis B
mort_2019$VIR.HEPO<-NULL; mort_2019$VIR.HEPO[with(mort_2019, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==15| #Other viral hepatitis
                                                                                         (ICD_10_1.CODE>=17&ICD_10_1.CODE<=19))))]<-1 
mort_2019$VIR.RABI<-NULL; mort_2019$VIR.RABI[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==82))]<-1 #Rabies
mort_2019$VIR.TRAC<-NULL; mort_2019$VIR.TRAC[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==71))]<-1 #Trachoma (??)


#Other arthropod-borne viral fevers and viral hemorrhagic fevers
mort_2019$VIR.OFAH<-NULL; mort_2019$VIR.OFAH[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE>=92&ICD_10_1.CODE<=94)|
                                                                                         (ICD_10_1.CODE>=96&ICD_10_1.CODE<=99))))]<-1 
mort_2019$VIR.HERP<-NULL; mort_2019$VIR.HERP[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==0))]<-1 #Herpes simplex infections
mort_2019$VIR.VRHZ<-NULL; mort_2019$VIR.VRHZ[with(mort_2019, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==1|ICD_10_1.CODE==2) ))]<-1 #Chickenpox or herpes zoster
mort_2019$VIR.PARO<-NULL; mort_2019$VIR.PARO[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==26))]<-1 #Mumps
mort_2019$VIR.OCLA<-NULL; mort_2019$VIR.OCLA[with(mort_2019, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==70|ICD_10_1.CODE==74)))]<-1 #Other chlamydia infections (??)
mort_2019$VIR.OTRA<-NULL; mort_2019$VIR.OTRA[with(mort_2019, ((ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE==85&(ICD_10_1.SUB==0|ICD_10_1.SUB==1|ICD_10_1.SUB==8))|
                                                                                          ICD_10_1.CODE==81|(ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)))|
                                                                (ICD_10_1.CHAPTER=="B" & ((ICD_10_1.CODE>=7&ICD_10_1.CODE<=9)|ICD_10_1.CODE==25|
                                                                                            (ICD_10_1.CODE>=27&ICD_10_1.CODE<=34)))))]<-1 #Other viral diseases


## Rickettsiosis and Protozoan Infections ##
mort_2019$RPI.TIFP<-NULL; mort_2019$RPI.TIFP[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==75 & ICD_10_1.SUB==0))]<-1 #Louse-borne epidemic thypus
mort_2019$RPI.OTIF<-NULL; mort_2019$RPI.OTIF[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==75 & ICD_10_1.SUB!=0))]<-1 #Other thypus
mort_2019$RPI.ORIC<-NULL; mort_2019$RPI.ORIC[with(mort_2019, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE>=77&ICD_10_1.CODE<=79) ))]<-1 #Other rickettsiosis
mort_2019$RPI.PALU<-NULL; mort_2019$RPI.PALU[with(mort_2019, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=54) ))]<-1 #Malaria
mort_2019$RPI.LEIS<-NULL; mort_2019$RPI.LEIS[with(mort_2019, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==55) ))]<-1 #Leishmaniasis
mort_2019$RPI.TRIP<-NULL; mort_2019$RPI.TRIP[with(mort_2019, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==56|ICD_10_1.CODE==57) ))]<-1 #Trypanosomiasis

## Parasitic worms, Mycosis and Other infectious diseases ##
mort_2019$PMO.ESPI<-NULL; mort_2019$PMO.ESPI[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE>=65&ICD_10_1.CODE<=67)|
                                                                                         ICD_10_1.CODE==69)))]<-1 #Other spirochetal diseases (Not syphilis)
mort_2019$PMO.FIRE<-NULL; mort_2019$PMO.FIRE[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==68))]<-1 #Relapsing fevers
mort_2019$PMO.MICO<-NULL; mort_2019$PMO.MICO[with(mort_2019, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=49) ))]<-1 #Mycosis 
mort_2019$PMO.SCHI<-NULL; mort_2019$PMO.SCHI[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==65))]<-1 #Schistosomiasis
mort_2019$PMO.TREM<-NULL; mort_2019$PMO.TREM[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==66))]<-1 #Other fluke (trematoda) infections
mort_2019$PMO.ECHI<-NULL; mort_2019$PMO.ECHI[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==67))]<-1 #Echinococcosis
mort_2019$PMO.DRAC<-NULL; mort_2019$PMO.DRAC[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==72))]<-1 #Dracunculiasis
mort_2019$PMO.ONCH<-NULL; mort_2019$PMO.ONCH[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==73))]<-1 #Onchocerciasis
mort_2019$PMO.FILA<-NULL; mort_2019$PMO.FILA[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==74))]<-1 #Filariasis
mort_2019$PMO.ANNE<-NULL; mort_2019$PMO.ANNE[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==76))]<-1 #Ancylostomiasis or Necatoriasis
mort_2019$PMO.HELM<-NULL; mort_2019$PMO.HELM[with(mort_2019, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==75|(ICD_10_1.CODE>=68&ICD_10_1.CODE<=71)|
                                                                                         (ICD_10_1.CODE>=77&ICD_10_1.CODE<=83))))]<-1 #Other Helminthiases
mort_2019$PMO.OTRA<-NULL; mort_2019$PMO.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==99|(ICD_10_1.CODE>=58&ICD_10_1.CODE<=64)|
                                                                                         (ICD_10_1.CODE>=85&ICD_10_1.CODE<=89)| 
                                                                                         (ICD_10_1.CODE>=95&ICD_10_1.CODE<=97))))]<-1 #Other infectious/parasitic disease

## Sequelae of infectious diseases ##
mort_2019$SEI.TUBE<-NULL; mort_2019$SEI.TUBE[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==90))]<-1 #Tuberculosis sequelae
mort_2019$SEI.POLI<-NULL; mort_2019$SEI.POLI[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==91))]<-1 #Poliomyelitis sequelae
mort_2019$SEI.LEPR<-NULL; mort_2019$SEI.LEPR[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==92))]<-1 #Leprosy sequelae
mort_2019$SEI.OTRA<-NULL; mort_2019$SEI.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==94))]<-1 #Sequelae from other infections

## Malignant neoplasms 1: lip, oral cavity and pharynx ##
mort_2019$NM1.LCBF<-NULL; mort_2019$NM1.LCBF[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=14)))]<-1

## Malignant neoplasms 2: digestive organs ##
mort_2019$NM2.ESOF<-NULL; mort_2019$NM2.ESOF[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==15))]<-1 #Esophagus
mort_2019$NM2.STOM<-NULL; mort_2019$NM2.STOM[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==16))]<-1 #Stomach
mort_2019$NM2.INDE<-NULL; mort_2019$NM2.INDE[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==17))]<-1 #Small intestine
mort_2019$NM2.COLO<-NULL; mort_2019$NM2.COLO[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==18))]<-1 #Colon
mort_2019$NM2.RECT<-NULL; mort_2019$NM2.RECT[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=19&ICD_10_1.CODE<=21)))]<-1 #Rectosigmoid junction, Rectum, Anus and anal canal
mort_2019$NM2.HIGA<-NULL; mort_2019$NM2.HIGA[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==22))]<-1 #Liver and intrahepatic bile ducts
mort_2019$NM2.PANC<-NULL; mort_2019$NM2.PANC[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==25))]<-1 #Pancreas
mort_2019$NM2.OTRO<-NULL; mort_2019$NM2.OTRO[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==23|ICD_10_1.CODE==24|ICD_10_1.CODE==26)))]<-1 #Other

## Malignant neoplasms 3: respiratory and intrathoracic organs ##
mort_2019$NM3.LARI<-NULL; mort_2019$NM3.LARI[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==32))]<-1 #Larynx
mort_2019$NM3.TBPU<-NULL; mort_2019$NM3.TBPU[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==33|ICD_10_1.CODE==34)))]<-1 #Trachea, bronchus and lung
mort_2019$NM3.OTRO<-NULL; mort_2019$NM3.OTRO[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==30|ICD_10_1.CODE==31|
                                                                                         (ICD_10_1.CODE>=37&ICD_10_1.CODE<=39))))]<-1 #Other

## Malignant neoplasms 4: bone, articular cartilage, skin, soft tissues and breast ##
mort_2019$NM4.BONE<-NULL; mort_2019$NM4.BONE[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==40|ICD_10_1.CODE==41)))]<-1 #Bone and articular cartilage
mort_2019$NM4.MELA<-NULL; mort_2019$NM4.MELA[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==43))]<-1 #Malignant melanoma of skin
mort_2019$NM4.SKIN<-NULL; mort_2019$NM4.SKIN[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==44))]<-1 #Other malignant neoplasm of skin
mort_2019$NM4.MAMA<-NULL; mort_2019$NM4.MAMA[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==50))]<-1 #Breast
mort_2019$NM4.SOFT<-NULL; mort_2019$NM4.SOFT[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=45&ICD_10_1.CODE<=49)))]<-1 #Mesothelial and soft tissue

## Malignant neoplasms 5: genitourinary organs ##
mort_2019$NM5.CERV<-NULL; mort_2019$NM5.CERV[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==53))]<-1 #Cervix uteri
mort_2019$NM5.PLAC<-NULL; mort_2019$NM5.PLAC[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==58))]<-1 #Placenta
mort_2019$NM5.UTER<-NULL; mort_2019$NM5.UTER[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==54|ICD_10_1.CODE==55)))]<-1 #Uterus
mort_2019$NM5.OVAR<-NULL; mort_2019$NM5.OVAR[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==56))]<-1 #Ovary
mort_2019$NM5.VAGI<-NULL; mort_2019$NM5.VAGI[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==51|ICD_10_1.CODE==52)))]<-1 #Vulva and vagina
mort_2019$NM5.OTFE<-NULL; mort_2019$NM5.OTFE[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==57))]<-1 #Other and unspecified (female)
mort_2019$NM5.PROS<-NULL; mort_2019$NM5.PROS[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==61))]<-1 #Prostate
mort_2019$NM5.TEST<-NULL; mort_2019$NM5.TEST[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==62))]<-1 #Testis
mort_2019$NM5.OTMA<-NULL; mort_2019$NM5.OTMA[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==60|ICD_10_1.CODE==63)))]<-1 #Other and unspecified (male)
mort_2019$NM5.VEJI<-NULL; mort_2019$NM5.VEJI[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==67))]<-1 #Bladder
mort_2019$NM5.OTUR<-NULL; mort_2019$NM5.OTUR[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ((ICD_10_1.CODE>=64&ICD_10_1.CODE<=66)|
                                                                                         ICD_10_1.CODE==68)))]<-1 #Other urinary tract neoplasms


## Malignant neoplasms 6: other organs and unspecified sites ##
mort_2019$NM6.ENCF<-NULL; mort_2019$NM6.ENCF[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==71))]<-1 #Brain
mort_2019$NM6.MENI<-NULL; mort_2019$NM6.MENI[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==70|ICD_10_1.CODE==72)))]<-1 #Meninges and other SNC
mort_2019$NM6.OJOA<-NULL; mort_2019$NM6.OJOA[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==69))]<-1 #Eyes and adnexa
mort_2019$NM6.OTRO<-NULL; mort_2019$NM6.OTRO[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=73&ICD_10_1.CODE<=80)))]<-1 #Other and unspecified

## Malignant neoplasms 7: lymphoid, hematopoietic and related tissue ##
mort_2019$NM7.ENHO<-NULL; mort_2019$NM7.ENHO[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==81))]<-1 #Hodgkin lymphoma
mort_2019$NM7.NOHO<-NULL; mort_2019$NM7.NOHO[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=82&ICD_10_1.CODE<=85)))]<-1 #Non-Hodgkin lymphoma
mort_2019$NM7.MMCP<-NULL; mort_2019$NM7.MMCP[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==90))]<-1 #Multiple myeloma and plasmatic cell neoplasms
mort_2019$NM7.LEUC<-NULL; mort_2019$NM7.LEUC[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=91&ICD_10_1.CODE<=95)))]<-1 #Leukemias
mort_2019$NM7.OTRO<-NULL; mort_2019$NM7.OTRO[with(mort_2019, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==88|ICD_10_1.CODE==96)))]<-1 #Other


## Malignant neoplasms 8: multiple primary tumors ##
mort_2019$NM8.MUPT<-NULL; mort_2019$NM8.MUPT[with(mort_2019, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==97))]<-1

## In situ neoplasms ##
mort_2019$NIS.CERV<-NULL; mort_2019$NIS.CERV[with(mort_2019, (ICD_10_1.CHAPTER=="D" & ICD_10_1.CODE==6))]<-1 #Cervix uteri
mort_2019$NIS.OTRO<-NULL; mort_2019$NIS.OTRO[with(mort_2019, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=5)| #Other in situ neoplasms
                                                                                         (ICD_10_1.CODE>=7&ICD_10_1.CODE<=9))))]<-1

## Benign neoplasms ##
mort_2019$NBE.SKIN<-NULL; mort_2019$NBE.SKIN[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==22|ICD_10_1.CODE==23) ))]<-1 #Skin
mort_2019$NBE.MAMA<-NULL; mort_2019$NBE.MAMA[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==24)))]<-1 #Breast
mort_2019$NBE.LEIO<-NULL; mort_2019$NBE.LEIO[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==25)))]<-1 #Leiomyoma of uterus
mort_2019$NBE.OVAR<-NULL; mort_2019$NBE.OVAR[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==27)))]<-1 #Ovary
mort_2019$NBE.URIN<-NULL; mort_2019$NBE.URIN[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==30)))]<-1 #Urinary tract
mort_2019$NBE.CSNC<-NULL; mort_2019$NBE.CSNC[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==33)))]<-1 #Brain and other CNS sites
mort_2019$NBE.TIRO<-NULL; mort_2019$NBE.TIRO[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==34)))]<-1 #Thyroid
mort_2019$NBE.OTRO<-NULL; mort_2019$NBE.OTRO[with(mort_2019, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=21)|ICD_10_1.CODE==26|
                                                                                         ICD_10_1.CODE==28|ICD_10_1.CODE==29|ICD_10_1.CODE==31|
                                                                                         ICD_10_1.CODE==32|ICD_10_1.CODE==35|ICD_10_1.CODE==36)))]<-1 #Other


## Neoplasms of uncertain behaviour ##
mort_2019$NCI.UNCB<-NULL; mort_2019$NCI.UNCB[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=37&ICD_10_1.CODE<=48)))]<-1

## Diseases of the blood and blood-forming organs and certain disorders involving the immune mechanism ##
mort_2019$SAN.ADFE<-NULL; mort_2019$SAN.ADFE[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==50)))]<-1 #Iron deficiency anemia
mort_2019$SAN.AOTR<-NULL; mort_2019$SAN.AOTR[with(mort_2019, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=51&ICD_10_1.CODE<=62)|ICD_10_1.CODE==64)))]<-1 #Other anemias
mort_2019$SAN.INMU<-NULL; mort_2019$SAN.INMU[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=89)))]<-1 #Immunity disorders
mort_2019$SAN.OTRA<-NULL; mort_2019$SAN.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=65&ICD_10_1.CODE<=76)))]<-1 #Other

## Endocrine and metabolic diseases ##
mort_2019$END.DEYO<-NULL; mort_2019$END.DEYO[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)))]<-1 #Iodine deficiency thyroid disorders
mort_2019$END.TTOX<-NULL; mort_2019$END.TTOX[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==5)))]<-1 #Thyrotoxicosis
mort_2019$END.TOTR<-NULL; mort_2019$END.TOTR[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==3|ICD_10_1.CODE==4|ICD_10_1.CODE==6|
                                                                                         ICD_10_1.CODE==7) ))]<-1 #Other thyroid disorders
mort_2019$END.DIAB<-NULL; mort_2019$END.DIAB[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=14)))]<-1 #Type 2 diabetes mellitus
mort_2019$END.LIPO<-NULL; mort_2019$END.LIPO[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==78)))]<-1 #Metabolism disorders and dyslipidemia
mort_2019$END.OBES<-NULL; mort_2019$END.OBES[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==66)))]<-1 #Obesity
mort_2019$END.DEPL<-NULL; mort_2019$END.DEPL[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==86)))]<-1 #Volume depletion
mort_2019$END.SQHA<-NULL; mort_2019$END.SQHA[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==68)))]<-1 #Sequelae of hyperalimentation
mort_2019$END.OTRA<-NULL; mort_2019$END.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="E" & ((ICD_10_1.CODE>=15&ICD_10_1.CODE<=34)|ICD_10_1.CODE==65|
                                                                                         ICD_10_1.CODE==67|(ICD_10_1.CODE>=70&ICD_10_1.CODE<=77)|
                                                                                         (ICD_10_1.CODE>=79&ICD_10_1.CODE<=85)|
                                                                                         (ICD_10_1.CODE>=87&ICD_10_1.CODE<=88))))]<-1 #Other


## Malnutrition and other nutritional deficiencies ##
mort_2019$NUT.KWAS<-NULL; mort_2019$NUT.KWAS[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==40|ICD_10_1.CODE==42) ))]<-1 #Kwashiorkor
mort_2019$NUT.MARA<-NULL; mort_2019$NUT.MARA[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==41) ))]<-1 #Nutritional marasmus
mort_2019$NUT.PROT<-NULL; mort_2019$NUT.PROT[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=43&ICD_10_1.CODE<=46)))]<-1 #Other protein-calorie malnutrition
mort_2019$NUT.VITA<-NULL; mort_2019$NUT.VITA[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==50) ))]<-1 #Vitamin A deficiency
mort_2019$NUT.VITO<-NULL; mort_2019$NUT.VITO[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=51&ICD_10_1.CODE<=56)))]<-1 #Other vitamin deficiencies
mort_2019$NUT.SECD<-NULL; mort_2019$NUT.SECD[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==64) ))]<-1 #Sequelae of malnutrition
mort_2019$NUT.OTRA<-NULL; mort_2019$NUT.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=63)))]<-1 #Other nutritional deficiencies


## Mental, Behavioral and Neurodevelopmental disorders ##
mort_2019$MEN.DEME<-NULL; mort_2019$MEN.DEME[with(mort_2019, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE==1|ICD_10_1.CODE==3)))]<-1 #Dementia
mort_2019$MEN.SDAL<-NULL; mort_2019$MEN.SDAL[with(mort_2019, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==10 & ICD_10_1.SUB==2))]<-1 #Alcohol dependence syndrome
mort_2019$MEN.OTAL<-NULL; mort_2019$MEN.OTAL[with(mort_2019, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==10 & ICD_10_1.SUB!=2))]<-1 #Other alcohol related disorders
mort_2019$MEN.TMSP<-NULL; mort_2019$MEN.TMSP[with(mort_2019, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=11&ICD_10_1.CODE<=19)))]<-1 #Mental and behavioral disorders due to other psychoactive substances use
mort_2019$MEN.ESQU<-NULL; mort_2019$MEN.ESQU[with(mort_2019, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=29)))]<-1 #Schizophrenia, schizotypal, delusional, and other non-mood psychotic disorders
mort_2019$MEN.HUMO<-NULL; mort_2019$MEN.HUMO[with(mort_2019, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=39)))]<-1 #Mood [affective] disorders
mort_2019$MEN.ESTR<-NULL; mort_2019$MEN.ESTR[with(mort_2019, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=48)))]<-1 #Anxiety, dissociative, stress-related, somatoform and other nonpsychotic mental disorders
mort_2019$MEN.FISI<-NULL; mort_2019$MEN.FISI[with(mort_2019, (ICD_10_1.CHAPTER=="F" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=59)&
                                                                                         (ICD_10_1.CODE!=53) )))]<-1 #Behavioral syndromes associated with physiological disturbances and physical factors
mort_2019$MEN.RETR<-NULL; mort_2019$MEN.RETR[with(mort_2019, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=70&ICD_10_1.CODE<=79)))]<-1 #Intellectual disabilities
mort_2019$MEN.OTRO<-NULL; mort_2019$MEN.OTRO[with(mort_2019, (ICD_10_1.CHAPTER=="F" & ((ICD_10_1.CODE>=4&ICD_10_1.CODE<=9)|(ICD_10_1.CODE>=60&ICD_10_1.CODE<=69)|
                                                                                         (ICD_10_1.CODE>=80&ICD_10_1.CODE<=99))))]<-1 #Other mental and behavioral disorders



## Diseases of the nervous system ##
mort_2019$NER.MENI<-NULL; mort_2019$NER.MENI[with(mort_2019, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==0|ICD_10_1.CODE==3)))]<-1 #Meningitis
mort_2019$NER.ISNC<-NULL; mort_2019$NER.ISNC[with(mort_2019, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=4&ICD_10_1.CODE<=9)))]<-1 #Other inflammatory diseases of the central nervous system
mort_2019$NER.PARK<-NULL; mort_2019$NER.PARK[with(mort_2019, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==20)))]<-1 #Parkinson's disease
mort_2019$NER.ALZH<-NULL; mort_2019$NER.ALZH[with(mort_2019, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==30)))]<-1 #Alzheimer's disease
mort_2019$NER.ESCM<-NULL; mort_2019$NER.ESCM[with(mort_2019, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==35)))]<-1 #Multiple sclerosis
mort_2019$NER.PALS<-NULL; mort_2019$NER.PALS[with(mort_2019, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=83)))]<-1 #Cerebral palsy and other paralytic syndromes
mort_2019$NER.EPIL<-NULL; mort_2019$NER.EPIL[with(mort_2019, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=41)))]<-1 #Epilepsy and recurrent seizures
mort_2019$NER.MIGR<-NULL; mort_2019$NER.MIGR[with(mort_2019, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=43&ICD_10_1.CODE<=44)))]<-1 #Migraine and other headache syndromes
mort_2019$NER.IQCT<-NULL; mort_2019$NER.IQCT[with(mort_2019, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==45)))]<-1 #Transient cerebral ischemic attacks and related syndromes
mort_2019$NER.SNPE<-NULL; mort_2019$NER.SNPE[with(mort_2019, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=59)))]<-1 #Nerve, nerve root and plexus disorders
mort_2019$NER.OTRA<-NULL; mort_2019$NER.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="G" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=12)|(ICD_10_1.CODE>=21&ICD_10_1.CODE<=25)|
                                                                                         (ICD_10_1.CODE==31)|(ICD_10_1.CODE==36)|(ICD_10_1.CODE==37)|(ICD_10_1.CODE==47)|
                                                                                         (ICD_10_1.CODE>=60&ICD_10_1.CODE<=62)|(ICD_10_1.CODE>=64&ICD_10_1.CODE<=72)|
                                                                                         (ICD_10_1.CODE>=90&ICD_10_1.CODE<=93)|(ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other



## Diseases of the eye and adnexa ##
mort_2019$EYE.PARP<-NULL; mort_2019$EYE.PARP[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Eyelid inflammation
mort_2019$EYE.ESCL<-NULL; mort_2019$EYE.ESCL[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=15&ICD_10_1.CODE<=19)))]<-1 #Disorders of sclera and cornea
mort_2019$EYE.GLAU<-NULL; mort_2019$EYE.GLAU[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==40)))]<-1 #Glaucoma
mort_2019$EYE.CATA<-NULL; mort_2019$EYE.CATA[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=25&ICD_10_1.CODE<=26)))]<-1 #Cataracts
mort_2019$EYE.CRIS<-NULL; mort_2019$EYE.CRIS[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==27)))]<-1 #Other disorders of lens
mort_2019$EYE.RETI<-NULL; mort_2019$EYE.RETI[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==33)))]<-1 #Retinal detachments and breaks
mort_2019$EYE.CEGU<-NULL; mort_2019$EYE.CEGU[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==54)))]<-1 #Blindness and low vision
mort_2019$EYE.CONJ<-NULL; mort_2019$EYE.CONJ[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==10)))]<-1 #Conjunctivitis
mort_2019$EYE.OTCO<-NULL; mort_2019$EYE.OTCO[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==11)))]<-1 #Other disorders of conjunctiva
mort_2019$EYE.LAGR<-NULL; mort_2019$EYE.LAGR[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==4)))]<-1 #Disorders of lacrimal system
mort_2019$EYE.ESTR<-NULL; mort_2019$EYE.ESTR[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=49&ICD_10_1.CODE<=50)))]<-1 #Strabismus
mort_2019$EYE.BINO<-NULL; mort_2019$EYE.BINO[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==51)))]<-1 #Other disorders of binocular movement
mort_2019$EYE.REFR<-NULL; mort_2019$EYE.REFR[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==52)))]<-1 #Disorders of refraction and accommodation
mort_2019$EYE.OTRA<-NULL; mort_2019$EYE.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE==2)|(ICD_10_1.CODE==5)|(ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)|
                                                                                         (ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)|(ICD_10_1.CODE>=34&ICD_10_1.CODE<=35)|
                                                                                         (ICD_10_1.CODE>=43&ICD_10_1.CODE<=44)|(ICD_10_1.CODE>=46&ICD_10_1.CODE<=47)|
                                                                                         (ICD_10_1.CODE==53)|(ICD_10_1.CODE==59)|
                                                                                         (ICD_10_1.CODE>=55&ICD_10_1.CODE<=57))))]<-1 #Other

## Diseases of the ear and mastoid process ##
mort_2019$EAR.OMTM<-NULL; mort_2019$EAR.OMTM[with(mort_2019, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE==65)|(ICD_10_1.CODE==66)| #Otitis media, disorders of Eustachian tube and mastoiditis
                                                                                         (ICD_10_1.CODE>=68&ICD_10_1.CODE<=70))))]<-1
mort_2019$EAR.OTOM<-NULL; mort_2019$EAR.OTOM[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=71&ICD_10_1.CODE<=74)))]<-1 #Other middle ear disorders
mort_2019$EAR.SORD<-NULL; mort_2019$EAR.SORD[with(mort_2019, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=91)))]<-1 #Hearing loss
mort_2019$EAR.OTRA<-NULL; mort_2019$EAR.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE>=60&ICD_10_1.CODE<=61)|(ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)|
                                                                                         (ICD_10_1.CODE>=92&ICD_10_1.CODE<=93)|(ICD_10_1.CODE==83)|(ICD_10_1.CODE==95))))]<-1 #Other


##  Diseases of the circulatory system 1: acute rheumatic fever and chronic rheumatic heart diseases ##
mort_2019$SC1.FIRE<-NULL; mort_2019$SC1.FIRE[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)))]<-1 #Acute rheumatic fever
mort_2019$SC1.CRHD<-NULL; mort_2019$SC1.CRHD[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=5&ICD_10_1.CODE<=9)))]<-1 #Chronic rheumatic heart diseases


## Diseases of the circulatory system 2: hypertensive diseases ##
mort_2019$SC2.ECHI<-NULL; mort_2019$SC2.ECHI[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==11|ICD_10_1.CODE==13)))]<-1 #Hypertensive heart disease
mort_2019$SC2.HTES<-NULL; mort_2019$SC2.HTES[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==10)))]<-1 #Essential (primary) hypertension
mort_2019$SC2.OTRA<-NULL; mort_2019$SC2.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==12)))]<-1 #Other


## Diseases of the circulatory system 3: ischemic heart diseases ##
mort_2019$SC3.IAMC<-NULL; mort_2019$SC3.IAMC[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==21|ICD_10_1.CODE==22)))]<-1 #Acute myocardial infarction
mort_2019$SC3.OTRA<-NULL; mort_2019$SC3.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=23&ICD_10_1.CODE<=25)|
                                                                                         ICD_10_1.CODE==20)))]<-1 #Other

## Diseases of the circulatory system 4: diseases of pulmonary circulation and other heart diseases ##
mort_2019$SC4.EMBP<-NULL; mort_2019$SC4.EMBP[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==26)))]<-1 #Pulmonary embolism
mort_2019$SC4.CARR<-NULL; mort_2019$SC4.CARR[with(mort_2019, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=45)| #Conduction disorders and arrhythmia
                                                                                         (ICD_10_1.CODE>=47&ICD_10_1.CODE<=49))))]<-1
mort_2019$SC4.PARO<-NULL; mort_2019$SC4.PARO[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==46)))]<-1 #Cardiac arrest
mort_2019$SC4.HEFA<-NULL; mort_2019$SC4.HEFA[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==50)))]<-1 #Heart failure
mort_2019$SC4.OTRA<-NULL; mort_2019$SC4.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=27&ICD_10_1.CODE<=31)|(ICD_10_1.CODE>=33&ICD_10_1.CODE<=38)|
                                                                                         ICD_10_1.CODE==40|ICD_10_1.CODE==42|ICD_10_1.CODE==51)))]<-1  #Other


## Diseases of the circulatory system 5: cerebrovascular diseases ##
mort_2019$SC5.HEMS<-NULL; mort_2019$SC5.HEMS[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==60)))]<-1 #Subarachnoid hemorrhage
mort_2019$SC5.HEMI<-NULL; mort_2019$SC5.HEMI[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=61&ICD_10_1.CODE<=62)))]<-1 #Intracerebral and other intracranial hemorrhage
mort_2019$SC5.ISQC<-NULL; mort_2019$SC5.ISQC[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==63)))]<-1 #Cerebral infarction
mort_2019$SC5.EVCN<-NULL; mort_2019$SC5.EVCN[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==64)))]<-1 #Unspecified (hemorrhagic vs isquemic)
mort_2019$SC5.ATSC<-NULL; mort_2019$SC5.ATSC[with(mort_2019, (ICD_10_1.CHAPTER=="I" & ICD_10_1.CODE==67 & ICD_10_1.SUB==2))]<-1 #Cerebral atherosclerosis
mort_2019$SC5.SEQC<-NULL; mort_2019$SC5.SEQC[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==69)))]<-1 #Sequelae of cerebrovascular disease
mort_2019$SC5.OTRA<-NULL; mort_2019$SC5.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==65|ICD_10_1.CODE==66| #Other
                                                                                         (ICD_10_1.CODE==67&ICD_10_1.SUB!=2)) ))]<-1


## Diseases of the circulatory system 6: other diseases of the circulatory system ##
mort_2019$SC6.ATER<-NULL; mort_2019$SC6.ATER[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==70)))]<-1 #Atherosclerosis
mort_2019$SC6.OEVP<-NULL; mort_2019$SC6.OEVP[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==73)))]<-1 #Other peripheral vascular diseases
mort_2019$SC6.ETAR<-NULL; mort_2019$SC6.ETAR[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==74)))]<-1 #Arterial embolism and thrombosis
mort_2019$SC6.OTAR<-NULL; mort_2019$SC6.OTAR[with(mort_2019, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=71&ICD_10_1.CODE<=72)| #Other diseases of arteries, arterioles and capillaries
                                                                                         (ICD_10_1.CODE>=77&ICD_10_1.CODE<=78))))]<-1
mort_2019$SC6.ETVE<-NULL; mort_2019$SC6.ETVE[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=82)))]<-1 #Phlebitis, trombophlebitis, other venous embolism and thrombosis
mort_2019$SC6.VARI<-NULL; mort_2019$SC6.VARI[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==83)))]<-1 #Varicose veins of lower extremities
mort_2019$SC6.HMRR<-NULL; mort_2019$SC6.HMRR[with(mort_2019, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==84)))]<-1 #Hemorrhoids
mort_2019$SC6.OTRA<-NULL; mort_2019$SC6.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=85&ICD_10_1.CODE<=97)| #Other
                                                                                         ICD_10_1.CODE==99)))]<-1


## Respiratory tract diseases 1: acute upper respiratory infections and other diseases of upper respiratory tract ##
mort_2019$ER1.FAAG<-NULL; mort_2019$ER1.FAAG[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==2)))]<-1 #Acute pharyngitis
mort_2019$ER1.TOAG<-NULL; mort_2019$ER1.TOAG[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==3)))]<-1 #Acute tonsillitis
mort_2019$ER1.LTAG<-NULL; mort_2019$ER1.LTAG[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==4)))]<-1 #Acute laryngitis and tracheitis
mort_2019$ER1.OTAG<-NULL; mort_2019$ER1.OTAG[with(mort_2019, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)| #Other acute upper respiratory infections
                                                                                         (ICD_10_1.CODE>=5&ICD_10_1.CODE<=6))))]<-1
mort_2019$ER1.PNSD<-NULL; mort_2019$ER1.PNSD[with(mort_2019, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE==33)| #Nasal polyp and deviated nasal septum
                                                                                         (ICD_10_1.CODE==34&ICD_10_1.SUB==2))))]<-1 
mort_2019$ER1.RNPC<-NULL; mort_2019$ER1.RNPC[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)))]<-1 #Chronic rhinitis, nasopharyngitis and pharyngitis
mort_2019$ER1.SINC<-NULL; mort_2019$ER1.SINC[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==32)))]<-1 #Chronic sinusitis
mort_2019$ER1.TADC<-NULL; mort_2019$ER1.TADC[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==35)))]<-1 #Chronic diseases of tonsils and adenoids
mort_2019$ER1.ONSN<-NULL; mort_2019$ER1.ONSN[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==34&(ICD_10_1.SUB!=2&ICD_10_1.SUB!=9))))]<-1 #Other disorders of nose and nasal sinuses
mort_2019$ER1.OTRA<-NULL; mort_2019$ER1.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=36&ICD_10_1.CODE<=39)))]<-1 #Other


## Respiratory tract diseases 2: other respiratory tract diseases ##
mort_2019$ER2.BRAG<-NULL; mort_2019$ER2.BRAG[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Acute bronchitis and bronchiolitis
mort_2019$ER2.NEUM<-NULL; mort_2019$ER2.NEUM[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=12&ICD_10_1.CODE<=18)))]<-1 #Pneumonia
mort_2019$ER2.INFL<-NULL; mort_2019$ER2.INFL[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=9&ICD_10_1.CODE<=11)))]<-1 #Influenza
mort_2019$ER2.BCNE<-NULL; mort_2019$ER2.BCNE[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=43)))]<-1 #Chronic and unspecified bronchitis, emphysema
mort_2019$ER2.ASMA<-NULL; mort_2019$ER2.ASMA[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=45&ICD_10_1.CODE<=46)))]<-1 #Asthma
mort_2019$ER2.BREC<-NULL; mort_2019$ER2.BREC[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==47)))]<-1 #Bronchiectasis
mort_2019$ER2.EPOC<-NULL; mort_2019$ER2.EPOC[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==44)))]<-1 #Chronic obstructive pulmonary disease
mort_2019$ER2.NMCS<-NULL; mort_2019$ER2.NMCS[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=65)))]<-1 #Pneumoconiosis
mort_2019$ER2.OTAE<-NULL; mort_2019$ER2.OTAE[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=66&ICD_10_1.CODE<=70)))]<-1 #Other pulmonary diseases due to external agents
mort_2019$ER2.PLEU<-NULL; mort_2019$ER2.PLEU[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=94)))]<-1 #Pleural conditions
mort_2019$ER2.IRIN<-NULL; mort_2019$ER2.IRIN[with(mort_2019, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==22)))]<-1 #Unspecified acute lower respiratory infection
mort_2019$ER2.OTRA<-NULL; mort_2019$ER2.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=86)|
                                                                                         (ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other


## Diseases of the digestive system 1: oral cavity and salivary glands ##
mort_2019$SD1.CARI<-NULL; mort_2019$SD1.CARI[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==2)))]<-1 #Dental caries
mort_2019$SD1.OTDI<-NULL; mort_2019$SD1.OTDI[with(mort_2019, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)| #Other disorders of teeth and supporting structures
                                                                                         (ICD_10_1.CODE>=3&ICD_10_1.CODE<=8))))]<-1
mort_2019$SD1.OTJA<-NULL; mort_2019$SD1.OTJA[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==10)))]<-1 #Other diseases of jaw
mort_2019$SD1.OTRA<-NULL; mort_2019$SD1.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=11&ICD_10_1.CODE<=14)|ICD_10_1.CODE==9)))]<-1 #Other


## Diseases of the digestive system 2: esophagus, stomach, intestines, hernia ##
mort_2019$SD2.ESOF<-NULL; mort_2019$SD2.ESOF[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=22)))]<-1 #Diseases of esophagus
mort_2019$SD2.GDIS<-NULL; mort_2019$SD2.GDIS[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==29)))]<-1 #Gastritis and duodenitis
mort_2019$SD2.GDUL<-NULL; mort_2019$SD2.GDUL[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=25&ICD_10_1.CODE<=27)))]<-1 #Gastric and duodenal ulcer
mort_2019$SD2.OTGD<-NULL; mort_2019$SD2.OTGD[with(mort_2019, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)|ICD_10_1.CODE==28)))]<-1 #Other diseases of stomach and duodenum
mort_2019$SD2.APEN<-NULL; mort_2019$SD2.APEN[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=38)))]<-1 #Diseases of appendix
mort_2019$SD2.INHE<-NULL; mort_2019$SD2.INHE[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==40)))]<-1 #Inguinal hernia
mort_2019$SD2.OTHE<-NULL; mort_2019$SD2.OTHE[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=41&ICD_10_1.CODE<=46)))]<-1 #Other hernias
mort_2019$SD2.CRCU<-NULL; mort_2019$SD2.CRCU[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=51)))]<-1 #Crohn's disease and ulcerative colitis
mort_2019$SD2.PIIO<-NULL; mort_2019$SD2.PIIO[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==56)))]<-1 #Paralytic ileus and intestinal obstruction without hernia
mort_2019$SD2.EDDI<-NULL; mort_2019$SD2.EDDI[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==57)))]<-1 #Diverticular disease of intestine
mort_2019$SD2.SIIO<-NULL; mort_2019$SD2.SIIO[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=59)))]<-1 #Irritable bowel syndrome and other functional intestinal disorders


## Diseases of the digestive system 3: liver and other parts of digestive system ##
mort_2019$SD3.ALLD<-NULL; mort_2019$SD3.ALLD[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==70)))]<-1 #Alcoholic liver disease
mort_2019$SD3.OTLI<-NULL; mort_2019$SD3.OTLI[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=71&ICD_10_1.CODE<=76)))]<-1 #Other diseases of liver
mort_2019$SD3.COLE<-NULL; mort_2019$SD3.COLE[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)))]<-1 #Cholelithiasis and cholecystitis
mort_2019$SD3.OTIP<-NULL; mort_2019$SD3.OTIP[with(mort_2019, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=52&ICD_10_1.CODE<=55)|
                                                                                         ICD_10_1.CODE>=60&ICD_10_1.CODE<=66)))]<-1 #Other diseases of intestines and peritoneum
mort_2019$SD3.PANC<-NULL; mort_2019$SD3.PANC[with(mort_2019, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Acute pancreatitis and other diseases of pancreas
mort_2019$SD3.OTRA<-NULL; mort_2019$SD3.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=82&ICD_10_1.CODE<=83)|
                                                                                         ICD_10_1.CODE>=87&ICD_10_1.CODE<=93)))]<-1 #Other diseases of digestive system



## Diseases of the skin and subcutaneous tissue ##
mort_2019$PTS.IPTS<-NULL; mort_2019$PTS.IPTS[with(mort_2019, (ICD_10_1.CHAPTER=="L" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=8)))]<-1 #Infections of the skin and subcutaneous tissue
mort_2019$PTS.DEEC<-NULL; mort_2019$PTS.DEEC[with(mort_2019, (ICD_10_1.CHAPTER=="L" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=30)))]<-1 #Dermatitis and eczema
mort_2019$PTS.OTRA<-NULL; mort_2019$PTS.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="L" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=13)|(ICD_10_1.CODE>=40&ICD_10_1.CODE<=44)|
                                                                                         (ICD_10_1.CODE>=50&ICD_10_1.CODE<=53)|(ICD_10_1.CODE>=55&ICD_10_1.CODE<=60)|
                                                                                         (ICD_10_1.CODE>=63&ICD_10_1.CODE<=85)|(ICD_10_1.CODE>=87&ICD_10_1.CODE<=98))))]<-1 #Other


## Diseases of the musculoskeletal system and connective tissue ##
mort_2019$MOC.PAIN<-NULL; mort_2019$MOC.PAIN[with(mort_2019, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=5&ICD_10_1.CODE<=6)|(ICD_10_1.CODE==8)|
                                                                                         (ICD_10_1.CODE>=10&ICD_10_1.CODE<=13))))]<-1 #Inflammatory polyarthropathies
mort_2019$MOC.OSAR<-NULL; mort_2019$MOC.OSAR[with(mort_2019, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=15&ICD_10_1.CODE<=19)))]<-1 #Osteoarthritis
mort_2019$MOC.ADOL<-NULL; mort_2019$MOC.ADOL[with(mort_2019, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Acquired deformities of limbs
mort_2019$MOC.OTAR<-NULL; mort_2019$MOC.OTAR[with(mort_2019, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)| 
                                                                                         (ICD_10_1.CODE>=22&ICD_10_1.CODE<=25))))]<-1 #Other joint disorders
mort_2019$MOC.SCTD<-NULL; mort_2019$MOC.SCTD[with(mort_2019, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=35)))]<-1 #Systemic connective tissue disorders
mort_2019$MOC.IVDD<-NULL; mort_2019$MOC.IVDD[with(mort_2019, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=51)))]<-1 #Intervertebral disc disorders
mort_2019$MOC.OTDO<-NULL; mort_2019$MOC.OTDO[with(mort_2019, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=40&ICD_10_1.CODE<=48)| 
                                                                                         (ICD_10_1.CODE>=53&ICD_10_1.CODE<=54))))]<-1 #Other dorsopathies
mort_2019$MOC.SOFT<-NULL; mort_2019$MOC.SOFT[with(mort_2019, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=60&ICD_10_1.CODE<=62)|(ICD_10_1.CODE>=65&ICD_10_1.CODE<=67)|
                                                                                         (ICD_10_1.CODE>=70&ICD_10_1.CODE<=72)|(ICD_10_1.CODE>=75&ICD_10_1.CODE<=79))))]<-1 #Soft tissue disorders
mort_2019$MOC.BONE<-NULL; mort_2019$MOC.BONE[with(mort_2019, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)|(ICD_10_1.CODE==83&ICD_10_1.SUB!=0)|
                                                                                         (ICD_10_1.CODE>=84&ICD_10_1.CODE<=85))))]<-1 #Disorders of bone density and structure
mort_2019$MOC.OMIE<-NULL; mort_2019$MOC.OMIE[with(mort_2019, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE==86)))]<-1 #Osteomyelitis
mort_2019$MOC.OTRA<-NULL; mort_2019$MOC.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)|
                                                                                         (ICD_10_1.CODE>=91&ICD_10_1.CODE<=99))))]<-1 #Other



## Diseases of the genitourinary system 1: urinary system ##
mort_2019$GU1.NFRI<-NULL; mort_2019$GU1.NFRI[with(mort_2019, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Acute and rapidly progressive nephritic syndrome
mort_2019$GU1.OTGL<-NULL; mort_2019$GU1.OTGL[with(mort_2019, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=2&ICD_10_1.CODE<=8)))]<-1 #Other glomerular diseases
mort_2019$GU1.ACKF<-NULL; mort_2019$GU1.ACKF[with(mort_2019, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=17&ICD_10_1.CODE<=19)))]<-1 #Acute kidney failure and chronic kidney disease
mort_2019$GU1.RTID<-NULL; mort_2019$GU1.RTID[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=12)|ICD_10_1.CODE==15)))]<-1 #Renal tubulo-interstitial diseases
mort_2019$GU1.OTTU<-NULL; mort_2019$GU1.OTTU[with(mort_2019, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=13&ICD_10_1.CODE<=14)))]<-1 #Other renal tubulo-interstitial diseases
mort_2019$GU1.LITO<-NULL; mort_2019$GU1.LITO[with(mort_2019, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Urolithiasis
mort_2019$GU1.RECO<-NULL; mort_2019$GU1.RECO[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==23))]<-1 #Unspecified renal colic
mort_2019$GU1.CIST<-NULL; mort_2019$GU1.CIST[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==30))]<-1 #Cystitis
mort_2019$GU1.OTRA<-NULL; mort_2019$GU1.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=25&ICD_10_1.CODE<=29)|(ICD_10_1.CODE>=31&ICD_10_1.CODE<=39))))]<-1 #Other


## Diseases of the genitourinary system 2: male genital organs ##
mort_2019$GU2.HIPR<-NULL; mort_2019$GU2.HIPR[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==40))]<-1 #Benign prostatic hyperplasia
mort_2019$GU2.OTPR<-NULL; mort_2019$GU2.OTPR[with(mort_2019, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=41&ICD_10_1.CODE<=42)))]<-1 #Other disorders of prostate
mort_2019$GU2.HCEC<-NULL; mort_2019$GU2.HCEC[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==43))]<-1 #Hydrocele and spermatocele
mort_2019$GU2.PREP<-NULL; mort_2019$GU2.PREP[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==47))]<-1 #Disorders of prepuce
mort_2019$GU2.MINF<-NULL; mort_2019$GU2.MINF[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==46))]<-1 #Male infertility
mort_2019$GU2.OTRA<-NULL; mort_2019$GU2.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=45)|(ICD_10_1.CODE>=48&ICD_10_1.CODE<=50))))]<-1 #Other



## Diseases of the genitourinary system 3: breast disorders ##
mort_2019$GU3.MAMA<-NULL; mort_2019$GU3.MAMA[with(mort_2019, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=64)))]<-1 #Disorders of breast


## Diseases of the genitourinary system 4: female genital organs ##
mort_2019$GU4.SAOO<-NULL; mort_2019$GU4.SAOO[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==70))]<-1 #Salpingitis and oophoritis
mort_2019$GU4.IDCU<-NULL; mort_2019$GU4.IDCU[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==72))]<-1 #Inflammatory disease of cervix uteri
mort_2019$GU4.OTVV<-NULL; mort_2019$GU4.OTVV[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=75&ICD_10_1.CODE<=76)|ICD_10_1.CODE==71)))]<-1 #Other diseases of uterus, vagina and vulva
mort_2019$GU4.OTPI<-NULL; mort_2019$GU4.OTPI[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==73))]<-1 #Other female pelvic inflammatory diseases
mort_2019$GU4.ENDM<-NULL; mort_2019$GU4.ENDM[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==80))]<-1 #Endometriosis
mort_2019$GU4.FPRO<-NULL; mort_2019$GU4.FPRO[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==81))]<-1 #Female genital prolapse
mort_2019$GU4.NOFB<-NULL; mort_2019$GU4.NOFB[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==83))]<-1 #Noninflammatory disorders of ovary, fallopian tube and broad ligament
mort_2019$GU4.MENS<-NULL; mort_2019$GU4.MENS[with(mort_2019, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=91&ICD_10_1.CODE<=92)))]<-1 #Disorders of menstruation
mort_2019$GU4.MNOP<-NULL; mort_2019$GU4.MNOP[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==95))]<-1 #Menopausal and other perimenopausal disorders
mort_2019$GU4.FINF<-NULL; mort_2019$GU4.FINF[with(mort_2019, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==97))]<-1 #Female infertility
mort_2019$GU4.OTRA<-NULL; mort_2019$GU4.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE==82|(ICD_10_1.CODE>=84&ICD_10_1.CODE<=90)|
                                                                                         (ICD_10_1.CODE>=93&ICD_10_1.CODE<=94)|ICD_10_1.CODE==96|ICD_10_1.CODE==98)))]<-1 #Other


## Obstetrics 1: direct obstetric causes (abortion) ##
mort_2019$OB1.SPON<-NULL; mort_2019$OB1.SPON[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==3))]<-1 #Spontaneous abortion
mort_2019$OB1.INDU<-NULL; mort_2019$OB1.INDU[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==4))]<-1 #Complications following (induced) termination of pregnancy
mort_2019$OB1.OTRA<-NULL; mort_2019$OB1.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)|(ICD_10_1.CODE>=5&ICD_10_1.CODE<=8))))]<-1 #Other abortion


## Obstetrics 2: direct obstetric causes (pregnancy and puerperium, except abortion) ##
mort_2019$OB2.EPHD<-NULL; mort_2019$OB2.EPHD[with(mort_2019, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=16)))]<-1 #Edema, proteinuria and hypertensive disorders in pregnancy, childbirth and the puerperium
mort_2019$OB2.HEMP<-NULL; mort_2019$OB2.HEMP[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=46)|
                                                                                         ICD_10_1.CODE==20)))]<-1 #Hemorrhage in early pregnancy, placenta previa, abruptio placentae, antepartum hemorrhage
mort_2019$OB2.FACD<-NULL; mort_2019$OB2.FACD[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=30&ICD_10_1.CODE<=43)|ICD_10_1.CODE==47|
                                                                                         ICD_10_1.CODE==48)))]<-1 #Maternal care related to the fetus and amniotic cavity and possible delivery problems
mort_2019$OB2.IGUT<-NULL; mort_2019$OB2.IGUT[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==23))]<-1 #Infections of genitourinary tract in pregnancy
mort_2019$OB2.DMIP<-NULL; mort_2019$OB2.DMIP[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==24))]<-1 #Diabetes mellitus in pregnancy
mort_2019$OB2.OBSL<-NULL; mort_2019$OB2.OBSL[with(mort_2019, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=64&ICD_10_1.CODE<=66)))]<-1 #Obstructed labor 
mort_2019$OB2.PPHE<-NULL; mort_2019$OB2.PPHE[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==72))]<-1 #Postpartum hemorrhage
mort_2019$OB2.SOPI<-NULL; mort_2019$OB2.SOPI[with(mort_2019, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Sepsis and other puerperal infections
mort_2019$OB2.PUER<-NULL; mort_2019$OB2.PUER[with(mort_2019, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=87&ICD_10_1.CODE<=92)))]<-1 #Other complications of the puerperium
mort_2019$OB2.OTPL<-NULL; mort_2019$OB2.OTPL[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=21&ICD_10_1.CODE<=22)|(ICD_10_1.CODE>=25&ICD_10_1.CODE<=29)|(ICD_10_1.CODE>=60&ICD_10_1.CODE<=63)|
                                                                                         (ICD_10_1.CODE>=67&ICD_10_1.CODE<=71)|(ICD_10_1.CODE>=73&ICD_10_1.CODE<=75))))]<-1 #Other complications of pregnancy and labor
mort_2019$OB2.OBTE<-NULL; mort_2019$OB2.OBTE[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==34))]<-1 #Obstetrical tetanus
mort_2019$OB2.BEPU<-NULL; mort_2019$OB2.BEPU[with(mort_2019, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==53))]<-1 #Mental and behavioral disorders associated with the puerperium
mort_2019$OB2.OMLC<-NULL; mort_2019$OB2.OMLC[with(mort_2019, (ICD_10_1.CHAPTER=="M" & ICD_10_1.CODE==83 & ICD_10_1.SUB==0))]<-1 #Puerperal osteomalacia
mort_2019$OB2.OTDC<-NULL; mort_2019$OB2.OTDC[with(mort_2019, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=96&ICD_10_1.CODE<=97)))]<-1 #Other direct obstetric causes
mort_2019$OB2.ODUC<-NULL; mort_2019$OB2.ODUC[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==95))]<-1 #Obstetric death of unspecified cause


## Obstetrics 3: delivery ##
mort_2019$OB3.SSDE<-NULL; mort_2019$OB3.SSDE[with(mort_2019, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==80))]<-1 #Single spontaneous delivery
mort_2019$OB3.OTDE<-NULL; mort_2019$OB3.OTDE[with(mort_2019, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=81&ICD_10_1.CODE<=84)))]<-1 #Other delivery


## Obstetrics 4: indirect obstetric causes ##
mort_2019$OB4.INOC<-NULL; mort_2019$OB4.INOC[with(mort_2019, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=98&ICD_10_1.CODE<=99)))]<-1 #Indirect obstetric causes


## Certain conditions originating in the perinatal period ##
mort_2019$NEO.NAMC<-NULL; mort_2019$NEO.NAMC[with(mort_2019, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE==0|ICD_10_1.CODE==4)))]<-1 #Newborn affected by maternal conditions
mort_2019$NEO.NAOC<-NULL; mort_2019$NEO.NAOC[with(mort_2019, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=1&ICD_10_1.CODE<=3)))]<-1 #Newborn affected by obstetric complications
mort_2019$NEO.GMGW<-NULL; mort_2019$NEO.GMGW[with(mort_2019, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE==5|ICD_10_1.CODE==7)))]<-1 #Slow fetal growth, fetal malnutrition, short gestation and low birth weight
mort_2019$NEO.BITR<-NULL; mort_2019$NEO.BITR[with(mort_2019, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=15)))]<-1 #Birth trauma
mort_2019$NEO.HIAS<-NULL; mort_2019$NEO.HIAS[with(mort_2019, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Intrauterine hypoxia and birth asphyxia 
mort_2019$NEO.SDRN<-NULL; mort_2019$NEO.SDRN[with(mort_2019, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=22&ICD_10_1.CODE<=28)))]<-1 #Respiratory distress of newborn and other perinatal respiratory disorders
mort_2019$NEO.INFE<-NULL; mort_2019$NEO.INFE[with(mort_2019, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=37)))]<-1 #Congenital viral, bacterial and parasitic diseases
mort_2019$NEO.OTIN<-NULL; mort_2019$NEO.OTIN[with(mort_2019, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=38&ICD_10_1.CODE<=39)))]<-1 #Other infections specific to the perinatal period
mort_2019$NEO.HDNB<-NULL; mort_2019$NEO.HDNB[with(mort_2019, (ICD_10_1.CHAPTER=="P" & ICD_10_1.CODE==55))]<-1 #Hemolytic disease of newborn
mort_2019$NEO.TENE<-NULL; mort_2019$NEO.TENE[with(mort_2019, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==33))]<-1 #Tetanus neonatorum
mort_2019$NEO.OTRA<-NULL; mort_2019$NEO.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="P" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=54)|(ICD_10_1.CODE>=56&ICD_10_1.CODE<=74)|
                                                                                         (ICD_10_1.CODE>=76&ICD_10_1.CODE<=96)|(ICD_10_1.CODE==8)|(ICD_10_1.CODE==29))))]<-1 #Other


## Congenital malformations, deformations and chromosomal abnormalities ##
mort_2019$CON.ANEN<-NULL; mort_2019$CON.ANEN[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==0))]<-1 #Anencephaly and similar malformations
mort_2019$CON.HIDR<-NULL; mort_2019$CON.HIDR[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==3))]<-1 #Congenital hydrocephalus
mort_2019$CON.SBIF<-NULL; mort_2019$CON.SBIF[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==5))]<-1 #Spina bifida
mort_2019$CON.OTNS<-NULL; mort_2019$CON.OTNS[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=1&ICD_10_1.CODE<=2)|(ICD_10_1.CODE==4)|
                                                                                         (ICD_10_1.CODE>=6&ICD_10_1.CODE<=7))))]<-1 #Other congenital malformations of the nervous system
mort_2019$CON.CIRC<-NULL; mort_2019$CON.CIRC[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=28)))]<-1 #Congenital malformations of the circulatory system
mort_2019$CON.CLCP<-NULL; mort_2019$CON.CLCP[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=37)))]<-1 #Cleft lip and cleft palate
mort_2019$CON.CINT<-NULL; mort_2019$CON.CINT[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==41))]<-1 #Congenital absence, atresia and stenosis of small intestine
mort_2019$CON.OTDS<-NULL; mort_2019$CON.OTDS[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=38&ICD_10_1.CODE<=40)|
                                                                                         (ICD_10_1.CODE>=42&ICD_10_1.CODE<=45))))]<-1 #Other congenital malformations of the digestive system 
mort_2019$CON.TEST<-NULL; mort_2019$CON.TEST[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==53))]<-1 #Undescended and ectopic testicle
mort_2019$CON.OTGU<-NULL; mort_2019$CON.OTGU[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=52)|
                                                                                         (ICD_10_1.CODE>=54&ICD_10_1.CODE<=64))))]<-1 #Other congenital malformations of genitourinary system
mort_2019$CON.DHIP<-NULL; mort_2019$CON.DHIP[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==65))]<-1 #Congenital deformities of hip
mort_2019$CON.FEET<-NULL; mort_2019$CON.FEET[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==66))]<-1 #Congenital deformities of feet
mort_2019$CON.OTMS<-NULL; mort_2019$CON.OTMS[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=67&ICD_10_1.CODE<=79)))]<-1 #Other congenital malformations and deformations of the musculoskeletal system
mort_2019$CON.OTRA<-NULL; mort_2019$CON.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=18)|(ICD_10_1.CODE>=30&ICD_10_1.CODE<=34)|
                                                                                         (ICD_10_1.CODE>=80&ICD_10_1.CODE<=89))))]<-1 #Other congenital malformations
mort_2019$CON.CROM<-NULL; mort_2019$CON.CROM[with(mort_2019, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=99)))]<-1 #Chromosomal abnormalities, not elsewhere classified


## Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified ##
mort_2019$NCL.FEVU<-NULL; mort_2019$NCL.FEVU[with(mort_2019, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==50))]<-1 #Fever of other and unknown origin
mort_2019$NCL.CAAB<-NULL; mort_2019$NCL.CAAB[with(mort_2019, (ICD_10_1.CHAPTER=="R" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Cardiac abnormalities
mort_2019$NCL.RAOR<-NULL; mort_2019$NCL.RAOR[with(mort_2019, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==33))]<-1 #Retention of urine
mort_2019$NCL.ABPP<-NULL; mort_2019$NCL.ABPP[with(mort_2019, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==10))]<-1 #Abdominal and pelvic pain
mort_2019$NCL.ARPD<-NULL; mort_2019$NCL.ARPD[with(mort_2019, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==54))]<-1 #Age-related physical debility
mort_2019$NCL.SIDS<-NULL; mort_2019$NCL.SIDS[with(mort_2019, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==95))]<-1 #Sudden infant death syndrome
mort_2019$NCL.REAR<-NULL; mort_2019$NCL.REAR[with(mort_2019, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==9 & ICD_10_1.SUB==2))]<-1 #Respiratory arrest
mort_2019$NCL.OTRA<-NULL; mort_2019$NCL.OTRA[with(mort_2019, (ICD_10_1.CHAPTER=="R" & ((ICD_10_1.CODE==9&(ICD_10_1.SUB==0|ICD_10_1.SUB==1|ICD_10_1.SUB==3|ICD_10_1.SUB==8))|
                                                                                         (ICD_10_1.CODE>=2&ICD_10_1.CODE<=8)|(ICD_10_1.CODE>=11&ICD_10_1.CODE<=32)|
                                                                                         (ICD_10_1.CODE>=34&ICD_10_1.CODE<=49)|(ICD_10_1.CODE>=51&ICD_10_1.CODE<=53)|
                                                                                         (ICD_10_1.CODE>=55&ICD_10_1.CODE<=94)|(ICD_10_1.CODE>=96&ICD_10_1.CODE<=99))))]<-1 #Other



## External causes of mortality 1: transport accidents ##
mort_2019$EX1.RAIL<-NULL; mort_2019$EX1.RAIL[with(mort_2019, (ICD_10_1.CHAPTER=="V" & ((ICD_10_1.CODE==5)|(ICD_10_1.CODE==15)|(ICD_10_1.CODE==80&ICD_10_1.SUB==6)|
                                                                                         (ICD_10_1.CODE==81&ICD_10_1.SUB!=1)) ))]<-1 #Railway accidents
mort_2019$EX1.MOTO<-NULL; mort_2019$EX1.MOTO[with(mort_2019, (ICD_10_1.CHAPTER=="V" &  (((ICD_10_1.CODE>=2&ICD_10_1.CODE<=4) & (ICD_10_1.SUB==1|ICD_10_1.SUB==9))|
                                                                                          ((ICD_10_1.CODE==9) & (ICD_10_1.SUB==2|ICD_10_1.SUB==3|ICD_10_1.SUB==9))|
                                                                                          ((ICD_10_1.CODE>=12&ICD_10_1.CODE<=14) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE==19) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=6))|
                                                                                          ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=28) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE>=29&ICD_10_1.CODE<=79) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE==80) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=5))|
                                                                                          ((ICD_10_1.CODE>=81&ICD_10_1.CODE<=82) & (ICD_10_1.SUB==1))|
                                                                                          ((ICD_10_1.CODE>=83&ICD_10_1.CODE<=86) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=3))|
                                                                                          ((ICD_10_1.CODE==87) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=8))|
                                                                                          ((ICD_10_1.CODE==89) & (ICD_10_1.SUB==2|ICD_10_1.SUB==9))) ))]<-1 #Motor vehicle traffic accidents
mort_2019$EX1.LAND<-NULL; mort_2019$EX1.LAND[with(mort_2019, (ICD_10_1.CHAPTER=="V" & ((ICD_10_1.CODE==1)|(ICD_10_1.CODE==6)|(ICD_10_1.CODE==10)|(ICD_10_1.CODE==11)|
                                                                                         (ICD_10_1.CODE>=16&ICD_10_1.CODE<=18)|(ICD_10_1.CODE==19&ICD_10_1.SUB==3)|
                                                                                         ((ICD_10_1.CODE==80) & (ICD_10_1.SUB<=2|ICD_10_1.SUB>=7))|
                                                                                         ((ICD_10_1.CODE==82) & (ICD_10_1.SUB>=2&ICD_10_1.SUB<=9))|
                                                                                         ((ICD_10_1.CODE==89) & (ICD_10_1.SUB==1|ICD_10_1.SUB==3)) )))]<-1 #Other land transport accidents
mort_2019$EX1.WATE<-NULL; mort_2019$EX1.WATE[with(mort_2019, (ICD_10_1.CHAPTER=="V" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=94)))]<-1 #Water transport accidents
mort_2019$EX1.AIRS<-NULL; mort_2019$EX1.AIRS[with(mort_2019, (ICD_10_1.CHAPTER=="V" & (ICD_10_1.CODE>=95&ICD_10_1.CODE<=97)))]<-1 #Air and space transport accidents
mort_2019$EX1.OTRO<-NULL; mort_2019$EX1.OTRO[with(mort_2019, (ICD_10_1.CHAPTER=="V" & (((ICD_10_1.CODE>=2&ICD_10_1.CODE<=4) & (ICD_10_1.SUB==0))|
                                                                                         ((ICD_10_1.CODE==9) & (ICD_10_1.SUB==0|ICD_10_1.SUB==1))|
                                                                                         ((ICD_10_1.CODE>=12&ICD_10_1.CODE<=14) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=2))|
                                                                                         ((ICD_10_1.CODE==19) & (ICD_10_1.SUB<=2|ICD_10_1.SUB>=8))|
                                                                                         ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=28) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=2))|
                                                                                         ((ICD_10_1.CODE>=29&ICD_10_1.CODE<=79) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=3))|
                                                                                         ((ICD_10_1.CODE>=83&ICD_10_1.CODE<=86) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=9))|
                                                                                         (ICD_10_1.CODE==82&ICD_10_1.SUB==0)|(ICD_10_1.CODE==87&ICD_10_1.SUB==9)|
                                                                                         (ICD_10_1.CODE==88)|(ICD_10_1.CODE==89&ICD_10_1.SUB==0)|
                                                                                         (ICD_10_1.CODE>=98&ICD_10_1.CODE<=99))))]<-1 #Other



## External causes of mortality 2: falls ##
mort_2019$EX2.FALL<-NULL; mort_2019$EX2.FALL[with(mort_2019, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=19)))]<-1 #Falls


## External causes of mortality 3: other accidents ##
mort_2019$EX3.ENVI<-NULL; mort_2019$EX3.ENVI[with(mort_2019, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=53&ICD_10_1.CODE<=64)) | 
                                                    (ICD_10_1.CHAPTER=="X" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=39)|(ICD_10_1.CODE>=50&ICD_10_1.CODE<=57))))]<-1 #Accidents caused by environmental factors
mort_2019$EX3.DROW<-NULL; mort_2019$EX3.DROW[with(mort_2019, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=65&ICD_10_1.CODE<=74)))]<-1 #Accidental non-transport drowning and submersion
mort_2019$EX3.FBNO<-NULL; mort_2019$EX3.FBNO[with(mort_2019, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE==44)))]<-1 #Foreign body entering into or through eye or natural orifice
mort_2019$EX3.MACH<-NULL; mort_2019$EX3.MACH[with(mort_2019, (ICD_10_1.CHAPTER=="W" & ((ICD_10_1.CODE>=23&ICD_10_1.CODE<=31)|ICD_10_1.CODE==35|
                                                                                         ICD_10_1.CODE==37|ICD_10_1.CODE==38|ICD_10_1.CODE==41|
                                                                                         (ICD_10_1.CODE>=45&ICD_10_1.CODE<=46))))]<-1 #Accidents caused by machinery or sharp instruments
mort_2019$EX3.FREG<-NULL; mort_2019$EX3.FREG[with(mort_2019, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=32&ICD_10_1.CODE<=34)))]<-1 #Accidents caused by firearms and guns
mort_2019$EX3.SEQA<-NULL; mort_2019$EX3.SEQA[with(mort_2019, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Sequelae of transport accidents and other accidents

mort_2019$EX3.OTRA<-NULL; mort_2019$EX3.OTRA[with(mort_2019, ((ICD_10_1.CHAPTER=="W" & ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=22)|ICD_10_1.CODE==36|ICD_10_1.CODE==39|ICD_10_1.CODE==40|ICD_10_1.CODE==42|
                                                                                          ICD_10_1.CODE==43|(ICD_10_1.CODE>=49&ICD_10_1.CODE<=52)|(ICD_10_1.CODE>=75&ICD_10_1.CODE<=99)))|
                                                                (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=59)) ))]<-1 #Other



## External causes of mortality 4: exposure to smoke, fire and flames ##
mort_2019$EX4.SMFF<-NULL; mort_2019$EX4.SMFF[with(mort_2019, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=9)))]<-1 #Exposure to smoke, fire and flames


## External causes of mortality 5: accidental poisoning and substance exposition ##
mort_2019$EX5.APDM<-NULL; mort_2019$EX5.APDM[with(mort_2019, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=44)))]<-1 #Accidental poisoning by drugs, medicaments and biological substances
mort_2019$EX5.APSL<-NULL; mort_2019$EX5.APSL[with(mort_2019, (ICD_10_1.CHAPTER=="X" & ((ICD_10_1.CODE>=45&ICD_10_1.CODE<=49)&(ICD_10_1.CODE!=47))))]<-1 #Accidental poisoning by other solid or liquid substances
mort_2019$EX5.APGV<-NULL; mort_2019$EX5.APGV[with(mort_2019, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE==47)))]<-1 #Accidental poisoning by other gases and vapours

## External causes of mortality 6: suicide ##
mort_2019$EX6.SUIC<-NULL; mort_2019$EX6.SUIC[with(mort_2019, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=84)))]<-1 #Intentional self-harm


## External causes of mortality 7: homicide ##
mort_2019$EX7.ASSA<-NULL; mort_2019$EX7.ASSA[with(mort_2019, ((ICD_10_1.CHAPTER=="X"&ICD_10_1.CODE>=85)|(ICD_10_1.CHAPTER=="Y"&ICD_10_1.CODE<=9)))]<-1 #Assault


## External causes of mortality 8: other violent causes of death ##
mort_2019$EX8.EOUI<-NULL; mort_2019$EX8.EOUI[with(mort_2019, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=34)))]<-1 #Event of undetermined intent
mort_2019$EX8.OWAR<-NULL; mort_2019$EX8.OWAR[with(mort_2019, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE==36)))]<-1 #Operations of war
mort_2019$EX8.LEGI<-NULL; mort_2019$EX8.LEGI[with(mort_2019, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE==35)))]<-1 #Legal intervention


## External causes of mortality 9: other external causes of mortality ##
mort_2019$EX9.DRUG<-NULL; mort_2019$EX9.DRUG[with(mort_2019, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=59)))]<-1 #Drugs, medicaments and biological substances causing adverse effects in therapeutic use
mort_2019$EX9.MSDV<-NULL; mort_2019$EX9.MSDV[with(mort_2019, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=84)))]<-1 #Misadventures to patients during surgical and medical care
mort_2019$EX9.SQEX<-NULL; mort_2019$EX9.SQEX[with(mort_2019, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)))]<-1 #Sequelae of external causes of morbidity and mortality


# COVID-19 #
mort_2019$COV.CONF<-NULL; mort_2019$COV.CONF[with(mort_2019, (ICD_10_1.CHAPTER=="U" & ICD_10_1.CODE==7 & ICD_10_1.SUB==1))]<-1 #Confirmed COVID-19
mort_2019$COV.SUSP<-NULL; mort_2019$COV.SUSP[with(mort_2019, (ICD_10_1.CHAPTER=="U" & ICD_10_1.CODE==7 & ICD_10_1.SUB==2))]<-1 #Suspected COVID-19


#Merge Datasets

mort_2019<-mort_2019 %>%left_join(dmu.cuadrantes.mun,by="id.mun")%>%
  rename(DMU_MUN=dmu)%>%
  rename(DMU_CAMAS_MUN=dmu_camas)%>%
  left_join(dmu.ent, by="id.ent")%>%
  rename(DMU_CAMAS_ENT=dmu_camas)%>%
  rename(DMU_ENT=dmu)

mort_2019$AVOIDABLE<-NULL
mort_2019$AVOIDABLE[mort_2019$TREA.PREV==1]<-1
mort_2019$AVOIDABLE[mort_2019$TREA.PREV==2]<-1
mort_2019$AVOIDABLE[mort_2019$TREA.PREV==3]<-1
mort_2019$AVOIDABLE[mort_2019$TREA.PREV==4]<-0


mort_2019$CONTEXTO<-NULL
mort_2019$CONTEXTO[mort_2019$CONTEXTO_DEFUNCION %in% c(1,2,3,4,5,6,7,8,9)]<-1
mort_2019$CONTEXTO[mort_2019$CONTEXTO_DEFUNCION %in% c(10,11,12,99)]<-2
mort_2019$CONTEXTO[mort_2019$CONTEXTO_DEFUNCION %in% c(99)]<-3


#### 2018 Dataset####
mort_2018 <- read.csv("Bases/Bases Federales Defuncion 2015-2016/Defunciones_2018.CSV")
mort_2018$id.ent<-paste0(str_pad(mort_2018$ENT_OCURR, 2,pad = "0"))
mort_2018$id.mun<-paste0(str_pad(mort_2018$ENT_OCURR, 2,pad = "0"),str_pad(mort_2018$MUN_OCURR,3, pad="0"))

mort_2018$FECHA_DEFUNCION<-as.Date(paste0(as.numeric(mort_2018$DIA_OCURR),"-",as.numeric(mort_2018$MES_OCURR),"-",as.numeric(mort_2018$ANIO_OCUR)),format = "%d-%m-%Y")
mort_2018<-cbind(mort_2018,data.frame(matrix(unlist(strsplit(as.character(mort_2018$EDAD), split = "(?=[0-9])", perl = TRUE)), nrow=length(strsplit(as.character(mort_2018$EDAD), split = "(?=[0-9])", perl = TRUE)), byrow=TRUE)))

mort_2018$X3[mort_2018$X1=="1"]<-"0"
mort_2018$X3[mort_2018$X1=="2"]<-"0"
mort_2018$X3[mort_2018$X1=="3"]<-"0"

mort_2018$X4[mort_2018$X1=="1"]<-"0"
mort_2018$X4[mort_2018$X1=="2"]<-"0"
mort_2018$X4[mort_2018$X1=="3"]<-"0"


mort_2018$edad<-as.numeric(paste0(str_pad(mort_2018$X2, 1),str_pad(mort_2018$X3, 1),str_pad(mort_2018$X4,1)))
mort_2018$edad[mort_2018$edad==998]<-NA

mort_2018<-mort_2018%>%
  filter(MES_OCURR!=99)%>%
  filter(ANIO_OCUR!=9999)%>%
  dplyr::select(-c("EDAD"))%>%
  dplyr::rename("EDAD"=edad, "SEXO"=SEXO, "ESTADO_DEFUNCION"=ENT_OCURR,"MUNICIPIO"=MUN_OCURR, 
         "CONTEXTO_DEFUNCION"=SITIO_OCUR,"CAUSA_MUERTE_ICD_10_CATEGORIA_1"=CAUSA_DEF)%>%
  mutate(Year=data.table::year(FECHA_DEFUNCION),MES=data.table::month(FECHA_DEFUNCION))%>%
  filter(Year=="2018")%>%
  filter(MES!=99)%>%
  mutate(FECHA_DEFUNCION=as.character(FECHA_DEFUNCION))%>%
  mutate(FECHA_DEFUNCION=as.Date(FECHA_DEFUNCION))%>%
  mutate(Year=data.table::year(FECHA_DEFUNCION),MES=data.table::month(FECHA_DEFUNCION))

mort_2018$ICD_10_1.CHAPTER<-str_extract(strsplit(mort_2018$CAUSA_MUERTE_ICD_10_CATEGORIA_1,NULL), "[A-Z]+" )
mort_2018$ICD_10_1.CODE<-as.numeric(substr(str_extract(strsplit(mort_2018$CAUSA_MUERTE_ICD_10_CATEGORIA_1, split = "(?<=[a-zA-Z])\\s*(?=[0-9])", perl = TRUE),"([[:digit:]]+)"),start=1,stop=2))

#ICD-10 Coding

#Preventable mortality specific causes
mort_2018$INTE.DIS[(mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=09))]<-1
mort_2018$DI.TE.PO[(mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE==35 | mort_2018$ICD_10_1.CODE==36 | mort_2018$ICD_10_1.CODE==80))]<-1
mort_2018$WHO.COUG[(mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE==37))]<-1
mort_2018$MENINGOC[(mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE==39))]<-1
mort_2018$SEPS.STR[(mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE>=40 & mort_2018$ICD_10_1.CODE<=41))]<-1
mort_2018$HAE.INFL[(mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE==49))]<-1
mort_2018$SEX.INFE[(mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE>=50 & mort_2018$ICD_10_1.CODE<=64))]<-1
mort_2018$VARICELL[(mort_2018$ICD_10_1.CHAPTER=="B" & (mort_2018$ICD_10_1.CODE==1))]<-1
mort_2018$MEASLESS[(mort_2018$ICD_10_1.CHAPTER=="B" & (mort_2018$ICD_10_1.CODE==5))]<-1
mort_2018$RUBELLAA[(mort_2018$ICD_10_1.CHAPTER=="B" & (mort_2018$ICD_10_1.CODE==6))]<-1 
mort_2018$VIRA.HEP[(mort_2018$ICD_10_1.CHAPTER=="B" & (mort_2018$ICD_10_1.CODE>=15 & mort_2018$ICD_10_1.CODE<=19))]<-1 
mort_2018$HIV.AIDS[(mort_2018$ICD_10_1.CHAPTER=="B" & (mort_2018$ICD_10_1.CODE>=20 & mort_2018$ICD_10_1.CODE<=24))]<-1 
mort_2018$MALARIAS[(mort_2018$ICD_10_1.CHAPTER=="B" & (mort_2018$ICD_10_1.CODE>=50 & mort_2018$ICD_10_1.CODE<=54))]<-1 
mort_2018$HAEM.MEN[(mort_2018$ICD_10_1.CHAPTER=="G" & (mort_2018$ICD_10_1.CODE==0))]<-1 
mort_2018$TUBERCUL[((mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE>=15 & mort_2018$ICD_10_1.CODE<=19))|
                      (mort_2018$ICD_10_1.CHAPTER=="B" & (mort_2018$ICD_10_1.CODE==90))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==65)))]<-1
mort_2018$UPG.CANC[(mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=16))]<-1
mort_2018$LIV.CANC[(mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==22))]<-1
mort_2018$LUN.CANC[(mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE>=33 & mort_2018$ICD_10_1.CODE<=34))]<-1
mort_2018$MESOTHEL[(mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==45))]<-1
mort_2018$MELANOMA[(mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==43))]<-1
mort_2018$BLA.CANC[(mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==67))]<-1
mort_2018$CER.CANC[(mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==53))]<-1
mort_2018$NUT.ANEM[(mort_2018$ICD_10_1.CHAPTER=="D" & (mort_2018$ICD_10_1.CODE>=50 & mort_2018$ICD_10_1.CODE<=53))]<-1
mort_2018$DIA.MELL[(mort_2018$ICD_10_1.CHAPTER=="E" & (mort_2018$ICD_10_1.CODE>=10 & mort_2018$ICD_10_1.CODE<=14))]<-1
mort_2018$AOR.ANEU[(mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE==71))]<-1
mort_2018$HYP.DISE[((mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE>=10 & mort_2018$ICD_10_1.CODE<=13))|
                      (mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE==15)))]<-1
mort_2018$ISH.HEAR[(mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE>=20 & mort_2018$ICD_10_1.CODE<=25))]<-1
mort_2018$CER.VASC[(mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE>=60 & mort_2018$ICD_10_1.CODE<=69))]<-1
mort_2018$ATH.DISE[(mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE==70 & mort_2018$ICD_10_1.CODE==73))]<-1
mort_2018$INFLUENZ[(mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE>=9 & mort_2018$ICD_10_1.CODE<=11))]<-1
mort_2018$PNE.STRE[(mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE>=13 & mort_2018$ICD_10_1.CODE<=14))]<-1
mort_2018$CHR.RESP[(mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE>=40 & mort_2018$ICD_10_1.CODE<=44))]<-1
mort_2018$LUN.DISE[((mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE>=60 & mort_2018$ICD_10_1.CODE<=64))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==66 & mort_2018$ICD_10_1.CODE<=70))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==82))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==92)))]<-1
mort_2018$TET.NEON[(mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE==33))]<-1
mort_2018$OBS.TETA[(mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE==34))]<-1
mort_2018$CER.CONG[((mort_2018$ICD_10_1.CHAPTER=="Q" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=1))|
                      (mort_2018$ICD_10_1.CHAPTER=="Q" & (mort_2018$ICD_10_1.CODE==5)))]<-1
mort_2018$TRAN.ACC[(mort_2018$ICD_10_1.CHAPTER=="V" & (mort_2018$ICD_10_1.CODE>=1 & mort_2018$ICD_10_1.CODE<=99))]<-1
mort_2018$ACCI.INJ[((mort_2018$ICD_10_1.CHAPTER=="W" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=39))|
                      (mort_2018$ICD_10_1.CHAPTER=="X" & (mort_2018$ICD_10_1.CODE>=49 & mort_2018$ICD_10_1.CODE<=59)))]<-1
mort_2018$INTE.HAR[(mort_2018$ICD_10_1.CHAPTER=="X" & (mort_2018$ICD_10_1.CODE>=66 & mort_2018$ICD_10_1.CODE<=84))]<-1
mort_2018$ASSA.LES[((mort_2018$ICD_10_1.CHAPTER=="X" & (mort_2018$ICD_10_1.CODE>=86 & mort_2018$ICD_10_1.CODE<=99))|
                      (mort_2018$ICD_10_1.CHAPTER=="Y" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=9)))]<-1
mort_2018$ALCH.DIS[((mort_2018$ICD_10_1.CHAPTER=="E" & (mort_2018$ICD_10_1.CODE==24))|
                      (mort_2018$ICD_10_1.CHAPTER=="F" & (mort_2018$ICD_10_1.CODE==10))|
                      (mort_2018$ICD_10_1.CHAPTER=="G" & (mort_2018$ICD_10_1.CODE==31))|
                      (mort_2018$ICD_10_1.CHAPTER=="G" & (mort_2018$ICD_10_1.CODE==62))|
                      (mort_2018$ICD_10_1.CHAPTER=="G" & (mort_2018$ICD_10_1.CODE==72))|
                      (mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE==42))|
                      (mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE==29))|
                      (mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE==70))|
                      (mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE==85))|
                      (mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE==86))|
                      (mort_2018$ICD_10_1.CHAPTER=="R" & (mort_2018$ICD_10_1.CODE==78))|
                      (mort_2018$ICD_10_1.CHAPTER=="X" & (mort_2018$ICD_10_1.CODE==45))|
                      (mort_2018$ICD_10_1.CHAPTER=="X" & (mort_2018$ICD_10_1.CODE==65))|
                      (mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE>=73 & mort_2018$ICD_10_1.CODE<=74))|
                      (mort_2018$ICD_10_1.CHAPTER=="Y" & (mort_2018$ICD_10_1.CODE==15)))]<-1
mort_2018$DRUG.REL[((mort_2018$ICD_10_1.CHAPTER=="F" & (mort_2018$ICD_10_1.CODE>=11 & mort_2018$ICD_10_1.CODE<=16))|
                      (mort_2018$ICD_10_1.CHAPTER=="F" & (mort_2018$ICD_10_1.CODE>=18 & mort_2018$ICD_10_1.CODE<=19))|
                      (mort_2018$ICD_10_1.CHAPTER=="X" & (mort_2018$ICD_10_1.CODE>=40 & mort_2018$ICD_10_1.CODE<=44))|
                      (mort_2018$ICD_10_1.CHAPTER=="X" & (mort_2018$ICD_10_1.CODE==85))|
                      (mort_2018$ICD_10_1.CHAPTER=="Y" & (mort_2018$ICD_10_1.CODE>=10 & mort_2018$ICD_10_1.CODE<=14))|
                      (mort_2018$ICD_10_1.CHAPTER=="X" & (mort_2018$ICD_10_1.CODE>=60 & mort_2018$ICD_10_1.CODE<=64)))]<-1

mort_2018$RESP.FAL[(mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==96))]<-1 #RESPIRATORY FAILLURE
mort_2018$FLUID.DI[(mort_2018$ICD_10_1.CHAPTER=="E" & (mort_2018$ICD_10_1.CODE==87))]<-1 #Other disorders of fluid, electrolyte and acid-base balance
mort_2018$SHOCK.AN[(mort_2018$ICD_10_1.CHAPTER=="R" & (mort_2018$ICD_10_1.CODE==57))]<-1 #Shock, not elsewhere classified

#Preventable mortality final coding

mort_2018$PREVENT<-NULL
mort_2018$PREVENT[((mort_2018$EDAD>=0 & mort_2018$EDAD<=74) & (mort_2018$INTE.DIS==1|
                                                                 mort_2018$DI.TE.PO==1|
                                                                 mort_2018$WHO.COUG==1|
                                                                 mort_2018$MENINGOC==1|
                                                                 mort_2018$SEPS.STR==1|
                                                                 mort_2018$HAE.INFL==1|
                                                                 mort_2018$SEX.INFE==1|
                                                                 mort_2018$VARICELL==1|
                                                                 mort_2018$MEASLESS==1|
                                                                 mort_2018$RUBELLAA==1|
                                                                 mort_2018$VIRA.HEP==1|
                                                                 mort_2018$HIV.AIDS==1|
                                                                 mort_2018$MALARIAS==1|
                                                                 mort_2018$HAEM.MEN==1|
                                                                 mort_2018$TUBERCUL==1|
                                                                 mort_2018$UPG.CANC==1|
                                                                 mort_2018$LIV.CANC==1|
                                                                 mort_2018$LUN.CANC==1|
                                                                 mort_2018$MESOTHEL==1|
                                                                 mort_2018$MELANOMA==1|
                                                                 mort_2018$BLA.CANC==1|
                                                                 mort_2018$CER.CANC==1|
                                                                 mort_2018$NUT.ANEM==1|
                                                                 mort_2018$DIA.MELL==1|
                                                                 mort_2018$AOR.ANEU==1|
                                                                 mort_2018$HYP.DISE==1|
                                                                 mort_2018$ISH.HEAR==1|
                                                                 mort_2018$CER.VASC==1|
                                                                 mort_2018$ATH.DISE==1|
                                                                 mort_2018$INFLUENZ==1|
                                                                 mort_2018$PNE.STRE==1|
                                                                 mort_2018$CHR.RESP==1|
                                                                 mort_2018$LUN.DISE==1|
                                                                 mort_2018$TET.NEON==1|
                                                                 mort_2018$OBS.TETA==1|
                                                                 mort_2018$CER.CONG==1|
                                                                 mort_2018$TRAN.ACC==1|
                                                                 mort_2018$ACCI.INJ==1|
                                                                 mort_2018$INTE.HAR==1|
                                                                 mort_2018$ASSA.LES==1|
                                                                 mort_2018$ALCH.DIS==1|
                                                                 mort_2018$DRUG.REL==1|
                                                                 mort_2018$RESP.FAL==1|
                                                                 mort_2018$FLUID.DI==1|
                                                                 mort_2018$SHOCK.AN==1))]<-1

#Treatable mortality specific causes

mort_2018$TUBERCUL[((mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE>=15 & mort_2018$ICD_10_1.CODE<=19))|
                      (mort_2018$ICD_10_1.CHAPTER=="B" & (mort_2018$ICD_10_1.CODE==90))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==65)))]<-1
mort_2018$FIE.SCAR[((mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE==38)))]<-1
mort_2018$SEPSIS.A[((mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE>=40 & mort_2018$ICD_10_1.CODE<=41)))]<-1
mort_2018$CELLULIS[((mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE==46))|
                      (mort_2018$ICD_10_1.CHAPTER=="L" & (mort_2018$ICD_10_1.CODE==3)))]<-1
mort_2018$LEGIONEL[((mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE==48)))]<-1
mort_2018$STRE.ENT[((mort_2018$ICD_10_1.CHAPTER=="A" & (mort_2018$ICD_10_1.CODE==49)))]<-1
mort_2018$MENINGIS[((mort_2018$ICD_10_1.CHAPTER=="G" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=3)))]<-1
mort_2018$CERV.CAN[((mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==53)))]<-1
mort_2018$COLO.CAN[((mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE>=18 & mort_2018$ICD_10_1.CODE<=21)))]<-1
mort_2018$BREA.CAN[((mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==50)))]<-1
mort_2018$UTER.CAN[((mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE>=54 & mort_2018$ICD_10_1.CODE<=55)))]<-1
mort_2018$TEST.CAN[((mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==62)))]<-1
mort_2018$THYR.CAN[((mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==73)))]<-1
mort_2018$HODG.CAN[((mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==81)))]<-1
mort_2018$LYMP.CAN[((mort_2018$ICD_10_1.CHAPTER=="C" & (mort_2018$ICD_10_1.CODE==91)))]<-1
mort_2018$BENI.CAN[((mort_2018$ICD_10_1.CHAPTER=="D" & (mort_2018$ICD_10_1.CODE>=10 & mort_2018$ICD_10_1.CODE<=36)))]<-1
mort_2018$DIA.MELL[(mort_2018$ICD_10_1.CHAPTER=="E" & (mort_2018$ICD_10_1.CODE>=10 & mort_2018$ICD_10_1.CODE<=14))]<-1
mort_2018$THRO.DIS[(mort_2018$ICD_10_1.CHAPTER=="E" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=7))]<-1
mort_2018$ADRE.DIS[(mort_2018$ICD_10_1.CHAPTER=="E" & (mort_2018$ICD_10_1.CODE>=24 & mort_2018$ICD_10_1.CODE<=27))]<-1
mort_2018$EPIL.DIS[(mort_2018$ICD_10_1.CHAPTER=="G" & (mort_2018$ICD_10_1.CODE>=40 & mort_2018$ICD_10_1.CODE<=41))]<-1
mort_2018$AOR.ANEU[(mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE==71))]<-1
mort_2018$HYP.DISE[((mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE>=10 & mort_2018$ICD_10_1.CODE<=13))|
                      (mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE==15)))]<-1
mort_2018$ISH.HEAR[(mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE>=20 & mort_2018$ICD_10_1.CODE<=25))]<-1
mort_2018$CER.VASC[(mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE>=60 & mort_2018$ICD_10_1.CODE<=69))]<-1
mort_2018$ATH.DISE[(mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE==70 & mort_2018$ICD_10_1.CODE==73))]<-1
mort_2018$RHE.DISE[(mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=9))]<-1
mort_2018$VEN.TROM[((mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE==26))|
                      (mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE==80))| 
                      (mort_2018$ICD_10_1.CHAPTER=="I" & (mort_2018$ICD_10_1.CODE==82)))]<-1
mort_2018$UPP.RESP[((mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=6))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE>=30 & mort_2018$ICD_10_1.CODE<=39)))]<-1
mort_2018$PNEU.UNS[((mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==12))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==15))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==16))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==17))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==18)))]<-1
mort_2018$AC.LOW.R[((mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==20 & mort_2018$ICD_10_1.CODE<=22)))]<-1
mort_2018$ASTH.BRO[((mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==45 & mort_2018$ICD_10_1.CODE<=47)))]<-1
mort_2018$SIRA.RES[((mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==80)))]<-1
mort_2018$PUL.EDEM[((mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==81)))]<-1
mort_2018$ABS.LUNG[((mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==85))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==86)))]<-1
mort_2018$OTH.PLER[((mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==90))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==93))|
                      (mort_2018$ICD_10_1.CHAPTER=="J" & (mort_2018$ICD_10_1.CODE==94)))]<-1
mort_2018$GAS.DUOD[((mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE>=25 & mort_2018$ICD_10_1.CODE<=28)))]<-1
mort_2018$APPENDIC[((mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE>=35 & mort_2018$ICD_10_1.CODE<=38)))]<-1
mort_2018$ABDO.HER[((mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE>=40 & mort_2018$ICD_10_1.CODE<=46)))]<-1
mort_2018$CHOLELIT[((mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE>=80 & mort_2018$ICD_10_1.CODE<=81)))]<-1
mort_2018$OTH.GALB[((mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE>=82 & mort_2018$ICD_10_1.CODE<=83)))]<-1
mort_2018$ACU.PANC[((mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE==85)))]<-1
mort_2018$OTH.PANC[((mort_2018$ICD_10_1.CHAPTER=="K" & (mort_2018$ICD_10_1.CODE==86)))]<-1
mort_2018$NEPH.NEP[((mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=7)))]<-1
mort_2018$OBS.UROP[((mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE==13))|
                      (mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE>=20 & mort_2018$ICD_10_1.CODE<=21))|
                      (mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE==35)))]<-1
mort_2018$REN.FAIL[((mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE>=17 & mort_2018$ICD_10_1.CODE<=19)))]<-1
mort_2018$REN.COLI[((mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE==23)))]<-1
mort_2018$TUB.DISF[((mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE==25)))]<-1
mort_2018$UNF.NEFP[((mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE>=26 & mort_2018$ICD_10_1.CODE<=27)))]<-1
mort_2018$INF.GENU[((mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE==34))|
                      (mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE==70))|
                      (mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE==73))|
                      (mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE==75))|
                      (mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE==76)))]<-1
mort_2018$PROS.HYP[((mort_2018$ICD_10_1.CHAPTER=="N" & (mort_2018$ICD_10_1.CODE==40)))]<-1
mort_2018$PRE.CHIL[((mort_2018$ICD_10_1.CHAPTER=="O" & (mort_2018$ICD_10_1.CODE>=0 & mort_2018$ICD_10_1.CODE<=99)))]<-1
mort_2018$CONG.CVD[((mort_2018$ICD_10_1.CHAPTER=="Q" & (mort_2018$ICD_10_1.CODE>=20 & mort_2018$ICD_10_1.CODE<=28)))]<-1
mort_2018$DRUGS.AE[((mort_2018$ICD_10_1.CHAPTER=="Y" & (mort_2018$ICD_10_1.CODE>=40 & mort_2018$ICD_10_1.CODE<=59)))]<-1
mort_2018$QX.DR.AE[((mort_2018$ICD_10_1.CHAPTER=="Y" & (mort_2018$ICD_10_1.CODE>=60 & mort_2018$ICD_10_1.CODE<=69))|
                      (mort_2018$ICD_10_1.CHAPTER=="Y" & (mort_2018$ICD_10_1.CODE>=83 & mort_2018$ICD_10_1.CODE<=84)))]<-1
mort_2018$MD.DR.AE[((mort_2018$ICD_10_1.CHAPTER=="Y" & (mort_2018$ICD_10_1.CODE>=70 & mort_2018$ICD_10_1.CODE<=82)))]<-1


#Treatable mortality final coding 

mort_2018$TREATAB<-NULL
mort_2018$TREATAB[((mort_2018$EDAD>=0 & mort_2018$EDAD<=74) & (mort_2018$TUBERCUL==1|
                                                                 mort_2018$FIE.SCAR==1|
                                                                 mort_2018$SEPSIS.A==1|
                                                                 mort_2018$CELLULIS==1|
                                                                 mort_2018$LEGIONEL==1|
                                                                 mort_2018$STRE.ENT==1|
                                                                 mort_2018$MENINGIS==1|
                                                                 mort_2018$COLO.CAN==1|
                                                                 mort_2018$CERV.CAN==1|
                                                                 mort_2018$BREA.CAN==1|
                                                                 mort_2018$UTER.CAN==1|
                                                                 mort_2018$TEST.CAN==1|
                                                                 mort_2018$THYR.CAN==1|
                                                                 mort_2018$HODG.CAN==1|
                                                                 mort_2018$LYMP.CAN==1|
                                                                 mort_2018$BENI.CAN==1|
                                                                 mort_2018$DIA.MELL==1|
                                                                 mort_2018$THRO.DIS==1|
                                                                 mort_2018$ADRE.DIS==1|
                                                                 mort_2018$EPIL.DIS==1|
                                                                 mort_2018$AOR.ANEU==1|
                                                                 mort_2018$HYP.DISE==1|
                                                                 mort_2018$ISH.HEAR==1|
                                                                 mort_2018$CER.VASC==1|
                                                                 mort_2018$ATH.DISE==1|
                                                                 mort_2018$RHE.DISE==1|
                                                                 mort_2018$VEN.TROM==1|
                                                                 mort_2018$UPP.RESP==1|
                                                                 mort_2018$PNEU.UNS==1|
                                                                 mort_2018$AC.LOW.R==1|
                                                                 mort_2018$ASTH.BRO==1|
                                                                 mort_2018$SIRA.RES==1|
                                                                 mort_2018$PUL.EDEM==1|
                                                                 mort_2018$ABS.LUNG==1|
                                                                 mort_2018$OTH.PLER==1|
                                                                 mort_2018$GAS.DUOD==1|
                                                                 mort_2018$APPENDIC==1|
                                                                 mort_2018$ABDO.HER==1|
                                                                 mort_2018$CHOLELIT==1|
                                                                 mort_2018$OTH.GALB==1|
                                                                 mort_2018$ACU.PANC==1|
                                                                 mort_2018$OTH.PANC==1|
                                                                 mort_2018$NEPH.NEP==1|
                                                                 mort_2018$OBS.UROP==1|
                                                                 mort_2018$REN.FAIL==1|
                                                                 mort_2018$REN.COLI==1|
                                                                 mort_2018$TUB.DISF==1|
                                                                 mort_2018$UNF.NEFP==1|
                                                                 mort_2018$INF.GENU==1|
                                                                 mort_2018$PROS.HYP==1|
                                                                 mort_2018$PRE.CHIL==1|
                                                                 mort_2018$CONG.CVD==1|
                                                                 mort_2018$DRUGS.AE==1|
                                                                 mort_2018$QX.DR.AE==1|
                                                                 mort_2018$MD.DR.AE==1))]<-1
#Final coding

mort_2018$TREA.PREV<-NULL
mort_2018$TREA.PREV[mort_2018$TREATAB==1 & (is.na(mort_2018$PREVENT) & !is.na(mort_2018$CAUSA_MUERTE_ICD_10_CATEGORIA_1))]<-1
mort_2018$TREA.PREV[mort_2018$PREVENT==1 & (is.na(mort_2018$TREATAB) & !is.na(mort_2018$CAUSA_MUERTE_ICD_10_CATEGORIA_1))]<-2
mort_2018$TREA.PREV[mort_2018$TREATAB==1 & mort_2018$PREVENT==1]<-3
mort_2018$TREA.PREV[(!is.na(mort_2018$CAUSA_MUERTE_ICD_10_CATEGORIA_1)) & (is.na(mort_2018$TREATAB) & is.na(mort_2018$PREVENT))]<-4

#Specific Cause

mort_2018$ICD_10_1.SUB<-as.numeric(substring(mort_2018$CAUSA_MUERTE_ICD_10_CATEGORIA_1,4))

## Intestinal Infectious Diseases ##
mort_2018$EII.COLE<-NULL; mort_2018$EII.COLE[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==0))]<-1 #Cholera
mort_2018$EII.TIPA<-NULL; mort_2018$EII.TIPA[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==1))]<-1 #Typhoid and paratyphoid fever
mort_2018$EII.SHIG<-NULL; mort_2018$EII.SHIG[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==3))]<-1 #Shigellosis
mort_2018$EII.TOXI<-NULL; mort_2018$EII.TOXI[with(mort_2018, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==2|ICD_10_1.CODE==5)))]<-1 #Food poisoning
mort_2018$EII.AMEB<-NULL; mort_2018$EII.AMEB[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==6))]<-1 #Amebiasis
mort_2018$EII.OTRA<-NULL; mort_2018$EII.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==4|ICD_10_1.CODE==7|ICD_10_1.CODE==8)))]<-1 #Other GI infection
mort_2018$EII.PRES<-NULL; mort_2018$EII.PRES[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==9))]<-1 #Presumed GI infection

## Tuberculosis ##
mort_2018$TUB.PULM<-NULL; mort_2018$TUB.PULM[with(mort_2018,(ICD_10_1.CHAPTER=="A" & #Pulmonary TB
                                                               ((ICD_10_1.CODE==15 & (ICD_10_1.SUB<=3|ICD_10_1.SUB==7|ICD_10_1.SUB==9))|
                                                                  (ICD_10_1.CODE==16 & (ICD_10_1.SUB<=2|ICD_10_1.SUB==7|ICD_10_1.SUB==9)) ) ))]<-1 
mort_2018$TUB.RESP<-NULL; mort_2018$TUB.RESP[with(mort_2018,(ICD_10_1.CHAPTER=="A" & #Other respiratory TB
                                                               ((ICD_10_1.CODE==15 & (ICD_10_1.SUB==4|ICD_10_1.SUB==5|ICD_10_1.SUB==6|ICD_10_1.SUB==8))|
                                                                  (ICD_10_1.CODE==16 & (ICD_10_1.SUB==3|ICD_10_1.SUB==4|ICD_10_1.SUB==5|ICD_10_1.SUB==8)))))]<-1 
mort_2018$TUB.NERV<-NULL; mort_2018$TUB.NERV[with(mort_2018, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==17) ))]<-1 #Nervous System TB
mort_2018$TUB.IPGM<-NULL; mort_2018$TUB.IPGM[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==3))]<-1 #Intestinal/peritoneal Tb
mort_2018$TUB.BONE<-NULL; mort_2018$TUB.BONE[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==0))]<-1 #Bone and joint Tb
mort_2018$TUB.URIN<-NULL; mort_2018$TUB.URIN[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==1))]<-1 #Genitourinary Tb
mort_2018$TUB.OTRA<-NULL; mort_2018$TUB.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="A" & #Other Tb
                                                                ((ICD_10_1.CODE==18 & (ICD_10_1.SUB==2|ICD_10_1.SUB>=4))|(ICD_10_1.CODE==19)) )) ]<-1

## Other bacterial diseases ##
mort_2018$BAC.PEST<-NULL; mort_2018$BAC.PEST[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==20))]<-1 #Plague (peste)
mort_2018$BAC.BRUS<-NULL; mort_2018$BAC.BRUS[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==23))]<-1 #Brusellosis
mort_2018$BAC.LEPR<-NULL; mort_2018$BAC.LEPR[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==30))]<-1 #Leprosy
mort_2018$BAC.DIFT<-NULL; mort_2018$BAC.DIFT[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==36))]<-1 #Diphtheria
mort_2018$BAC.PERT<-NULL; mort_2018$BAC.PERT[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==37))]<-1 #Pertussis
mort_2018$BAC.PYOG<-NULL; mort_2018$BAC.PYOG[with(mort_2018, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==38|ICD_10_1.CODE==46)))]<-1 #Scarlet fever, erysipelas
mort_2018$BAC.MENI<-NULL; mort_2018$BAC.MENI[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==39))]<-1 #Meningococcal disease
mort_2018$BAC.TETA<-NULL; mort_2018$BAC.TETA[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==35))]<-1 #Tetanus
mort_2018$BAC.SEPS<-NULL; mort_2018$BAC.SEPS[with(mort_2018, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==40|ICD_10_1.CODE==41) ))]<-1 #Sepsis
mort_2018$BAC.OTRA<-NULL; mort_2018$BAC.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="A" &
                                                                (ICD_10_1.CODE==21|ICD_10_1.CODE==22|(ICD_10_1.CODE>=24&ICD_10_1.CODE<=28)|
                                                                   ICD_10_1.CODE==31|ICD_10_1.CODE==32|(ICD_10_1.CODE>=42&ICD_10_1.CODE<=44)|
                                                                   ICD_10_1.CODE==48|ICD_10_1.CODE==49)))]<-1 #Other

## Sexually transmitted diseases ##
mort_2018$ETS.SIF1<-NULL; mort_2018$ETS.SIF1[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==50))]<-1 #Congenital syphilis
mort_2018$ETS.SIF2<-NULL; mort_2018$ETS.SIF2[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==51))]<-1 #Early syphilis
mort_2018$ETS.SIF3<-NULL; mort_2018$ETS.SIF3[with(mort_2018, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==52|ICD_10_1.CODE==53)))]<-1 #Other syphilis
mort_2018$ETS.GONO<-NULL; mort_2018$ETS.GONO[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==54))]<-1 #Gonorrhea
mort_2018$ETS.CLAM<-NULL; mort_2018$ETS.CLAM[with(mort_2018, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==55|ICD_10_1.CODE==56)))]<-1 #Chlamydia
mort_2018$ETS.OTRA<-NULL; mort_2018$ETS.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE>=57&ICD_10_1.CODE<=64)))]<-1 #Other STD



## Viral diseases ##
mort_2018$VIR.POLI<-NULL; mort_2018$VIR.POLI[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==80))]<-1 #Acute Poliomyelitis
mort_2018$VIR.VIRU<-NULL; mort_2018$VIR.VIRU[with(mort_2018, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==3|ICD_10_1.CODE==4)))]<-1 #Smallpox (viruela)
mort_2018$VIR.SARA<-NULL; mort_2018$VIR.SARA[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==5))]<-1 #Measles
mort_2018$VIR.RUBE<-NULL; mort_2018$VIR.RUBE[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==6))]<-1 #Rubella
mort_2018$VIR.FIAM<-NULL; mort_2018$VIR.FIAM[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==95))]<-1 #Yellow fever
mort_2018$VIR.DENG<-NULL; mort_2018$VIR.DENG[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==90))]<-1 #Dengue fever
mort_2018$VIR.DHEM<-NULL; mort_2018$VIR.DHEM[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==91))]<-1 #Dengue hemorragic fever
mort_2018$VIR.VIH1<-NULL; mort_2018$VIR.VIH1[with(mort_2018, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=24)))]<-1 #HIV infection
mort_2018$VIR.EVTA<-NULL; mort_2018$VIR.EVTA[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE==85&ICD_10_1.SUB==2)| #Arthropod-Borne Viral Encephalitis
                                                                                         ICD_10_1.CODE==83|ICD_10_1.CODE==84|ICD_10_1.CODE==86)))]<-1 
mort_2018$VIR.HEPB<-NULL; mort_2018$VIR.HEPB[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==16))]<-1 #Acute Hepatitis B
mort_2018$VIR.HEPO<-NULL; mort_2018$VIR.HEPO[with(mort_2018, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==15| #Other viral hepatitis
                                                                                         (ICD_10_1.CODE>=17&ICD_10_1.CODE<=19))))]<-1 
mort_2018$VIR.RABI<-NULL; mort_2018$VIR.RABI[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==82))]<-1 #Rabies
mort_2018$VIR.TRAC<-NULL; mort_2018$VIR.TRAC[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==71))]<-1 #Trachoma (??)


#Other arthropod-borne viral fevers and viral hemorrhagic fevers
mort_2018$VIR.OFAH<-NULL; mort_2018$VIR.OFAH[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE>=92&ICD_10_1.CODE<=94)|
                                                                                         (ICD_10_1.CODE>=96&ICD_10_1.CODE<=99))))]<-1 
mort_2018$VIR.HERP<-NULL; mort_2018$VIR.HERP[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==0))]<-1 #Herpes simplex infections
mort_2018$VIR.VRHZ<-NULL; mort_2018$VIR.VRHZ[with(mort_2018, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==1|ICD_10_1.CODE==2) ))]<-1 #Chickenpox or herpes zoster
mort_2018$VIR.PARO<-NULL; mort_2018$VIR.PARO[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==26))]<-1 #Mumps
mort_2018$VIR.OCLA<-NULL; mort_2018$VIR.OCLA[with(mort_2018, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==70|ICD_10_1.CODE==74)))]<-1 #Other chlamydia infections (??)
mort_2018$VIR.OTRA<-NULL; mort_2018$VIR.OTRA[with(mort_2018, ((ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE==85&(ICD_10_1.SUB==0|ICD_10_1.SUB==1|ICD_10_1.SUB==8))|
                                                                                          ICD_10_1.CODE==81|(ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)))|
                                                                (ICD_10_1.CHAPTER=="B" & ((ICD_10_1.CODE>=7&ICD_10_1.CODE<=9)|ICD_10_1.CODE==25|
                                                                                            (ICD_10_1.CODE>=27&ICD_10_1.CODE<=34)))))]<-1 #Other viral diseases


## Rickettsiosis and Protozoan Infections ##
mort_2018$RPI.TIFP<-NULL; mort_2018$RPI.TIFP[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==75 & ICD_10_1.SUB==0))]<-1 #Louse-borne epidemic thypus
mort_2018$RPI.OTIF<-NULL; mort_2018$RPI.OTIF[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==75 & ICD_10_1.SUB!=0))]<-1 #Other thypus
mort_2018$RPI.ORIC<-NULL; mort_2018$RPI.ORIC[with(mort_2018, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE>=77&ICD_10_1.CODE<=79) ))]<-1 #Other rickettsiosis
mort_2018$RPI.PALU<-NULL; mort_2018$RPI.PALU[with(mort_2018, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=54) ))]<-1 #Malaria
mort_2018$RPI.LEIS<-NULL; mort_2018$RPI.LEIS[with(mort_2018, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==55) ))]<-1 #Leishmaniasis
mort_2018$RPI.TRIP<-NULL; mort_2018$RPI.TRIP[with(mort_2018, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==56|ICD_10_1.CODE==57) ))]<-1 #Trypanosomiasis

## Parasitic worms, Mycosis and Other infectious diseases ##
mort_2018$PMO.ESPI<-NULL; mort_2018$PMO.ESPI[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE>=65&ICD_10_1.CODE<=67)|
                                                                                         ICD_10_1.CODE==69)))]<-1 #Other spirochetal diseases (Not syphilis)
mort_2018$PMO.FIRE<-NULL; mort_2018$PMO.FIRE[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==68))]<-1 #Relapsing fevers
mort_2018$PMO.MICO<-NULL; mort_2018$PMO.MICO[with(mort_2018, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=49) ))]<-1 #Mycosis 
mort_2018$PMO.SCHI<-NULL; mort_2018$PMO.SCHI[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==65))]<-1 #Schistosomiasis
mort_2018$PMO.TREM<-NULL; mort_2018$PMO.TREM[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==66))]<-1 #Other fluke (trematoda) infections
mort_2018$PMO.ECHI<-NULL; mort_2018$PMO.ECHI[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==67))]<-1 #Echinococcosis
mort_2018$PMO.DRAC<-NULL; mort_2018$PMO.DRAC[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==72))]<-1 #Dracunculiasis
mort_2018$PMO.ONCH<-NULL; mort_2018$PMO.ONCH[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==73))]<-1 #Onchocerciasis
mort_2018$PMO.FILA<-NULL; mort_2018$PMO.FILA[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==74))]<-1 #Filariasis
mort_2018$PMO.ANNE<-NULL; mort_2018$PMO.ANNE[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==76))]<-1 #Ancylostomiasis or Necatoriasis
mort_2018$PMO.HELM<-NULL; mort_2018$PMO.HELM[with(mort_2018, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==75|(ICD_10_1.CODE>=68&ICD_10_1.CODE<=71)|
                                                                                         (ICD_10_1.CODE>=77&ICD_10_1.CODE<=83))))]<-1 #Other Helminthiases
mort_2018$PMO.OTRA<-NULL; mort_2018$PMO.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==99|(ICD_10_1.CODE>=58&ICD_10_1.CODE<=64)|
                                                                                         (ICD_10_1.CODE>=85&ICD_10_1.CODE<=89)| 
                                                                                         (ICD_10_1.CODE>=95&ICD_10_1.CODE<=97))))]<-1 #Other infectious/parasitic disease

## Sequelae of infectious diseases ##
mort_2018$SEI.TUBE<-NULL; mort_2018$SEI.TUBE[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==90))]<-1 #Tuberculosis sequelae
mort_2018$SEI.POLI<-NULL; mort_2018$SEI.POLI[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==91))]<-1 #Poliomyelitis sequelae
mort_2018$SEI.LEPR<-NULL; mort_2018$SEI.LEPR[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==92))]<-1 #Leprosy sequelae
mort_2018$SEI.OTRA<-NULL; mort_2018$SEI.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==94))]<-1 #Sequelae from other infections

## Malignant neoplasms 1: lip, oral cavity and pharynx ##
mort_2018$NM1.LCBF<-NULL; mort_2018$NM1.LCBF[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=14)))]<-1

## Malignant neoplasms 2: digestive organs ##
mort_2018$NM2.ESOF<-NULL; mort_2018$NM2.ESOF[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==15))]<-1 #Esophagus
mort_2018$NM2.STOM<-NULL; mort_2018$NM2.STOM[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==16))]<-1 #Stomach
mort_2018$NM2.INDE<-NULL; mort_2018$NM2.INDE[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==17))]<-1 #Small intestine
mort_2018$NM2.COLO<-NULL; mort_2018$NM2.COLO[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==18))]<-1 #Colon
mort_2018$NM2.RECT<-NULL; mort_2018$NM2.RECT[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=19&ICD_10_1.CODE<=21)))]<-1 #Rectosigmoid junction, Rectum, Anus and anal canal
mort_2018$NM2.HIGA<-NULL; mort_2018$NM2.HIGA[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==22))]<-1 #Liver and intrahepatic bile ducts
mort_2018$NM2.PANC<-NULL; mort_2018$NM2.PANC[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==25))]<-1 #Pancreas
mort_2018$NM2.OTRO<-NULL; mort_2018$NM2.OTRO[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==23|ICD_10_1.CODE==24|ICD_10_1.CODE==26)))]<-1 #Other

## Malignant neoplasms 3: respiratory and intrathoracic organs ##
mort_2018$NM3.LARI<-NULL; mort_2018$NM3.LARI[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==32))]<-1 #Larynx
mort_2018$NM3.TBPU<-NULL; mort_2018$NM3.TBPU[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==33|ICD_10_1.CODE==34)))]<-1 #Trachea, bronchus and lung
mort_2018$NM3.OTRO<-NULL; mort_2018$NM3.OTRO[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==30|ICD_10_1.CODE==31|
                                                                                         (ICD_10_1.CODE>=37&ICD_10_1.CODE<=39))))]<-1 #Other

## Malignant neoplasms 4: bone, articular cartilage, skin, soft tissues and breast ##
mort_2018$NM4.BONE<-NULL; mort_2018$NM4.BONE[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==40|ICD_10_1.CODE==41)))]<-1 #Bone and articular cartilage
mort_2018$NM4.MELA<-NULL; mort_2018$NM4.MELA[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==43))]<-1 #Malignant melanoma of skin
mort_2018$NM4.SKIN<-NULL; mort_2018$NM4.SKIN[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==44))]<-1 #Other malignant neoplasm of skin
mort_2018$NM4.MAMA<-NULL; mort_2018$NM4.MAMA[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==50))]<-1 #Breast
mort_2018$NM4.SOFT<-NULL; mort_2018$NM4.SOFT[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=45&ICD_10_1.CODE<=49)))]<-1 #Mesothelial and soft tissue

## Malignant neoplasms 5: genitourinary organs ##
mort_2018$NM5.CERV<-NULL; mort_2018$NM5.CERV[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==53))]<-1 #Cervix uteri
mort_2018$NM5.PLAC<-NULL; mort_2018$NM5.PLAC[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==58))]<-1 #Placenta
mort_2018$NM5.UTER<-NULL; mort_2018$NM5.UTER[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==54|ICD_10_1.CODE==55)))]<-1 #Uterus
mort_2018$NM5.OVAR<-NULL; mort_2018$NM5.OVAR[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==56))]<-1 #Ovary
mort_2018$NM5.VAGI<-NULL; mort_2018$NM5.VAGI[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==51|ICD_10_1.CODE==52)))]<-1 #Vulva and vagina
mort_2018$NM5.OTFE<-NULL; mort_2018$NM5.OTFE[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==57))]<-1 #Other and unspecified (female)
mort_2018$NM5.PROS<-NULL; mort_2018$NM5.PROS[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==61))]<-1 #Prostate
mort_2018$NM5.TEST<-NULL; mort_2018$NM5.TEST[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==62))]<-1 #Testis
mort_2018$NM5.OTMA<-NULL; mort_2018$NM5.OTMA[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==60|ICD_10_1.CODE==63)))]<-1 #Other and unspecified (male)
mort_2018$NM5.VEJI<-NULL; mort_2018$NM5.VEJI[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==67))]<-1 #Bladder
mort_2018$NM5.OTUR<-NULL; mort_2018$NM5.OTUR[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ((ICD_10_1.CODE>=64&ICD_10_1.CODE<=66)|
                                                                                         ICD_10_1.CODE==68)))]<-1 #Other urinary tract neoplasms


## Malignant neoplasms 6: other organs and unspecified sites ##
mort_2018$NM6.ENCF<-NULL; mort_2018$NM6.ENCF[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==71))]<-1 #Brain
mort_2018$NM6.MENI<-NULL; mort_2018$NM6.MENI[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==70|ICD_10_1.CODE==72)))]<-1 #Meninges and other SNC
mort_2018$NM6.OJOA<-NULL; mort_2018$NM6.OJOA[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==69))]<-1 #Eyes and adnexa
mort_2018$NM6.OTRO<-NULL; mort_2018$NM6.OTRO[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=73&ICD_10_1.CODE<=80)))]<-1 #Other and unspecified

## Malignant neoplasms 7: lymphoid, hematopoietic and related tissue ##
mort_2018$NM7.ENHO<-NULL; mort_2018$NM7.ENHO[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==81))]<-1 #Hodgkin lymphoma
mort_2018$NM7.NOHO<-NULL; mort_2018$NM7.NOHO[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=82&ICD_10_1.CODE<=85)))]<-1 #Non-Hodgkin lymphoma
mort_2018$NM7.MMCP<-NULL; mort_2018$NM7.MMCP[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==90))]<-1 #Multiple myeloma and plasmatic cell neoplasms
mort_2018$NM7.LEUC<-NULL; mort_2018$NM7.LEUC[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=91&ICD_10_1.CODE<=95)))]<-1 #Leukemias
mort_2018$NM7.OTRO<-NULL; mort_2018$NM7.OTRO[with(mort_2018, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==88|ICD_10_1.CODE==96)))]<-1 #Other


## Malignant neoplasms 8: multiple primary tumors ##
mort_2018$NM8.MUPT<-NULL; mort_2018$NM8.MUPT[with(mort_2018, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==97))]<-1

## In situ neoplasms ##
mort_2018$NIS.CERV<-NULL; mort_2018$NIS.CERV[with(mort_2018, (ICD_10_1.CHAPTER=="D" & ICD_10_1.CODE==6))]<-1 #Cervix uteri
mort_2018$NIS.OTRO<-NULL; mort_2018$NIS.OTRO[with(mort_2018, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=5)| #Other in situ neoplasms
                                                                                         (ICD_10_1.CODE>=7&ICD_10_1.CODE<=9))))]<-1

## Benign neoplasms ##
mort_2018$NBE.SKIN<-NULL; mort_2018$NBE.SKIN[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==22|ICD_10_1.CODE==23) ))]<-1 #Skin
mort_2018$NBE.MAMA<-NULL; mort_2018$NBE.MAMA[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==24)))]<-1 #Breast
mort_2018$NBE.LEIO<-NULL; mort_2018$NBE.LEIO[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==25)))]<-1 #Leiomyoma of uterus
mort_2018$NBE.OVAR<-NULL; mort_2018$NBE.OVAR[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==27)))]<-1 #Ovary
mort_2018$NBE.URIN<-NULL; mort_2018$NBE.URIN[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==30)))]<-1 #Urinary tract
mort_2018$NBE.CSNC<-NULL; mort_2018$NBE.CSNC[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==33)))]<-1 #Brain and other CNS sites
mort_2018$NBE.TIRO<-NULL; mort_2018$NBE.TIRO[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==34)))]<-1 #Thyroid
mort_2018$NBE.OTRO<-NULL; mort_2018$NBE.OTRO[with(mort_2018, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=21)|ICD_10_1.CODE==26|
                                                                                         ICD_10_1.CODE==28|ICD_10_1.CODE==29|ICD_10_1.CODE==31|
                                                                                         ICD_10_1.CODE==32|ICD_10_1.CODE==35|ICD_10_1.CODE==36)))]<-1 #Other


## Neoplasms of uncertain behaviour ##
mort_2018$NCI.UNCB<-NULL; mort_2018$NCI.UNCB[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=37&ICD_10_1.CODE<=48)))]<-1

## Diseases of the blood and blood-forming organs and certain disorders involving the immune mechanism ##
mort_2018$SAN.ADFE<-NULL; mort_2018$SAN.ADFE[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==50)))]<-1 #Iron deficiency anemia
mort_2018$SAN.AOTR<-NULL; mort_2018$SAN.AOTR[with(mort_2018, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=51&ICD_10_1.CODE<=62)|ICD_10_1.CODE==64)))]<-1 #Other anemias
mort_2018$SAN.INMU<-NULL; mort_2018$SAN.INMU[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=89)))]<-1 #Immunity disorders
mort_2018$SAN.OTRA<-NULL; mort_2018$SAN.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=65&ICD_10_1.CODE<=76)))]<-1 #Other

## Endocrine and metabolic diseases ##
mort_2018$END.DEYO<-NULL; mort_2018$END.DEYO[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)))]<-1 #Iodine deficiency thyroid disorders
mort_2018$END.TTOX<-NULL; mort_2018$END.TTOX[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==5)))]<-1 #Thyrotoxicosis
mort_2018$END.TOTR<-NULL; mort_2018$END.TOTR[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==3|ICD_10_1.CODE==4|ICD_10_1.CODE==6|
                                                                                         ICD_10_1.CODE==7) ))]<-1 #Other thyroid disorders
mort_2018$END.DIAB<-NULL; mort_2018$END.DIAB[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=14)))]<-1 #Type 2 diabetes mellitus
mort_2018$END.LIPO<-NULL; mort_2018$END.LIPO[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==78)))]<-1 #Metabolism disorders and dyslipidemia
mort_2018$END.OBES<-NULL; mort_2018$END.OBES[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==66)))]<-1 #Obesity
mort_2018$END.DEPL<-NULL; mort_2018$END.DEPL[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==86)))]<-1 #Volume depletion
mort_2018$END.SQHA<-NULL; mort_2018$END.SQHA[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==68)))]<-1 #Sequelae of hyperalimentation
mort_2018$END.OTRA<-NULL; mort_2018$END.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="E" & ((ICD_10_1.CODE>=15&ICD_10_1.CODE<=34)|ICD_10_1.CODE==65|
                                                                                         ICD_10_1.CODE==67|(ICD_10_1.CODE>=70&ICD_10_1.CODE<=77)|
                                                                                         (ICD_10_1.CODE>=79&ICD_10_1.CODE<=85)|
                                                                                         (ICD_10_1.CODE>=87&ICD_10_1.CODE<=88))))]<-1 #Other


## Malnutrition and other nutritional deficiencies ##
mort_2018$NUT.KWAS<-NULL; mort_2018$NUT.KWAS[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==40|ICD_10_1.CODE==42) ))]<-1 #Kwashiorkor
mort_2018$NUT.MARA<-NULL; mort_2018$NUT.MARA[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==41) ))]<-1 #Nutritional marasmus
mort_2018$NUT.PROT<-NULL; mort_2018$NUT.PROT[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=43&ICD_10_1.CODE<=46)))]<-1 #Other protein-calorie malnutrition
mort_2018$NUT.VITA<-NULL; mort_2018$NUT.VITA[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==50) ))]<-1 #Vitamin A deficiency
mort_2018$NUT.VITO<-NULL; mort_2018$NUT.VITO[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=51&ICD_10_1.CODE<=56)))]<-1 #Other vitamin deficiencies
mort_2018$NUT.SECD<-NULL; mort_2018$NUT.SECD[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==64) ))]<-1 #Sequelae of malnutrition
mort_2018$NUT.OTRA<-NULL; mort_2018$NUT.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=63)))]<-1 #Other nutritional deficiencies


## Mental, Behavioral and Neurodevelopmental disorders ##
mort_2018$MEN.DEME<-NULL; mort_2018$MEN.DEME[with(mort_2018, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE==1|ICD_10_1.CODE==3)))]<-1 #Dementia
mort_2018$MEN.SDAL<-NULL; mort_2018$MEN.SDAL[with(mort_2018, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==10 & ICD_10_1.SUB==2))]<-1 #Alcohol dependence syndrome
mort_2018$MEN.OTAL<-NULL; mort_2018$MEN.OTAL[with(mort_2018, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==10 & ICD_10_1.SUB!=2))]<-1 #Other alcohol related disorders
mort_2018$MEN.TMSP<-NULL; mort_2018$MEN.TMSP[with(mort_2018, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=11&ICD_10_1.CODE<=19)))]<-1 #Mental and behavioral disorders due to other psychoactive substances use
mort_2018$MEN.ESQU<-NULL; mort_2018$MEN.ESQU[with(mort_2018, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=29)))]<-1 #Schizophrenia, schizotypal, delusional, and other non-mood psychotic disorders
mort_2018$MEN.HUMO<-NULL; mort_2018$MEN.HUMO[with(mort_2018, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=39)))]<-1 #Mood [affective] disorders
mort_2018$MEN.ESTR<-NULL; mort_2018$MEN.ESTR[with(mort_2018, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=48)))]<-1 #Anxiety, dissociative, stress-related, somatoform and other nonpsychotic mental disorders
mort_2018$MEN.FISI<-NULL; mort_2018$MEN.FISI[with(mort_2018, (ICD_10_1.CHAPTER=="F" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=59)&
                                                                                         (ICD_10_1.CODE!=53) )))]<-1 #Behavioral syndromes associated with physiological disturbances and physical factors
mort_2018$MEN.RETR<-NULL; mort_2018$MEN.RETR[with(mort_2018, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=70&ICD_10_1.CODE<=79)))]<-1 #Intellectual disabilities
mort_2018$MEN.OTRO<-NULL; mort_2018$MEN.OTRO[with(mort_2018, (ICD_10_1.CHAPTER=="F" & ((ICD_10_1.CODE>=4&ICD_10_1.CODE<=9)|(ICD_10_1.CODE>=60&ICD_10_1.CODE<=69)|
                                                                                         (ICD_10_1.CODE>=80&ICD_10_1.CODE<=99))))]<-1 #Other mental and behavioral disorders



## Diseases of the nervous system ##
mort_2018$NER.MENI<-NULL; mort_2018$NER.MENI[with(mort_2018, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==0|ICD_10_1.CODE==3)))]<-1 #Meningitis
mort_2018$NER.ISNC<-NULL; mort_2018$NER.ISNC[with(mort_2018, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=4&ICD_10_1.CODE<=9)))]<-1 #Other inflammatory diseases of the central nervous system
mort_2018$NER.PARK<-NULL; mort_2018$NER.PARK[with(mort_2018, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==20)))]<-1 #Parkinson's disease
mort_2018$NER.ALZH<-NULL; mort_2018$NER.ALZH[with(mort_2018, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==30)))]<-1 #Alzheimer's disease
mort_2018$NER.ESCM<-NULL; mort_2018$NER.ESCM[with(mort_2018, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==35)))]<-1 #Multiple sclerosis
mort_2018$NER.PALS<-NULL; mort_2018$NER.PALS[with(mort_2018, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=83)))]<-1 #Cerebral palsy and other paralytic syndromes
mort_2018$NER.EPIL<-NULL; mort_2018$NER.EPIL[with(mort_2018, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=41)))]<-1 #Epilepsy and recurrent seizures
mort_2018$NER.MIGR<-NULL; mort_2018$NER.MIGR[with(mort_2018, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=43&ICD_10_1.CODE<=44)))]<-1 #Migraine and other headache syndromes
mort_2018$NER.IQCT<-NULL; mort_2018$NER.IQCT[with(mort_2018, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==45)))]<-1 #Transient cerebral ischemic attacks and related syndromes
mort_2018$NER.SNPE<-NULL; mort_2018$NER.SNPE[with(mort_2018, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=59)))]<-1 #Nerve, nerve root and plexus disorders
mort_2018$NER.OTRA<-NULL; mort_2018$NER.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="G" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=12)|(ICD_10_1.CODE>=21&ICD_10_1.CODE<=25)|
                                                                                         (ICD_10_1.CODE==31)|(ICD_10_1.CODE==36)|(ICD_10_1.CODE==37)|(ICD_10_1.CODE==47)|
                                                                                         (ICD_10_1.CODE>=60&ICD_10_1.CODE<=62)|(ICD_10_1.CODE>=64&ICD_10_1.CODE<=72)|
                                                                                         (ICD_10_1.CODE>=90&ICD_10_1.CODE<=93)|(ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other



## Diseases of the eye and adnexa ##
mort_2018$EYE.PARP<-NULL; mort_2018$EYE.PARP[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Eyelid inflammation
mort_2018$EYE.ESCL<-NULL; mort_2018$EYE.ESCL[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=15&ICD_10_1.CODE<=19)))]<-1 #Disorders of sclera and cornea
mort_2018$EYE.GLAU<-NULL; mort_2018$EYE.GLAU[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==40)))]<-1 #Glaucoma
mort_2018$EYE.CATA<-NULL; mort_2018$EYE.CATA[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=25&ICD_10_1.CODE<=26)))]<-1 #Cataracts
mort_2018$EYE.CRIS<-NULL; mort_2018$EYE.CRIS[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==27)))]<-1 #Other disorders of lens
mort_2018$EYE.RETI<-NULL; mort_2018$EYE.RETI[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==33)))]<-1 #Retinal detachments and breaks
mort_2018$EYE.CEGU<-NULL; mort_2018$EYE.CEGU[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==54)))]<-1 #Blindness and low vision
mort_2018$EYE.CONJ<-NULL; mort_2018$EYE.CONJ[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==10)))]<-1 #Conjunctivitis
mort_2018$EYE.OTCO<-NULL; mort_2018$EYE.OTCO[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==11)))]<-1 #Other disorders of conjunctiva
mort_2018$EYE.LAGR<-NULL; mort_2018$EYE.LAGR[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==4)))]<-1 #Disorders of lacrimal system
mort_2018$EYE.ESTR<-NULL; mort_2018$EYE.ESTR[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=49&ICD_10_1.CODE<=50)))]<-1 #Strabismus
mort_2018$EYE.BINO<-NULL; mort_2018$EYE.BINO[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==51)))]<-1 #Other disorders of binocular movement
mort_2018$EYE.REFR<-NULL; mort_2018$EYE.REFR[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==52)))]<-1 #Disorders of refraction and accommodation
mort_2018$EYE.OTRA<-NULL; mort_2018$EYE.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE==2)|(ICD_10_1.CODE==5)|(ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)|
                                                                                         (ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)|(ICD_10_1.CODE>=34&ICD_10_1.CODE<=35)|
                                                                                         (ICD_10_1.CODE>=43&ICD_10_1.CODE<=44)|(ICD_10_1.CODE>=46&ICD_10_1.CODE<=47)|
                                                                                         (ICD_10_1.CODE==53)|(ICD_10_1.CODE==59)|
                                                                                         (ICD_10_1.CODE>=55&ICD_10_1.CODE<=57))))]<-1 #Other

## Diseases of the ear and mastoid process ##
mort_2018$EAR.OMTM<-NULL; mort_2018$EAR.OMTM[with(mort_2018, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE==65)|(ICD_10_1.CODE==66)| #Otitis media, disorders of Eustachian tube and mastoiditis
                                                                                         (ICD_10_1.CODE>=68&ICD_10_1.CODE<=70))))]<-1
mort_2018$EAR.OTOM<-NULL; mort_2018$EAR.OTOM[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=71&ICD_10_1.CODE<=74)))]<-1 #Other middle ear disorders
mort_2018$EAR.SORD<-NULL; mort_2018$EAR.SORD[with(mort_2018, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=91)))]<-1 #Hearing loss
mort_2018$EAR.OTRA<-NULL; mort_2018$EAR.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE>=60&ICD_10_1.CODE<=61)|(ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)|
                                                                                         (ICD_10_1.CODE>=92&ICD_10_1.CODE<=93)|(ICD_10_1.CODE==83)|(ICD_10_1.CODE==95))))]<-1 #Other


##  Diseases of the circulatory system 1: acute rheumatic fever and chronic rheumatic heart diseases ##
mort_2018$SC1.FIRE<-NULL; mort_2018$SC1.FIRE[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)))]<-1 #Acute rheumatic fever
mort_2018$SC1.CRHD<-NULL; mort_2018$SC1.CRHD[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=5&ICD_10_1.CODE<=9)))]<-1 #Chronic rheumatic heart diseases


## Diseases of the circulatory system 2: hypertensive diseases ##
mort_2018$SC2.ECHI<-NULL; mort_2018$SC2.ECHI[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==11|ICD_10_1.CODE==13)))]<-1 #Hypertensive heart disease
mort_2018$SC2.HTES<-NULL; mort_2018$SC2.HTES[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==10)))]<-1 #Essential (primary) hypertension
mort_2018$SC2.OTRA<-NULL; mort_2018$SC2.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==12)))]<-1 #Other


## Diseases of the circulatory system 3: ischemic heart diseases ##
mort_2018$SC3.IAMC<-NULL; mort_2018$SC3.IAMC[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==21|ICD_10_1.CODE==22)))]<-1 #Acute myocardial infarction
mort_2018$SC3.OTRA<-NULL; mort_2018$SC3.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=23&ICD_10_1.CODE<=25)|
                                                                                         ICD_10_1.CODE==20)))]<-1 #Other

## Diseases of the circulatory system 4: diseases of pulmonary circulation and other heart diseases ##
mort_2018$SC4.EMBP<-NULL; mort_2018$SC4.EMBP[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==26)))]<-1 #Pulmonary embolism
mort_2018$SC4.CARR<-NULL; mort_2018$SC4.CARR[with(mort_2018, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=45)| #Conduction disorders and arrhythmia
                                                                                         (ICD_10_1.CODE>=47&ICD_10_1.CODE<=49))))]<-1
mort_2018$SC4.PARO<-NULL; mort_2018$SC4.PARO[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==46)))]<-1 #Cardiac arrest
mort_2018$SC4.HEFA<-NULL; mort_2018$SC4.HEFA[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==50)))]<-1 #Heart failure
mort_2018$SC4.OTRA<-NULL; mort_2018$SC4.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=27&ICD_10_1.CODE<=31)|(ICD_10_1.CODE>=33&ICD_10_1.CODE<=38)|
                                                                                         ICD_10_1.CODE==40|ICD_10_1.CODE==42|ICD_10_1.CODE==51)))]<-1  #Other


## Diseases of the circulatory system 5: cerebrovascular diseases ##
mort_2018$SC5.HEMS<-NULL; mort_2018$SC5.HEMS[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==60)))]<-1 #Subarachnoid hemorrhage
mort_2018$SC5.HEMI<-NULL; mort_2018$SC5.HEMI[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=61&ICD_10_1.CODE<=62)))]<-1 #Intracerebral and other intracranial hemorrhage
mort_2018$SC5.ISQC<-NULL; mort_2018$SC5.ISQC[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==63)))]<-1 #Cerebral infarction
mort_2018$SC5.EVCN<-NULL; mort_2018$SC5.EVCN[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==64)))]<-1 #Unspecified (hemorrhagic vs isquemic)
mort_2018$SC5.ATSC<-NULL; mort_2018$SC5.ATSC[with(mort_2018, (ICD_10_1.CHAPTER=="I" & ICD_10_1.CODE==67 & ICD_10_1.SUB==2))]<-1 #Cerebral atherosclerosis
mort_2018$SC5.SEQC<-NULL; mort_2018$SC5.SEQC[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==69)))]<-1 #Sequelae of cerebrovascular disease
mort_2018$SC5.OTRA<-NULL; mort_2018$SC5.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==65|ICD_10_1.CODE==66| #Other
                                                                                         (ICD_10_1.CODE==67&ICD_10_1.SUB!=2)) ))]<-1


## Diseases of the circulatory system 6: other diseases of the circulatory system ##
mort_2018$SC6.ATER<-NULL; mort_2018$SC6.ATER[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==70)))]<-1 #Atherosclerosis
mort_2018$SC6.OEVP<-NULL; mort_2018$SC6.OEVP[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==73)))]<-1 #Other peripheral vascular diseases
mort_2018$SC6.ETAR<-NULL; mort_2018$SC6.ETAR[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==74)))]<-1 #Arterial embolism and thrombosis
mort_2018$SC6.OTAR<-NULL; mort_2018$SC6.OTAR[with(mort_2018, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=71&ICD_10_1.CODE<=72)| #Other diseases of arteries, arterioles and capillaries
                                                                                         (ICD_10_1.CODE>=77&ICD_10_1.CODE<=78))))]<-1
mort_2018$SC6.ETVE<-NULL; mort_2018$SC6.ETVE[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=82)))]<-1 #Phlebitis, trombophlebitis, other venous embolism and thrombosis
mort_2018$SC6.VARI<-NULL; mort_2018$SC6.VARI[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==83)))]<-1 #Varicose veins of lower extremities
mort_2018$SC6.HMRR<-NULL; mort_2018$SC6.HMRR[with(mort_2018, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==84)))]<-1 #Hemorrhoids
mort_2018$SC6.OTRA<-NULL; mort_2018$SC6.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=85&ICD_10_1.CODE<=97)| #Other
                                                                                         ICD_10_1.CODE==99)))]<-1


## Respiratory tract diseases 1: acute upper respiratory infections and other diseases of upper respiratory tract ##
mort_2018$ER1.FAAG<-NULL; mort_2018$ER1.FAAG[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==2)))]<-1 #Acute pharyngitis
mort_2018$ER1.TOAG<-NULL; mort_2018$ER1.TOAG[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==3)))]<-1 #Acute tonsillitis
mort_2018$ER1.LTAG<-NULL; mort_2018$ER1.LTAG[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==4)))]<-1 #Acute laryngitis and tracheitis
mort_2018$ER1.OTAG<-NULL; mort_2018$ER1.OTAG[with(mort_2018, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)| #Other acute upper respiratory infections
                                                                                         (ICD_10_1.CODE>=5&ICD_10_1.CODE<=6))))]<-1
mort_2018$ER1.PNSD<-NULL; mort_2018$ER1.PNSD[with(mort_2018, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE==33)| #Nasal polyp and deviated nasal septum
                                                                                         (ICD_10_1.CODE==34&ICD_10_1.SUB==2))))]<-1 
mort_2018$ER1.RNPC<-NULL; mort_2018$ER1.RNPC[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)))]<-1 #Chronic rhinitis, nasopharyngitis and pharyngitis
mort_2018$ER1.SINC<-NULL; mort_2018$ER1.SINC[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==32)))]<-1 #Chronic sinusitis
mort_2018$ER1.TADC<-NULL; mort_2018$ER1.TADC[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==35)))]<-1 #Chronic diseases of tonsils and adenoids
mort_2018$ER1.ONSN<-NULL; mort_2018$ER1.ONSN[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==34&(ICD_10_1.SUB!=2&ICD_10_1.SUB!=9))))]<-1 #Other disorders of nose and nasal sinuses
mort_2018$ER1.OTRA<-NULL; mort_2018$ER1.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=36&ICD_10_1.CODE<=39)))]<-1 #Other


## Respiratory tract diseases 2: other respiratory tract diseases ##
mort_2018$ER2.BRAG<-NULL; mort_2018$ER2.BRAG[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Acute bronchitis and bronchiolitis
mort_2018$ER2.NEUM<-NULL; mort_2018$ER2.NEUM[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=12&ICD_10_1.CODE<=18)))]<-1 #Pneumonia
mort_2018$ER2.INFL<-NULL; mort_2018$ER2.INFL[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=9&ICD_10_1.CODE<=11)))]<-1 #Influenza
mort_2018$ER2.BCNE<-NULL; mort_2018$ER2.BCNE[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=43)))]<-1 #Chronic and unspecified bronchitis, emphysema
mort_2018$ER2.ASMA<-NULL; mort_2018$ER2.ASMA[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=45&ICD_10_1.CODE<=46)))]<-1 #Asthma
mort_2018$ER2.BREC<-NULL; mort_2018$ER2.BREC[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==47)))]<-1 #Bronchiectasis
mort_2018$ER2.EPOC<-NULL; mort_2018$ER2.EPOC[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==44)))]<-1 #Chronic obstructive pulmonary disease
mort_2018$ER2.NMCS<-NULL; mort_2018$ER2.NMCS[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=65)))]<-1 #Pneumoconiosis
mort_2018$ER2.OTAE<-NULL; mort_2018$ER2.OTAE[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=66&ICD_10_1.CODE<=70)))]<-1 #Other pulmonary diseases due to external agents
mort_2018$ER2.PLEU<-NULL; mort_2018$ER2.PLEU[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=94)))]<-1 #Pleural conditions
mort_2018$ER2.IRIN<-NULL; mort_2018$ER2.IRIN[with(mort_2018, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==22)))]<-1 #Unspecified acute lower respiratory infection
mort_2018$ER2.OTRA<-NULL; mort_2018$ER2.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=86)|
                                                                                         (ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other


## Diseases of the digestive system 1: oral cavity and salivary glands ##
mort_2018$SD1.CARI<-NULL; mort_2018$SD1.CARI[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==2)))]<-1 #Dental caries
mort_2018$SD1.OTDI<-NULL; mort_2018$SD1.OTDI[with(mort_2018, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)| #Other disorders of teeth and supporting structures
                                                                                         (ICD_10_1.CODE>=3&ICD_10_1.CODE<=8))))]<-1
mort_2018$SD1.OTJA<-NULL; mort_2018$SD1.OTJA[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==10)))]<-1 #Other diseases of jaw
mort_2018$SD1.OTRA<-NULL; mort_2018$SD1.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=11&ICD_10_1.CODE<=14)|ICD_10_1.CODE==9)))]<-1 #Other


## Diseases of the digestive system 2: esophagus, stomach, intestines, hernia ##
mort_2018$SD2.ESOF<-NULL; mort_2018$SD2.ESOF[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=22)))]<-1 #Diseases of esophagus
mort_2018$SD2.GDIS<-NULL; mort_2018$SD2.GDIS[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==29)))]<-1 #Gastritis and duodenitis
mort_2018$SD2.GDUL<-NULL; mort_2018$SD2.GDUL[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=25&ICD_10_1.CODE<=27)))]<-1 #Gastric and duodenal ulcer
mort_2018$SD2.OTGD<-NULL; mort_2018$SD2.OTGD[with(mort_2018, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)|ICD_10_1.CODE==28)))]<-1 #Other diseases of stomach and duodenum
mort_2018$SD2.APEN<-NULL; mort_2018$SD2.APEN[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=38)))]<-1 #Diseases of appendix
mort_2018$SD2.INHE<-NULL; mort_2018$SD2.INHE[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==40)))]<-1 #Inguinal hernia
mort_2018$SD2.OTHE<-NULL; mort_2018$SD2.OTHE[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=41&ICD_10_1.CODE<=46)))]<-1 #Other hernias
mort_2018$SD2.CRCU<-NULL; mort_2018$SD2.CRCU[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=51)))]<-1 #Crohn's disease and ulcerative colitis
mort_2018$SD2.PIIO<-NULL; mort_2018$SD2.PIIO[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==56)))]<-1 #Paralytic ileus and intestinal obstruction without hernia
mort_2018$SD2.EDDI<-NULL; mort_2018$SD2.EDDI[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==57)))]<-1 #Diverticular disease of intestine
mort_2018$SD2.SIIO<-NULL; mort_2018$SD2.SIIO[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=59)))]<-1 #Irritable bowel syndrome and other functional intestinal disorders


## Diseases of the digestive system 3: liver and other parts of digestive system ##
mort_2018$SD3.ALLD<-NULL; mort_2018$SD3.ALLD[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==70)))]<-1 #Alcoholic liver disease
mort_2018$SD3.OTLI<-NULL; mort_2018$SD3.OTLI[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=71&ICD_10_1.CODE<=76)))]<-1 #Other diseases of liver
mort_2018$SD3.COLE<-NULL; mort_2018$SD3.COLE[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)))]<-1 #Cholelithiasis and cholecystitis
mort_2018$SD3.OTIP<-NULL; mort_2018$SD3.OTIP[with(mort_2018, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=52&ICD_10_1.CODE<=55)|
                                                                                         ICD_10_1.CODE>=60&ICD_10_1.CODE<=66)))]<-1 #Other diseases of intestines and peritoneum
mort_2018$SD3.PANC<-NULL; mort_2018$SD3.PANC[with(mort_2018, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Acute pancreatitis and other diseases of pancreas
mort_2018$SD3.OTRA<-NULL; mort_2018$SD3.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=82&ICD_10_1.CODE<=83)|
                                                                                         ICD_10_1.CODE>=87&ICD_10_1.CODE<=93)))]<-1 #Other diseases of digestive system



## Diseases of the skin and subcutaneous tissue ##
mort_2018$PTS.IPTS<-NULL; mort_2018$PTS.IPTS[with(mort_2018, (ICD_10_1.CHAPTER=="L" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=8)))]<-1 #Infections of the skin and subcutaneous tissue
mort_2018$PTS.DEEC<-NULL; mort_2018$PTS.DEEC[with(mort_2018, (ICD_10_1.CHAPTER=="L" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=30)))]<-1 #Dermatitis and eczema
mort_2018$PTS.OTRA<-NULL; mort_2018$PTS.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="L" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=13)|(ICD_10_1.CODE>=40&ICD_10_1.CODE<=44)|
                                                                                         (ICD_10_1.CODE>=50&ICD_10_1.CODE<=53)|(ICD_10_1.CODE>=55&ICD_10_1.CODE<=60)|
                                                                                         (ICD_10_1.CODE>=63&ICD_10_1.CODE<=85)|(ICD_10_1.CODE>=87&ICD_10_1.CODE<=98))))]<-1 #Other


## Diseases of the musculoskeletal system and connective tissue ##
mort_2018$MOC.PAIN<-NULL; mort_2018$MOC.PAIN[with(mort_2018, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=5&ICD_10_1.CODE<=6)|(ICD_10_1.CODE==8)|
                                                                                         (ICD_10_1.CODE>=10&ICD_10_1.CODE<=13))))]<-1 #Inflammatory polyarthropathies
mort_2018$MOC.OSAR<-NULL; mort_2018$MOC.OSAR[with(mort_2018, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=15&ICD_10_1.CODE<=19)))]<-1 #Osteoarthritis
mort_2018$MOC.ADOL<-NULL; mort_2018$MOC.ADOL[with(mort_2018, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Acquired deformities of limbs
mort_2018$MOC.OTAR<-NULL; mort_2018$MOC.OTAR[with(mort_2018, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)| 
                                                                                         (ICD_10_1.CODE>=22&ICD_10_1.CODE<=25))))]<-1 #Other joint disorders
mort_2018$MOC.SCTD<-NULL; mort_2018$MOC.SCTD[with(mort_2018, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=35)))]<-1 #Systemic connective tissue disorders
mort_2018$MOC.IVDD<-NULL; mort_2018$MOC.IVDD[with(mort_2018, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=51)))]<-1 #Intervertebral disc disorders
mort_2018$MOC.OTDO<-NULL; mort_2018$MOC.OTDO[with(mort_2018, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=40&ICD_10_1.CODE<=48)| 
                                                                                         (ICD_10_1.CODE>=53&ICD_10_1.CODE<=54))))]<-1 #Other dorsopathies
mort_2018$MOC.SOFT<-NULL; mort_2018$MOC.SOFT[with(mort_2018, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=60&ICD_10_1.CODE<=62)|(ICD_10_1.CODE>=65&ICD_10_1.CODE<=67)|
                                                                                         (ICD_10_1.CODE>=70&ICD_10_1.CODE<=72)|(ICD_10_1.CODE>=75&ICD_10_1.CODE<=79))))]<-1 #Soft tissue disorders
mort_2018$MOC.BONE<-NULL; mort_2018$MOC.BONE[with(mort_2018, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)|(ICD_10_1.CODE==83&ICD_10_1.SUB!=0)|
                                                                                         (ICD_10_1.CODE>=84&ICD_10_1.CODE<=85))))]<-1 #Disorders of bone density and structure
mort_2018$MOC.OMIE<-NULL; mort_2018$MOC.OMIE[with(mort_2018, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE==86)))]<-1 #Osteomyelitis
mort_2018$MOC.OTRA<-NULL; mort_2018$MOC.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)|
                                                                                         (ICD_10_1.CODE>=91&ICD_10_1.CODE<=99))))]<-1 #Other



## Diseases of the genitourinary system 1: urinary system ##
mort_2018$GU1.NFRI<-NULL; mort_2018$GU1.NFRI[with(mort_2018, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Acute and rapidly progressive nephritic syndrome
mort_2018$GU1.OTGL<-NULL; mort_2018$GU1.OTGL[with(mort_2018, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=2&ICD_10_1.CODE<=8)))]<-1 #Other glomerular diseases
mort_2018$GU1.ACKF<-NULL; mort_2018$GU1.ACKF[with(mort_2018, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=17&ICD_10_1.CODE<=19)))]<-1 #Acute kidney failure and chronic kidney disease
mort_2018$GU1.RTID<-NULL; mort_2018$GU1.RTID[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=12)|ICD_10_1.CODE==15)))]<-1 #Renal tubulo-interstitial diseases
mort_2018$GU1.OTTU<-NULL; mort_2018$GU1.OTTU[with(mort_2018, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=13&ICD_10_1.CODE<=14)))]<-1 #Other renal tubulo-interstitial diseases
mort_2018$GU1.LITO<-NULL; mort_2018$GU1.LITO[with(mort_2018, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Urolithiasis
mort_2018$GU1.RECO<-NULL; mort_2018$GU1.RECO[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==23))]<-1 #Unspecified renal colic
mort_2018$GU1.CIST<-NULL; mort_2018$GU1.CIST[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==30))]<-1 #Cystitis
mort_2018$GU1.OTRA<-NULL; mort_2018$GU1.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=25&ICD_10_1.CODE<=29)|(ICD_10_1.CODE>=31&ICD_10_1.CODE<=39))))]<-1 #Other


## Diseases of the genitourinary system 2: male genital organs ##
mort_2018$GU2.HIPR<-NULL; mort_2018$GU2.HIPR[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==40))]<-1 #Benign prostatic hyperplasia
mort_2018$GU2.OTPR<-NULL; mort_2018$GU2.OTPR[with(mort_2018, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=41&ICD_10_1.CODE<=42)))]<-1 #Other disorders of prostate
mort_2018$GU2.HCEC<-NULL; mort_2018$GU2.HCEC[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==43))]<-1 #Hydrocele and spermatocele
mort_2018$GU2.PREP<-NULL; mort_2018$GU2.PREP[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==47))]<-1 #Disorders of prepuce
mort_2018$GU2.MINF<-NULL; mort_2018$GU2.MINF[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==46))]<-1 #Male infertility
mort_2018$GU2.OTRA<-NULL; mort_2018$GU2.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=45)|(ICD_10_1.CODE>=48&ICD_10_1.CODE<=50))))]<-1 #Other



## Diseases of the genitourinary system 3: breast disorders ##
mort_2018$GU3.MAMA<-NULL; mort_2018$GU3.MAMA[with(mort_2018, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=64)))]<-1 #Disorders of breast


## Diseases of the genitourinary system 4: female genital organs ##
mort_2018$GU4.SAOO<-NULL; mort_2018$GU4.SAOO[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==70))]<-1 #Salpingitis and oophoritis
mort_2018$GU4.IDCU<-NULL; mort_2018$GU4.IDCU[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==72))]<-1 #Inflammatory disease of cervix uteri
mort_2018$GU4.OTVV<-NULL; mort_2018$GU4.OTVV[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=75&ICD_10_1.CODE<=76)|ICD_10_1.CODE==71)))]<-1 #Other diseases of uterus, vagina and vulva
mort_2018$GU4.OTPI<-NULL; mort_2018$GU4.OTPI[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==73))]<-1 #Other female pelvic inflammatory diseases
mort_2018$GU4.ENDM<-NULL; mort_2018$GU4.ENDM[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==80))]<-1 #Endometriosis
mort_2018$GU4.FPRO<-NULL; mort_2018$GU4.FPRO[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==81))]<-1 #Female genital prolapse
mort_2018$GU4.NOFB<-NULL; mort_2018$GU4.NOFB[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==83))]<-1 #Noninflammatory disorders of ovary, fallopian tube and broad ligament
mort_2018$GU4.MENS<-NULL; mort_2018$GU4.MENS[with(mort_2018, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=91&ICD_10_1.CODE<=92)))]<-1 #Disorders of menstruation
mort_2018$GU4.MNOP<-NULL; mort_2018$GU4.MNOP[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==95))]<-1 #Menopausal and other perimenopausal disorders
mort_2018$GU4.FINF<-NULL; mort_2018$GU4.FINF[with(mort_2018, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==97))]<-1 #Female infertility
mort_2018$GU4.OTRA<-NULL; mort_2018$GU4.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE==82|(ICD_10_1.CODE>=84&ICD_10_1.CODE<=90)|
                                                                                         (ICD_10_1.CODE>=93&ICD_10_1.CODE<=94)|ICD_10_1.CODE==96|ICD_10_1.CODE==98)))]<-1 #Other


## Obstetrics 1: direct obstetric causes (abortion) ##
mort_2018$OB1.SPON<-NULL; mort_2018$OB1.SPON[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==3))]<-1 #Spontaneous abortion
mort_2018$OB1.INDU<-NULL; mort_2018$OB1.INDU[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==4))]<-1 #Complications following (induced) termination of pregnancy
mort_2018$OB1.OTRA<-NULL; mort_2018$OB1.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)|(ICD_10_1.CODE>=5&ICD_10_1.CODE<=8))))]<-1 #Other abortion


## Obstetrics 2: direct obstetric causes (pregnancy and puerperium, except abortion) ##
mort_2018$OB2.EPHD<-NULL; mort_2018$OB2.EPHD[with(mort_2018, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=16)))]<-1 #Edema, proteinuria and hypertensive disorders in pregnancy, childbirth and the puerperium
mort_2018$OB2.HEMP<-NULL; mort_2018$OB2.HEMP[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=46)|
                                                                                         ICD_10_1.CODE==20)))]<-1 #Hemorrhage in early pregnancy, placenta previa, abruptio placentae, antepartum hemorrhage
mort_2018$OB2.FACD<-NULL; mort_2018$OB2.FACD[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=30&ICD_10_1.CODE<=43)|ICD_10_1.CODE==47|
                                                                                         ICD_10_1.CODE==48)))]<-1 #Maternal care related to the fetus and amniotic cavity and possible delivery problems
mort_2018$OB2.IGUT<-NULL; mort_2018$OB2.IGUT[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==23))]<-1 #Infections of genitourinary tract in pregnancy
mort_2018$OB2.DMIP<-NULL; mort_2018$OB2.DMIP[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==24))]<-1 #Diabetes mellitus in pregnancy
mort_2018$OB2.OBSL<-NULL; mort_2018$OB2.OBSL[with(mort_2018, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=64&ICD_10_1.CODE<=66)))]<-1 #Obstructed labor 
mort_2018$OB2.PPHE<-NULL; mort_2018$OB2.PPHE[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==72))]<-1 #Postpartum hemorrhage
mort_2018$OB2.SOPI<-NULL; mort_2018$OB2.SOPI[with(mort_2018, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Sepsis and other puerperal infections
mort_2018$OB2.PUER<-NULL; mort_2018$OB2.PUER[with(mort_2018, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=87&ICD_10_1.CODE<=92)))]<-1 #Other complications of the puerperium
mort_2018$OB2.OTPL<-NULL; mort_2018$OB2.OTPL[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=21&ICD_10_1.CODE<=22)|(ICD_10_1.CODE>=25&ICD_10_1.CODE<=29)|(ICD_10_1.CODE>=60&ICD_10_1.CODE<=63)|
                                                                                         (ICD_10_1.CODE>=67&ICD_10_1.CODE<=71)|(ICD_10_1.CODE>=73&ICD_10_1.CODE<=75))))]<-1 #Other complications of pregnancy and labor
mort_2018$OB2.OBTE<-NULL; mort_2018$OB2.OBTE[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==34))]<-1 #Obstetrical tetanus
mort_2018$OB2.BEPU<-NULL; mort_2018$OB2.BEPU[with(mort_2018, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==53))]<-1 #Mental and behavioral disorders associated with the puerperium
mort_2018$OB2.OMLC<-NULL; mort_2018$OB2.OMLC[with(mort_2018, (ICD_10_1.CHAPTER=="M" & ICD_10_1.CODE==83 & ICD_10_1.SUB==0))]<-1 #Puerperal osteomalacia
mort_2018$OB2.OTDC<-NULL; mort_2018$OB2.OTDC[with(mort_2018, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=96&ICD_10_1.CODE<=97)))]<-1 #Other direct obstetric causes
mort_2018$OB2.ODUC<-NULL; mort_2018$OB2.ODUC[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==95))]<-1 #Obstetric death of unspecified cause


## Obstetrics 3: delivery ##
mort_2018$OB3.SSDE<-NULL; mort_2018$OB3.SSDE[with(mort_2018, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==80))]<-1 #Single spontaneous delivery
mort_2018$OB3.OTDE<-NULL; mort_2018$OB3.OTDE[with(mort_2018, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=81&ICD_10_1.CODE<=84)))]<-1 #Other delivery


## Obstetrics 4: indirect obstetric causes ##
mort_2018$OB4.INOC<-NULL; mort_2018$OB4.INOC[with(mort_2018, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=98&ICD_10_1.CODE<=99)))]<-1 #Indirect obstetric causes


## Certain conditions originating in the perinatal period ##
mort_2018$NEO.NAMC<-NULL; mort_2018$NEO.NAMC[with(mort_2018, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE==0|ICD_10_1.CODE==4)))]<-1 #Newborn affected by maternal conditions
mort_2018$NEO.NAOC<-NULL; mort_2018$NEO.NAOC[with(mort_2018, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=1&ICD_10_1.CODE<=3)))]<-1 #Newborn affected by obstetric complications
mort_2018$NEO.GMGW<-NULL; mort_2018$NEO.GMGW[with(mort_2018, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE==5|ICD_10_1.CODE==7)))]<-1 #Slow fetal growth, fetal malnutrition, short gestation and low birth weight
mort_2018$NEO.BITR<-NULL; mort_2018$NEO.BITR[with(mort_2018, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=15)))]<-1 #Birth trauma
mort_2018$NEO.HIAS<-NULL; mort_2018$NEO.HIAS[with(mort_2018, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Intrauterine hypoxia and birth asphyxia 
mort_2018$NEO.SDRN<-NULL; mort_2018$NEO.SDRN[with(mort_2018, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=22&ICD_10_1.CODE<=28)))]<-1 #Respiratory distress of newborn and other perinatal respiratory disorders
mort_2018$NEO.INFE<-NULL; mort_2018$NEO.INFE[with(mort_2018, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=37)))]<-1 #Congenital viral, bacterial and parasitic diseases
mort_2018$NEO.OTIN<-NULL; mort_2018$NEO.OTIN[with(mort_2018, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=38&ICD_10_1.CODE<=39)))]<-1 #Other infections specific to the perinatal period
mort_2018$NEO.HDNB<-NULL; mort_2018$NEO.HDNB[with(mort_2018, (ICD_10_1.CHAPTER=="P" & ICD_10_1.CODE==55))]<-1 #Hemolytic disease of newborn
mort_2018$NEO.TENE<-NULL; mort_2018$NEO.TENE[with(mort_2018, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==33))]<-1 #Tetanus neonatorum
mort_2018$NEO.OTRA<-NULL; mort_2018$NEO.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="P" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=54)|(ICD_10_1.CODE>=56&ICD_10_1.CODE<=74)|
                                                                                         (ICD_10_1.CODE>=76&ICD_10_1.CODE<=96)|(ICD_10_1.CODE==8)|(ICD_10_1.CODE==29))))]<-1 #Other


## Congenital malformations, deformations and chromosomal abnormalities ##
mort_2018$CON.ANEN<-NULL; mort_2018$CON.ANEN[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==0))]<-1 #Anencephaly and similar malformations
mort_2018$CON.HIDR<-NULL; mort_2018$CON.HIDR[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==3))]<-1 #Congenital hydrocephalus
mort_2018$CON.SBIF<-NULL; mort_2018$CON.SBIF[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==5))]<-1 #Spina bifida
mort_2018$CON.OTNS<-NULL; mort_2018$CON.OTNS[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=1&ICD_10_1.CODE<=2)|(ICD_10_1.CODE==4)|
                                                                                         (ICD_10_1.CODE>=6&ICD_10_1.CODE<=7))))]<-1 #Other congenital malformations of the nervous system
mort_2018$CON.CIRC<-NULL; mort_2018$CON.CIRC[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=28)))]<-1 #Congenital malformations of the circulatory system
mort_2018$CON.CLCP<-NULL; mort_2018$CON.CLCP[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=37)))]<-1 #Cleft lip and cleft palate
mort_2018$CON.CINT<-NULL; mort_2018$CON.CINT[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==41))]<-1 #Congenital absence, atresia and stenosis of small intestine
mort_2018$CON.OTDS<-NULL; mort_2018$CON.OTDS[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=38&ICD_10_1.CODE<=40)|
                                                                                         (ICD_10_1.CODE>=42&ICD_10_1.CODE<=45))))]<-1 #Other congenital malformations of the digestive system 
mort_2018$CON.TEST<-NULL; mort_2018$CON.TEST[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==53))]<-1 #Undescended and ectopic testicle
mort_2018$CON.OTGU<-NULL; mort_2018$CON.OTGU[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=52)|
                                                                                         (ICD_10_1.CODE>=54&ICD_10_1.CODE<=64))))]<-1 #Other congenital malformations of genitourinary system
mort_2018$CON.DHIP<-NULL; mort_2018$CON.DHIP[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==65))]<-1 #Congenital deformities of hip
mort_2018$CON.FEET<-NULL; mort_2018$CON.FEET[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==66))]<-1 #Congenital deformities of feet
mort_2018$CON.OTMS<-NULL; mort_2018$CON.OTMS[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=67&ICD_10_1.CODE<=79)))]<-1 #Other congenital malformations and deformations of the musculoskeletal system
mort_2018$CON.OTRA<-NULL; mort_2018$CON.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=18)|(ICD_10_1.CODE>=30&ICD_10_1.CODE<=34)|
                                                                                         (ICD_10_1.CODE>=80&ICD_10_1.CODE<=89))))]<-1 #Other congenital malformations
mort_2018$CON.CROM<-NULL; mort_2018$CON.CROM[with(mort_2018, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=99)))]<-1 #Chromosomal abnormalities, not elsewhere classified


## Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified ##
mort_2018$NCL.FEVU<-NULL; mort_2018$NCL.FEVU[with(mort_2018, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==50))]<-1 #Fever of other and unknown origin
mort_2018$NCL.CAAB<-NULL; mort_2018$NCL.CAAB[with(mort_2018, (ICD_10_1.CHAPTER=="R" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Cardiac abnormalities
mort_2018$NCL.RAOR<-NULL; mort_2018$NCL.RAOR[with(mort_2018, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==33))]<-1 #Retention of urine
mort_2018$NCL.ABPP<-NULL; mort_2018$NCL.ABPP[with(mort_2018, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==10))]<-1 #Abdominal and pelvic pain
mort_2018$NCL.ARPD<-NULL; mort_2018$NCL.ARPD[with(mort_2018, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==54))]<-1 #Age-related physical debility
mort_2018$NCL.SIDS<-NULL; mort_2018$NCL.SIDS[with(mort_2018, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==95))]<-1 #Sudden infant death syndrome
mort_2018$NCL.REAR<-NULL; mort_2018$NCL.REAR[with(mort_2018, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==9 & ICD_10_1.SUB==2))]<-1 #Respiratory arrest
mort_2018$NCL.OTRA<-NULL; mort_2018$NCL.OTRA[with(mort_2018, (ICD_10_1.CHAPTER=="R" & ((ICD_10_1.CODE==9&(ICD_10_1.SUB==0|ICD_10_1.SUB==1|ICD_10_1.SUB==3|ICD_10_1.SUB==8))|
                                                                                         (ICD_10_1.CODE>=2&ICD_10_1.CODE<=8)|(ICD_10_1.CODE>=11&ICD_10_1.CODE<=32)|
                                                                                         (ICD_10_1.CODE>=34&ICD_10_1.CODE<=49)|(ICD_10_1.CODE>=51&ICD_10_1.CODE<=53)|
                                                                                         (ICD_10_1.CODE>=55&ICD_10_1.CODE<=94)|(ICD_10_1.CODE>=96&ICD_10_1.CODE<=99))))]<-1 #Other



## External causes of mortality 1: transport accidents ##
mort_2018$EX1.RAIL<-NULL; mort_2018$EX1.RAIL[with(mort_2018, (ICD_10_1.CHAPTER=="V" & ((ICD_10_1.CODE==5)|(ICD_10_1.CODE==15)|(ICD_10_1.CODE==80&ICD_10_1.SUB==6)|
                                                                                         (ICD_10_1.CODE==81&ICD_10_1.SUB!=1)) ))]<-1 #Railway accidents
mort_2018$EX1.MOTO<-NULL; mort_2018$EX1.MOTO[with(mort_2018, (ICD_10_1.CHAPTER=="V" &  (((ICD_10_1.CODE>=2&ICD_10_1.CODE<=4) & (ICD_10_1.SUB==1|ICD_10_1.SUB==9))|
                                                                                          ((ICD_10_1.CODE==9) & (ICD_10_1.SUB==2|ICD_10_1.SUB==3|ICD_10_1.SUB==9))|
                                                                                          ((ICD_10_1.CODE>=12&ICD_10_1.CODE<=14) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE==19) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=6))|
                                                                                          ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=28) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE>=29&ICD_10_1.CODE<=79) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE==80) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=5))|
                                                                                          ((ICD_10_1.CODE>=81&ICD_10_1.CODE<=82) & (ICD_10_1.SUB==1))|
                                                                                          ((ICD_10_1.CODE>=83&ICD_10_1.CODE<=86) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=3))|
                                                                                          ((ICD_10_1.CODE==87) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=8))|
                                                                                          ((ICD_10_1.CODE==89) & (ICD_10_1.SUB==2|ICD_10_1.SUB==9))) ))]<-1 #Motor vehicle traffic accidents
mort_2018$EX1.LAND<-NULL; mort_2018$EX1.LAND[with(mort_2018, (ICD_10_1.CHAPTER=="V" & ((ICD_10_1.CODE==1)|(ICD_10_1.CODE==6)|(ICD_10_1.CODE==10)|(ICD_10_1.CODE==11)|
                                                                                         (ICD_10_1.CODE>=16&ICD_10_1.CODE<=18)|(ICD_10_1.CODE==19&ICD_10_1.SUB==3)|
                                                                                         ((ICD_10_1.CODE==80) & (ICD_10_1.SUB<=2|ICD_10_1.SUB>=7))|
                                                                                         ((ICD_10_1.CODE==82) & (ICD_10_1.SUB>=2&ICD_10_1.SUB<=9))|
                                                                                         ((ICD_10_1.CODE==89) & (ICD_10_1.SUB==1|ICD_10_1.SUB==3)) )))]<-1 #Other land transport accidents
mort_2018$EX1.WATE<-NULL; mort_2018$EX1.WATE[with(mort_2018, (ICD_10_1.CHAPTER=="V" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=94)))]<-1 #Water transport accidents
mort_2018$EX1.AIRS<-NULL; mort_2018$EX1.AIRS[with(mort_2018, (ICD_10_1.CHAPTER=="V" & (ICD_10_1.CODE>=95&ICD_10_1.CODE<=97)))]<-1 #Air and space transport accidents
mort_2018$EX1.OTRO<-NULL; mort_2018$EX1.OTRO[with(mort_2018, (ICD_10_1.CHAPTER=="V" & (((ICD_10_1.CODE>=2&ICD_10_1.CODE<=4) & (ICD_10_1.SUB==0))|
                                                                                         ((ICD_10_1.CODE==9) & (ICD_10_1.SUB==0|ICD_10_1.SUB==1))|
                                                                                         ((ICD_10_1.CODE>=12&ICD_10_1.CODE<=14) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=2))|
                                                                                         ((ICD_10_1.CODE==19) & (ICD_10_1.SUB<=2|ICD_10_1.SUB>=8))|
                                                                                         ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=28) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=2))|
                                                                                         ((ICD_10_1.CODE>=29&ICD_10_1.CODE<=79) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=3))|
                                                                                         ((ICD_10_1.CODE>=83&ICD_10_1.CODE<=86) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=9))|
                                                                                         (ICD_10_1.CODE==82&ICD_10_1.SUB==0)|(ICD_10_1.CODE==87&ICD_10_1.SUB==9)|
                                                                                         (ICD_10_1.CODE==88)|(ICD_10_1.CODE==89&ICD_10_1.SUB==0)|
                                                                                         (ICD_10_1.CODE>=98&ICD_10_1.CODE<=99))))]<-1 #Other



## External causes of mortality 2: falls ##
mort_2018$EX2.FALL<-NULL; mort_2018$EX2.FALL[with(mort_2018, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=19)))]<-1 #Falls


## External causes of mortality 3: other accidents ##
mort_2018$EX3.ENVI<-NULL; mort_2018$EX3.ENVI[with(mort_2018, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=53&ICD_10_1.CODE<=64)) | 
                                                    (ICD_10_1.CHAPTER=="X" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=39)|(ICD_10_1.CODE>=50&ICD_10_1.CODE<=57))))]<-1 #Accidents caused by environmental factors
mort_2018$EX3.DROW<-NULL; mort_2018$EX3.DROW[with(mort_2018, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=65&ICD_10_1.CODE<=74)))]<-1 #Accidental non-transport drowning and submersion
mort_2018$EX3.FBNO<-NULL; mort_2018$EX3.FBNO[with(mort_2018, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE==44)))]<-1 #Foreign body entering into or through eye or natural orifice
mort_2018$EX3.MACH<-NULL; mort_2018$EX3.MACH[with(mort_2018, (ICD_10_1.CHAPTER=="W" & ((ICD_10_1.CODE>=23&ICD_10_1.CODE<=31)|ICD_10_1.CODE==35|
                                                                                         ICD_10_1.CODE==37|ICD_10_1.CODE==38|ICD_10_1.CODE==41|
                                                                                         (ICD_10_1.CODE>=45&ICD_10_1.CODE<=46))))]<-1 #Accidents caused by machinery or sharp instruments
mort_2018$EX3.FREG<-NULL; mort_2018$EX3.FREG[with(mort_2018, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=32&ICD_10_1.CODE<=34)))]<-1 #Accidents caused by firearms and guns
mort_2018$EX3.SEQA<-NULL; mort_2018$EX3.SEQA[with(mort_2018, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Sequelae of transport accidents and other accidents

mort_2018$EX3.OTRA<-NULL; mort_2018$EX3.OTRA[with(mort_2018, ((ICD_10_1.CHAPTER=="W" & ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=22)|ICD_10_1.CODE==36|ICD_10_1.CODE==39|ICD_10_1.CODE==40|ICD_10_1.CODE==42|
                                                                                          ICD_10_1.CODE==43|(ICD_10_1.CODE>=49&ICD_10_1.CODE<=52)|(ICD_10_1.CODE>=75&ICD_10_1.CODE<=99)))|
                                                                (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=59)) ))]<-1 #Other



## External causes of mortality 4: exposure to smoke, fire and flames ##
mort_2018$EX4.SMFF<-NULL; mort_2018$EX4.SMFF[with(mort_2018, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=9)))]<-1 #Exposure to smoke, fire and flames


## External causes of mortality 5: accidental poisoning and substance exposition ##
mort_2018$EX5.APDM<-NULL; mort_2018$EX5.APDM[with(mort_2018, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=44)))]<-1 #Accidental poisoning by drugs, medicaments and biological substances
mort_2018$EX5.APSL<-NULL; mort_2018$EX5.APSL[with(mort_2018, (ICD_10_1.CHAPTER=="X" & ((ICD_10_1.CODE>=45&ICD_10_1.CODE<=49)&(ICD_10_1.CODE!=47))))]<-1 #Accidental poisoning by other solid or liquid substances
mort_2018$EX5.APGV<-NULL; mort_2018$EX5.APGV[with(mort_2018, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE==47)))]<-1 #Accidental poisoning by other gases and vapours

## External causes of mortality 6: suicide ##
mort_2018$EX6.SUIC<-NULL; mort_2018$EX6.SUIC[with(mort_2018, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=84)))]<-1 #Intentional self-harm


## External causes of mortality 7: homicide ##
mort_2018$EX7.ASSA<-NULL; mort_2018$EX7.ASSA[with(mort_2018, ((ICD_10_1.CHAPTER=="X"&ICD_10_1.CODE>=85)|(ICD_10_1.CHAPTER=="Y"&ICD_10_1.CODE<=9)))]<-1 #Assault


## External causes of mortality 8: other violent causes of death ##
mort_2018$EX8.EOUI<-NULL; mort_2018$EX8.EOUI[with(mort_2018, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=34)))]<-1 #Event of undetermined intent
mort_2018$EX8.OWAR<-NULL; mort_2018$EX8.OWAR[with(mort_2018, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE==36)))]<-1 #Operations of war
mort_2018$EX8.LEGI<-NULL; mort_2018$EX8.LEGI[with(mort_2018, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE==35)))]<-1 #Legal intervention


## External causes of mortality 9: other external causes of mortality ##
mort_2018$EX9.DRUG<-NULL; mort_2018$EX9.DRUG[with(mort_2018, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=59)))]<-1 #Drugs, medicaments and biological substances causing adverse effects in therapeutic use
mort_2018$EX9.MSDV<-NULL; mort_2018$EX9.MSDV[with(mort_2018, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=84)))]<-1 #Misadventures to patients during surgical and medical care
mort_2018$EX9.SQEX<-NULL; mort_2018$EX9.SQEX[with(mort_2018, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)))]<-1 #Sequelae of external causes of morbidity and mortality


# COVID-19 #
mort_2018$COV.CONF<-NULL; mort_2018$COV.CONF[with(mort_2018, (ICD_10_1.CHAPTER=="U" & ICD_10_1.CODE==7 & ICD_10_1.SUB==1))]<-1 #Confirmed COVID-19
mort_2018$COV.SUSP<-NULL; mort_2018$COV.SUSP[with(mort_2018, (ICD_10_1.CHAPTER=="U" & ICD_10_1.CODE==7 & ICD_10_1.SUB==2))]<-1 #Suspected COVID-19


#Merge Datasets

mort_2018<-mort_2018 %>%left_join(dmu.cuadrantes.mun,by="id.mun")%>%
  rename(DMU_MUN=dmu)%>%
  rename(DMU_CAMAS_MUN=dmu_camas)%>%
  left_join(dmu.ent, by="id.ent")%>%
  rename(DMU_CAMAS_ENT=dmu_camas)%>%
  rename(DMU_ENT=dmu)

mort_2018$AVOIDABLE<-NULL
mort_2018$AVOIDABLE[mort_2018$TREA.PREV==1]<-1
mort_2018$AVOIDABLE[mort_2018$TREA.PREV==2]<-1
mort_2018$AVOIDABLE[mort_2018$TREA.PREV==3]<-1
mort_2018$AVOIDABLE[mort_2018$TREA.PREV==4]<-0

mort_2018$CONTEXTO<-NULL
mort_2018$CONTEXTO[mort_2018$CONTEXTO_DEFUNCION %in% c(1,2,3,4,5,6,7,8,9)]<-1
mort_2018$CONTEXTO[mort_2018$CONTEXTO_DEFUNCION %in% c(10,11,12,99)]<-2
mort_2018$CONTEXTO[mort_2018$CONTEXTO_DEFUNCION %in% c(99)]<-3

#### 2017 Dataset####
mort_2017 <- read.csv("Bases/Bases Federales Defuncion 2015-2016/Defunciones_2017.CSV")
mort_2017$id.ent<-paste0(str_pad(mort_2017$ENT_OCURR, 2,pad = "0"))
mort_2017$id.mun<-paste0(str_pad(mort_2017$ENT_OCURR, 2,pad = "0"),str_pad(mort_2017$MUN_OCURR,3, pad="0"))

mort_2017$FECHA_DEFUNCION<-as.Date(paste0(as.numeric(mort_2017$DIA_OCURR),"-",as.numeric(mort_2017$MES_OCURR),"-",as.numeric(mort_2017$ANIO_OCUR)),format = "%d-%m-%Y")
mort_2017<-cbind(mort_2017,data.frame(matrix(unlist(strsplit(as.character(mort_2017$EDAD), split = "(?=[0-9])", perl = TRUE)), nrow=length(strsplit(as.character(mort_2017$EDAD), split = "(?=[0-9])", perl = TRUE)), byrow=TRUE)))

mort_2017$X3[mort_2017$X1=="1"]<-"0"
mort_2017$X3[mort_2017$X1=="2"]<-"0"
mort_2017$X3[mort_2017$X1=="3"]<-"0"

mort_2017$X4[mort_2017$X1=="1"]<-"0"
mort_2017$X4[mort_2017$X1=="2"]<-"0"
mort_2017$X4[mort_2017$X1=="3"]<-"0"


mort_2017$edad<-as.numeric(paste0(str_pad(mort_2017$X2, 1),str_pad(mort_2017$X3, 1),str_pad(mort_2017$X4,1)))
mort_2017$edad[mort_2017$edad==998]<-NA

mort_2017<-mort_2017%>%
  filter(MES_OCURR!=99)%>%
  filter(ANIO_OCUR!=9999)%>%
  dplyr::select(-c("EDAD"))%>%
  dplyr::rename("EDAD"=edad, "SEXO"=SEXO, "ESTADO_DEFUNCION"=ENT_OCURR,"MUNICIPIO"=MUN_OCURR, 
                "CONTEXTO_DEFUNCION"=SITIO_OCUR,"CAUSA_MUERTE_ICD_10_CATEGORIA_1"=CAUSA_DEF)%>%
  mutate(Year=data.table::year(FECHA_DEFUNCION),MES=data.table::month(FECHA_DEFUNCION))%>%
  filter(Year=="2017")%>%
  filter(MES!=99)%>%
  mutate(FECHA_DEFUNCION=as.character(FECHA_DEFUNCION))%>%
  mutate(FECHA_DEFUNCION=as.Date(FECHA_DEFUNCION))%>%
  mutate(Year=data.table::year(FECHA_DEFUNCION),MES=data.table::month(FECHA_DEFUNCION))

mort_2017$ICD_10_1.CHAPTER<-str_extract(strsplit(mort_2017$CAUSA_MUERTE_ICD_10_CATEGORIA_1,NULL), "[A-Z]+" )
mort_2017$ICD_10_1.CODE<-as.numeric(substr(str_extract(strsplit(mort_2017$CAUSA_MUERTE_ICD_10_CATEGORIA_1, split = "(?<=[a-zA-Z])\\s*(?=[0-9])", perl = TRUE),"([[:digit:]]+)"),start=1,stop=2))

#ICD-10 Coding

#Preventable mortality specific causes
mort_2017$INTE.DIS[(mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=09))]<-1
mort_2017$DI.TE.PO[(mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE==35 | mort_2017$ICD_10_1.CODE==36 | mort_2017$ICD_10_1.CODE==80))]<-1
mort_2017$WHO.COUG[(mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE==37))]<-1
mort_2017$MENINGOC[(mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE==39))]<-1
mort_2017$SEPS.STR[(mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE>=40 & mort_2017$ICD_10_1.CODE<=41))]<-1
mort_2017$HAE.INFL[(mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE==49))]<-1
mort_2017$SEX.INFE[(mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE>=50 & mort_2017$ICD_10_1.CODE<=64))]<-1
mort_2017$VARICELL[(mort_2017$ICD_10_1.CHAPTER=="B" & (mort_2017$ICD_10_1.CODE==1))]<-1
mort_2017$MEASLESS[(mort_2017$ICD_10_1.CHAPTER=="B" & (mort_2017$ICD_10_1.CODE==5))]<-1
mort_2017$RUBELLAA[(mort_2017$ICD_10_1.CHAPTER=="B" & (mort_2017$ICD_10_1.CODE==6))]<-1 
mort_2017$VIRA.HEP[(mort_2017$ICD_10_1.CHAPTER=="B" & (mort_2017$ICD_10_1.CODE>=15 & mort_2017$ICD_10_1.CODE<=19))]<-1 
mort_2017$HIV.AIDS[(mort_2017$ICD_10_1.CHAPTER=="B" & (mort_2017$ICD_10_1.CODE>=20 & mort_2017$ICD_10_1.CODE<=24))]<-1 
mort_2017$MALARIAS[(mort_2017$ICD_10_1.CHAPTER=="B" & (mort_2017$ICD_10_1.CODE>=50 & mort_2017$ICD_10_1.CODE<=54))]<-1 
mort_2017$HAEM.MEN[(mort_2017$ICD_10_1.CHAPTER=="G" & (mort_2017$ICD_10_1.CODE==0))]<-1 
mort_2017$TUBERCUL[((mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE>=15 & mort_2017$ICD_10_1.CODE<=19))|
                      (mort_2017$ICD_10_1.CHAPTER=="B" & (mort_2017$ICD_10_1.CODE==90))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==65)))]<-1
mort_2017$UPG.CANC[(mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=16))]<-1
mort_2017$LIV.CANC[(mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==22))]<-1
mort_2017$LUN.CANC[(mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE>=33 & mort_2017$ICD_10_1.CODE<=34))]<-1
mort_2017$MESOTHEL[(mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==45))]<-1
mort_2017$MELANOMA[(mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==43))]<-1
mort_2017$BLA.CANC[(mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==67))]<-1
mort_2017$CER.CANC[(mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==53))]<-1
mort_2017$NUT.ANEM[(mort_2017$ICD_10_1.CHAPTER=="D" & (mort_2017$ICD_10_1.CODE>=50 & mort_2017$ICD_10_1.CODE<=53))]<-1
mort_2017$DIA.MELL[(mort_2017$ICD_10_1.CHAPTER=="E" & (mort_2017$ICD_10_1.CODE>=10 & mort_2017$ICD_10_1.CODE<=14))]<-1
mort_2017$AOR.ANEU[(mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE==71))]<-1
mort_2017$HYP.DISE[((mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE>=10 & mort_2017$ICD_10_1.CODE<=13))|
                      (mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE==15)))]<-1
mort_2017$ISH.HEAR[(mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE>=20 & mort_2017$ICD_10_1.CODE<=25))]<-1
mort_2017$CER.VASC[(mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE>=60 & mort_2017$ICD_10_1.CODE<=69))]<-1
mort_2017$ATH.DISE[(mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE==70 & mort_2017$ICD_10_1.CODE==73))]<-1
mort_2017$INFLUENZ[(mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE>=9 & mort_2017$ICD_10_1.CODE<=11))]<-1
mort_2017$PNE.STRE[(mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE>=13 & mort_2017$ICD_10_1.CODE<=14))]<-1
mort_2017$CHR.RESP[(mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE>=40 & mort_2017$ICD_10_1.CODE<=44))]<-1
mort_2017$LUN.DISE[((mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE>=60 & mort_2017$ICD_10_1.CODE<=64))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==66 & mort_2017$ICD_10_1.CODE<=70))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==82))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==92)))]<-1
mort_2017$TET.NEON[(mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE==33))]<-1
mort_2017$OBS.TETA[(mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE==34))]<-1
mort_2017$CER.CONG[((mort_2017$ICD_10_1.CHAPTER=="Q" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=1))|
                      (mort_2017$ICD_10_1.CHAPTER=="Q" & (mort_2017$ICD_10_1.CODE==5)))]<-1
mort_2017$TRAN.ACC[(mort_2017$ICD_10_1.CHAPTER=="V" & (mort_2017$ICD_10_1.CODE>=1 & mort_2017$ICD_10_1.CODE<=99))]<-1
mort_2017$ACCI.INJ[((mort_2017$ICD_10_1.CHAPTER=="W" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=39))|
                      (mort_2017$ICD_10_1.CHAPTER=="X" & (mort_2017$ICD_10_1.CODE>=49 & mort_2017$ICD_10_1.CODE<=59)))]<-1
mort_2017$INTE.HAR[(mort_2017$ICD_10_1.CHAPTER=="X" & (mort_2017$ICD_10_1.CODE>=66 & mort_2017$ICD_10_1.CODE<=84))]<-1
mort_2017$ASSA.LES[((mort_2017$ICD_10_1.CHAPTER=="X" & (mort_2017$ICD_10_1.CODE>=86 & mort_2017$ICD_10_1.CODE<=99))|
                      (mort_2017$ICD_10_1.CHAPTER=="Y" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=9)))]<-1
mort_2017$ALCH.DIS[((mort_2017$ICD_10_1.CHAPTER=="E" & (mort_2017$ICD_10_1.CODE==24))|
                      (mort_2017$ICD_10_1.CHAPTER=="F" & (mort_2017$ICD_10_1.CODE==10))|
                      (mort_2017$ICD_10_1.CHAPTER=="G" & (mort_2017$ICD_10_1.CODE==31))|
                      (mort_2017$ICD_10_1.CHAPTER=="G" & (mort_2017$ICD_10_1.CODE==62))|
                      (mort_2017$ICD_10_1.CHAPTER=="G" & (mort_2017$ICD_10_1.CODE==72))|
                      (mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE==42))|
                      (mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE==29))|
                      (mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE==70))|
                      (mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE==85))|
                      (mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE==86))|
                      (mort_2017$ICD_10_1.CHAPTER=="R" & (mort_2017$ICD_10_1.CODE==78))|
                      (mort_2017$ICD_10_1.CHAPTER=="X" & (mort_2017$ICD_10_1.CODE==45))|
                      (mort_2017$ICD_10_1.CHAPTER=="X" & (mort_2017$ICD_10_1.CODE==65))|
                      (mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE>=73 & mort_2017$ICD_10_1.CODE<=74))|
                      (mort_2017$ICD_10_1.CHAPTER=="Y" & (mort_2017$ICD_10_1.CODE==15)))]<-1
mort_2017$DRUG.REL[((mort_2017$ICD_10_1.CHAPTER=="F" & (mort_2017$ICD_10_1.CODE>=11 & mort_2017$ICD_10_1.CODE<=16))|
                      (mort_2017$ICD_10_1.CHAPTER=="F" & (mort_2017$ICD_10_1.CODE>=18 & mort_2017$ICD_10_1.CODE<=19))|
                      (mort_2017$ICD_10_1.CHAPTER=="X" & (mort_2017$ICD_10_1.CODE>=40 & mort_2017$ICD_10_1.CODE<=44))|
                      (mort_2017$ICD_10_1.CHAPTER=="X" & (mort_2017$ICD_10_1.CODE==85))|
                      (mort_2017$ICD_10_1.CHAPTER=="Y" & (mort_2017$ICD_10_1.CODE>=10 & mort_2017$ICD_10_1.CODE<=14))|
                      (mort_2017$ICD_10_1.CHAPTER=="X" & (mort_2017$ICD_10_1.CODE>=60 & mort_2017$ICD_10_1.CODE<=64)))]<-1

mort_2017$RESP.FAL[(mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==96))]<-1 #RESPIRATORY FAILLURE
mort_2017$FLUID.DI[(mort_2017$ICD_10_1.CHAPTER=="E" & (mort_2017$ICD_10_1.CODE==87))]<-1 #Other disorders of fluid, electrolyte and acid-base balance
mort_2017$SHOCK.AN[(mort_2017$ICD_10_1.CHAPTER=="R" & (mort_2017$ICD_10_1.CODE==57))]<-1 #Shock, not elsewhere classified

#Preventable mortality final coding

mort_2017$PREVENT<-NULL
mort_2017$PREVENT[((mort_2017$EDAD>=0 & mort_2017$EDAD<=74) & (mort_2017$INTE.DIS==1|
                                                                 mort_2017$DI.TE.PO==1|
                                                                 mort_2017$WHO.COUG==1|
                                                                 mort_2017$MENINGOC==1|
                                                                 mort_2017$SEPS.STR==1|
                                                                 mort_2017$HAE.INFL==1|
                                                                 mort_2017$SEX.INFE==1|
                                                                 mort_2017$VARICELL==1|
                                                                 mort_2017$MEASLESS==1|
                                                                 mort_2017$RUBELLAA==1|
                                                                 mort_2017$VIRA.HEP==1|
                                                                 mort_2017$HIV.AIDS==1|
                                                                 mort_2017$MALARIAS==1|
                                                                 mort_2017$HAEM.MEN==1|
                                                                 mort_2017$TUBERCUL==1|
                                                                 mort_2017$UPG.CANC==1|
                                                                 mort_2017$LIV.CANC==1|
                                                                 mort_2017$LUN.CANC==1|
                                                                 mort_2017$MESOTHEL==1|
                                                                 mort_2017$MELANOMA==1|
                                                                 mort_2017$BLA.CANC==1|
                                                                 mort_2017$CER.CANC==1|
                                                                 mort_2017$NUT.ANEM==1|
                                                                 mort_2017$DIA.MELL==1|
                                                                 mort_2017$AOR.ANEU==1|
                                                                 mort_2017$HYP.DISE==1|
                                                                 mort_2017$ISH.HEAR==1|
                                                                 mort_2017$CER.VASC==1|
                                                                 mort_2017$ATH.DISE==1|
                                                                 mort_2017$INFLUENZ==1|
                                                                 mort_2017$PNE.STRE==1|
                                                                 mort_2017$CHR.RESP==1|
                                                                 mort_2017$LUN.DISE==1|
                                                                 mort_2017$TET.NEON==1|
                                                                 mort_2017$OBS.TETA==1|
                                                                 mort_2017$CER.CONG==1|
                                                                 mort_2017$TRAN.ACC==1|
                                                                 mort_2017$ACCI.INJ==1|
                                                                 mort_2017$INTE.HAR==1|
                                                                 mort_2017$ASSA.LES==1|
                                                                 mort_2017$ALCH.DIS==1|
                                                                 mort_2017$DRUG.REL==1|
                                                                 mort_2017$RESP.FAL==1|
                                                                 mort_2017$FLUID.DI==1|
                                                                 mort_2017$SHOCK.AN==1))]<-1

#Treatable mortality specific causes

mort_2017$TUBERCUL[((mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE>=15 & mort_2017$ICD_10_1.CODE<=19))|
                      (mort_2017$ICD_10_1.CHAPTER=="B" & (mort_2017$ICD_10_1.CODE==90))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==65)))]<-1
mort_2017$FIE.SCAR[((mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE==38)))]<-1
mort_2017$SEPSIS.A[((mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE>=40 & mort_2017$ICD_10_1.CODE<=41)))]<-1
mort_2017$CELLULIS[((mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE==46))|
                      (mort_2017$ICD_10_1.CHAPTER=="L" & (mort_2017$ICD_10_1.CODE==3)))]<-1
mort_2017$LEGIONEL[((mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE==48)))]<-1
mort_2017$STRE.ENT[((mort_2017$ICD_10_1.CHAPTER=="A" & (mort_2017$ICD_10_1.CODE==49)))]<-1
mort_2017$MENINGIS[((mort_2017$ICD_10_1.CHAPTER=="G" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=3)))]<-1
mort_2017$CERV.CAN[((mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==53)))]<-1
mort_2017$COLO.CAN[((mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE>=18 & mort_2017$ICD_10_1.CODE<=21)))]<-1
mort_2017$BREA.CAN[((mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==50)))]<-1
mort_2017$UTER.CAN[((mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE>=54 & mort_2017$ICD_10_1.CODE<=55)))]<-1
mort_2017$TEST.CAN[((mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==62)))]<-1
mort_2017$THYR.CAN[((mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==73)))]<-1
mort_2017$HODG.CAN[((mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==81)))]<-1
mort_2017$LYMP.CAN[((mort_2017$ICD_10_1.CHAPTER=="C" & (mort_2017$ICD_10_1.CODE==91)))]<-1
mort_2017$BENI.CAN[((mort_2017$ICD_10_1.CHAPTER=="D" & (mort_2017$ICD_10_1.CODE>=10 & mort_2017$ICD_10_1.CODE<=36)))]<-1
mort_2017$DIA.MELL[(mort_2017$ICD_10_1.CHAPTER=="E" & (mort_2017$ICD_10_1.CODE>=10 & mort_2017$ICD_10_1.CODE<=14))]<-1
mort_2017$THRO.DIS[(mort_2017$ICD_10_1.CHAPTER=="E" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=7))]<-1
mort_2017$ADRE.DIS[(mort_2017$ICD_10_1.CHAPTER=="E" & (mort_2017$ICD_10_1.CODE>=24 & mort_2017$ICD_10_1.CODE<=27))]<-1
mort_2017$EPIL.DIS[(mort_2017$ICD_10_1.CHAPTER=="G" & (mort_2017$ICD_10_1.CODE>=40 & mort_2017$ICD_10_1.CODE<=41))]<-1
mort_2017$AOR.ANEU[(mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE==71))]<-1
mort_2017$HYP.DISE[((mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE>=10 & mort_2017$ICD_10_1.CODE<=13))|
                      (mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE==15)))]<-1
mort_2017$ISH.HEAR[(mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE>=20 & mort_2017$ICD_10_1.CODE<=25))]<-1
mort_2017$CER.VASC[(mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE>=60 & mort_2017$ICD_10_1.CODE<=69))]<-1
mort_2017$ATH.DISE[(mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE==70 & mort_2017$ICD_10_1.CODE==73))]<-1
mort_2017$RHE.DISE[(mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=9))]<-1
mort_2017$VEN.TROM[((mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE==26))|
                      (mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE==80))| 
                      (mort_2017$ICD_10_1.CHAPTER=="I" & (mort_2017$ICD_10_1.CODE==82)))]<-1
mort_2017$UPP.RESP[((mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=6))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE>=30 & mort_2017$ICD_10_1.CODE<=39)))]<-1
mort_2017$PNEU.UNS[((mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==12))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==15))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==16))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==17))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==18)))]<-1
mort_2017$AC.LOW.R[((mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==20 & mort_2017$ICD_10_1.CODE<=22)))]<-1
mort_2017$ASTH.BRO[((mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==45 & mort_2017$ICD_10_1.CODE<=47)))]<-1
mort_2017$SIRA.RES[((mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==80)))]<-1
mort_2017$PUL.EDEM[((mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==81)))]<-1
mort_2017$ABS.LUNG[((mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==85))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==86)))]<-1
mort_2017$OTH.PLER[((mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==90))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==93))|
                      (mort_2017$ICD_10_1.CHAPTER=="J" & (mort_2017$ICD_10_1.CODE==94)))]<-1
mort_2017$GAS.DUOD[((mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE>=25 & mort_2017$ICD_10_1.CODE<=28)))]<-1
mort_2017$APPENDIC[((mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE>=35 & mort_2017$ICD_10_1.CODE<=38)))]<-1
mort_2017$ABDO.HER[((mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE>=40 & mort_2017$ICD_10_1.CODE<=46)))]<-1
mort_2017$CHOLELIT[((mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE>=80 & mort_2017$ICD_10_1.CODE<=81)))]<-1
mort_2017$OTH.GALB[((mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE>=82 & mort_2017$ICD_10_1.CODE<=83)))]<-1
mort_2017$ACU.PANC[((mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE==85)))]<-1
mort_2017$OTH.PANC[((mort_2017$ICD_10_1.CHAPTER=="K" & (mort_2017$ICD_10_1.CODE==86)))]<-1
mort_2017$NEPH.NEP[((mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=7)))]<-1
mort_2017$OBS.UROP[((mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE==13))|
                      (mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE>=20 & mort_2017$ICD_10_1.CODE<=21))|
                      (mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE==35)))]<-1
mort_2017$REN.FAIL[((mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE>=17 & mort_2017$ICD_10_1.CODE<=19)))]<-1
mort_2017$REN.COLI[((mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE==23)))]<-1
mort_2017$TUB.DISF[((mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE==25)))]<-1
mort_2017$UNF.NEFP[((mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE>=26 & mort_2017$ICD_10_1.CODE<=27)))]<-1
mort_2017$INF.GENU[((mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE==34))|
                      (mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE==70))|
                      (mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE==73))|
                      (mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE==75))|
                      (mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE==76)))]<-1
mort_2017$PROS.HYP[((mort_2017$ICD_10_1.CHAPTER=="N" & (mort_2017$ICD_10_1.CODE==40)))]<-1
mort_2017$PRE.CHIL[((mort_2017$ICD_10_1.CHAPTER=="O" & (mort_2017$ICD_10_1.CODE>=0 & mort_2017$ICD_10_1.CODE<=99)))]<-1
mort_2017$CONG.CVD[((mort_2017$ICD_10_1.CHAPTER=="Q" & (mort_2017$ICD_10_1.CODE>=20 & mort_2017$ICD_10_1.CODE<=28)))]<-1
mort_2017$DRUGS.AE[((mort_2017$ICD_10_1.CHAPTER=="Y" & (mort_2017$ICD_10_1.CODE>=40 & mort_2017$ICD_10_1.CODE<=59)))]<-1
mort_2017$QX.DR.AE[((mort_2017$ICD_10_1.CHAPTER=="Y" & (mort_2017$ICD_10_1.CODE>=60 & mort_2017$ICD_10_1.CODE<=69))|
                      (mort_2017$ICD_10_1.CHAPTER=="Y" & (mort_2017$ICD_10_1.CODE>=83 & mort_2017$ICD_10_1.CODE<=84)))]<-1
mort_2017$MD.DR.AE[((mort_2017$ICD_10_1.CHAPTER=="Y" & (mort_2017$ICD_10_1.CODE>=70 & mort_2017$ICD_10_1.CODE<=82)))]<-1


#Treatable mortality final coding 

mort_2017$TREATAB<-NULL
mort_2017$TREATAB[((mort_2017$EDAD>=0 & mort_2017$EDAD<=74) & (mort_2017$TUBERCUL==1|
                                                                 mort_2017$FIE.SCAR==1|
                                                                 mort_2017$SEPSIS.A==1|
                                                                 mort_2017$CELLULIS==1|
                                                                 mort_2017$LEGIONEL==1|
                                                                 mort_2017$STRE.ENT==1|
                                                                 mort_2017$MENINGIS==1|
                                                                 mort_2017$COLO.CAN==1|
                                                                 mort_2017$CERV.CAN==1|
                                                                 mort_2017$BREA.CAN==1|
                                                                 mort_2017$UTER.CAN==1|
                                                                 mort_2017$TEST.CAN==1|
                                                                 mort_2017$THYR.CAN==1|
                                                                 mort_2017$HODG.CAN==1|
                                                                 mort_2017$LYMP.CAN==1|
                                                                 mort_2017$BENI.CAN==1|
                                                                 mort_2017$DIA.MELL==1|
                                                                 mort_2017$THRO.DIS==1|
                                                                 mort_2017$ADRE.DIS==1|
                                                                 mort_2017$EPIL.DIS==1|
                                                                 mort_2017$AOR.ANEU==1|
                                                                 mort_2017$HYP.DISE==1|
                                                                 mort_2017$ISH.HEAR==1|
                                                                 mort_2017$CER.VASC==1|
                                                                 mort_2017$ATH.DISE==1|
                                                                 mort_2017$RHE.DISE==1|
                                                                 mort_2017$VEN.TROM==1|
                                                                 mort_2017$UPP.RESP==1|
                                                                 mort_2017$PNEU.UNS==1|
                                                                 mort_2017$AC.LOW.R==1|
                                                                 mort_2017$ASTH.BRO==1|
                                                                 mort_2017$SIRA.RES==1|
                                                                 mort_2017$PUL.EDEM==1|
                                                                 mort_2017$ABS.LUNG==1|
                                                                 mort_2017$OTH.PLER==1|
                                                                 mort_2017$GAS.DUOD==1|
                                                                 mort_2017$APPENDIC==1|
                                                                 mort_2017$ABDO.HER==1|
                                                                 mort_2017$CHOLELIT==1|
                                                                 mort_2017$OTH.GALB==1|
                                                                 mort_2017$ACU.PANC==1|
                                                                 mort_2017$OTH.PANC==1|
                                                                 mort_2017$NEPH.NEP==1|
                                                                 mort_2017$OBS.UROP==1|
                                                                 mort_2017$REN.FAIL==1|
                                                                 mort_2017$REN.COLI==1|
                                                                 mort_2017$TUB.DISF==1|
                                                                 mort_2017$UNF.NEFP==1|
                                                                 mort_2017$INF.GENU==1|
                                                                 mort_2017$PROS.HYP==1|
                                                                 mort_2017$PRE.CHIL==1|
                                                                 mort_2017$CONG.CVD==1|
                                                                 mort_2017$DRUGS.AE==1|
                                                                 mort_2017$QX.DR.AE==1|
                                                                 mort_2017$MD.DR.AE==1))]<-1
#Final coding

mort_2017$TREA.PREV<-NULL
mort_2017$TREA.PREV[mort_2017$TREATAB==1 & (is.na(mort_2017$PREVENT) & !is.na(mort_2017$CAUSA_MUERTE_ICD_10_CATEGORIA_1))]<-1
mort_2017$TREA.PREV[mort_2017$PREVENT==1 & (is.na(mort_2017$TREATAB) & !is.na(mort_2017$CAUSA_MUERTE_ICD_10_CATEGORIA_1))]<-2
mort_2017$TREA.PREV[mort_2017$TREATAB==1 & mort_2017$PREVENT==1]<-3
mort_2017$TREA.PREV[(!is.na(mort_2017$CAUSA_MUERTE_ICD_10_CATEGORIA_1)) & (is.na(mort_2017$TREATAB) & is.na(mort_2017$PREVENT))]<-4

#Cause Specific

mort_2017$ICD_10_1.SUB<-as.numeric(substring(mort_2017$CAUSA_MUERTE_ICD_10_CATEGORIA_1,4))

## Intestinal Infectious Diseases ##
mort_2017$EII.COLE<-NULL; mort_2017$EII.COLE[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==0))]<-1 #Cholera
mort_2017$EII.TIPA<-NULL; mort_2017$EII.TIPA[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==1))]<-1 #Typhoid and paratyphoid fever
mort_2017$EII.SHIG<-NULL; mort_2017$EII.SHIG[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==3))]<-1 #Shigellosis
mort_2017$EII.TOXI<-NULL; mort_2017$EII.TOXI[with(mort_2017, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==2|ICD_10_1.CODE==5)))]<-1 #Food poisoning
mort_2017$EII.AMEB<-NULL; mort_2017$EII.AMEB[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==6))]<-1 #Amebiasis
mort_2017$EII.OTRA<-NULL; mort_2017$EII.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==4|ICD_10_1.CODE==7|ICD_10_1.CODE==8)))]<-1 #Other GI infection
mort_2017$EII.PRES<-NULL; mort_2017$EII.PRES[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==9))]<-1 #Presumed GI infection

## Tuberculosis ##
mort_2017$TUB.PULM<-NULL; mort_2017$TUB.PULM[with(mort_2017,(ICD_10_1.CHAPTER=="A" & #Pulmonary TB
                                                               ((ICD_10_1.CODE==15 & (ICD_10_1.SUB<=3|ICD_10_1.SUB==7|ICD_10_1.SUB==9))|
                                                                  (ICD_10_1.CODE==16 & (ICD_10_1.SUB<=2|ICD_10_1.SUB==7|ICD_10_1.SUB==9)) ) ))]<-1 
mort_2017$TUB.RESP<-NULL; mort_2017$TUB.RESP[with(mort_2017,(ICD_10_1.CHAPTER=="A" & #Other respiratory TB
                                                               ((ICD_10_1.CODE==15 & (ICD_10_1.SUB==4|ICD_10_1.SUB==5|ICD_10_1.SUB==6|ICD_10_1.SUB==8))|
                                                                  (ICD_10_1.CODE==16 & (ICD_10_1.SUB==3|ICD_10_1.SUB==4|ICD_10_1.SUB==5|ICD_10_1.SUB==8)))))]<-1 
mort_2017$TUB.NERV<-NULL; mort_2017$TUB.NERV[with(mort_2017, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==17) ))]<-1 #Nervous System TB
mort_2017$TUB.IPGM<-NULL; mort_2017$TUB.IPGM[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==3))]<-1 #Intestinal/peritoneal Tb
mort_2017$TUB.BONE<-NULL; mort_2017$TUB.BONE[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==0))]<-1 #Bone and joint Tb
mort_2017$TUB.URIN<-NULL; mort_2017$TUB.URIN[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==1))]<-1 #Genitourinary Tb
mort_2017$TUB.OTRA<-NULL; mort_2017$TUB.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="A" & #Other Tb
                                                                ((ICD_10_1.CODE==18 & (ICD_10_1.SUB==2|ICD_10_1.SUB>=4))|(ICD_10_1.CODE==19)) )) ]<-1

## Other bacterial diseases ##
mort_2017$BAC.PEST<-NULL; mort_2017$BAC.PEST[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==20))]<-1 #Plague (peste)
mort_2017$BAC.BRUS<-NULL; mort_2017$BAC.BRUS[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==23))]<-1 #Brusellosis
mort_2017$BAC.LEPR<-NULL; mort_2017$BAC.LEPR[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==30))]<-1 #Leprosy
mort_2017$BAC.DIFT<-NULL; mort_2017$BAC.DIFT[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==36))]<-1 #Diphtheria
mort_2017$BAC.PERT<-NULL; mort_2017$BAC.PERT[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==37))]<-1 #Pertussis
mort_2017$BAC.PYOG<-NULL; mort_2017$BAC.PYOG[with(mort_2017, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==38|ICD_10_1.CODE==46)))]<-1 #Scarlet fever, erysipelas
mort_2017$BAC.MENI<-NULL; mort_2017$BAC.MENI[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==39))]<-1 #Meningococcal disease
mort_2017$BAC.TETA<-NULL; mort_2017$BAC.TETA[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==35))]<-1 #Tetanus
mort_2017$BAC.SEPS<-NULL; mort_2017$BAC.SEPS[with(mort_2017, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==40|ICD_10_1.CODE==41) ))]<-1 #Sepsis
mort_2017$BAC.OTRA<-NULL; mort_2017$BAC.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="A" &
                                                                (ICD_10_1.CODE==21|ICD_10_1.CODE==22|(ICD_10_1.CODE>=24&ICD_10_1.CODE<=28)|
                                                                   ICD_10_1.CODE==31|ICD_10_1.CODE==32|(ICD_10_1.CODE>=42&ICD_10_1.CODE<=44)|
                                                                   ICD_10_1.CODE==48|ICD_10_1.CODE==49)))]<-1 #Other

## Sexually transmitted diseases ##
mort_2017$ETS.SIF1<-NULL; mort_2017$ETS.SIF1[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==50))]<-1 #Congenital syphilis
mort_2017$ETS.SIF2<-NULL; mort_2017$ETS.SIF2[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==51))]<-1 #Early syphilis
mort_2017$ETS.SIF3<-NULL; mort_2017$ETS.SIF3[with(mort_2017, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==52|ICD_10_1.CODE==53)))]<-1 #Other syphilis
mort_2017$ETS.GONO<-NULL; mort_2017$ETS.GONO[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==54))]<-1 #Gonorrhea
mort_2017$ETS.CLAM<-NULL; mort_2017$ETS.CLAM[with(mort_2017, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==55|ICD_10_1.CODE==56)))]<-1 #Chlamydia
mort_2017$ETS.OTRA<-NULL; mort_2017$ETS.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE>=57&ICD_10_1.CODE<=64)))]<-1 #Other STD



## Viral diseases ##
mort_2017$VIR.POLI<-NULL; mort_2017$VIR.POLI[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==80))]<-1 #Acute Poliomyelitis
mort_2017$VIR.VIRU<-NULL; mort_2017$VIR.VIRU[with(mort_2017, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==3|ICD_10_1.CODE==4)))]<-1 #Smallpox (viruela)
mort_2017$VIR.SARA<-NULL; mort_2017$VIR.SARA[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==5))]<-1 #Measles
mort_2017$VIR.RUBE<-NULL; mort_2017$VIR.RUBE[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==6))]<-1 #Rubella
mort_2017$VIR.FIAM<-NULL; mort_2017$VIR.FIAM[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==95))]<-1 #Yellow fever
mort_2017$VIR.DENG<-NULL; mort_2017$VIR.DENG[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==90))]<-1 #Dengue fever
mort_2017$VIR.DHEM<-NULL; mort_2017$VIR.DHEM[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==91))]<-1 #Dengue hemorragic fever
mort_2017$VIR.VIH1<-NULL; mort_2017$VIR.VIH1[with(mort_2017, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=24)))]<-1 #HIV infection
mort_2017$VIR.EVTA<-NULL; mort_2017$VIR.EVTA[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE==85&ICD_10_1.SUB==2)| #Arthropod-Borne Viral Encephalitis
                                                                                         ICD_10_1.CODE==83|ICD_10_1.CODE==84|ICD_10_1.CODE==86)))]<-1 
mort_2017$VIR.HEPB<-NULL; mort_2017$VIR.HEPB[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==16))]<-1 #Acute Hepatitis B
mort_2017$VIR.HEPO<-NULL; mort_2017$VIR.HEPO[with(mort_2017, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==15| #Other viral hepatitis
                                                                                         (ICD_10_1.CODE>=17&ICD_10_1.CODE<=19))))]<-1 
mort_2017$VIR.RABI<-NULL; mort_2017$VIR.RABI[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==82))]<-1 #Rabies
mort_2017$VIR.TRAC<-NULL; mort_2017$VIR.TRAC[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==71))]<-1 #Trachoma (??)


#Other arthropod-borne viral fevers and viral hemorrhagic fevers
mort_2017$VIR.OFAH<-NULL; mort_2017$VIR.OFAH[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE>=92&ICD_10_1.CODE<=94)|
                                                                                         (ICD_10_1.CODE>=96&ICD_10_1.CODE<=99))))]<-1 
mort_2017$VIR.HERP<-NULL; mort_2017$VIR.HERP[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==0))]<-1 #Herpes simplex infections
mort_2017$VIR.VRHZ<-NULL; mort_2017$VIR.VRHZ[with(mort_2017, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==1|ICD_10_1.CODE==2) ))]<-1 #Chickenpox or herpes zoster
mort_2017$VIR.PARO<-NULL; mort_2017$VIR.PARO[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==26))]<-1 #Mumps
mort_2017$VIR.OCLA<-NULL; mort_2017$VIR.OCLA[with(mort_2017, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==70|ICD_10_1.CODE==74)))]<-1 #Other chlamydia infections (??)
mort_2017$VIR.OTRA<-NULL; mort_2017$VIR.OTRA[with(mort_2017, ((ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE==85&(ICD_10_1.SUB==0|ICD_10_1.SUB==1|ICD_10_1.SUB==8))|
                                                                                          ICD_10_1.CODE==81|(ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)))|
                                                                (ICD_10_1.CHAPTER=="B" & ((ICD_10_1.CODE>=7&ICD_10_1.CODE<=9)|ICD_10_1.CODE==25|
                                                                                            (ICD_10_1.CODE>=27&ICD_10_1.CODE<=34)))))]<-1 #Other viral diseases


## Rickettsiosis and Protozoan Infections ##
mort_2017$RPI.TIFP<-NULL; mort_2017$RPI.TIFP[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==75 & ICD_10_1.SUB==0))]<-1 #Louse-borne epidemic thypus
mort_2017$RPI.OTIF<-NULL; mort_2017$RPI.OTIF[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==75 & ICD_10_1.SUB!=0))]<-1 #Other thypus
mort_2017$RPI.ORIC<-NULL; mort_2017$RPI.ORIC[with(mort_2017, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE>=77&ICD_10_1.CODE<=79) ))]<-1 #Other rickettsiosis
mort_2017$RPI.PALU<-NULL; mort_2017$RPI.PALU[with(mort_2017, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=54) ))]<-1 #Malaria
mort_2017$RPI.LEIS<-NULL; mort_2017$RPI.LEIS[with(mort_2017, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==55) ))]<-1 #Leishmaniasis
mort_2017$RPI.TRIP<-NULL; mort_2017$RPI.TRIP[with(mort_2017, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==56|ICD_10_1.CODE==57) ))]<-1 #Trypanosomiasis

## Parasitic worms, Mycosis and Other infectious diseases ##
mort_2017$PMO.ESPI<-NULL; mort_2017$PMO.ESPI[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE>=65&ICD_10_1.CODE<=67)|
                                                                                         ICD_10_1.CODE==69)))]<-1 #Other spirochetal diseases (Not syphilis)
mort_2017$PMO.FIRE<-NULL; mort_2017$PMO.FIRE[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==68))]<-1 #Relapsing fevers
mort_2017$PMO.MICO<-NULL; mort_2017$PMO.MICO[with(mort_2017, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=49) ))]<-1 #Mycosis 
mort_2017$PMO.SCHI<-NULL; mort_2017$PMO.SCHI[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==65))]<-1 #Schistosomiasis
mort_2017$PMO.TREM<-NULL; mort_2017$PMO.TREM[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==66))]<-1 #Other fluke (trematoda) infections
mort_2017$PMO.ECHI<-NULL; mort_2017$PMO.ECHI[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==67))]<-1 #Echinococcosis
mort_2017$PMO.DRAC<-NULL; mort_2017$PMO.DRAC[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==72))]<-1 #Dracunculiasis
mort_2017$PMO.ONCH<-NULL; mort_2017$PMO.ONCH[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==73))]<-1 #Onchocerciasis
mort_2017$PMO.FILA<-NULL; mort_2017$PMO.FILA[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==74))]<-1 #Filariasis
mort_2017$PMO.ANNE<-NULL; mort_2017$PMO.ANNE[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==76))]<-1 #Ancylostomiasis or Necatoriasis
mort_2017$PMO.HELM<-NULL; mort_2017$PMO.HELM[with(mort_2017, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==75|(ICD_10_1.CODE>=68&ICD_10_1.CODE<=71)|
                                                                                         (ICD_10_1.CODE>=77&ICD_10_1.CODE<=83))))]<-1 #Other Helminthiases
mort_2017$PMO.OTRA<-NULL; mort_2017$PMO.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==99|(ICD_10_1.CODE>=58&ICD_10_1.CODE<=64)|
                                                                                         (ICD_10_1.CODE>=85&ICD_10_1.CODE<=89)| 
                                                                                         (ICD_10_1.CODE>=95&ICD_10_1.CODE<=97))))]<-1 #Other infectious/parasitic disease

## Sequelae of infectious diseases ##
mort_2017$SEI.TUBE<-NULL; mort_2017$SEI.TUBE[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==90))]<-1 #Tuberculosis sequelae
mort_2017$SEI.POLI<-NULL; mort_2017$SEI.POLI[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==91))]<-1 #Poliomyelitis sequelae
mort_2017$SEI.LEPR<-NULL; mort_2017$SEI.LEPR[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==92))]<-1 #Leprosy sequelae
mort_2017$SEI.OTRA<-NULL; mort_2017$SEI.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==94))]<-1 #Sequelae from other infections

## Malignant neoplasms 1: lip, oral cavity and pharynx ##
mort_2017$NM1.LCBF<-NULL; mort_2017$NM1.LCBF[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=14)))]<-1

## Malignant neoplasms 2: digestive organs ##
mort_2017$NM2.ESOF<-NULL; mort_2017$NM2.ESOF[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==15))]<-1 #Esophagus
mort_2017$NM2.STOM<-NULL; mort_2017$NM2.STOM[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==16))]<-1 #Stomach
mort_2017$NM2.INDE<-NULL; mort_2017$NM2.INDE[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==17))]<-1 #Small intestine
mort_2017$NM2.COLO<-NULL; mort_2017$NM2.COLO[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==18))]<-1 #Colon
mort_2017$NM2.RECT<-NULL; mort_2017$NM2.RECT[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=19&ICD_10_1.CODE<=21)))]<-1 #Rectosigmoid junction, Rectum, Anus and anal canal
mort_2017$NM2.HIGA<-NULL; mort_2017$NM2.HIGA[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==22))]<-1 #Liver and intrahepatic bile ducts
mort_2017$NM2.PANC<-NULL; mort_2017$NM2.PANC[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==25))]<-1 #Pancreas
mort_2017$NM2.OTRO<-NULL; mort_2017$NM2.OTRO[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==23|ICD_10_1.CODE==24|ICD_10_1.CODE==26)))]<-1 #Other

## Malignant neoplasms 3: respiratory and intrathoracic organs ##
mort_2017$NM3.LARI<-NULL; mort_2017$NM3.LARI[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==32))]<-1 #Larynx
mort_2017$NM3.TBPU<-NULL; mort_2017$NM3.TBPU[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==33|ICD_10_1.CODE==34)))]<-1 #Trachea, bronchus and lung
mort_2017$NM3.OTRO<-NULL; mort_2017$NM3.OTRO[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==30|ICD_10_1.CODE==31|
                                                                                         (ICD_10_1.CODE>=37&ICD_10_1.CODE<=39))))]<-1 #Other

## Malignant neoplasms 4: bone, articular cartilage, skin, soft tissues and breast ##
mort_2017$NM4.BONE<-NULL; mort_2017$NM4.BONE[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==40|ICD_10_1.CODE==41)))]<-1 #Bone and articular cartilage
mort_2017$NM4.MELA<-NULL; mort_2017$NM4.MELA[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==43))]<-1 #Malignant melanoma of skin
mort_2017$NM4.SKIN<-NULL; mort_2017$NM4.SKIN[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==44))]<-1 #Other malignant neoplasm of skin
mort_2017$NM4.MAMA<-NULL; mort_2017$NM4.MAMA[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==50))]<-1 #Breast
mort_2017$NM4.SOFT<-NULL; mort_2017$NM4.SOFT[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=45&ICD_10_1.CODE<=49)))]<-1 #Mesothelial and soft tissue

## Malignant neoplasms 5: genitourinary organs ##
mort_2017$NM5.CERV<-NULL; mort_2017$NM5.CERV[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==53))]<-1 #Cervix uteri
mort_2017$NM5.PLAC<-NULL; mort_2017$NM5.PLAC[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==58))]<-1 #Placenta
mort_2017$NM5.UTER<-NULL; mort_2017$NM5.UTER[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==54|ICD_10_1.CODE==55)))]<-1 #Uterus
mort_2017$NM5.OVAR<-NULL; mort_2017$NM5.OVAR[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==56))]<-1 #Ovary
mort_2017$NM5.VAGI<-NULL; mort_2017$NM5.VAGI[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==51|ICD_10_1.CODE==52)))]<-1 #Vulva and vagina
mort_2017$NM5.OTFE<-NULL; mort_2017$NM5.OTFE[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==57))]<-1 #Other and unspecified (female)
mort_2017$NM5.PROS<-NULL; mort_2017$NM5.PROS[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==61))]<-1 #Prostate
mort_2017$NM5.TEST<-NULL; mort_2017$NM5.TEST[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==62))]<-1 #Testis
mort_2017$NM5.OTMA<-NULL; mort_2017$NM5.OTMA[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==60|ICD_10_1.CODE==63)))]<-1 #Other and unspecified (male)
mort_2017$NM5.VEJI<-NULL; mort_2017$NM5.VEJI[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==67))]<-1 #Bladder
mort_2017$NM5.OTUR<-NULL; mort_2017$NM5.OTUR[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ((ICD_10_1.CODE>=64&ICD_10_1.CODE<=66)|
                                                                                         ICD_10_1.CODE==68)))]<-1 #Other urinary tract neoplasms


## Malignant neoplasms 6: other organs and unspecified sites ##
mort_2017$NM6.ENCF<-NULL; mort_2017$NM6.ENCF[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==71))]<-1 #Brain
mort_2017$NM6.MENI<-NULL; mort_2017$NM6.MENI[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==70|ICD_10_1.CODE==72)))]<-1 #Meninges and other SNC
mort_2017$NM6.OJOA<-NULL; mort_2017$NM6.OJOA[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==69))]<-1 #Eyes and adnexa
mort_2017$NM6.OTRO<-NULL; mort_2017$NM6.OTRO[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=73&ICD_10_1.CODE<=80)))]<-1 #Other and unspecified

## Malignant neoplasms 7: lymphoid, hematopoietic and related tissue ##
mort_2017$NM7.ENHO<-NULL; mort_2017$NM7.ENHO[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==81))]<-1 #Hodgkin lymphoma
mort_2017$NM7.NOHO<-NULL; mort_2017$NM7.NOHO[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=82&ICD_10_1.CODE<=85)))]<-1 #Non-Hodgkin lymphoma
mort_2017$NM7.MMCP<-NULL; mort_2017$NM7.MMCP[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==90))]<-1 #Multiple myeloma and plasmatic cell neoplasms
mort_2017$NM7.LEUC<-NULL; mort_2017$NM7.LEUC[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=91&ICD_10_1.CODE<=95)))]<-1 #Leukemias
mort_2017$NM7.OTRO<-NULL; mort_2017$NM7.OTRO[with(mort_2017, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==88|ICD_10_1.CODE==96)))]<-1 #Other


## Malignant neoplasms 8: multiple primary tumors ##
mort_2017$NM8.MUPT<-NULL; mort_2017$NM8.MUPT[with(mort_2017, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==97))]<-1

## In situ neoplasms ##
mort_2017$NIS.CERV<-NULL; mort_2017$NIS.CERV[with(mort_2017, (ICD_10_1.CHAPTER=="D" & ICD_10_1.CODE==6))]<-1 #Cervix uteri
mort_2017$NIS.OTRO<-NULL; mort_2017$NIS.OTRO[with(mort_2017, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=5)| #Other in situ neoplasms
                                                                                         (ICD_10_1.CODE>=7&ICD_10_1.CODE<=9))))]<-1

## Benign neoplasms ##
mort_2017$NBE.SKIN<-NULL; mort_2017$NBE.SKIN[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==22|ICD_10_1.CODE==23) ))]<-1 #Skin
mort_2017$NBE.MAMA<-NULL; mort_2017$NBE.MAMA[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==24)))]<-1 #Breast
mort_2017$NBE.LEIO<-NULL; mort_2017$NBE.LEIO[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==25)))]<-1 #Leiomyoma of uterus
mort_2017$NBE.OVAR<-NULL; mort_2017$NBE.OVAR[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==27)))]<-1 #Ovary
mort_2017$NBE.URIN<-NULL; mort_2017$NBE.URIN[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==30)))]<-1 #Urinary tract
mort_2017$NBE.CSNC<-NULL; mort_2017$NBE.CSNC[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==33)))]<-1 #Brain and other CNS sites
mort_2017$NBE.TIRO<-NULL; mort_2017$NBE.TIRO[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==34)))]<-1 #Thyroid
mort_2017$NBE.OTRO<-NULL; mort_2017$NBE.OTRO[with(mort_2017, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=21)|ICD_10_1.CODE==26|
                                                                                         ICD_10_1.CODE==28|ICD_10_1.CODE==29|ICD_10_1.CODE==31|
                                                                                         ICD_10_1.CODE==32|ICD_10_1.CODE==35|ICD_10_1.CODE==36)))]<-1 #Other


## Neoplasms of uncertain behaviour ##
mort_2017$NCI.UNCB<-NULL; mort_2017$NCI.UNCB[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=37&ICD_10_1.CODE<=48)))]<-1

## Diseases of the blood and blood-forming organs and certain disorders involving the immune mechanism ##
mort_2017$SAN.ADFE<-NULL; mort_2017$SAN.ADFE[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==50)))]<-1 #Iron deficiency anemia
mort_2017$SAN.AOTR<-NULL; mort_2017$SAN.AOTR[with(mort_2017, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=51&ICD_10_1.CODE<=62)|ICD_10_1.CODE==64)))]<-1 #Other anemias
mort_2017$SAN.INMU<-NULL; mort_2017$SAN.INMU[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=89)))]<-1 #Immunity disorders
mort_2017$SAN.OTRA<-NULL; mort_2017$SAN.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=65&ICD_10_1.CODE<=76)))]<-1 #Other

## Endocrine and metabolic diseases ##
mort_2017$END.DEYO<-NULL; mort_2017$END.DEYO[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)))]<-1 #Iodine deficiency thyroid disorders
mort_2017$END.TTOX<-NULL; mort_2017$END.TTOX[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==5)))]<-1 #Thyrotoxicosis
mort_2017$END.TOTR<-NULL; mort_2017$END.TOTR[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==3|ICD_10_1.CODE==4|ICD_10_1.CODE==6|
                                                                                         ICD_10_1.CODE==7) ))]<-1 #Other thyroid disorders
mort_2017$END.DIAB<-NULL; mort_2017$END.DIAB[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=14)))]<-1 #Type 2 diabetes mellitus
mort_2017$END.LIPO<-NULL; mort_2017$END.LIPO[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==78)))]<-1 #Metabolism disorders and dyslipidemia
mort_2017$END.OBES<-NULL; mort_2017$END.OBES[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==66)))]<-1 #Obesity
mort_2017$END.DEPL<-NULL; mort_2017$END.DEPL[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==86)))]<-1 #Volume depletion
mort_2017$END.SQHA<-NULL; mort_2017$END.SQHA[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==68)))]<-1 #Sequelae of hyperalimentation
mort_2017$END.OTRA<-NULL; mort_2017$END.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="E" & ((ICD_10_1.CODE>=15&ICD_10_1.CODE<=34)|ICD_10_1.CODE==65|
                                                                                         ICD_10_1.CODE==67|(ICD_10_1.CODE>=70&ICD_10_1.CODE<=77)|
                                                                                         (ICD_10_1.CODE>=79&ICD_10_1.CODE<=85)|
                                                                                         (ICD_10_1.CODE>=87&ICD_10_1.CODE<=88))))]<-1 #Other


## Malnutrition and other nutritional deficiencies ##
mort_2017$NUT.KWAS<-NULL; mort_2017$NUT.KWAS[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==40|ICD_10_1.CODE==42) ))]<-1 #Kwashiorkor
mort_2017$NUT.MARA<-NULL; mort_2017$NUT.MARA[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==41) ))]<-1 #Nutritional marasmus
mort_2017$NUT.PROT<-NULL; mort_2017$NUT.PROT[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=43&ICD_10_1.CODE<=46)))]<-1 #Other protein-calorie malnutrition
mort_2017$NUT.VITA<-NULL; mort_2017$NUT.VITA[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==50) ))]<-1 #Vitamin A deficiency
mort_2017$NUT.VITO<-NULL; mort_2017$NUT.VITO[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=51&ICD_10_1.CODE<=56)))]<-1 #Other vitamin deficiencies
mort_2017$NUT.SECD<-NULL; mort_2017$NUT.SECD[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==64) ))]<-1 #Sequelae of malnutrition
mort_2017$NUT.OTRA<-NULL; mort_2017$NUT.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=63)))]<-1 #Other nutritional deficiencies


## Mental, Behavioral and Neurodevelopmental disorders ##
mort_2017$MEN.DEME<-NULL; mort_2017$MEN.DEME[with(mort_2017, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE==1|ICD_10_1.CODE==3)))]<-1 #Dementia
mort_2017$MEN.SDAL<-NULL; mort_2017$MEN.SDAL[with(mort_2017, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==10 & ICD_10_1.SUB==2))]<-1 #Alcohol dependence syndrome
mort_2017$MEN.OTAL<-NULL; mort_2017$MEN.OTAL[with(mort_2017, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==10 & ICD_10_1.SUB!=2))]<-1 #Other alcohol related disorders
mort_2017$MEN.TMSP<-NULL; mort_2017$MEN.TMSP[with(mort_2017, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=11&ICD_10_1.CODE<=19)))]<-1 #Mental and behavioral disorders due to other psychoactive substances use
mort_2017$MEN.ESQU<-NULL; mort_2017$MEN.ESQU[with(mort_2017, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=29)))]<-1 #Schizophrenia, schizotypal, delusional, and other non-mood psychotic disorders
mort_2017$MEN.HUMO<-NULL; mort_2017$MEN.HUMO[with(mort_2017, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=39)))]<-1 #Mood [affective] disorders
mort_2017$MEN.ESTR<-NULL; mort_2017$MEN.ESTR[with(mort_2017, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=48)))]<-1 #Anxiety, dissociative, stress-related, somatoform and other nonpsychotic mental disorders
mort_2017$MEN.FISI<-NULL; mort_2017$MEN.FISI[with(mort_2017, (ICD_10_1.CHAPTER=="F" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=59)&
                                                                                         (ICD_10_1.CODE!=53) )))]<-1 #Behavioral syndromes associated with physiological disturbances and physical factors
mort_2017$MEN.RETR<-NULL; mort_2017$MEN.RETR[with(mort_2017, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=70&ICD_10_1.CODE<=79)))]<-1 #Intellectual disabilities
mort_2017$MEN.OTRO<-NULL; mort_2017$MEN.OTRO[with(mort_2017, (ICD_10_1.CHAPTER=="F" & ((ICD_10_1.CODE>=4&ICD_10_1.CODE<=9)|(ICD_10_1.CODE>=60&ICD_10_1.CODE<=69)|
                                                                                         (ICD_10_1.CODE>=80&ICD_10_1.CODE<=99))))]<-1 #Other mental and behavioral disorders



## Diseases of the nervous system ##
mort_2017$NER.MENI<-NULL; mort_2017$NER.MENI[with(mort_2017, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==0|ICD_10_1.CODE==3)))]<-1 #Meningitis
mort_2017$NER.ISNC<-NULL; mort_2017$NER.ISNC[with(mort_2017, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=4&ICD_10_1.CODE<=9)))]<-1 #Other inflammatory diseases of the central nervous system
mort_2017$NER.PARK<-NULL; mort_2017$NER.PARK[with(mort_2017, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==20)))]<-1 #Parkinson's disease
mort_2017$NER.ALZH<-NULL; mort_2017$NER.ALZH[with(mort_2017, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==30)))]<-1 #Alzheimer's disease
mort_2017$NER.ESCM<-NULL; mort_2017$NER.ESCM[with(mort_2017, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==35)))]<-1 #Multiple sclerosis
mort_2017$NER.PALS<-NULL; mort_2017$NER.PALS[with(mort_2017, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=83)))]<-1 #Cerebral palsy and other paralytic syndromes
mort_2017$NER.EPIL<-NULL; mort_2017$NER.EPIL[with(mort_2017, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=41)))]<-1 #Epilepsy and recurrent seizures
mort_2017$NER.MIGR<-NULL; mort_2017$NER.MIGR[with(mort_2017, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=43&ICD_10_1.CODE<=44)))]<-1 #Migraine and other headache syndromes
mort_2017$NER.IQCT<-NULL; mort_2017$NER.IQCT[with(mort_2017, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==45)))]<-1 #Transient cerebral ischemic attacks and related syndromes
mort_2017$NER.SNPE<-NULL; mort_2017$NER.SNPE[with(mort_2017, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=59)))]<-1 #Nerve, nerve root and plexus disorders
mort_2017$NER.OTRA<-NULL; mort_2017$NER.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="G" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=12)|(ICD_10_1.CODE>=21&ICD_10_1.CODE<=25)|
                                                                                         (ICD_10_1.CODE==31)|(ICD_10_1.CODE==36)|(ICD_10_1.CODE==37)|(ICD_10_1.CODE==47)|
                                                                                         (ICD_10_1.CODE>=60&ICD_10_1.CODE<=62)|(ICD_10_1.CODE>=64&ICD_10_1.CODE<=72)|
                                                                                         (ICD_10_1.CODE>=90&ICD_10_1.CODE<=93)|(ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other



## Diseases of the eye and adnexa ##
mort_2017$EYE.PARP<-NULL; mort_2017$EYE.PARP[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Eyelid inflammation
mort_2017$EYE.ESCL<-NULL; mort_2017$EYE.ESCL[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=15&ICD_10_1.CODE<=19)))]<-1 #Disorders of sclera and cornea
mort_2017$EYE.GLAU<-NULL; mort_2017$EYE.GLAU[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==40)))]<-1 #Glaucoma
mort_2017$EYE.CATA<-NULL; mort_2017$EYE.CATA[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=25&ICD_10_1.CODE<=26)))]<-1 #Cataracts
mort_2017$EYE.CRIS<-NULL; mort_2017$EYE.CRIS[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==27)))]<-1 #Other disorders of lens
mort_2017$EYE.RETI<-NULL; mort_2017$EYE.RETI[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==33)))]<-1 #Retinal detachments and breaks
mort_2017$EYE.CEGU<-NULL; mort_2017$EYE.CEGU[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==54)))]<-1 #Blindness and low vision
mort_2017$EYE.CONJ<-NULL; mort_2017$EYE.CONJ[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==10)))]<-1 #Conjunctivitis
mort_2017$EYE.OTCO<-NULL; mort_2017$EYE.OTCO[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==11)))]<-1 #Other disorders of conjunctiva
mort_2017$EYE.LAGR<-NULL; mort_2017$EYE.LAGR[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==4)))]<-1 #Disorders of lacrimal system
mort_2017$EYE.ESTR<-NULL; mort_2017$EYE.ESTR[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=49&ICD_10_1.CODE<=50)))]<-1 #Strabismus
mort_2017$EYE.BINO<-NULL; mort_2017$EYE.BINO[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==51)))]<-1 #Other disorders of binocular movement
mort_2017$EYE.REFR<-NULL; mort_2017$EYE.REFR[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==52)))]<-1 #Disorders of refraction and accommodation
mort_2017$EYE.OTRA<-NULL; mort_2017$EYE.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE==2)|(ICD_10_1.CODE==5)|(ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)|
                                                                                         (ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)|(ICD_10_1.CODE>=34&ICD_10_1.CODE<=35)|
                                                                                         (ICD_10_1.CODE>=43&ICD_10_1.CODE<=44)|(ICD_10_1.CODE>=46&ICD_10_1.CODE<=47)|
                                                                                         (ICD_10_1.CODE==53)|(ICD_10_1.CODE==59)|
                                                                                         (ICD_10_1.CODE>=55&ICD_10_1.CODE<=57))))]<-1 #Other

## Diseases of the ear and mastoid process ##
mort_2017$EAR.OMTM<-NULL; mort_2017$EAR.OMTM[with(mort_2017, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE==65)|(ICD_10_1.CODE==66)| #Otitis media, disorders of Eustachian tube and mastoiditis
                                                                                         (ICD_10_1.CODE>=68&ICD_10_1.CODE<=70))))]<-1
mort_2017$EAR.OTOM<-NULL; mort_2017$EAR.OTOM[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=71&ICD_10_1.CODE<=74)))]<-1 #Other middle ear disorders
mort_2017$EAR.SORD<-NULL; mort_2017$EAR.SORD[with(mort_2017, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=91)))]<-1 #Hearing loss
mort_2017$EAR.OTRA<-NULL; mort_2017$EAR.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE>=60&ICD_10_1.CODE<=61)|(ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)|
                                                                                         (ICD_10_1.CODE>=92&ICD_10_1.CODE<=93)|(ICD_10_1.CODE==83)|(ICD_10_1.CODE==95))))]<-1 #Other


##  Diseases of the circulatory system 1: acute rheumatic fever and chronic rheumatic heart diseases ##
mort_2017$SC1.FIRE<-NULL; mort_2017$SC1.FIRE[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)))]<-1 #Acute rheumatic fever
mort_2017$SC1.CRHD<-NULL; mort_2017$SC1.CRHD[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=5&ICD_10_1.CODE<=9)))]<-1 #Chronic rheumatic heart diseases


## Diseases of the circulatory system 2: hypertensive diseases ##
mort_2017$SC2.ECHI<-NULL; mort_2017$SC2.ECHI[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==11|ICD_10_1.CODE==13)))]<-1 #Hypertensive heart disease
mort_2017$SC2.HTES<-NULL; mort_2017$SC2.HTES[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==10)))]<-1 #Essential (primary) hypertension
mort_2017$SC2.OTRA<-NULL; mort_2017$SC2.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==12)))]<-1 #Other


## Diseases of the circulatory system 3: ischemic heart diseases ##
mort_2017$SC3.IAMC<-NULL; mort_2017$SC3.IAMC[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==21|ICD_10_1.CODE==22)))]<-1 #Acute myocardial infarction
mort_2017$SC3.OTRA<-NULL; mort_2017$SC3.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=23&ICD_10_1.CODE<=25)|
                                                                                         ICD_10_1.CODE==20)))]<-1 #Other

## Diseases of the circulatory system 4: diseases of pulmonary circulation and other heart diseases ##
mort_2017$SC4.EMBP<-NULL; mort_2017$SC4.EMBP[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==26)))]<-1 #Pulmonary embolism
mort_2017$SC4.CARR<-NULL; mort_2017$SC4.CARR[with(mort_2017, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=45)| #Conduction disorders and arrhythmia
                                                                                         (ICD_10_1.CODE>=47&ICD_10_1.CODE<=49))))]<-1
mort_2017$SC4.PARO<-NULL; mort_2017$SC4.PARO[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==46)))]<-1 #Cardiac arrest
mort_2017$SC4.HEFA<-NULL; mort_2017$SC4.HEFA[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==50)))]<-1 #Heart failure
mort_2017$SC4.OTRA<-NULL; mort_2017$SC4.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=27&ICD_10_1.CODE<=31)|(ICD_10_1.CODE>=33&ICD_10_1.CODE<=38)|
                                                                                         ICD_10_1.CODE==40|ICD_10_1.CODE==42|ICD_10_1.CODE==51)))]<-1  #Other


## Diseases of the circulatory system 5: cerebrovascular diseases ##
mort_2017$SC5.HEMS<-NULL; mort_2017$SC5.HEMS[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==60)))]<-1 #Subarachnoid hemorrhage
mort_2017$SC5.HEMI<-NULL; mort_2017$SC5.HEMI[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=61&ICD_10_1.CODE<=62)))]<-1 #Intracerebral and other intracranial hemorrhage
mort_2017$SC5.ISQC<-NULL; mort_2017$SC5.ISQC[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==63)))]<-1 #Cerebral infarction
mort_2017$SC5.EVCN<-NULL; mort_2017$SC5.EVCN[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==64)))]<-1 #Unspecified (hemorrhagic vs isquemic)
mort_2017$SC5.ATSC<-NULL; mort_2017$SC5.ATSC[with(mort_2017, (ICD_10_1.CHAPTER=="I" & ICD_10_1.CODE==67 & ICD_10_1.SUB==2))]<-1 #Cerebral atherosclerosis
mort_2017$SC5.SEQC<-NULL; mort_2017$SC5.SEQC[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==69)))]<-1 #Sequelae of cerebrovascular disease
mort_2017$SC5.OTRA<-NULL; mort_2017$SC5.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==65|ICD_10_1.CODE==66| #Other
                                                                                         (ICD_10_1.CODE==67&ICD_10_1.SUB!=2)) ))]<-1


## Diseases of the circulatory system 6: other diseases of the circulatory system ##
mort_2017$SC6.ATER<-NULL; mort_2017$SC6.ATER[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==70)))]<-1 #Atherosclerosis
mort_2017$SC6.OEVP<-NULL; mort_2017$SC6.OEVP[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==73)))]<-1 #Other peripheral vascular diseases
mort_2017$SC6.ETAR<-NULL; mort_2017$SC6.ETAR[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==74)))]<-1 #Arterial embolism and thrombosis
mort_2017$SC6.OTAR<-NULL; mort_2017$SC6.OTAR[with(mort_2017, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=71&ICD_10_1.CODE<=72)| #Other diseases of arteries, arterioles and capillaries
                                                                                         (ICD_10_1.CODE>=77&ICD_10_1.CODE<=78))))]<-1
mort_2017$SC6.ETVE<-NULL; mort_2017$SC6.ETVE[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=82)))]<-1 #Phlebitis, trombophlebitis, other venous embolism and thrombosis
mort_2017$SC6.VARI<-NULL; mort_2017$SC6.VARI[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==83)))]<-1 #Varicose veins of lower extremities
mort_2017$SC6.HMRR<-NULL; mort_2017$SC6.HMRR[with(mort_2017, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==84)))]<-1 #Hemorrhoids
mort_2017$SC6.OTRA<-NULL; mort_2017$SC6.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=85&ICD_10_1.CODE<=97)| #Other
                                                                                         ICD_10_1.CODE==99)))]<-1


## Respiratory tract diseases 1: acute upper respiratory infections and other diseases of upper respiratory tract ##
mort_2017$ER1.FAAG<-NULL; mort_2017$ER1.FAAG[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==2)))]<-1 #Acute pharyngitis
mort_2017$ER1.TOAG<-NULL; mort_2017$ER1.TOAG[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==3)))]<-1 #Acute tonsillitis
mort_2017$ER1.LTAG<-NULL; mort_2017$ER1.LTAG[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==4)))]<-1 #Acute laryngitis and tracheitis
mort_2017$ER1.OTAG<-NULL; mort_2017$ER1.OTAG[with(mort_2017, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)| #Other acute upper respiratory infections
                                                                                         (ICD_10_1.CODE>=5&ICD_10_1.CODE<=6))))]<-1
mort_2017$ER1.PNSD<-NULL; mort_2017$ER1.PNSD[with(mort_2017, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE==33)| #Nasal polyp and deviated nasal septum
                                                                                         (ICD_10_1.CODE==34&ICD_10_1.SUB==2))))]<-1 
mort_2017$ER1.RNPC<-NULL; mort_2017$ER1.RNPC[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)))]<-1 #Chronic rhinitis, nasopharyngitis and pharyngitis
mort_2017$ER1.SINC<-NULL; mort_2017$ER1.SINC[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==32)))]<-1 #Chronic sinusitis
mort_2017$ER1.TADC<-NULL; mort_2017$ER1.TADC[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==35)))]<-1 #Chronic diseases of tonsils and adenoids
mort_2017$ER1.ONSN<-NULL; mort_2017$ER1.ONSN[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==34&(ICD_10_1.SUB!=2&ICD_10_1.SUB!=9))))]<-1 #Other disorders of nose and nasal sinuses
mort_2017$ER1.OTRA<-NULL; mort_2017$ER1.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=36&ICD_10_1.CODE<=39)))]<-1 #Other


## Respiratory tract diseases 2: other respiratory tract diseases ##
mort_2017$ER2.BRAG<-NULL; mort_2017$ER2.BRAG[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Acute bronchitis and bronchiolitis
mort_2017$ER2.NEUM<-NULL; mort_2017$ER2.NEUM[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=12&ICD_10_1.CODE<=18)))]<-1 #Pneumonia
mort_2017$ER2.INFL<-NULL; mort_2017$ER2.INFL[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=9&ICD_10_1.CODE<=11)))]<-1 #Influenza
mort_2017$ER2.BCNE<-NULL; mort_2017$ER2.BCNE[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=43)))]<-1 #Chronic and unspecified bronchitis, emphysema
mort_2017$ER2.ASMA<-NULL; mort_2017$ER2.ASMA[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=45&ICD_10_1.CODE<=46)))]<-1 #Asthma
mort_2017$ER2.BREC<-NULL; mort_2017$ER2.BREC[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==47)))]<-1 #Bronchiectasis
mort_2017$ER2.EPOC<-NULL; mort_2017$ER2.EPOC[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==44)))]<-1 #Chronic obstructive pulmonary disease
mort_2017$ER2.NMCS<-NULL; mort_2017$ER2.NMCS[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=65)))]<-1 #Pneumoconiosis
mort_2017$ER2.OTAE<-NULL; mort_2017$ER2.OTAE[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=66&ICD_10_1.CODE<=70)))]<-1 #Other pulmonary diseases due to external agents
mort_2017$ER2.PLEU<-NULL; mort_2017$ER2.PLEU[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=94)))]<-1 #Pleural conditions
mort_2017$ER2.IRIN<-NULL; mort_2017$ER2.IRIN[with(mort_2017, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==22)))]<-1 #Unspecified acute lower respiratory infection
mort_2017$ER2.OTRA<-NULL; mort_2017$ER2.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=86)|
                                                                                         (ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other


## Diseases of the digestive system 1: oral cavity and salivary glands ##
mort_2017$SD1.CARI<-NULL; mort_2017$SD1.CARI[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==2)))]<-1 #Dental caries
mort_2017$SD1.OTDI<-NULL; mort_2017$SD1.OTDI[with(mort_2017, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)| #Other disorders of teeth and supporting structures
                                                                                         (ICD_10_1.CODE>=3&ICD_10_1.CODE<=8))))]<-1
mort_2017$SD1.OTJA<-NULL; mort_2017$SD1.OTJA[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==10)))]<-1 #Other diseases of jaw
mort_2017$SD1.OTRA<-NULL; mort_2017$SD1.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=11&ICD_10_1.CODE<=14)|ICD_10_1.CODE==9)))]<-1 #Other


## Diseases of the digestive system 2: esophagus, stomach, intestines, hernia ##
mort_2017$SD2.ESOF<-NULL; mort_2017$SD2.ESOF[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=22)))]<-1 #Diseases of esophagus
mort_2017$SD2.GDIS<-NULL; mort_2017$SD2.GDIS[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==29)))]<-1 #Gastritis and duodenitis
mort_2017$SD2.GDUL<-NULL; mort_2017$SD2.GDUL[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=25&ICD_10_1.CODE<=27)))]<-1 #Gastric and duodenal ulcer
mort_2017$SD2.OTGD<-NULL; mort_2017$SD2.OTGD[with(mort_2017, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)|ICD_10_1.CODE==28)))]<-1 #Other diseases of stomach and duodenum
mort_2017$SD2.APEN<-NULL; mort_2017$SD2.APEN[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=38)))]<-1 #Diseases of appendix
mort_2017$SD2.INHE<-NULL; mort_2017$SD2.INHE[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==40)))]<-1 #Inguinal hernia
mort_2017$SD2.OTHE<-NULL; mort_2017$SD2.OTHE[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=41&ICD_10_1.CODE<=46)))]<-1 #Other hernias
mort_2017$SD2.CRCU<-NULL; mort_2017$SD2.CRCU[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=51)))]<-1 #Crohn's disease and ulcerative colitis
mort_2017$SD2.PIIO<-NULL; mort_2017$SD2.PIIO[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==56)))]<-1 #Paralytic ileus and intestinal obstruction without hernia
mort_2017$SD2.EDDI<-NULL; mort_2017$SD2.EDDI[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==57)))]<-1 #Diverticular disease of intestine
mort_2017$SD2.SIIO<-NULL; mort_2017$SD2.SIIO[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=59)))]<-1 #Irritable bowel syndrome and other functional intestinal disorders


## Diseases of the digestive system 3: liver and other parts of digestive system ##
mort_2017$SD3.ALLD<-NULL; mort_2017$SD3.ALLD[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==70)))]<-1 #Alcoholic liver disease
mort_2017$SD3.OTLI<-NULL; mort_2017$SD3.OTLI[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=71&ICD_10_1.CODE<=76)))]<-1 #Other diseases of liver
mort_2017$SD3.COLE<-NULL; mort_2017$SD3.COLE[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)))]<-1 #Cholelithiasis and cholecystitis
mort_2017$SD3.OTIP<-NULL; mort_2017$SD3.OTIP[with(mort_2017, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=52&ICD_10_1.CODE<=55)|
                                                                                         ICD_10_1.CODE>=60&ICD_10_1.CODE<=66)))]<-1 #Other diseases of intestines and peritoneum
mort_2017$SD3.PANC<-NULL; mort_2017$SD3.PANC[with(mort_2017, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Acute pancreatitis and other diseases of pancreas
mort_2017$SD3.OTRA<-NULL; mort_2017$SD3.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=82&ICD_10_1.CODE<=83)|
                                                                                         ICD_10_1.CODE>=87&ICD_10_1.CODE<=93)))]<-1 #Other diseases of digestive system



## Diseases of the skin and subcutaneous tissue ##
mort_2017$PTS.IPTS<-NULL; mort_2017$PTS.IPTS[with(mort_2017, (ICD_10_1.CHAPTER=="L" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=8)))]<-1 #Infections of the skin and subcutaneous tissue
mort_2017$PTS.DEEC<-NULL; mort_2017$PTS.DEEC[with(mort_2017, (ICD_10_1.CHAPTER=="L" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=30)))]<-1 #Dermatitis and eczema
mort_2017$PTS.OTRA<-NULL; mort_2017$PTS.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="L" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=13)|(ICD_10_1.CODE>=40&ICD_10_1.CODE<=44)|
                                                                                         (ICD_10_1.CODE>=50&ICD_10_1.CODE<=53)|(ICD_10_1.CODE>=55&ICD_10_1.CODE<=60)|
                                                                                         (ICD_10_1.CODE>=63&ICD_10_1.CODE<=85)|(ICD_10_1.CODE>=87&ICD_10_1.CODE<=98))))]<-1 #Other


## Diseases of the musculoskeletal system and connective tissue ##
mort_2017$MOC.PAIN<-NULL; mort_2017$MOC.PAIN[with(mort_2017, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=5&ICD_10_1.CODE<=6)|(ICD_10_1.CODE==8)|
                                                                                         (ICD_10_1.CODE>=10&ICD_10_1.CODE<=13))))]<-1 #Inflammatory polyarthropathies
mort_2017$MOC.OSAR<-NULL; mort_2017$MOC.OSAR[with(mort_2017, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=15&ICD_10_1.CODE<=19)))]<-1 #Osteoarthritis
mort_2017$MOC.ADOL<-NULL; mort_2017$MOC.ADOL[with(mort_2017, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Acquired deformities of limbs
mort_2017$MOC.OTAR<-NULL; mort_2017$MOC.OTAR[with(mort_2017, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)| 
                                                                                         (ICD_10_1.CODE>=22&ICD_10_1.CODE<=25))))]<-1 #Other joint disorders
mort_2017$MOC.SCTD<-NULL; mort_2017$MOC.SCTD[with(mort_2017, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=35)))]<-1 #Systemic connective tissue disorders
mort_2017$MOC.IVDD<-NULL; mort_2017$MOC.IVDD[with(mort_2017, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=51)))]<-1 #Intervertebral disc disorders
mort_2017$MOC.OTDO<-NULL; mort_2017$MOC.OTDO[with(mort_2017, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=40&ICD_10_1.CODE<=48)| 
                                                                                         (ICD_10_1.CODE>=53&ICD_10_1.CODE<=54))))]<-1 #Other dorsopathies
mort_2017$MOC.SOFT<-NULL; mort_2017$MOC.SOFT[with(mort_2017, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=60&ICD_10_1.CODE<=62)|(ICD_10_1.CODE>=65&ICD_10_1.CODE<=67)|
                                                                                         (ICD_10_1.CODE>=70&ICD_10_1.CODE<=72)|(ICD_10_1.CODE>=75&ICD_10_1.CODE<=79))))]<-1 #Soft tissue disorders
mort_2017$MOC.BONE<-NULL; mort_2017$MOC.BONE[with(mort_2017, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)|(ICD_10_1.CODE==83&ICD_10_1.SUB!=0)|
                                                                                         (ICD_10_1.CODE>=84&ICD_10_1.CODE<=85))))]<-1 #Disorders of bone density and structure
mort_2017$MOC.OMIE<-NULL; mort_2017$MOC.OMIE[with(mort_2017, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE==86)))]<-1 #Osteomyelitis
mort_2017$MOC.OTRA<-NULL; mort_2017$MOC.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)|
                                                                                         (ICD_10_1.CODE>=91&ICD_10_1.CODE<=99))))]<-1 #Other



## Diseases of the genitourinary system 1: urinary system ##
mort_2017$GU1.NFRI<-NULL; mort_2017$GU1.NFRI[with(mort_2017, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Acute and rapidly progressive nephritic syndrome
mort_2017$GU1.OTGL<-NULL; mort_2017$GU1.OTGL[with(mort_2017, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=2&ICD_10_1.CODE<=8)))]<-1 #Other glomerular diseases
mort_2017$GU1.ACKF<-NULL; mort_2017$GU1.ACKF[with(mort_2017, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=17&ICD_10_1.CODE<=19)))]<-1 #Acute kidney failure and chronic kidney disease
mort_2017$GU1.RTID<-NULL; mort_2017$GU1.RTID[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=12)|ICD_10_1.CODE==15)))]<-1 #Renal tubulo-interstitial diseases
mort_2017$GU1.OTTU<-NULL; mort_2017$GU1.OTTU[with(mort_2017, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=13&ICD_10_1.CODE<=14)))]<-1 #Other renal tubulo-interstitial diseases
mort_2017$GU1.LITO<-NULL; mort_2017$GU1.LITO[with(mort_2017, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Urolithiasis
mort_2017$GU1.RECO<-NULL; mort_2017$GU1.RECO[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==23))]<-1 #Unspecified renal colic
mort_2017$GU1.CIST<-NULL; mort_2017$GU1.CIST[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==30))]<-1 #Cystitis
mort_2017$GU1.OTRA<-NULL; mort_2017$GU1.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=25&ICD_10_1.CODE<=29)|(ICD_10_1.CODE>=31&ICD_10_1.CODE<=39))))]<-1 #Other


## Diseases of the genitourinary system 2: male genital organs ##
mort_2017$GU2.HIPR<-NULL; mort_2017$GU2.HIPR[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==40))]<-1 #Benign prostatic hyperplasia
mort_2017$GU2.OTPR<-NULL; mort_2017$GU2.OTPR[with(mort_2017, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=41&ICD_10_1.CODE<=42)))]<-1 #Other disorders of prostate
mort_2017$GU2.HCEC<-NULL; mort_2017$GU2.HCEC[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==43))]<-1 #Hydrocele and spermatocele
mort_2017$GU2.PREP<-NULL; mort_2017$GU2.PREP[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==47))]<-1 #Disorders of prepuce
mort_2017$GU2.MINF<-NULL; mort_2017$GU2.MINF[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==46))]<-1 #Male infertility
mort_2017$GU2.OTRA<-NULL; mort_2017$GU2.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=45)|(ICD_10_1.CODE>=48&ICD_10_1.CODE<=50))))]<-1 #Other



## Diseases of the genitourinary system 3: breast disorders ##
mort_2017$GU3.MAMA<-NULL; mort_2017$GU3.MAMA[with(mort_2017, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=64)))]<-1 #Disorders of breast


## Diseases of the genitourinary system 4: female genital organs ##
mort_2017$GU4.SAOO<-NULL; mort_2017$GU4.SAOO[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==70))]<-1 #Salpingitis and oophoritis
mort_2017$GU4.IDCU<-NULL; mort_2017$GU4.IDCU[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==72))]<-1 #Inflammatory disease of cervix uteri
mort_2017$GU4.OTVV<-NULL; mort_2017$GU4.OTVV[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=75&ICD_10_1.CODE<=76)|ICD_10_1.CODE==71)))]<-1 #Other diseases of uterus, vagina and vulva
mort_2017$GU4.OTPI<-NULL; mort_2017$GU4.OTPI[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==73))]<-1 #Other female pelvic inflammatory diseases
mort_2017$GU4.ENDM<-NULL; mort_2017$GU4.ENDM[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==80))]<-1 #Endometriosis
mort_2017$GU4.FPRO<-NULL; mort_2017$GU4.FPRO[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==81))]<-1 #Female genital prolapse
mort_2017$GU4.NOFB<-NULL; mort_2017$GU4.NOFB[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==83))]<-1 #Noninflammatory disorders of ovary, fallopian tube and broad ligament
mort_2017$GU4.MENS<-NULL; mort_2017$GU4.MENS[with(mort_2017, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=91&ICD_10_1.CODE<=92)))]<-1 #Disorders of menstruation
mort_2017$GU4.MNOP<-NULL; mort_2017$GU4.MNOP[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==95))]<-1 #Menopausal and other perimenopausal disorders
mort_2017$GU4.FINF<-NULL; mort_2017$GU4.FINF[with(mort_2017, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==97))]<-1 #Female infertility
mort_2017$GU4.OTRA<-NULL; mort_2017$GU4.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE==82|(ICD_10_1.CODE>=84&ICD_10_1.CODE<=90)|
                                                                                         (ICD_10_1.CODE>=93&ICD_10_1.CODE<=94)|ICD_10_1.CODE==96|ICD_10_1.CODE==98)))]<-1 #Other


## Obstetrics 1: direct obstetric causes (abortion) ##
mort_2017$OB1.SPON<-NULL; mort_2017$OB1.SPON[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==3))]<-1 #Spontaneous abortion
mort_2017$OB1.INDU<-NULL; mort_2017$OB1.INDU[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==4))]<-1 #Complications following (induced) termination of pregnancy
mort_2017$OB1.OTRA<-NULL; mort_2017$OB1.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)|(ICD_10_1.CODE>=5&ICD_10_1.CODE<=8))))]<-1 #Other abortion


## Obstetrics 2: direct obstetric causes (pregnancy and puerperium, except abortion) ##
mort_2017$OB2.EPHD<-NULL; mort_2017$OB2.EPHD[with(mort_2017, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=16)))]<-1 #Edema, proteinuria and hypertensive disorders in pregnancy, childbirth and the puerperium
mort_2017$OB2.HEMP<-NULL; mort_2017$OB2.HEMP[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=46)|
                                                                                         ICD_10_1.CODE==20)))]<-1 #Hemorrhage in early pregnancy, placenta previa, abruptio placentae, antepartum hemorrhage
mort_2017$OB2.FACD<-NULL; mort_2017$OB2.FACD[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=30&ICD_10_1.CODE<=43)|ICD_10_1.CODE==47|
                                                                                         ICD_10_1.CODE==48)))]<-1 #Maternal care related to the fetus and amniotic cavity and possible delivery problems
mort_2017$OB2.IGUT<-NULL; mort_2017$OB2.IGUT[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==23))]<-1 #Infections of genitourinary tract in pregnancy
mort_2017$OB2.DMIP<-NULL; mort_2017$OB2.DMIP[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==24))]<-1 #Diabetes mellitus in pregnancy
mort_2017$OB2.OBSL<-NULL; mort_2017$OB2.OBSL[with(mort_2017, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=64&ICD_10_1.CODE<=66)))]<-1 #Obstructed labor 
mort_2017$OB2.PPHE<-NULL; mort_2017$OB2.PPHE[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==72))]<-1 #Postpartum hemorrhage
mort_2017$OB2.SOPI<-NULL; mort_2017$OB2.SOPI[with(mort_2017, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Sepsis and other puerperal infections
mort_2017$OB2.PUER<-NULL; mort_2017$OB2.PUER[with(mort_2017, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=87&ICD_10_1.CODE<=92)))]<-1 #Other complications of the puerperium
mort_2017$OB2.OTPL<-NULL; mort_2017$OB2.OTPL[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=21&ICD_10_1.CODE<=22)|(ICD_10_1.CODE>=25&ICD_10_1.CODE<=29)|(ICD_10_1.CODE>=60&ICD_10_1.CODE<=63)|
                                                                                         (ICD_10_1.CODE>=67&ICD_10_1.CODE<=71)|(ICD_10_1.CODE>=73&ICD_10_1.CODE<=75))))]<-1 #Other complications of pregnancy and labor
mort_2017$OB2.OBTE<-NULL; mort_2017$OB2.OBTE[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==34))]<-1 #Obstetrical tetanus
mort_2017$OB2.BEPU<-NULL; mort_2017$OB2.BEPU[with(mort_2017, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==53))]<-1 #Mental and behavioral disorders associated with the puerperium
mort_2017$OB2.OMLC<-NULL; mort_2017$OB2.OMLC[with(mort_2017, (ICD_10_1.CHAPTER=="M" & ICD_10_1.CODE==83 & ICD_10_1.SUB==0))]<-1 #Puerperal osteomalacia
mort_2017$OB2.OTDC<-NULL; mort_2017$OB2.OTDC[with(mort_2017, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=96&ICD_10_1.CODE<=97)))]<-1 #Other direct obstetric causes
mort_2017$OB2.ODUC<-NULL; mort_2017$OB2.ODUC[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==95))]<-1 #Obstetric death of unspecified cause


## Obstetrics 3: delivery ##
mort_2017$OB3.SSDE<-NULL; mort_2017$OB3.SSDE[with(mort_2017, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==80))]<-1 #Single spontaneous delivery
mort_2017$OB3.OTDE<-NULL; mort_2017$OB3.OTDE[with(mort_2017, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=81&ICD_10_1.CODE<=84)))]<-1 #Other delivery


## Obstetrics 4: indirect obstetric causes ##
mort_2017$OB4.INOC<-NULL; mort_2017$OB4.INOC[with(mort_2017, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=98&ICD_10_1.CODE<=99)))]<-1 #Indirect obstetric causes


## Certain conditions originating in the perinatal period ##
mort_2017$NEO.NAMC<-NULL; mort_2017$NEO.NAMC[with(mort_2017, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE==0|ICD_10_1.CODE==4)))]<-1 #Newborn affected by maternal conditions
mort_2017$NEO.NAOC<-NULL; mort_2017$NEO.NAOC[with(mort_2017, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=1&ICD_10_1.CODE<=3)))]<-1 #Newborn affected by obstetric complications
mort_2017$NEO.GMGW<-NULL; mort_2017$NEO.GMGW[with(mort_2017, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE==5|ICD_10_1.CODE==7)))]<-1 #Slow fetal growth, fetal malnutrition, short gestation and low birth weight
mort_2017$NEO.BITR<-NULL; mort_2017$NEO.BITR[with(mort_2017, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=15)))]<-1 #Birth trauma
mort_2017$NEO.HIAS<-NULL; mort_2017$NEO.HIAS[with(mort_2017, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Intrauterine hypoxia and birth asphyxia 
mort_2017$NEO.SDRN<-NULL; mort_2017$NEO.SDRN[with(mort_2017, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=22&ICD_10_1.CODE<=28)))]<-1 #Respiratory distress of newborn and other perinatal respiratory disorders
mort_2017$NEO.INFE<-NULL; mort_2017$NEO.INFE[with(mort_2017, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=37)))]<-1 #Congenital viral, bacterial and parasitic diseases
mort_2017$NEO.OTIN<-NULL; mort_2017$NEO.OTIN[with(mort_2017, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=38&ICD_10_1.CODE<=39)))]<-1 #Other infections specific to the perinatal period
mort_2017$NEO.HDNB<-NULL; mort_2017$NEO.HDNB[with(mort_2017, (ICD_10_1.CHAPTER=="P" & ICD_10_1.CODE==55))]<-1 #Hemolytic disease of newborn
mort_2017$NEO.TENE<-NULL; mort_2017$NEO.TENE[with(mort_2017, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==33))]<-1 #Tetanus neonatorum
mort_2017$NEO.OTRA<-NULL; mort_2017$NEO.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="P" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=54)|(ICD_10_1.CODE>=56&ICD_10_1.CODE<=74)|
                                                                                         (ICD_10_1.CODE>=76&ICD_10_1.CODE<=96)|(ICD_10_1.CODE==8)|(ICD_10_1.CODE==29))))]<-1 #Other


## Congenital malformations, deformations and chromosomal abnormalities ##
mort_2017$CON.ANEN<-NULL; mort_2017$CON.ANEN[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==0))]<-1 #Anencephaly and similar malformations
mort_2017$CON.HIDR<-NULL; mort_2017$CON.HIDR[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==3))]<-1 #Congenital hydrocephalus
mort_2017$CON.SBIF<-NULL; mort_2017$CON.SBIF[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==5))]<-1 #Spina bifida
mort_2017$CON.OTNS<-NULL; mort_2017$CON.OTNS[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=1&ICD_10_1.CODE<=2)|(ICD_10_1.CODE==4)|
                                                                                         (ICD_10_1.CODE>=6&ICD_10_1.CODE<=7))))]<-1 #Other congenital malformations of the nervous system
mort_2017$CON.CIRC<-NULL; mort_2017$CON.CIRC[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=28)))]<-1 #Congenital malformations of the circulatory system
mort_2017$CON.CLCP<-NULL; mort_2017$CON.CLCP[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=37)))]<-1 #Cleft lip and cleft palate
mort_2017$CON.CINT<-NULL; mort_2017$CON.CINT[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==41))]<-1 #Congenital absence, atresia and stenosis of small intestine
mort_2017$CON.OTDS<-NULL; mort_2017$CON.OTDS[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=38&ICD_10_1.CODE<=40)|
                                                                                         (ICD_10_1.CODE>=42&ICD_10_1.CODE<=45))))]<-1 #Other congenital malformations of the digestive system 
mort_2017$CON.TEST<-NULL; mort_2017$CON.TEST[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==53))]<-1 #Undescended and ectopic testicle
mort_2017$CON.OTGU<-NULL; mort_2017$CON.OTGU[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=52)|
                                                                                         (ICD_10_1.CODE>=54&ICD_10_1.CODE<=64))))]<-1 #Other congenital malformations of genitourinary system
mort_2017$CON.DHIP<-NULL; mort_2017$CON.DHIP[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==65))]<-1 #Congenital deformities of hip
mort_2017$CON.FEET<-NULL; mort_2017$CON.FEET[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==66))]<-1 #Congenital deformities of feet
mort_2017$CON.OTMS<-NULL; mort_2017$CON.OTMS[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=67&ICD_10_1.CODE<=79)))]<-1 #Other congenital malformations and deformations of the musculoskeletal system
mort_2017$CON.OTRA<-NULL; mort_2017$CON.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=18)|(ICD_10_1.CODE>=30&ICD_10_1.CODE<=34)|
                                                                                         (ICD_10_1.CODE>=80&ICD_10_1.CODE<=89))))]<-1 #Other congenital malformations
mort_2017$CON.CROM<-NULL; mort_2017$CON.CROM[with(mort_2017, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=99)))]<-1 #Chromosomal abnormalities, not elsewhere classified


## Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified ##
mort_2017$NCL.FEVU<-NULL; mort_2017$NCL.FEVU[with(mort_2017, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==50))]<-1 #Fever of other and unknown origin
mort_2017$NCL.CAAB<-NULL; mort_2017$NCL.CAAB[with(mort_2017, (ICD_10_1.CHAPTER=="R" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Cardiac abnormalities
mort_2017$NCL.RAOR<-NULL; mort_2017$NCL.RAOR[with(mort_2017, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==33))]<-1 #Retention of urine
mort_2017$NCL.ABPP<-NULL; mort_2017$NCL.ABPP[with(mort_2017, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==10))]<-1 #Abdominal and pelvic pain
mort_2017$NCL.ARPD<-NULL; mort_2017$NCL.ARPD[with(mort_2017, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==54))]<-1 #Age-related physical debility
mort_2017$NCL.SIDS<-NULL; mort_2017$NCL.SIDS[with(mort_2017, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==95))]<-1 #Sudden infant death syndrome
mort_2017$NCL.REAR<-NULL; mort_2017$NCL.REAR[with(mort_2017, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==9 & ICD_10_1.SUB==2))]<-1 #Respiratory arrest
mort_2017$NCL.OTRA<-NULL; mort_2017$NCL.OTRA[with(mort_2017, (ICD_10_1.CHAPTER=="R" & ((ICD_10_1.CODE==9&(ICD_10_1.SUB==0|ICD_10_1.SUB==1|ICD_10_1.SUB==3|ICD_10_1.SUB==8))|
                                                                                         (ICD_10_1.CODE>=2&ICD_10_1.CODE<=8)|(ICD_10_1.CODE>=11&ICD_10_1.CODE<=32)|
                                                                                         (ICD_10_1.CODE>=34&ICD_10_1.CODE<=49)|(ICD_10_1.CODE>=51&ICD_10_1.CODE<=53)|
                                                                                         (ICD_10_1.CODE>=55&ICD_10_1.CODE<=94)|(ICD_10_1.CODE>=96&ICD_10_1.CODE<=99))))]<-1 #Other



## External causes of mortality 1: transport accidents ##
mort_2017$EX1.RAIL<-NULL; mort_2017$EX1.RAIL[with(mort_2017, (ICD_10_1.CHAPTER=="V" & ((ICD_10_1.CODE==5)|(ICD_10_1.CODE==15)|(ICD_10_1.CODE==80&ICD_10_1.SUB==6)|
                                                                                         (ICD_10_1.CODE==81&ICD_10_1.SUB!=1)) ))]<-1 #Railway accidents
mort_2017$EX1.MOTO<-NULL; mort_2017$EX1.MOTO[with(mort_2017, (ICD_10_1.CHAPTER=="V" &  (((ICD_10_1.CODE>=2&ICD_10_1.CODE<=4) & (ICD_10_1.SUB==1|ICD_10_1.SUB==9))|
                                                                                          ((ICD_10_1.CODE==9) & (ICD_10_1.SUB==2|ICD_10_1.SUB==3|ICD_10_1.SUB==9))|
                                                                                          ((ICD_10_1.CODE>=12&ICD_10_1.CODE<=14) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE==19) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=6))|
                                                                                          ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=28) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE>=29&ICD_10_1.CODE<=79) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE==80) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=5))|
                                                                                          ((ICD_10_1.CODE>=81&ICD_10_1.CODE<=82) & (ICD_10_1.SUB==1))|
                                                                                          ((ICD_10_1.CODE>=83&ICD_10_1.CODE<=86) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=3))|
                                                                                          ((ICD_10_1.CODE==87) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=8))|
                                                                                          ((ICD_10_1.CODE==89) & (ICD_10_1.SUB==2|ICD_10_1.SUB==9))) ))]<-1 #Motor vehicle traffic accidents
mort_2017$EX1.LAND<-NULL; mort_2017$EX1.LAND[with(mort_2017, (ICD_10_1.CHAPTER=="V" & ((ICD_10_1.CODE==1)|(ICD_10_1.CODE==6)|(ICD_10_1.CODE==10)|(ICD_10_1.CODE==11)|
                                                                                         (ICD_10_1.CODE>=16&ICD_10_1.CODE<=18)|(ICD_10_1.CODE==19&ICD_10_1.SUB==3)|
                                                                                         ((ICD_10_1.CODE==80) & (ICD_10_1.SUB<=2|ICD_10_1.SUB>=7))|
                                                                                         ((ICD_10_1.CODE==82) & (ICD_10_1.SUB>=2&ICD_10_1.SUB<=9))|
                                                                                         ((ICD_10_1.CODE==89) & (ICD_10_1.SUB==1|ICD_10_1.SUB==3)) )))]<-1 #Other land transport accidents
mort_2017$EX1.WATE<-NULL; mort_2017$EX1.WATE[with(mort_2017, (ICD_10_1.CHAPTER=="V" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=94)))]<-1 #Water transport accidents
mort_2017$EX1.AIRS<-NULL; mort_2017$EX1.AIRS[with(mort_2017, (ICD_10_1.CHAPTER=="V" & (ICD_10_1.CODE>=95&ICD_10_1.CODE<=97)))]<-1 #Air and space transport accidents
mort_2017$EX1.OTRO<-NULL; mort_2017$EX1.OTRO[with(mort_2017, (ICD_10_1.CHAPTER=="V" & (((ICD_10_1.CODE>=2&ICD_10_1.CODE<=4) & (ICD_10_1.SUB==0))|
                                                                                         ((ICD_10_1.CODE==9) & (ICD_10_1.SUB==0|ICD_10_1.SUB==1))|
                                                                                         ((ICD_10_1.CODE>=12&ICD_10_1.CODE<=14) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=2))|
                                                                                         ((ICD_10_1.CODE==19) & (ICD_10_1.SUB<=2|ICD_10_1.SUB>=8))|
                                                                                         ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=28) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=2))|
                                                                                         ((ICD_10_1.CODE>=29&ICD_10_1.CODE<=79) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=3))|
                                                                                         ((ICD_10_1.CODE>=83&ICD_10_1.CODE<=86) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=9))|
                                                                                         (ICD_10_1.CODE==82&ICD_10_1.SUB==0)|(ICD_10_1.CODE==87&ICD_10_1.SUB==9)|
                                                                                         (ICD_10_1.CODE==88)|(ICD_10_1.CODE==89&ICD_10_1.SUB==0)|
                                                                                         (ICD_10_1.CODE>=98&ICD_10_1.CODE<=99))))]<-1 #Other



## External causes of mortality 2: falls ##
mort_2017$EX2.FALL<-NULL; mort_2017$EX2.FALL[with(mort_2017, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=19)))]<-1 #Falls


## External causes of mortality 3: other accidents ##
mort_2017$EX3.ENVI<-NULL; mort_2017$EX3.ENVI[with(mort_2017, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=53&ICD_10_1.CODE<=64)) | 
                                                    (ICD_10_1.CHAPTER=="X" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=39)|(ICD_10_1.CODE>=50&ICD_10_1.CODE<=57))))]<-1 #Accidents caused by environmental factors
mort_2017$EX3.DROW<-NULL; mort_2017$EX3.DROW[with(mort_2017, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=65&ICD_10_1.CODE<=74)))]<-1 #Accidental non-transport drowning and submersion
mort_2017$EX3.FBNO<-NULL; mort_2017$EX3.FBNO[with(mort_2017, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE==44)))]<-1 #Foreign body entering into or through eye or natural orifice
mort_2017$EX3.MACH<-NULL; mort_2017$EX3.MACH[with(mort_2017, (ICD_10_1.CHAPTER=="W" & ((ICD_10_1.CODE>=23&ICD_10_1.CODE<=31)|ICD_10_1.CODE==35|
                                                                                         ICD_10_1.CODE==37|ICD_10_1.CODE==38|ICD_10_1.CODE==41|
                                                                                         (ICD_10_1.CODE>=45&ICD_10_1.CODE<=46))))]<-1 #Accidents caused by machinery or sharp instruments
mort_2017$EX3.FREG<-NULL; mort_2017$EX3.FREG[with(mort_2017, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=32&ICD_10_1.CODE<=34)))]<-1 #Accidents caused by firearms and guns
mort_2017$EX3.SEQA<-NULL; mort_2017$EX3.SEQA[with(mort_2017, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Sequelae of transport accidents and other accidents

mort_2017$EX3.OTRA<-NULL; mort_2017$EX3.OTRA[with(mort_2017, ((ICD_10_1.CHAPTER=="W" & ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=22)|ICD_10_1.CODE==36|ICD_10_1.CODE==39|ICD_10_1.CODE==40|ICD_10_1.CODE==42|
                                                                                          ICD_10_1.CODE==43|(ICD_10_1.CODE>=49&ICD_10_1.CODE<=52)|(ICD_10_1.CODE>=75&ICD_10_1.CODE<=99)))|
                                                                (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=59)) ))]<-1 #Other



## External causes of mortality 4: exposure to smoke, fire and flames ##
mort_2017$EX4.SMFF<-NULL; mort_2017$EX4.SMFF[with(mort_2017, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=9)))]<-1 #Exposure to smoke, fire and flames


## External causes of mortality 5: accidental poisoning and substance exposition ##
mort_2017$EX5.APDM<-NULL; mort_2017$EX5.APDM[with(mort_2017, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=44)))]<-1 #Accidental poisoning by drugs, medicaments and biological substances
mort_2017$EX5.APSL<-NULL; mort_2017$EX5.APSL[with(mort_2017, (ICD_10_1.CHAPTER=="X" & ((ICD_10_1.CODE>=45&ICD_10_1.CODE<=49)&(ICD_10_1.CODE!=47))))]<-1 #Accidental poisoning by other solid or liquid substances
mort_2017$EX5.APGV<-NULL; mort_2017$EX5.APGV[with(mort_2017, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE==47)))]<-1 #Accidental poisoning by other gases and vapours

## External causes of mortality 6: suicide ##
mort_2017$EX6.SUIC<-NULL; mort_2017$EX6.SUIC[with(mort_2017, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=84)))]<-1 #Intentional self-harm


## External causes of mortality 7: homicide ##
mort_2017$EX7.ASSA<-NULL; mort_2017$EX7.ASSA[with(mort_2017, ((ICD_10_1.CHAPTER=="X"&ICD_10_1.CODE>=85)|(ICD_10_1.CHAPTER=="Y"&ICD_10_1.CODE<=9)))]<-1 #Assault


## External causes of mortality 8: other violent causes of death ##
mort_2017$EX8.EOUI<-NULL; mort_2017$EX8.EOUI[with(mort_2017, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=34)))]<-1 #Event of undetermined intent
mort_2017$EX8.OWAR<-NULL; mort_2017$EX8.OWAR[with(mort_2017, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE==36)))]<-1 #Operations of war
mort_2017$EX8.LEGI<-NULL; mort_2017$EX8.LEGI[with(mort_2017, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE==35)))]<-1 #Legal intervention


## External causes of mortality 9: other external causes of mortality ##
mort_2017$EX9.DRUG<-NULL; mort_2017$EX9.DRUG[with(mort_2017, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=59)))]<-1 #Drugs, medicaments and biological substances causing adverse effects in therapeutic use
mort_2017$EX9.MSDV<-NULL; mort_2017$EX9.MSDV[with(mort_2017, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=84)))]<-1 #Misadventures to patients during surgical and medical care
mort_2017$EX9.SQEX<-NULL; mort_2017$EX9.SQEX[with(mort_2017, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)))]<-1 #Sequelae of external causes of morbidity and mortality


# COVID-19 #
mort_2017$COV.CONF<-NULL; mort_2017$COV.CONF[with(mort_2017, (ICD_10_1.CHAPTER=="U" & ICD_10_1.CODE==7 & ICD_10_1.SUB==1))]<-1 #Confirmed COVID-19
mort_2017$COV.SUSP<-NULL; mort_2017$COV.SUSP[with(mort_2017, (ICD_10_1.CHAPTER=="U" & ICD_10_1.CODE==7 & ICD_10_1.SUB==2))]<-1 #Suspected COVID-19



#Merge Datasets

mort_2017<-mort_2017 %>%left_join(dmu.cuadrantes.mun,by="id.mun")%>%
  rename(DMU_MUN=dmu)%>%
  rename(DMU_CAMAS_MUN=dmu_camas)%>%
  left_join(dmu.ent, by="id.ent")%>%
  rename(DMU_CAMAS_ENT=dmu_camas)%>%
  rename(DMU_ENT=dmu)

mort_2017$AVOIDABLE<-NULL
mort_2017$AVOIDABLE[mort_2017$TREA.PREV==1]<-1
mort_2017$AVOIDABLE[mort_2017$TREA.PREV==2]<-1
mort_2017$AVOIDABLE[mort_2017$TREA.PREV==3]<-1
mort_2017$AVOIDABLE[mort_2017$TREA.PREV==4]<-0

mort_2017$CONTEXTO<-NULL
mort_2017$CONTEXTO[mort_2017$CONTEXTO_DEFUNCION %in% c(1,2,3,4,5,6,7,8,9)]<-1
mort_2017$CONTEXTO[mort_2017$CONTEXTO_DEFUNCION %in% c(10,11,12,99)]<-2
mort_2017$CONTEXTO[mort_2017$CONTEXTO_DEFUNCION %in% c(99)]<-3

#### 2016 Dataset####
mort_2016 <- read.csv("Bases/Bases Federales Defuncion 2015-2016/Defunciones_2016.CSV")
mort_2016$id.ent<-paste0(str_pad(mort_2016$ent_ocurr, 2,pad = "0"))
mort_2016$id.mun<-paste0(str_pad(mort_2016$ent_ocurr, 2,pad = "0"),str_pad(mort_2016$mun_ocurr,3, pad="0"))

mort_2016$FECHA_DEFUNCION<-as.Date(paste0(as.numeric(mort_2016$dia_ocurr),"-",as.numeric(mort_2016$mes_ocurr),"-",as.numeric(mort_2016$anio_ocur)),format = "%d-%m-%Y")
mort_2016<-cbind(mort_2016,data.frame(matrix(unlist(strsplit(as.character(mort_2016$edad), split = "(?=[0-9])", perl = TRUE)), nrow=length(strsplit(as.character(mort_2016$edad), split = "(?=[0-9])", perl = TRUE)), byrow=TRUE)))

mort_2016$X3[mort_2016$X1=="1"]<-"0"
mort_2016$X3[mort_2016$X1=="2"]<-"0"
mort_2016$X3[mort_2016$X1=="3"]<-"0"

mort_2016$X4[mort_2016$X1=="1"]<-"0"
mort_2016$X4[mort_2016$X1=="2"]<-"0"
mort_2016$X4[mort_2016$X1=="3"]<-"0"


mort_2016$edad<-as.numeric(paste0(str_pad(mort_2016$X2, 1),str_pad(mort_2016$X3, 1),str_pad(mort_2016$X4,1)))
mort_2016$edad[mort_2016$edad==998]<-NA

mort_2016<-mort_2016%>%
  filter(mes_ocurr!=99)%>%
  filter(anio_ocur!=9999)%>%
  dplyr::rename("EDAD"=edad, "SEXO"=sexo, "ESTADO_DEFUNCION"=ent_ocurr,"MUNICIPIO"=mun_ocurr, 
                "CONTEXTO_DEFUNCION"=sitio_ocur,"CAUSA_MUERTE_ICD_10_CATEGORIA_1"=causa_def)%>%
  mutate(Year=data.table::year(FECHA_DEFUNCION),MES=data.table::month(FECHA_DEFUNCION))%>%
  filter(Year=="2016")%>%
  filter(MES!=99)%>%
  mutate(FECHA_DEFUNCION=as.character(FECHA_DEFUNCION))%>%
  mutate(FECHA_DEFUNCION=as.Date(FECHA_DEFUNCION))%>%
  mutate(Year=data.table::year(FECHA_DEFUNCION),MES=data.table::month(FECHA_DEFUNCION))

mort_2016$ICD_10_1.CHAPTER<-str_extract(strsplit(mort_2016$CAUSA_MUERTE_ICD_10_CATEGORIA_1,NULL), "[A-Z]+" )
mort_2016$ICD_10_1.CODE<-as.numeric(substr(str_extract(strsplit(mort_2016$CAUSA_MUERTE_ICD_10_CATEGORIA_1, split = "(?<=[a-zA-Z])\\s*(?=[0-9])", perl = TRUE),"([[:digit:]]+)"),start=1,stop=2))

#ICD-10 Coding

#Preventable mortality specific causes
mort_2016$INTE.DIS[(mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=09))]<-1
mort_2016$DI.TE.PO[(mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE==35 | mort_2016$ICD_10_1.CODE==36 | mort_2016$ICD_10_1.CODE==80))]<-1
mort_2016$WHO.COUG[(mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE==37))]<-1
mort_2016$MENINGOC[(mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE==39))]<-1
mort_2016$SEPS.STR[(mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE>=40 & mort_2016$ICD_10_1.CODE<=41))]<-1
mort_2016$HAE.INFL[(mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE==49))]<-1
mort_2016$SEX.INFE[(mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE>=50 & mort_2016$ICD_10_1.CODE<=64))]<-1
mort_2016$VARICELL[(mort_2016$ICD_10_1.CHAPTER=="B" & (mort_2016$ICD_10_1.CODE==1))]<-1
mort_2016$MEASLESS[(mort_2016$ICD_10_1.CHAPTER=="B" & (mort_2016$ICD_10_1.CODE==5))]<-1
mort_2016$RUBELLAA[(mort_2016$ICD_10_1.CHAPTER=="B" & (mort_2016$ICD_10_1.CODE==6))]<-1 
mort_2016$VIRA.HEP[(mort_2016$ICD_10_1.CHAPTER=="B" & (mort_2016$ICD_10_1.CODE>=15 & mort_2016$ICD_10_1.CODE<=19))]<-1 
mort_2016$HIV.AIDS[(mort_2016$ICD_10_1.CHAPTER=="B" & (mort_2016$ICD_10_1.CODE>=20 & mort_2016$ICD_10_1.CODE<=24))]<-1 
mort_2016$MALARIAS[(mort_2016$ICD_10_1.CHAPTER=="B" & (mort_2016$ICD_10_1.CODE>=50 & mort_2016$ICD_10_1.CODE<=54))]<-1 
mort_2016$HAEM.MEN[(mort_2016$ICD_10_1.CHAPTER=="G" & (mort_2016$ICD_10_1.CODE==0))]<-1 
mort_2016$TUBERCUL[((mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE>=15 & mort_2016$ICD_10_1.CODE<=19))|
                      (mort_2016$ICD_10_1.CHAPTER=="B" & (mort_2016$ICD_10_1.CODE==90))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==65)))]<-1
mort_2016$UPG.CANC[(mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=16))]<-1
mort_2016$LIV.CANC[(mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==22))]<-1
mort_2016$LUN.CANC[(mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE>=33 & mort_2016$ICD_10_1.CODE<=34))]<-1
mort_2016$MESOTHEL[(mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==45))]<-1
mort_2016$MELANOMA[(mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==43))]<-1
mort_2016$BLA.CANC[(mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==67))]<-1
mort_2016$CER.CANC[(mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==53))]<-1
mort_2016$NUT.ANEM[(mort_2016$ICD_10_1.CHAPTER=="D" & (mort_2016$ICD_10_1.CODE>=50 & mort_2016$ICD_10_1.CODE<=53))]<-1
mort_2016$DIA.MELL[(mort_2016$ICD_10_1.CHAPTER=="E" & (mort_2016$ICD_10_1.CODE>=10 & mort_2016$ICD_10_1.CODE<=14))]<-1
mort_2016$AOR.ANEU[(mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE==71))]<-1
mort_2016$HYP.DISE[((mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE>=10 & mort_2016$ICD_10_1.CODE<=13))|
                      (mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE==15)))]<-1
mort_2016$ISH.HEAR[(mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE>=20 & mort_2016$ICD_10_1.CODE<=25))]<-1
mort_2016$CER.VASC[(mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE>=60 & mort_2016$ICD_10_1.CODE<=69))]<-1
mort_2016$ATH.DISE[(mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE==70 & mort_2016$ICD_10_1.CODE==73))]<-1
mort_2016$INFLUENZ[(mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE>=9 & mort_2016$ICD_10_1.CODE<=11))]<-1
mort_2016$PNE.STRE[(mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE>=13 & mort_2016$ICD_10_1.CODE<=14))]<-1
mort_2016$CHR.RESP[(mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE>=40 & mort_2016$ICD_10_1.CODE<=44))]<-1
mort_2016$LUN.DISE[((mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE>=60 & mort_2016$ICD_10_1.CODE<=64))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==66 & mort_2016$ICD_10_1.CODE<=70))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==82))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==92)))]<-1
mort_2016$TET.NEON[(mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE==33))]<-1
mort_2016$OBS.TETA[(mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE==34))]<-1
mort_2016$CER.CONG[((mort_2016$ICD_10_1.CHAPTER=="Q" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=1))|
                      (mort_2016$ICD_10_1.CHAPTER=="Q" & (mort_2016$ICD_10_1.CODE==5)))]<-1
mort_2016$TRAN.ACC[(mort_2016$ICD_10_1.CHAPTER=="V" & (mort_2016$ICD_10_1.CODE>=1 & mort_2016$ICD_10_1.CODE<=99))]<-1
mort_2016$ACCI.INJ[((mort_2016$ICD_10_1.CHAPTER=="W" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=39))|
                      (mort_2016$ICD_10_1.CHAPTER=="X" & (mort_2016$ICD_10_1.CODE>=49 & mort_2016$ICD_10_1.CODE<=59)))]<-1
mort_2016$INTE.HAR[(mort_2016$ICD_10_1.CHAPTER=="X" & (mort_2016$ICD_10_1.CODE>=66 & mort_2016$ICD_10_1.CODE<=84))]<-1
mort_2016$ASSA.LES[((mort_2016$ICD_10_1.CHAPTER=="X" & (mort_2016$ICD_10_1.CODE>=86 & mort_2016$ICD_10_1.CODE<=99))|
                      (mort_2016$ICD_10_1.CHAPTER=="Y" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=9)))]<-1
mort_2016$ALCH.DIS[((mort_2016$ICD_10_1.CHAPTER=="E" & (mort_2016$ICD_10_1.CODE==24))|
                      (mort_2016$ICD_10_1.CHAPTER=="F" & (mort_2016$ICD_10_1.CODE==10))|
                      (mort_2016$ICD_10_1.CHAPTER=="G" & (mort_2016$ICD_10_1.CODE==31))|
                      (mort_2016$ICD_10_1.CHAPTER=="G" & (mort_2016$ICD_10_1.CODE==62))|
                      (mort_2016$ICD_10_1.CHAPTER=="G" & (mort_2016$ICD_10_1.CODE==72))|
                      (mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE==42))|
                      (mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE==29))|
                      (mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE==70))|
                      (mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE==85))|
                      (mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE==86))|
                      (mort_2016$ICD_10_1.CHAPTER=="R" & (mort_2016$ICD_10_1.CODE==78))|
                      (mort_2016$ICD_10_1.CHAPTER=="X" & (mort_2016$ICD_10_1.CODE==45))|
                      (mort_2016$ICD_10_1.CHAPTER=="X" & (mort_2016$ICD_10_1.CODE==65))|
                      (mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE>=73 & mort_2016$ICD_10_1.CODE<=74))|
                      (mort_2016$ICD_10_1.CHAPTER=="Y" & (mort_2016$ICD_10_1.CODE==15)))]<-1
mort_2016$DRUG.REL[((mort_2016$ICD_10_1.CHAPTER=="F" & (mort_2016$ICD_10_1.CODE>=11 & mort_2016$ICD_10_1.CODE<=16))|
                      (mort_2016$ICD_10_1.CHAPTER=="F" & (mort_2016$ICD_10_1.CODE>=18 & mort_2016$ICD_10_1.CODE<=19))|
                      (mort_2016$ICD_10_1.CHAPTER=="X" & (mort_2016$ICD_10_1.CODE>=40 & mort_2016$ICD_10_1.CODE<=44))|
                      (mort_2016$ICD_10_1.CHAPTER=="X" & (mort_2016$ICD_10_1.CODE==85))|
                      (mort_2016$ICD_10_1.CHAPTER=="Y" & (mort_2016$ICD_10_1.CODE>=10 & mort_2016$ICD_10_1.CODE<=14))|
                      (mort_2016$ICD_10_1.CHAPTER=="X" & (mort_2016$ICD_10_1.CODE>=60 & mort_2016$ICD_10_1.CODE<=64)))]<-1

mort_2016$RESP.FAL[(mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==96))]<-1 #RESPIRATORY FAILLURE
mort_2016$FLUID.DI[(mort_2016$ICD_10_1.CHAPTER=="E" & (mort_2016$ICD_10_1.CODE==87))]<-1 #Other disorders of fluid, electrolyte and acid-base balance
mort_2016$SHOCK.AN[(mort_2016$ICD_10_1.CHAPTER=="R" & (mort_2016$ICD_10_1.CODE==57))]<-1 #Shock, not elsewhere classified

#Preventable mortality final coding

mort_2016$PREVENT<-NULL
mort_2016$PREVENT[((mort_2016$EDAD>=0 & mort_2016$EDAD<=74) & (mort_2016$INTE.DIS==1|
                                                                 mort_2016$DI.TE.PO==1|
                                                                 mort_2016$WHO.COUG==1|
                                                                 mort_2016$MENINGOC==1|
                                                                 mort_2016$SEPS.STR==1|
                                                                 mort_2016$HAE.INFL==1|
                                                                 mort_2016$SEX.INFE==1|
                                                                 mort_2016$VARICELL==1|
                                                                 mort_2016$MEASLESS==1|
                                                                 mort_2016$RUBELLAA==1|
                                                                 mort_2016$VIRA.HEP==1|
                                                                 mort_2016$HIV.AIDS==1|
                                                                 mort_2016$MALARIAS==1|
                                                                 mort_2016$HAEM.MEN==1|
                                                                 mort_2016$TUBERCUL==1|
                                                                 mort_2016$UPG.CANC==1|
                                                                 mort_2016$LIV.CANC==1|
                                                                 mort_2016$LUN.CANC==1|
                                                                 mort_2016$MESOTHEL==1|
                                                                 mort_2016$MELANOMA==1|
                                                                 mort_2016$BLA.CANC==1|
                                                                 mort_2016$CER.CANC==1|
                                                                 mort_2016$NUT.ANEM==1|
                                                                 mort_2016$DIA.MELL==1|
                                                                 mort_2016$AOR.ANEU==1|
                                                                 mort_2016$HYP.DISE==1|
                                                                 mort_2016$ISH.HEAR==1|
                                                                 mort_2016$CER.VASC==1|
                                                                 mort_2016$ATH.DISE==1|
                                                                 mort_2016$INFLUENZ==1|
                                                                 mort_2016$PNE.STRE==1|
                                                                 mort_2016$CHR.RESP==1|
                                                                 mort_2016$LUN.DISE==1|
                                                                 mort_2016$TET.NEON==1|
                                                                 mort_2016$OBS.TETA==1|
                                                                 mort_2016$CER.CONG==1|
                                                                 mort_2016$TRAN.ACC==1|
                                                                 mort_2016$ACCI.INJ==1|
                                                                 mort_2016$INTE.HAR==1|
                                                                 mort_2016$ASSA.LES==1|
                                                                 mort_2016$ALCH.DIS==1|
                                                                 mort_2016$DRUG.REL==1|
                                                                 mort_2016$RESP.FAL==1|
                                                                 mort_2016$FLUID.DI==1|
                                                                 mort_2016$SHOCK.AN==1))]<-1

#Treatable mortality specific causes

mort_2016$TUBERCUL[((mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE>=15 & mort_2016$ICD_10_1.CODE<=19))|
                      (mort_2016$ICD_10_1.CHAPTER=="B" & (mort_2016$ICD_10_1.CODE==90))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==65)))]<-1
mort_2016$FIE.SCAR[((mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE==38)))]<-1
mort_2016$SEPSIS.A[((mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE>=40 & mort_2016$ICD_10_1.CODE<=41)))]<-1
mort_2016$CELLULIS[((mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE==46))|
                      (mort_2016$ICD_10_1.CHAPTER=="L" & (mort_2016$ICD_10_1.CODE==3)))]<-1
mort_2016$LEGIONEL[((mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE==48)))]<-1
mort_2016$STRE.ENT[((mort_2016$ICD_10_1.CHAPTER=="A" & (mort_2016$ICD_10_1.CODE==49)))]<-1
mort_2016$MENINGIS[((mort_2016$ICD_10_1.CHAPTER=="G" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=3)))]<-1
mort_2016$CERV.CAN[((mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==53)))]<-1
mort_2016$COLO.CAN[((mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE>=18 & mort_2016$ICD_10_1.CODE<=21)))]<-1
mort_2016$BREA.CAN[((mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==50)))]<-1
mort_2016$UTER.CAN[((mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE>=54 & mort_2016$ICD_10_1.CODE<=55)))]<-1
mort_2016$TEST.CAN[((mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==62)))]<-1
mort_2016$THYR.CAN[((mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==73)))]<-1
mort_2016$HODG.CAN[((mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==81)))]<-1
mort_2016$LYMP.CAN[((mort_2016$ICD_10_1.CHAPTER=="C" & (mort_2016$ICD_10_1.CODE==91)))]<-1
mort_2016$BENI.CAN[((mort_2016$ICD_10_1.CHAPTER=="D" & (mort_2016$ICD_10_1.CODE>=10 & mort_2016$ICD_10_1.CODE<=36)))]<-1
mort_2016$DIA.MELL[(mort_2016$ICD_10_1.CHAPTER=="E" & (mort_2016$ICD_10_1.CODE>=10 & mort_2016$ICD_10_1.CODE<=14))]<-1
mort_2016$THRO.DIS[(mort_2016$ICD_10_1.CHAPTER=="E" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=7))]<-1
mort_2016$ADRE.DIS[(mort_2016$ICD_10_1.CHAPTER=="E" & (mort_2016$ICD_10_1.CODE>=24 & mort_2016$ICD_10_1.CODE<=27))]<-1
mort_2016$EPIL.DIS[(mort_2016$ICD_10_1.CHAPTER=="G" & (mort_2016$ICD_10_1.CODE>=40 & mort_2016$ICD_10_1.CODE<=41))]<-1
mort_2016$AOR.ANEU[(mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE==71))]<-1
mort_2016$HYP.DISE[((mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE>=10 & mort_2016$ICD_10_1.CODE<=13))|
                      (mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE==15)))]<-1
mort_2016$ISH.HEAR[(mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE>=20 & mort_2016$ICD_10_1.CODE<=25))]<-1
mort_2016$CER.VASC[(mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE>=60 & mort_2016$ICD_10_1.CODE<=69))]<-1
mort_2016$ATH.DISE[(mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE==70 & mort_2016$ICD_10_1.CODE==73))]<-1
mort_2016$RHE.DISE[(mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=9))]<-1
mort_2016$VEN.TROM[((mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE==26))|
                      (mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE==80))| 
                      (mort_2016$ICD_10_1.CHAPTER=="I" & (mort_2016$ICD_10_1.CODE==82)))]<-1
mort_2016$UPP.RESP[((mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=6))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE>=30 & mort_2016$ICD_10_1.CODE<=39)))]<-1
mort_2016$PNEU.UNS[((mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==12))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==15))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==16))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==17))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==18)))]<-1
mort_2016$AC.LOW.R[((mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==20 & mort_2016$ICD_10_1.CODE<=22)))]<-1
mort_2016$ASTH.BRO[((mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==45 & mort_2016$ICD_10_1.CODE<=47)))]<-1
mort_2016$SIRA.RES[((mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==80)))]<-1
mort_2016$PUL.EDEM[((mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==81)))]<-1
mort_2016$ABS.LUNG[((mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==85))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==86)))]<-1
mort_2016$OTH.PLER[((mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==90))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==93))|
                      (mort_2016$ICD_10_1.CHAPTER=="J" & (mort_2016$ICD_10_1.CODE==94)))]<-1
mort_2016$GAS.DUOD[((mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE>=25 & mort_2016$ICD_10_1.CODE<=28)))]<-1
mort_2016$APPENDIC[((mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE>=35 & mort_2016$ICD_10_1.CODE<=38)))]<-1
mort_2016$ABDO.HER[((mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE>=40 & mort_2016$ICD_10_1.CODE<=46)))]<-1
mort_2016$CHOLELIT[((mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE>=80 & mort_2016$ICD_10_1.CODE<=81)))]<-1
mort_2016$OTH.GALB[((mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE>=82 & mort_2016$ICD_10_1.CODE<=83)))]<-1
mort_2016$ACU.PANC[((mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE==85)))]<-1
mort_2016$OTH.PANC[((mort_2016$ICD_10_1.CHAPTER=="K" & (mort_2016$ICD_10_1.CODE==86)))]<-1
mort_2016$NEPH.NEP[((mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=7)))]<-1
mort_2016$OBS.UROP[((mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE==13))|
                      (mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE>=20 & mort_2016$ICD_10_1.CODE<=21))|
                      (mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE==35)))]<-1
mort_2016$REN.FAIL[((mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE>=17 & mort_2016$ICD_10_1.CODE<=19)))]<-1
mort_2016$REN.COLI[((mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE==23)))]<-1
mort_2016$TUB.DISF[((mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE==25)))]<-1
mort_2016$UNF.NEFP[((mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE>=26 & mort_2016$ICD_10_1.CODE<=27)))]<-1
mort_2016$INF.GENU[((mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE==34))|
                      (mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE==70))|
                      (mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE==73))|
                      (mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE==75))|
                      (mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE==76)))]<-1
mort_2016$PROS.HYP[((mort_2016$ICD_10_1.CHAPTER=="N" & (mort_2016$ICD_10_1.CODE==40)))]<-1
mort_2016$PRE.CHIL[((mort_2016$ICD_10_1.CHAPTER=="O" & (mort_2016$ICD_10_1.CODE>=0 & mort_2016$ICD_10_1.CODE<=99)))]<-1
mort_2016$CONG.CVD[((mort_2016$ICD_10_1.CHAPTER=="Q" & (mort_2016$ICD_10_1.CODE>=20 & mort_2016$ICD_10_1.CODE<=28)))]<-1
mort_2016$DRUGS.AE[((mort_2016$ICD_10_1.CHAPTER=="Y" & (mort_2016$ICD_10_1.CODE>=40 & mort_2016$ICD_10_1.CODE<=59)))]<-1
mort_2016$QX.DR.AE[((mort_2016$ICD_10_1.CHAPTER=="Y" & (mort_2016$ICD_10_1.CODE>=60 & mort_2016$ICD_10_1.CODE<=69))|
                      (mort_2016$ICD_10_1.CHAPTER=="Y" & (mort_2016$ICD_10_1.CODE>=83 & mort_2016$ICD_10_1.CODE<=84)))]<-1
mort_2016$MD.DR.AE[((mort_2016$ICD_10_1.CHAPTER=="Y" & (mort_2016$ICD_10_1.CODE>=70 & mort_2016$ICD_10_1.CODE<=82)))]<-1


#Treatable mortality final coding 

mort_2016$TREATAB<-NULL
mort_2016$TREATAB[((mort_2016$EDAD>=0 & mort_2016$EDAD<=74) & (mort_2016$TUBERCUL==1|
                                                                 mort_2016$FIE.SCAR==1|
                                                                 mort_2016$SEPSIS.A==1|
                                                                 mort_2016$CELLULIS==1|
                                                                 mort_2016$LEGIONEL==1|
                                                                 mort_2016$STRE.ENT==1|
                                                                 mort_2016$MENINGIS==1|
                                                                 mort_2016$COLO.CAN==1|
                                                                 mort_2016$CERV.CAN==1|
                                                                 mort_2016$BREA.CAN==1|
                                                                 mort_2016$UTER.CAN==1|
                                                                 mort_2016$TEST.CAN==1|
                                                                 mort_2016$THYR.CAN==1|
                                                                 mort_2016$HODG.CAN==1|
                                                                 mort_2016$LYMP.CAN==1|
                                                                 mort_2016$BENI.CAN==1|
                                                                 mort_2016$DIA.MELL==1|
                                                                 mort_2016$THRO.DIS==1|
                                                                 mort_2016$ADRE.DIS==1|
                                                                 mort_2016$EPIL.DIS==1|
                                                                 mort_2016$AOR.ANEU==1|
                                                                 mort_2016$HYP.DISE==1|
                                                                 mort_2016$ISH.HEAR==1|
                                                                 mort_2016$CER.VASC==1|
                                                                 mort_2016$ATH.DISE==1|
                                                                 mort_2016$RHE.DISE==1|
                                                                 mort_2016$VEN.TROM==1|
                                                                 mort_2016$UPP.RESP==1|
                                                                 mort_2016$PNEU.UNS==1|
                                                                 mort_2016$AC.LOW.R==1|
                                                                 mort_2016$ASTH.BRO==1|
                                                                 mort_2016$SIRA.RES==1|
                                                                 mort_2016$PUL.EDEM==1|
                                                                 mort_2016$ABS.LUNG==1|
                                                                 mort_2016$OTH.PLER==1|
                                                                 mort_2016$GAS.DUOD==1|
                                                                 mort_2016$APPENDIC==1|
                                                                 mort_2016$ABDO.HER==1|
                                                                 mort_2016$CHOLELIT==1|
                                                                 mort_2016$OTH.GALB==1|
                                                                 mort_2016$ACU.PANC==1|
                                                                 mort_2016$OTH.PANC==1|
                                                                 mort_2016$NEPH.NEP==1|
                                                                 mort_2016$OBS.UROP==1|
                                                                 mort_2016$REN.FAIL==1|
                                                                 mort_2016$REN.COLI==1|
                                                                 mort_2016$TUB.DISF==1|
                                                                 mort_2016$UNF.NEFP==1|
                                                                 mort_2016$INF.GENU==1|
                                                                 mort_2016$PROS.HYP==1|
                                                                 mort_2016$PRE.CHIL==1|
                                                                 mort_2016$CONG.CVD==1|
                                                                 mort_2016$DRUGS.AE==1|
                                                                 mort_2016$QX.DR.AE==1|
                                                                 mort_2016$MD.DR.AE==1))]<-1
#Final coding

mort_2016$TREA.PREV<-NULL
mort_2016$TREA.PREV[mort_2016$TREATAB==1 & (is.na(mort_2016$PREVENT) & !is.na(mort_2016$CAUSA_MUERTE_ICD_10_CATEGORIA_1))]<-1
mort_2016$TREA.PREV[mort_2016$PREVENT==1 & (is.na(mort_2016$TREATAB) & !is.na(mort_2016$CAUSA_MUERTE_ICD_10_CATEGORIA_1))]<-2
mort_2016$TREA.PREV[mort_2016$TREATAB==1 & mort_2016$PREVENT==1]<-3
mort_2016$TREA.PREV[(!is.na(mort_2016$CAUSA_MUERTE_ICD_10_CATEGORIA_1)) & (is.na(mort_2016$TREATAB) & is.na(mort_2016$PREVENT))]<-4

#Cause Specific 

mort_2016$ICD_10_1.SUB<-as.numeric(substring(mort_2016$CAUSA_MUERTE_ICD_10_CATEGORIA_1,4))

## Intestinal Infectious Diseases ##
mort_2016$EII.COLE<-NULL; mort_2016$EII.COLE[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==0))]<-1 #Cholera
mort_2016$EII.TIPA<-NULL; mort_2016$EII.TIPA[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==1))]<-1 #Typhoid and paratyphoid fever
mort_2016$EII.SHIG<-NULL; mort_2016$EII.SHIG[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==3))]<-1 #Shigellosis
mort_2016$EII.TOXI<-NULL; mort_2016$EII.TOXI[with(mort_2016, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==2|ICD_10_1.CODE==5)))]<-1 #Food poisoning
mort_2016$EII.AMEB<-NULL; mort_2016$EII.AMEB[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==6))]<-1 #Amebiasis
mort_2016$EII.OTRA<-NULL; mort_2016$EII.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==4|ICD_10_1.CODE==7|ICD_10_1.CODE==8)))]<-1 #Other GI infection
mort_2016$EII.PRES<-NULL; mort_2016$EII.PRES[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==9))]<-1 #Presumed GI infection

## Tuberculosis ##
mort_2016$TUB.PULM<-NULL; mort_2016$TUB.PULM[with(mort_2016,(ICD_10_1.CHAPTER=="A" & #Pulmonary TB
                                                               ((ICD_10_1.CODE==15 & (ICD_10_1.SUB<=3|ICD_10_1.SUB==7|ICD_10_1.SUB==9))|
                                                                  (ICD_10_1.CODE==16 & (ICD_10_1.SUB<=2|ICD_10_1.SUB==7|ICD_10_1.SUB==9)) ) ))]<-1 
mort_2016$TUB.RESP<-NULL; mort_2016$TUB.RESP[with(mort_2016,(ICD_10_1.CHAPTER=="A" & #Other respiratory TB
                                                               ((ICD_10_1.CODE==15 & (ICD_10_1.SUB==4|ICD_10_1.SUB==5|ICD_10_1.SUB==6|ICD_10_1.SUB==8))|
                                                                  (ICD_10_1.CODE==16 & (ICD_10_1.SUB==3|ICD_10_1.SUB==4|ICD_10_1.SUB==5|ICD_10_1.SUB==8)))))]<-1 
mort_2016$TUB.NERV<-NULL; mort_2016$TUB.NERV[with(mort_2016, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==17) ))]<-1 #Nervous System TB
mort_2016$TUB.IPGM<-NULL; mort_2016$TUB.IPGM[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==3))]<-1 #Intestinal/peritoneal Tb
mort_2016$TUB.BONE<-NULL; mort_2016$TUB.BONE[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==0))]<-1 #Bone and joint Tb
mort_2016$TUB.URIN<-NULL; mort_2016$TUB.URIN[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==18 & ICD_10_1.SUB==1))]<-1 #Genitourinary Tb
mort_2016$TUB.OTRA<-NULL; mort_2016$TUB.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="A" & #Other Tb
                                                                ((ICD_10_1.CODE==18 & (ICD_10_1.SUB==2|ICD_10_1.SUB>=4))|(ICD_10_1.CODE==19)) )) ]<-1

## Other bacterial diseases ##
mort_2016$BAC.PEST<-NULL; mort_2016$BAC.PEST[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==20))]<-1 #Plague (peste)
mort_2016$BAC.BRUS<-NULL; mort_2016$BAC.BRUS[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==23))]<-1 #Brusellosis
mort_2016$BAC.LEPR<-NULL; mort_2016$BAC.LEPR[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==30))]<-1 #Leprosy
mort_2016$BAC.DIFT<-NULL; mort_2016$BAC.DIFT[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==36))]<-1 #Diphtheria
mort_2016$BAC.PERT<-NULL; mort_2016$BAC.PERT[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==37))]<-1 #Pertussis
mort_2016$BAC.PYOG<-NULL; mort_2016$BAC.PYOG[with(mort_2016, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==38|ICD_10_1.CODE==46)))]<-1 #Scarlet fever, erysipelas
mort_2016$BAC.MENI<-NULL; mort_2016$BAC.MENI[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==39))]<-1 #Meningococcal disease
mort_2016$BAC.TETA<-NULL; mort_2016$BAC.TETA[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==35))]<-1 #Tetanus
mort_2016$BAC.SEPS<-NULL; mort_2016$BAC.SEPS[with(mort_2016, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==40|ICD_10_1.CODE==41) ))]<-1 #Sepsis
mort_2016$BAC.OTRA<-NULL; mort_2016$BAC.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="A" &
                                                                (ICD_10_1.CODE==21|ICD_10_1.CODE==22|(ICD_10_1.CODE>=24&ICD_10_1.CODE<=28)|
                                                                   ICD_10_1.CODE==31|ICD_10_1.CODE==32|(ICD_10_1.CODE>=42&ICD_10_1.CODE<=44)|
                                                                   ICD_10_1.CODE==48|ICD_10_1.CODE==49)))]<-1 #Other

## Sexually transmitted diseases ##
mort_2016$ETS.SIF1<-NULL; mort_2016$ETS.SIF1[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==50))]<-1 #Congenital syphilis
mort_2016$ETS.SIF2<-NULL; mort_2016$ETS.SIF2[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==51))]<-1 #Early syphilis
mort_2016$ETS.SIF3<-NULL; mort_2016$ETS.SIF3[with(mort_2016, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==52|ICD_10_1.CODE==53)))]<-1 #Other syphilis
mort_2016$ETS.GONO<-NULL; mort_2016$ETS.GONO[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==54))]<-1 #Gonorrhea
mort_2016$ETS.CLAM<-NULL; mort_2016$ETS.CLAM[with(mort_2016, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==55|ICD_10_1.CODE==56)))]<-1 #Chlamydia
mort_2016$ETS.OTRA<-NULL; mort_2016$ETS.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE>=57&ICD_10_1.CODE<=64)))]<-1 #Other STD



## Viral diseases ##
mort_2016$VIR.POLI<-NULL; mort_2016$VIR.POLI[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==80))]<-1 #Acute Poliomyelitis
mort_2016$VIR.VIRU<-NULL; mort_2016$VIR.VIRU[with(mort_2016, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==3|ICD_10_1.CODE==4)))]<-1 #Smallpox (viruela)
mort_2016$VIR.SARA<-NULL; mort_2016$VIR.SARA[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==5))]<-1 #Measles
mort_2016$VIR.RUBE<-NULL; mort_2016$VIR.RUBE[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==6))]<-1 #Rubella
mort_2016$VIR.FIAM<-NULL; mort_2016$VIR.FIAM[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==95))]<-1 #Yellow fever
mort_2016$VIR.DENG<-NULL; mort_2016$VIR.DENG[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==90))]<-1 #Dengue fever
mort_2016$VIR.DHEM<-NULL; mort_2016$VIR.DHEM[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==91))]<-1 #Dengue hemorragic fever
mort_2016$VIR.VIH1<-NULL; mort_2016$VIR.VIH1[with(mort_2016, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=24)))]<-1 #HIV infection
mort_2016$VIR.EVTA<-NULL; mort_2016$VIR.EVTA[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE==85&ICD_10_1.SUB==2)| #Arthropod-Borne Viral Encephalitis
                                                                                         ICD_10_1.CODE==83|ICD_10_1.CODE==84|ICD_10_1.CODE==86)))]<-1 
mort_2016$VIR.HEPB<-NULL; mort_2016$VIR.HEPB[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==16))]<-1 #Acute Hepatitis B
mort_2016$VIR.HEPO<-NULL; mort_2016$VIR.HEPO[with(mort_2016, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==15| #Other viral hepatitis
                                                                                         (ICD_10_1.CODE>=17&ICD_10_1.CODE<=19))))]<-1 
mort_2016$VIR.RABI<-NULL; mort_2016$VIR.RABI[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==82))]<-1 #Rabies
mort_2016$VIR.TRAC<-NULL; mort_2016$VIR.TRAC[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==71))]<-1 #Trachoma (??)


#Other arthropod-borne viral fevers and viral hemorrhagic fevers
mort_2016$VIR.OFAH<-NULL; mort_2016$VIR.OFAH[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE>=92&ICD_10_1.CODE<=94)|
                                                                                         (ICD_10_1.CODE>=96&ICD_10_1.CODE<=99))))]<-1 
mort_2016$VIR.HERP<-NULL; mort_2016$VIR.HERP[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==0))]<-1 #Herpes simplex infections
mort_2016$VIR.VRHZ<-NULL; mort_2016$VIR.VRHZ[with(mort_2016, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==1|ICD_10_1.CODE==2) ))]<-1 #Chickenpox or herpes zoster
mort_2016$VIR.PARO<-NULL; mort_2016$VIR.PARO[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==26))]<-1 #Mumps
mort_2016$VIR.OCLA<-NULL; mort_2016$VIR.OCLA[with(mort_2016, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE==70|ICD_10_1.CODE==74)))]<-1 #Other chlamydia infections (??)
mort_2016$VIR.OTRA<-NULL; mort_2016$VIR.OTRA[with(mort_2016, ((ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE==85&(ICD_10_1.SUB==0|ICD_10_1.SUB==1|ICD_10_1.SUB==8))|
                                                                                          ICD_10_1.CODE==81|(ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)))|
                                                                (ICD_10_1.CHAPTER=="B" & ((ICD_10_1.CODE>=7&ICD_10_1.CODE<=9)|ICD_10_1.CODE==25|
                                                                                            (ICD_10_1.CODE>=27&ICD_10_1.CODE<=34)))))]<-1 #Other viral diseases


## Rickettsiosis and Protozoan Infections ##
mort_2016$RPI.TIFP<-NULL; mort_2016$RPI.TIFP[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==75 & ICD_10_1.SUB==0))]<-1 #Louse-borne epidemic thypus
mort_2016$RPI.OTIF<-NULL; mort_2016$RPI.OTIF[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==75 & ICD_10_1.SUB!=0))]<-1 #Other thypus
mort_2016$RPI.ORIC<-NULL; mort_2016$RPI.ORIC[with(mort_2016, (ICD_10_1.CHAPTER=="A" & (ICD_10_1.CODE>=77&ICD_10_1.CODE<=79) ))]<-1 #Other rickettsiosis
mort_2016$RPI.PALU<-NULL; mort_2016$RPI.PALU[with(mort_2016, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=54) ))]<-1 #Malaria
mort_2016$RPI.LEIS<-NULL; mort_2016$RPI.LEIS[with(mort_2016, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==55) ))]<-1 #Leishmaniasis
mort_2016$RPI.TRIP<-NULL; mort_2016$RPI.TRIP[with(mort_2016, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==56|ICD_10_1.CODE==57) ))]<-1 #Trypanosomiasis

## Parasitic worms, Mycosis and Other infectious diseases ##
mort_2016$PMO.ESPI<-NULL; mort_2016$PMO.ESPI[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ((ICD_10_1.CODE>=65&ICD_10_1.CODE<=67)|
                                                                                         ICD_10_1.CODE==69)))]<-1 #Other spirochetal diseases (Not syphilis)
mort_2016$PMO.FIRE<-NULL; mort_2016$PMO.FIRE[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==68))]<-1 #Relapsing fevers
mort_2016$PMO.MICO<-NULL; mort_2016$PMO.MICO[with(mort_2016, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=49) ))]<-1 #Mycosis 
mort_2016$PMO.SCHI<-NULL; mort_2016$PMO.SCHI[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==65))]<-1 #Schistosomiasis
mort_2016$PMO.TREM<-NULL; mort_2016$PMO.TREM[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==66))]<-1 #Other fluke (trematoda) infections
mort_2016$PMO.ECHI<-NULL; mort_2016$PMO.ECHI[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==67))]<-1 #Echinococcosis
mort_2016$PMO.DRAC<-NULL; mort_2016$PMO.DRAC[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==72))]<-1 #Dracunculiasis
mort_2016$PMO.ONCH<-NULL; mort_2016$PMO.ONCH[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==73))]<-1 #Onchocerciasis
mort_2016$PMO.FILA<-NULL; mort_2016$PMO.FILA[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==74))]<-1 #Filariasis
mort_2016$PMO.ANNE<-NULL; mort_2016$PMO.ANNE[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==76))]<-1 #Ancylostomiasis or Necatoriasis
mort_2016$PMO.HELM<-NULL; mort_2016$PMO.HELM[with(mort_2016, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==75|(ICD_10_1.CODE>=68&ICD_10_1.CODE<=71)|
                                                                                         (ICD_10_1.CODE>=77&ICD_10_1.CODE<=83))))]<-1 #Other Helminthiases
mort_2016$PMO.OTRA<-NULL; mort_2016$PMO.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="B" & (ICD_10_1.CODE==99|(ICD_10_1.CODE>=58&ICD_10_1.CODE<=64)|
                                                                                         (ICD_10_1.CODE>=85&ICD_10_1.CODE<=89)| 
                                                                                         (ICD_10_1.CODE>=95&ICD_10_1.CODE<=97))))]<-1 #Other infectious/parasitic disease

## Sequelae of infectious diseases ##
mort_2016$SEI.TUBE<-NULL; mort_2016$SEI.TUBE[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==90))]<-1 #Tuberculosis sequelae
mort_2016$SEI.POLI<-NULL; mort_2016$SEI.POLI[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==91))]<-1 #Poliomyelitis sequelae
mort_2016$SEI.LEPR<-NULL; mort_2016$SEI.LEPR[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==92))]<-1 #Leprosy sequelae
mort_2016$SEI.OTRA<-NULL; mort_2016$SEI.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="B" & ICD_10_1.CODE==94))]<-1 #Sequelae from other infections

## Malignant neoplasms 1: lip, oral cavity and pharynx ##
mort_2016$NM1.LCBF<-NULL; mort_2016$NM1.LCBF[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=14)))]<-1

## Malignant neoplasms 2: digestive organs ##
mort_2016$NM2.ESOF<-NULL; mort_2016$NM2.ESOF[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==15))]<-1 #Esophagus
mort_2016$NM2.STOM<-NULL; mort_2016$NM2.STOM[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==16))]<-1 #Stomach
mort_2016$NM2.INDE<-NULL; mort_2016$NM2.INDE[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==17))]<-1 #Small intestine
mort_2016$NM2.COLO<-NULL; mort_2016$NM2.COLO[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==18))]<-1 #Colon
mort_2016$NM2.RECT<-NULL; mort_2016$NM2.RECT[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=19&ICD_10_1.CODE<=21)))]<-1 #Rectosigmoid junction, Rectum, Anus and anal canal
mort_2016$NM2.HIGA<-NULL; mort_2016$NM2.HIGA[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==22))]<-1 #Liver and intrahepatic bile ducts
mort_2016$NM2.PANC<-NULL; mort_2016$NM2.PANC[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==25))]<-1 #Pancreas
mort_2016$NM2.OTRO<-NULL; mort_2016$NM2.OTRO[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==23|ICD_10_1.CODE==24|ICD_10_1.CODE==26)))]<-1 #Other

## Malignant neoplasms 3: respiratory and intrathoracic organs ##
mort_2016$NM3.LARI<-NULL; mort_2016$NM3.LARI[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==32))]<-1 #Larynx
mort_2016$NM3.TBPU<-NULL; mort_2016$NM3.TBPU[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==33|ICD_10_1.CODE==34)))]<-1 #Trachea, bronchus and lung
mort_2016$NM3.OTRO<-NULL; mort_2016$NM3.OTRO[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==30|ICD_10_1.CODE==31|
                                                                                         (ICD_10_1.CODE>=37&ICD_10_1.CODE<=39))))]<-1 #Other

## Malignant neoplasms 4: bone, articular cartilage, skin, soft tissues and breast ##
mort_2016$NM4.BONE<-NULL; mort_2016$NM4.BONE[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==40|ICD_10_1.CODE==41)))]<-1 #Bone and articular cartilage
mort_2016$NM4.MELA<-NULL; mort_2016$NM4.MELA[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==43))]<-1 #Malignant melanoma of skin
mort_2016$NM4.SKIN<-NULL; mort_2016$NM4.SKIN[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==44))]<-1 #Other malignant neoplasm of skin
mort_2016$NM4.MAMA<-NULL; mort_2016$NM4.MAMA[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==50))]<-1 #Breast
mort_2016$NM4.SOFT<-NULL; mort_2016$NM4.SOFT[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=45&ICD_10_1.CODE<=49)))]<-1 #Mesothelial and soft tissue

## Malignant neoplasms 5: genitourinary organs ##
mort_2016$NM5.CERV<-NULL; mort_2016$NM5.CERV[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==53))]<-1 #Cervix uteri
mort_2016$NM5.PLAC<-NULL; mort_2016$NM5.PLAC[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==58))]<-1 #Placenta
mort_2016$NM5.UTER<-NULL; mort_2016$NM5.UTER[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==54|ICD_10_1.CODE==55)))]<-1 #Uterus
mort_2016$NM5.OVAR<-NULL; mort_2016$NM5.OVAR[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==56))]<-1 #Ovary
mort_2016$NM5.VAGI<-NULL; mort_2016$NM5.VAGI[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==51|ICD_10_1.CODE==52)))]<-1 #Vulva and vagina
mort_2016$NM5.OTFE<-NULL; mort_2016$NM5.OTFE[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==57))]<-1 #Other and unspecified (female)
mort_2016$NM5.PROS<-NULL; mort_2016$NM5.PROS[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==61))]<-1 #Prostate
mort_2016$NM5.TEST<-NULL; mort_2016$NM5.TEST[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==62))]<-1 #Testis
mort_2016$NM5.OTMA<-NULL; mort_2016$NM5.OTMA[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==60|ICD_10_1.CODE==63)))]<-1 #Other and unspecified (male)
mort_2016$NM5.VEJI<-NULL; mort_2016$NM5.VEJI[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==67))]<-1 #Bladder
mort_2016$NM5.OTUR<-NULL; mort_2016$NM5.OTUR[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ((ICD_10_1.CODE>=64&ICD_10_1.CODE<=66)|
                                                                                         ICD_10_1.CODE==68)))]<-1 #Other urinary tract neoplasms


## Malignant neoplasms 6: other organs and unspecified sites ##
mort_2016$NM6.ENCF<-NULL; mort_2016$NM6.ENCF[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==71))]<-1 #Brain
mort_2016$NM6.MENI<-NULL; mort_2016$NM6.MENI[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==70|ICD_10_1.CODE==72)))]<-1 #Meninges and other SNC
mort_2016$NM6.OJOA<-NULL; mort_2016$NM6.OJOA[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==69))]<-1 #Eyes and adnexa
mort_2016$NM6.OTRO<-NULL; mort_2016$NM6.OTRO[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=73&ICD_10_1.CODE<=80)))]<-1 #Other and unspecified

## Malignant neoplasms 7: lymphoid, hematopoietic and related tissue ##
mort_2016$NM7.ENHO<-NULL; mort_2016$NM7.ENHO[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==81))]<-1 #Hodgkin lymphoma
mort_2016$NM7.NOHO<-NULL; mort_2016$NM7.NOHO[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=82&ICD_10_1.CODE<=85)))]<-1 #Non-Hodgkin lymphoma
mort_2016$NM7.MMCP<-NULL; mort_2016$NM7.MMCP[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==90))]<-1 #Multiple myeloma and plasmatic cell neoplasms
mort_2016$NM7.LEUC<-NULL; mort_2016$NM7.LEUC[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE>=91&ICD_10_1.CODE<=95)))]<-1 #Leukemias
mort_2016$NM7.OTRO<-NULL; mort_2016$NM7.OTRO[with(mort_2016, (ICD_10_1.CHAPTER=="C" & (ICD_10_1.CODE==88|ICD_10_1.CODE==96)))]<-1 #Other


## Malignant neoplasms 8: multiple primary tumors ##
mort_2016$NM8.MUPT<-NULL; mort_2016$NM8.MUPT[with(mort_2016, (ICD_10_1.CHAPTER=="C" & ICD_10_1.CODE==97))]<-1

## In situ neoplasms ##
mort_2016$NIS.CERV<-NULL; mort_2016$NIS.CERV[with(mort_2016, (ICD_10_1.CHAPTER=="D" & ICD_10_1.CODE==6))]<-1 #Cervix uteri
mort_2016$NIS.OTRO<-NULL; mort_2016$NIS.OTRO[with(mort_2016, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=5)| #Other in situ neoplasms
                                                                                         (ICD_10_1.CODE>=7&ICD_10_1.CODE<=9))))]<-1

## Benign neoplasms ##
mort_2016$NBE.SKIN<-NULL; mort_2016$NBE.SKIN[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==22|ICD_10_1.CODE==23) ))]<-1 #Skin
mort_2016$NBE.MAMA<-NULL; mort_2016$NBE.MAMA[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==24)))]<-1 #Breast
mort_2016$NBE.LEIO<-NULL; mort_2016$NBE.LEIO[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==25)))]<-1 #Leiomyoma of uterus
mort_2016$NBE.OVAR<-NULL; mort_2016$NBE.OVAR[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==27)))]<-1 #Ovary
mort_2016$NBE.URIN<-NULL; mort_2016$NBE.URIN[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==30)))]<-1 #Urinary tract
mort_2016$NBE.CSNC<-NULL; mort_2016$NBE.CSNC[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==33)))]<-1 #Brain and other CNS sites
mort_2016$NBE.TIRO<-NULL; mort_2016$NBE.TIRO[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==34)))]<-1 #Thyroid
mort_2016$NBE.OTRO<-NULL; mort_2016$NBE.OTRO[with(mort_2016, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=21)|ICD_10_1.CODE==26|
                                                                                         ICD_10_1.CODE==28|ICD_10_1.CODE==29|ICD_10_1.CODE==31|
                                                                                         ICD_10_1.CODE==32|ICD_10_1.CODE==35|ICD_10_1.CODE==36)))]<-1 #Other


## Neoplasms of uncertain behaviour ##
mort_2016$NCI.UNCB<-NULL; mort_2016$NCI.UNCB[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=37&ICD_10_1.CODE<=48)))]<-1

## Diseases of the blood and blood-forming organs and certain disorders involving the immune mechanism ##
mort_2016$SAN.ADFE<-NULL; mort_2016$SAN.ADFE[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE==50)))]<-1 #Iron deficiency anemia
mort_2016$SAN.AOTR<-NULL; mort_2016$SAN.AOTR[with(mort_2016, (ICD_10_1.CHAPTER=="D" & ((ICD_10_1.CODE>=51&ICD_10_1.CODE<=62)|ICD_10_1.CODE==64)))]<-1 #Other anemias
mort_2016$SAN.INMU<-NULL; mort_2016$SAN.INMU[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=89)))]<-1 #Immunity disorders
mort_2016$SAN.OTRA<-NULL; mort_2016$SAN.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="D" & (ICD_10_1.CODE>=65&ICD_10_1.CODE<=76)))]<-1 #Other

## Endocrine and metabolic diseases ##
mort_2016$END.DEYO<-NULL; mort_2016$END.DEYO[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)))]<-1 #Iodine deficiency thyroid disorders
mort_2016$END.TTOX<-NULL; mort_2016$END.TTOX[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==5)))]<-1 #Thyrotoxicosis
mort_2016$END.TOTR<-NULL; mort_2016$END.TOTR[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==3|ICD_10_1.CODE==4|ICD_10_1.CODE==6|
                                                                                         ICD_10_1.CODE==7) ))]<-1 #Other thyroid disorders
mort_2016$END.DIAB<-NULL; mort_2016$END.DIAB[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=14)))]<-1 #Type 2 diabetes mellitus
mort_2016$END.LIPO<-NULL; mort_2016$END.LIPO[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==78)))]<-1 #Metabolism disorders and dyslipidemia
mort_2016$END.OBES<-NULL; mort_2016$END.OBES[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==66)))]<-1 #Obesity
mort_2016$END.DEPL<-NULL; mort_2016$END.DEPL[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==86)))]<-1 #Volume depletion
mort_2016$END.SQHA<-NULL; mort_2016$END.SQHA[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==68)))]<-1 #Sequelae of hyperalimentation
mort_2016$END.OTRA<-NULL; mort_2016$END.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="E" & ((ICD_10_1.CODE>=15&ICD_10_1.CODE<=34)|ICD_10_1.CODE==65|
                                                                                         ICD_10_1.CODE==67|(ICD_10_1.CODE>=70&ICD_10_1.CODE<=77)|
                                                                                         (ICD_10_1.CODE>=79&ICD_10_1.CODE<=85)|
                                                                                         (ICD_10_1.CODE>=87&ICD_10_1.CODE<=88))))]<-1 #Other


## Malnutrition and other nutritional deficiencies ##
mort_2016$NUT.KWAS<-NULL; mort_2016$NUT.KWAS[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==40|ICD_10_1.CODE==42) ))]<-1 #Kwashiorkor
mort_2016$NUT.MARA<-NULL; mort_2016$NUT.MARA[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==41) ))]<-1 #Nutritional marasmus
mort_2016$NUT.PROT<-NULL; mort_2016$NUT.PROT[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=43&ICD_10_1.CODE<=46)))]<-1 #Other protein-calorie malnutrition
mort_2016$NUT.VITA<-NULL; mort_2016$NUT.VITA[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==50) ))]<-1 #Vitamin A deficiency
mort_2016$NUT.VITO<-NULL; mort_2016$NUT.VITO[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=51&ICD_10_1.CODE<=56)))]<-1 #Other vitamin deficiencies
mort_2016$NUT.SECD<-NULL; mort_2016$NUT.SECD[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE==64) ))]<-1 #Sequelae of malnutrition
mort_2016$NUT.OTRA<-NULL; mort_2016$NUT.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="E" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=63)))]<-1 #Other nutritional deficiencies


## Mental, Behavioral and Neurodevelopmental disorders ##
mort_2016$MEN.DEME<-NULL; mort_2016$MEN.DEME[with(mort_2016, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE==1|ICD_10_1.CODE==3)))]<-1 #Dementia
mort_2016$MEN.SDAL<-NULL; mort_2016$MEN.SDAL[with(mort_2016, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==10 & ICD_10_1.SUB==2))]<-1 #Alcohol dependence syndrome
mort_2016$MEN.OTAL<-NULL; mort_2016$MEN.OTAL[with(mort_2016, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==10 & ICD_10_1.SUB!=2))]<-1 #Other alcohol related disorders
mort_2016$MEN.TMSP<-NULL; mort_2016$MEN.TMSP[with(mort_2016, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=11&ICD_10_1.CODE<=19)))]<-1 #Mental and behavioral disorders due to other psychoactive substances use
mort_2016$MEN.ESQU<-NULL; mort_2016$MEN.ESQU[with(mort_2016, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=29)))]<-1 #Schizophrenia, schizotypal, delusional, and other non-mood psychotic disorders
mort_2016$MEN.HUMO<-NULL; mort_2016$MEN.HUMO[with(mort_2016, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=39)))]<-1 #Mood [affective] disorders
mort_2016$MEN.ESTR<-NULL; mort_2016$MEN.ESTR[with(mort_2016, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=48)))]<-1 #Anxiety, dissociative, stress-related, somatoform and other nonpsychotic mental disorders
mort_2016$MEN.FISI<-NULL; mort_2016$MEN.FISI[with(mort_2016, (ICD_10_1.CHAPTER=="F" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=59)&
                                                                                         (ICD_10_1.CODE!=53) )))]<-1 #Behavioral syndromes associated with physiological disturbances and physical factors
mort_2016$MEN.RETR<-NULL; mort_2016$MEN.RETR[with(mort_2016, (ICD_10_1.CHAPTER=="F" & (ICD_10_1.CODE>=70&ICD_10_1.CODE<=79)))]<-1 #Intellectual disabilities
mort_2016$MEN.OTRO<-NULL; mort_2016$MEN.OTRO[with(mort_2016, (ICD_10_1.CHAPTER=="F" & ((ICD_10_1.CODE>=4&ICD_10_1.CODE<=9)|(ICD_10_1.CODE>=60&ICD_10_1.CODE<=69)|
                                                                                         (ICD_10_1.CODE>=80&ICD_10_1.CODE<=99))))]<-1 #Other mental and behavioral disorders



## Diseases of the nervous system ##
mort_2016$NER.MENI<-NULL; mort_2016$NER.MENI[with(mort_2016, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==0|ICD_10_1.CODE==3)))]<-1 #Meningitis
mort_2016$NER.ISNC<-NULL; mort_2016$NER.ISNC[with(mort_2016, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=4&ICD_10_1.CODE<=9)))]<-1 #Other inflammatory diseases of the central nervous system
mort_2016$NER.PARK<-NULL; mort_2016$NER.PARK[with(mort_2016, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==20)))]<-1 #Parkinson's disease
mort_2016$NER.ALZH<-NULL; mort_2016$NER.ALZH[with(mort_2016, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==30)))]<-1 #Alzheimer's disease
mort_2016$NER.ESCM<-NULL; mort_2016$NER.ESCM[with(mort_2016, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==35)))]<-1 #Multiple sclerosis
mort_2016$NER.PALS<-NULL; mort_2016$NER.PALS[with(mort_2016, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=83)))]<-1 #Cerebral palsy and other paralytic syndromes
mort_2016$NER.EPIL<-NULL; mort_2016$NER.EPIL[with(mort_2016, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=41)))]<-1 #Epilepsy and recurrent seizures
mort_2016$NER.MIGR<-NULL; mort_2016$NER.MIGR[with(mort_2016, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=43&ICD_10_1.CODE<=44)))]<-1 #Migraine and other headache syndromes
mort_2016$NER.IQCT<-NULL; mort_2016$NER.IQCT[with(mort_2016, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE==45)))]<-1 #Transient cerebral ischemic attacks and related syndromes
mort_2016$NER.SNPE<-NULL; mort_2016$NER.SNPE[with(mort_2016, (ICD_10_1.CHAPTER=="G" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=59)))]<-1 #Nerve, nerve root and plexus disorders
mort_2016$NER.OTRA<-NULL; mort_2016$NER.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="G" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=12)|(ICD_10_1.CODE>=21&ICD_10_1.CODE<=25)|
                                                                                         (ICD_10_1.CODE==31)|(ICD_10_1.CODE==36)|(ICD_10_1.CODE==37)|(ICD_10_1.CODE==47)|
                                                                                         (ICD_10_1.CODE>=60&ICD_10_1.CODE<=62)|(ICD_10_1.CODE>=64&ICD_10_1.CODE<=72)|
                                                                                         (ICD_10_1.CODE>=90&ICD_10_1.CODE<=93)|(ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other



## Diseases of the eye and adnexa ##
mort_2016$EYE.PARP<-NULL; mort_2016$EYE.PARP[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Eyelid inflammation
mort_2016$EYE.ESCL<-NULL; mort_2016$EYE.ESCL[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=15&ICD_10_1.CODE<=19)))]<-1 #Disorders of sclera and cornea
mort_2016$EYE.GLAU<-NULL; mort_2016$EYE.GLAU[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==40)))]<-1 #Glaucoma
mort_2016$EYE.CATA<-NULL; mort_2016$EYE.CATA[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=25&ICD_10_1.CODE<=26)))]<-1 #Cataracts
mort_2016$EYE.CRIS<-NULL; mort_2016$EYE.CRIS[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==27)))]<-1 #Other disorders of lens
mort_2016$EYE.RETI<-NULL; mort_2016$EYE.RETI[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==33)))]<-1 #Retinal detachments and breaks
mort_2016$EYE.CEGU<-NULL; mort_2016$EYE.CEGU[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==54)))]<-1 #Blindness and low vision
mort_2016$EYE.CONJ<-NULL; mort_2016$EYE.CONJ[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==10)))]<-1 #Conjunctivitis
mort_2016$EYE.OTCO<-NULL; mort_2016$EYE.OTCO[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==11)))]<-1 #Other disorders of conjunctiva
mort_2016$EYE.LAGR<-NULL; mort_2016$EYE.LAGR[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==4)))]<-1 #Disorders of lacrimal system
mort_2016$EYE.ESTR<-NULL; mort_2016$EYE.ESTR[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=49&ICD_10_1.CODE<=50)))]<-1 #Strabismus
mort_2016$EYE.BINO<-NULL; mort_2016$EYE.BINO[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==51)))]<-1 #Other disorders of binocular movement
mort_2016$EYE.REFR<-NULL; mort_2016$EYE.REFR[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE==52)))]<-1 #Disorders of refraction and accommodation
mort_2016$EYE.OTRA<-NULL; mort_2016$EYE.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE==2)|(ICD_10_1.CODE==5)|(ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)|
                                                                                         (ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)|(ICD_10_1.CODE>=34&ICD_10_1.CODE<=35)|
                                                                                         (ICD_10_1.CODE>=43&ICD_10_1.CODE<=44)|(ICD_10_1.CODE>=46&ICD_10_1.CODE<=47)|
                                                                                         (ICD_10_1.CODE==53)|(ICD_10_1.CODE==59)|
                                                                                         (ICD_10_1.CODE>=55&ICD_10_1.CODE<=57))))]<-1 #Other

## Diseases of the ear and mastoid process ##
mort_2016$EAR.OMTM<-NULL; mort_2016$EAR.OMTM[with(mort_2016, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE==65)|(ICD_10_1.CODE==66)| #Otitis media, disorders of Eustachian tube and mastoiditis
                                                                                         (ICD_10_1.CODE>=68&ICD_10_1.CODE<=70))))]<-1
mort_2016$EAR.OTOM<-NULL; mort_2016$EAR.OTOM[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=71&ICD_10_1.CODE<=74)))]<-1 #Other middle ear disorders
mort_2016$EAR.SORD<-NULL; mort_2016$EAR.SORD[with(mort_2016, (ICD_10_1.CHAPTER=="H" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=91)))]<-1 #Hearing loss
mort_2016$EAR.OTRA<-NULL; mort_2016$EAR.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="H" & ((ICD_10_1.CODE>=60&ICD_10_1.CODE<=61)|(ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)|
                                                                                         (ICD_10_1.CODE>=92&ICD_10_1.CODE<=93)|(ICD_10_1.CODE==83)|(ICD_10_1.CODE==95))))]<-1 #Other


##  Diseases of the circulatory system 1: acute rheumatic fever and chronic rheumatic heart diseases ##
mort_2016$SC1.FIRE<-NULL; mort_2016$SC1.FIRE[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)))]<-1 #Acute rheumatic fever
mort_2016$SC1.CRHD<-NULL; mort_2016$SC1.CRHD[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=5&ICD_10_1.CODE<=9)))]<-1 #Chronic rheumatic heart diseases


## Diseases of the circulatory system 2: hypertensive diseases ##
mort_2016$SC2.ECHI<-NULL; mort_2016$SC2.ECHI[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==11|ICD_10_1.CODE==13)))]<-1 #Hypertensive heart disease
mort_2016$SC2.HTES<-NULL; mort_2016$SC2.HTES[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==10)))]<-1 #Essential (primary) hypertension
mort_2016$SC2.OTRA<-NULL; mort_2016$SC2.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==12)))]<-1 #Other


## Diseases of the circulatory system 3: ischemic heart diseases ##
mort_2016$SC3.IAMC<-NULL; mort_2016$SC3.IAMC[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==21|ICD_10_1.CODE==22)))]<-1 #Acute myocardial infarction
mort_2016$SC3.OTRA<-NULL; mort_2016$SC3.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=23&ICD_10_1.CODE<=25)|
                                                                                         ICD_10_1.CODE==20)))]<-1 #Other

## Diseases of the circulatory system 4: diseases of pulmonary circulation and other heart diseases ##
mort_2016$SC4.EMBP<-NULL; mort_2016$SC4.EMBP[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==26)))]<-1 #Pulmonary embolism
mort_2016$SC4.CARR<-NULL; mort_2016$SC4.CARR[with(mort_2016, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=45)| #Conduction disorders and arrhythmia
                                                                                         (ICD_10_1.CODE>=47&ICD_10_1.CODE<=49))))]<-1
mort_2016$SC4.PARO<-NULL; mort_2016$SC4.PARO[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==46)))]<-1 #Cardiac arrest
mort_2016$SC4.HEFA<-NULL; mort_2016$SC4.HEFA[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==50)))]<-1 #Heart failure
mort_2016$SC4.OTRA<-NULL; mort_2016$SC4.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=27&ICD_10_1.CODE<=31)|(ICD_10_1.CODE>=33&ICD_10_1.CODE<=38)|
                                                                                         ICD_10_1.CODE==40|ICD_10_1.CODE==42|ICD_10_1.CODE==51)))]<-1  #Other


## Diseases of the circulatory system 5: cerebrovascular diseases ##
mort_2016$SC5.HEMS<-NULL; mort_2016$SC5.HEMS[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==60)))]<-1 #Subarachnoid hemorrhage
mort_2016$SC5.HEMI<-NULL; mort_2016$SC5.HEMI[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=61&ICD_10_1.CODE<=62)))]<-1 #Intracerebral and other intracranial hemorrhage
mort_2016$SC5.ISQC<-NULL; mort_2016$SC5.ISQC[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==63)))]<-1 #Cerebral infarction
mort_2016$SC5.EVCN<-NULL; mort_2016$SC5.EVCN[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==64)))]<-1 #Unspecified (hemorrhagic vs isquemic)
mort_2016$SC5.ATSC<-NULL; mort_2016$SC5.ATSC[with(mort_2016, (ICD_10_1.CHAPTER=="I" & ICD_10_1.CODE==67 & ICD_10_1.SUB==2))]<-1 #Cerebral atherosclerosis
mort_2016$SC5.SEQC<-NULL; mort_2016$SC5.SEQC[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==69)))]<-1 #Sequelae of cerebrovascular disease
mort_2016$SC5.OTRA<-NULL; mort_2016$SC5.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==65|ICD_10_1.CODE==66| #Other
                                                                                         (ICD_10_1.CODE==67&ICD_10_1.SUB!=2)) ))]<-1


## Diseases of the circulatory system 6: other diseases of the circulatory system ##
mort_2016$SC6.ATER<-NULL; mort_2016$SC6.ATER[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==70)))]<-1 #Atherosclerosis
mort_2016$SC6.OEVP<-NULL; mort_2016$SC6.OEVP[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==73)))]<-1 #Other peripheral vascular diseases
mort_2016$SC6.ETAR<-NULL; mort_2016$SC6.ETAR[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==74)))]<-1 #Arterial embolism and thrombosis
mort_2016$SC6.OTAR<-NULL; mort_2016$SC6.OTAR[with(mort_2016, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=71&ICD_10_1.CODE<=72)| #Other diseases of arteries, arterioles and capillaries
                                                                                         (ICD_10_1.CODE>=77&ICD_10_1.CODE<=78))))]<-1
mort_2016$SC6.ETVE<-NULL; mort_2016$SC6.ETVE[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=82)))]<-1 #Phlebitis, trombophlebitis, other venous embolism and thrombosis
mort_2016$SC6.VARI<-NULL; mort_2016$SC6.VARI[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==83)))]<-1 #Varicose veins of lower extremities
mort_2016$SC6.HMRR<-NULL; mort_2016$SC6.HMRR[with(mort_2016, (ICD_10_1.CHAPTER=="I" & (ICD_10_1.CODE==84)))]<-1 #Hemorrhoids
mort_2016$SC6.OTRA<-NULL; mort_2016$SC6.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="I" & ((ICD_10_1.CODE>=85&ICD_10_1.CODE<=97)| #Other
                                                                                         ICD_10_1.CODE==99)))]<-1


## Respiratory tract diseases 1: acute upper respiratory infections and other diseases of upper respiratory tract ##
mort_2016$ER1.FAAG<-NULL; mort_2016$ER1.FAAG[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==2)))]<-1 #Acute pharyngitis
mort_2016$ER1.TOAG<-NULL; mort_2016$ER1.TOAG[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==3)))]<-1 #Acute tonsillitis
mort_2016$ER1.LTAG<-NULL; mort_2016$ER1.LTAG[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==4)))]<-1 #Acute laryngitis and tracheitis
mort_2016$ER1.OTAG<-NULL; mort_2016$ER1.OTAG[with(mort_2016, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)| #Other acute upper respiratory infections
                                                                                         (ICD_10_1.CODE>=5&ICD_10_1.CODE<=6))))]<-1
mort_2016$ER1.PNSD<-NULL; mort_2016$ER1.PNSD[with(mort_2016, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE==33)| #Nasal polyp and deviated nasal septum
                                                                                         (ICD_10_1.CODE==34&ICD_10_1.SUB==2))))]<-1 
mort_2016$ER1.RNPC<-NULL; mort_2016$ER1.RNPC[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)))]<-1 #Chronic rhinitis, nasopharyngitis and pharyngitis
mort_2016$ER1.SINC<-NULL; mort_2016$ER1.SINC[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==32)))]<-1 #Chronic sinusitis
mort_2016$ER1.TADC<-NULL; mort_2016$ER1.TADC[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==35)))]<-1 #Chronic diseases of tonsils and adenoids
mort_2016$ER1.ONSN<-NULL; mort_2016$ER1.ONSN[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==34&(ICD_10_1.SUB!=2&ICD_10_1.SUB!=9))))]<-1 #Other disorders of nose and nasal sinuses
mort_2016$ER1.OTRA<-NULL; mort_2016$ER1.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=36&ICD_10_1.CODE<=39)))]<-1 #Other


## Respiratory tract diseases 2: other respiratory tract diseases ##
mort_2016$ER2.BRAG<-NULL; mort_2016$ER2.BRAG[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Acute bronchitis and bronchiolitis
mort_2016$ER2.NEUM<-NULL; mort_2016$ER2.NEUM[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=12&ICD_10_1.CODE<=18)))]<-1 #Pneumonia
mort_2016$ER2.INFL<-NULL; mort_2016$ER2.INFL[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=9&ICD_10_1.CODE<=11)))]<-1 #Influenza
mort_2016$ER2.BCNE<-NULL; mort_2016$ER2.BCNE[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=43)))]<-1 #Chronic and unspecified bronchitis, emphysema
mort_2016$ER2.ASMA<-NULL; mort_2016$ER2.ASMA[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=45&ICD_10_1.CODE<=46)))]<-1 #Asthma
mort_2016$ER2.BREC<-NULL; mort_2016$ER2.BREC[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==47)))]<-1 #Bronchiectasis
mort_2016$ER2.EPOC<-NULL; mort_2016$ER2.EPOC[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==44)))]<-1 #Chronic obstructive pulmonary disease
mort_2016$ER2.NMCS<-NULL; mort_2016$ER2.NMCS[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=65)))]<-1 #Pneumoconiosis
mort_2016$ER2.OTAE<-NULL; mort_2016$ER2.OTAE[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=66&ICD_10_1.CODE<=70)))]<-1 #Other pulmonary diseases due to external agents
mort_2016$ER2.PLEU<-NULL; mort_2016$ER2.PLEU[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=94)))]<-1 #Pleural conditions
mort_2016$ER2.IRIN<-NULL; mort_2016$ER2.IRIN[with(mort_2016, (ICD_10_1.CHAPTER=="J" & (ICD_10_1.CODE==22)))]<-1 #Unspecified acute lower respiratory infection
mort_2016$ER2.OTRA<-NULL; mort_2016$ER2.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="J" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=86)|
                                                                                         (ICD_10_1.CODE>=95&ICD_10_1.CODE<=98))))]<-1 #Other


## Diseases of the digestive system 1: oral cavity and salivary glands ##
mort_2016$SD1.CARI<-NULL; mort_2016$SD1.CARI[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==2)))]<-1 #Dental caries
mort_2016$SD1.OTDI<-NULL; mort_2016$SD1.OTDI[with(mort_2016, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)| #Other disorders of teeth and supporting structures
                                                                                         (ICD_10_1.CODE>=3&ICD_10_1.CODE<=8))))]<-1
mort_2016$SD1.OTJA<-NULL; mort_2016$SD1.OTJA[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==10)))]<-1 #Other diseases of jaw
mort_2016$SD1.OTRA<-NULL; mort_2016$SD1.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=11&ICD_10_1.CODE<=14)|ICD_10_1.CODE==9)))]<-1 #Other


## Diseases of the digestive system 2: esophagus, stomach, intestines, hernia ##
mort_2016$SD2.ESOF<-NULL; mort_2016$SD2.ESOF[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=22)))]<-1 #Diseases of esophagus
mort_2016$SD2.GDIS<-NULL; mort_2016$SD2.GDIS[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==29)))]<-1 #Gastritis and duodenitis
mort_2016$SD2.GDUL<-NULL; mort_2016$SD2.GDUL[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=25&ICD_10_1.CODE<=27)))]<-1 #Gastric and duodenal ulcer
mort_2016$SD2.OTGD<-NULL; mort_2016$SD2.OTGD[with(mort_2016, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=30&ICD_10_1.CODE<=31)|ICD_10_1.CODE==28)))]<-1 #Other diseases of stomach and duodenum
mort_2016$SD2.APEN<-NULL; mort_2016$SD2.APEN[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=38)))]<-1 #Diseases of appendix
mort_2016$SD2.INHE<-NULL; mort_2016$SD2.INHE[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==40)))]<-1 #Inguinal hernia
mort_2016$SD2.OTHE<-NULL; mort_2016$SD2.OTHE[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=41&ICD_10_1.CODE<=46)))]<-1 #Other hernias
mort_2016$SD2.CRCU<-NULL; mort_2016$SD2.CRCU[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=51)))]<-1 #Crohn's disease and ulcerative colitis
mort_2016$SD2.PIIO<-NULL; mort_2016$SD2.PIIO[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==56)))]<-1 #Paralytic ileus and intestinal obstruction without hernia
mort_2016$SD2.EDDI<-NULL; mort_2016$SD2.EDDI[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==57)))]<-1 #Diverticular disease of intestine
mort_2016$SD2.SIIO<-NULL; mort_2016$SD2.SIIO[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=59)))]<-1 #Irritable bowel syndrome and other functional intestinal disorders


## Diseases of the digestive system 3: liver and other parts of digestive system ##
mort_2016$SD3.ALLD<-NULL; mort_2016$SD3.ALLD[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE==70)))]<-1 #Alcoholic liver disease
mort_2016$SD3.OTLI<-NULL; mort_2016$SD3.OTLI[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=71&ICD_10_1.CODE<=76)))]<-1 #Other diseases of liver
mort_2016$SD3.COLE<-NULL; mort_2016$SD3.COLE[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)))]<-1 #Cholelithiasis and cholecystitis
mort_2016$SD3.OTIP<-NULL; mort_2016$SD3.OTIP[with(mort_2016, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=52&ICD_10_1.CODE<=55)|
                                                                                         ICD_10_1.CODE>=60&ICD_10_1.CODE<=66)))]<-1 #Other diseases of intestines and peritoneum
mort_2016$SD3.PANC<-NULL; mort_2016$SD3.PANC[with(mort_2016, (ICD_10_1.CHAPTER=="K" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Acute pancreatitis and other diseases of pancreas
mort_2016$SD3.OTRA<-NULL; mort_2016$SD3.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="K" & ((ICD_10_1.CODE>=82&ICD_10_1.CODE<=83)|
                                                                                         ICD_10_1.CODE>=87&ICD_10_1.CODE<=93)))]<-1 #Other diseases of digestive system



## Diseases of the skin and subcutaneous tissue ##
mort_2016$PTS.IPTS<-NULL; mort_2016$PTS.IPTS[with(mort_2016, (ICD_10_1.CHAPTER=="L" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=8)))]<-1 #Infections of the skin and subcutaneous tissue
mort_2016$PTS.DEEC<-NULL; mort_2016$PTS.DEEC[with(mort_2016, (ICD_10_1.CHAPTER=="L" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=30)))]<-1 #Dermatitis and eczema
mort_2016$PTS.OTRA<-NULL; mort_2016$PTS.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="L" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=13)|(ICD_10_1.CODE>=40&ICD_10_1.CODE<=44)|
                                                                                         (ICD_10_1.CODE>=50&ICD_10_1.CODE<=53)|(ICD_10_1.CODE>=55&ICD_10_1.CODE<=60)|
                                                                                         (ICD_10_1.CODE>=63&ICD_10_1.CODE<=85)|(ICD_10_1.CODE>=87&ICD_10_1.CODE<=98))))]<-1 #Other


## Diseases of the musculoskeletal system and connective tissue ##
mort_2016$MOC.PAIN<-NULL; mort_2016$MOC.PAIN[with(mort_2016, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=5&ICD_10_1.CODE<=6)|(ICD_10_1.CODE==8)|
                                                                                         (ICD_10_1.CODE>=10&ICD_10_1.CODE<=13))))]<-1 #Inflammatory polyarthropathies
mort_2016$MOC.OSAR<-NULL; mort_2016$MOC.OSAR[with(mort_2016, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=15&ICD_10_1.CODE<=19)))]<-1 #Osteoarthritis
mort_2016$MOC.ADOL<-NULL; mort_2016$MOC.ADOL[with(mort_2016, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Acquired deformities of limbs
mort_2016$MOC.OTAR<-NULL; mort_2016$MOC.OTAR[with(mort_2016, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)| 
                                                                                         (ICD_10_1.CODE>=22&ICD_10_1.CODE<=25))))]<-1 #Other joint disorders
mort_2016$MOC.SCTD<-NULL; mort_2016$MOC.SCTD[with(mort_2016, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=30&ICD_10_1.CODE<=35)))]<-1 #Systemic connective tissue disorders
mort_2016$MOC.IVDD<-NULL; mort_2016$MOC.IVDD[with(mort_2016, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE>=50&ICD_10_1.CODE<=51)))]<-1 #Intervertebral disc disorders
mort_2016$MOC.OTDO<-NULL; mort_2016$MOC.OTDO[with(mort_2016, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=40&ICD_10_1.CODE<=48)| 
                                                                                         (ICD_10_1.CODE>=53&ICD_10_1.CODE<=54))))]<-1 #Other dorsopathies
mort_2016$MOC.SOFT<-NULL; mort_2016$MOC.SOFT[with(mort_2016, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=60&ICD_10_1.CODE<=62)|(ICD_10_1.CODE>=65&ICD_10_1.CODE<=67)|
                                                                                         (ICD_10_1.CODE>=70&ICD_10_1.CODE<=72)|(ICD_10_1.CODE>=75&ICD_10_1.CODE<=79))))]<-1 #Soft tissue disorders
mort_2016$MOC.BONE<-NULL; mort_2016$MOC.BONE[with(mort_2016, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=80&ICD_10_1.CODE<=81)|(ICD_10_1.CODE==83&ICD_10_1.SUB!=0)|
                                                                                         (ICD_10_1.CODE>=84&ICD_10_1.CODE<=85))))]<-1 #Disorders of bone density and structure
mort_2016$MOC.OMIE<-NULL; mort_2016$MOC.OMIE[with(mort_2016, (ICD_10_1.CHAPTER=="M" & (ICD_10_1.CODE==86)))]<-1 #Osteomyelitis
mort_2016$MOC.OTRA<-NULL; mort_2016$MOC.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="M" & ((ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)|
                                                                                         (ICD_10_1.CODE>=91&ICD_10_1.CODE<=99))))]<-1 #Other



## Diseases of the genitourinary system 1: urinary system ##
mort_2016$GU1.NFRI<-NULL; mort_2016$GU1.NFRI[with(mort_2016, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Acute and rapidly progressive nephritic syndrome
mort_2016$GU1.OTGL<-NULL; mort_2016$GU1.OTGL[with(mort_2016, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=2&ICD_10_1.CODE<=8)))]<-1 #Other glomerular diseases
mort_2016$GU1.ACKF<-NULL; mort_2016$GU1.ACKF[with(mort_2016, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=17&ICD_10_1.CODE<=19)))]<-1 #Acute kidney failure and chronic kidney disease
mort_2016$GU1.RTID<-NULL; mort_2016$GU1.RTID[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=12)|ICD_10_1.CODE==15)))]<-1 #Renal tubulo-interstitial diseases
mort_2016$GU1.OTTU<-NULL; mort_2016$GU1.OTTU[with(mort_2016, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=13&ICD_10_1.CODE<=14)))]<-1 #Other renal tubulo-interstitial diseases
mort_2016$GU1.LITO<-NULL; mort_2016$GU1.LITO[with(mort_2016, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Urolithiasis
mort_2016$GU1.RECO<-NULL; mort_2016$GU1.RECO[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==23))]<-1 #Unspecified renal colic
mort_2016$GU1.CIST<-NULL; mort_2016$GU1.CIST[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==30))]<-1 #Cystitis
mort_2016$GU1.OTRA<-NULL; mort_2016$GU1.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=25&ICD_10_1.CODE<=29)|(ICD_10_1.CODE>=31&ICD_10_1.CODE<=39))))]<-1 #Other


## Diseases of the genitourinary system 2: male genital organs ##
mort_2016$GU2.HIPR<-NULL; mort_2016$GU2.HIPR[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==40))]<-1 #Benign prostatic hyperplasia
mort_2016$GU2.OTPR<-NULL; mort_2016$GU2.OTPR[with(mort_2016, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=41&ICD_10_1.CODE<=42)))]<-1 #Other disorders of prostate
mort_2016$GU2.HCEC<-NULL; mort_2016$GU2.HCEC[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==43))]<-1 #Hydrocele and spermatocele
mort_2016$GU2.PREP<-NULL; mort_2016$GU2.PREP[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==47))]<-1 #Disorders of prepuce
mort_2016$GU2.MINF<-NULL; mort_2016$GU2.MINF[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==46))]<-1 #Male infertility
mort_2016$GU2.OTRA<-NULL; mort_2016$GU2.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=45)|(ICD_10_1.CODE>=48&ICD_10_1.CODE<=50))))]<-1 #Other



## Diseases of the genitourinary system 3: breast disorders ##
mort_2016$GU3.MAMA<-NULL; mort_2016$GU3.MAMA[with(mort_2016, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=64)))]<-1 #Disorders of breast


## Diseases of the genitourinary system 4: female genital organs ##
mort_2016$GU4.SAOO<-NULL; mort_2016$GU4.SAOO[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==70))]<-1 #Salpingitis and oophoritis
mort_2016$GU4.IDCU<-NULL; mort_2016$GU4.IDCU[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==72))]<-1 #Inflammatory disease of cervix uteri
mort_2016$GU4.OTVV<-NULL; mort_2016$GU4.OTVV[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ((ICD_10_1.CODE>=75&ICD_10_1.CODE<=76)|ICD_10_1.CODE==71)))]<-1 #Other diseases of uterus, vagina and vulva
mort_2016$GU4.OTPI<-NULL; mort_2016$GU4.OTPI[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==73))]<-1 #Other female pelvic inflammatory diseases
mort_2016$GU4.ENDM<-NULL; mort_2016$GU4.ENDM[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==80))]<-1 #Endometriosis
mort_2016$GU4.FPRO<-NULL; mort_2016$GU4.FPRO[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==81))]<-1 #Female genital prolapse
mort_2016$GU4.NOFB<-NULL; mort_2016$GU4.NOFB[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==83))]<-1 #Noninflammatory disorders of ovary, fallopian tube and broad ligament
mort_2016$GU4.MENS<-NULL; mort_2016$GU4.MENS[with(mort_2016, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE>=91&ICD_10_1.CODE<=92)))]<-1 #Disorders of menstruation
mort_2016$GU4.MNOP<-NULL; mort_2016$GU4.MNOP[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==95))]<-1 #Menopausal and other perimenopausal disorders
mort_2016$GU4.FINF<-NULL; mort_2016$GU4.FINF[with(mort_2016, (ICD_10_1.CHAPTER=="N" & ICD_10_1.CODE==97))]<-1 #Female infertility
mort_2016$GU4.OTRA<-NULL; mort_2016$GU4.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="N" & (ICD_10_1.CODE==82|(ICD_10_1.CODE>=84&ICD_10_1.CODE<=90)|
                                                                                         (ICD_10_1.CODE>=93&ICD_10_1.CODE<=94)|ICD_10_1.CODE==96|ICD_10_1.CODE==98)))]<-1 #Other


## Obstetrics 1: direct obstetric causes (abortion) ##
mort_2016$OB1.SPON<-NULL; mort_2016$OB1.SPON[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==3))]<-1 #Spontaneous abortion
mort_2016$OB1.INDU<-NULL; mort_2016$OB1.INDU[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==4))]<-1 #Complications following (induced) termination of pregnancy
mort_2016$OB1.OTRA<-NULL; mort_2016$OB1.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=0&ICD_10_1.CODE<=2)|(ICD_10_1.CODE>=5&ICD_10_1.CODE<=8))))]<-1 #Other abortion


## Obstetrics 2: direct obstetric causes (pregnancy and puerperium, except abortion) ##
mort_2016$OB2.EPHD<-NULL; mort_2016$OB2.EPHD[with(mort_2016, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=16)))]<-1 #Edema, proteinuria and hypertensive disorders in pregnancy, childbirth and the puerperium
mort_2016$OB2.HEMP<-NULL; mort_2016$OB2.HEMP[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=44&ICD_10_1.CODE<=46)|
                                                                                         ICD_10_1.CODE==20)))]<-1 #Hemorrhage in early pregnancy, placenta previa, abruptio placentae, antepartum hemorrhage
mort_2016$OB2.FACD<-NULL; mort_2016$OB2.FACD[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=30&ICD_10_1.CODE<=43)|ICD_10_1.CODE==47|
                                                                                         ICD_10_1.CODE==48)))]<-1 #Maternal care related to the fetus and amniotic cavity and possible delivery problems
mort_2016$OB2.IGUT<-NULL; mort_2016$OB2.IGUT[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==23))]<-1 #Infections of genitourinary tract in pregnancy
mort_2016$OB2.DMIP<-NULL; mort_2016$OB2.DMIP[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==24))]<-1 #Diabetes mellitus in pregnancy
mort_2016$OB2.OBSL<-NULL; mort_2016$OB2.OBSL[with(mort_2016, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=64&ICD_10_1.CODE<=66)))]<-1 #Obstructed labor 
mort_2016$OB2.PPHE<-NULL; mort_2016$OB2.PPHE[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==72))]<-1 #Postpartum hemorrhage
mort_2016$OB2.SOPI<-NULL; mort_2016$OB2.SOPI[with(mort_2016, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Sepsis and other puerperal infections
mort_2016$OB2.PUER<-NULL; mort_2016$OB2.PUER[with(mort_2016, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=87&ICD_10_1.CODE<=92)))]<-1 #Other complications of the puerperium
mort_2016$OB2.OTPL<-NULL; mort_2016$OB2.OTPL[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ((ICD_10_1.CODE>=21&ICD_10_1.CODE<=22)|(ICD_10_1.CODE>=25&ICD_10_1.CODE<=29)|(ICD_10_1.CODE>=60&ICD_10_1.CODE<=63)|
                                                                                         (ICD_10_1.CODE>=67&ICD_10_1.CODE<=71)|(ICD_10_1.CODE>=73&ICD_10_1.CODE<=75))))]<-1 #Other complications of pregnancy and labor
mort_2016$OB2.OBTE<-NULL; mort_2016$OB2.OBTE[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==34))]<-1 #Obstetrical tetanus
mort_2016$OB2.BEPU<-NULL; mort_2016$OB2.BEPU[with(mort_2016, (ICD_10_1.CHAPTER=="F" & ICD_10_1.CODE==53))]<-1 #Mental and behavioral disorders associated with the puerperium
mort_2016$OB2.OMLC<-NULL; mort_2016$OB2.OMLC[with(mort_2016, (ICD_10_1.CHAPTER=="M" & ICD_10_1.CODE==83 & ICD_10_1.SUB==0))]<-1 #Puerperal osteomalacia
mort_2016$OB2.OTDC<-NULL; mort_2016$OB2.OTDC[with(mort_2016, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=96&ICD_10_1.CODE<=97)))]<-1 #Other direct obstetric causes
mort_2016$OB2.ODUC<-NULL; mort_2016$OB2.ODUC[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==95))]<-1 #Obstetric death of unspecified cause


## Obstetrics 3: delivery ##
mort_2016$OB3.SSDE<-NULL; mort_2016$OB3.SSDE[with(mort_2016, (ICD_10_1.CHAPTER=="O" & ICD_10_1.CODE==80))]<-1 #Single spontaneous delivery
mort_2016$OB3.OTDE<-NULL; mort_2016$OB3.OTDE[with(mort_2016, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=81&ICD_10_1.CODE<=84)))]<-1 #Other delivery


## Obstetrics 4: indirect obstetric causes ##
mort_2016$OB4.INOC<-NULL; mort_2016$OB4.INOC[with(mort_2016, (ICD_10_1.CHAPTER=="O" & (ICD_10_1.CODE>=98&ICD_10_1.CODE<=99)))]<-1 #Indirect obstetric causes


## Certain conditions originating in the perinatal period ##
mort_2016$NEO.NAMC<-NULL; mort_2016$NEO.NAMC[with(mort_2016, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE==0|ICD_10_1.CODE==4)))]<-1 #Newborn affected by maternal conditions
mort_2016$NEO.NAOC<-NULL; mort_2016$NEO.NAOC[with(mort_2016, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=1&ICD_10_1.CODE<=3)))]<-1 #Newborn affected by obstetric complications
mort_2016$NEO.GMGW<-NULL; mort_2016$NEO.GMGW[with(mort_2016, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE==5|ICD_10_1.CODE==7)))]<-1 #Slow fetal growth, fetal malnutrition, short gestation and low birth weight
mort_2016$NEO.BITR<-NULL; mort_2016$NEO.BITR[with(mort_2016, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=15)))]<-1 #Birth trauma
mort_2016$NEO.HIAS<-NULL; mort_2016$NEO.HIAS[with(mort_2016, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=21)))]<-1 #Intrauterine hypoxia and birth asphyxia 
mort_2016$NEO.SDRN<-NULL; mort_2016$NEO.SDRN[with(mort_2016, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=22&ICD_10_1.CODE<=28)))]<-1 #Respiratory distress of newborn and other perinatal respiratory disorders
mort_2016$NEO.INFE<-NULL; mort_2016$NEO.INFE[with(mort_2016, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=37)))]<-1 #Congenital viral, bacterial and parasitic diseases
mort_2016$NEO.OTIN<-NULL; mort_2016$NEO.OTIN[with(mort_2016, (ICD_10_1.CHAPTER=="P" & (ICD_10_1.CODE>=38&ICD_10_1.CODE<=39)))]<-1 #Other infections specific to the perinatal period
mort_2016$NEO.HDNB<-NULL; mort_2016$NEO.HDNB[with(mort_2016, (ICD_10_1.CHAPTER=="P" & ICD_10_1.CODE==55))]<-1 #Hemolytic disease of newborn
mort_2016$NEO.TENE<-NULL; mort_2016$NEO.TENE[with(mort_2016, (ICD_10_1.CHAPTER=="A" & ICD_10_1.CODE==33))]<-1 #Tetanus neonatorum
mort_2016$NEO.OTRA<-NULL; mort_2016$NEO.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="P" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=54)|(ICD_10_1.CODE>=56&ICD_10_1.CODE<=74)|
                                                                                         (ICD_10_1.CODE>=76&ICD_10_1.CODE<=96)|(ICD_10_1.CODE==8)|(ICD_10_1.CODE==29))))]<-1 #Other


## Congenital malformations, deformations and chromosomal abnormalities ##
mort_2016$CON.ANEN<-NULL; mort_2016$CON.ANEN[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==0))]<-1 #Anencephaly and similar malformations
mort_2016$CON.HIDR<-NULL; mort_2016$CON.HIDR[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==3))]<-1 #Congenital hydrocephalus
mort_2016$CON.SBIF<-NULL; mort_2016$CON.SBIF[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==5))]<-1 #Spina bifida
mort_2016$CON.OTNS<-NULL; mort_2016$CON.OTNS[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=1&ICD_10_1.CODE<=2)|(ICD_10_1.CODE==4)|
                                                                                         (ICD_10_1.CODE>=6&ICD_10_1.CODE<=7))))]<-1 #Other congenital malformations of the nervous system
mort_2016$CON.CIRC<-NULL; mort_2016$CON.CIRC[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=20&ICD_10_1.CODE<=28)))]<-1 #Congenital malformations of the circulatory system
mort_2016$CON.CLCP<-NULL; mort_2016$CON.CLCP[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=35&ICD_10_1.CODE<=37)))]<-1 #Cleft lip and cleft palate
mort_2016$CON.CINT<-NULL; mort_2016$CON.CINT[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==41))]<-1 #Congenital absence, atresia and stenosis of small intestine
mort_2016$CON.OTDS<-NULL; mort_2016$CON.OTDS[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=38&ICD_10_1.CODE<=40)|
                                                                                         (ICD_10_1.CODE>=42&ICD_10_1.CODE<=45))))]<-1 #Other congenital malformations of the digestive system 
mort_2016$CON.TEST<-NULL; mort_2016$CON.TEST[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==53))]<-1 #Undescended and ectopic testicle
mort_2016$CON.OTGU<-NULL; mort_2016$CON.OTGU[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=50&ICD_10_1.CODE<=52)|
                                                                                         (ICD_10_1.CODE>=54&ICD_10_1.CODE<=64))))]<-1 #Other congenital malformations of genitourinary system
mort_2016$CON.DHIP<-NULL; mort_2016$CON.DHIP[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==65))]<-1 #Congenital deformities of hip
mort_2016$CON.FEET<-NULL; mort_2016$CON.FEET[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ICD_10_1.CODE==66))]<-1 #Congenital deformities of feet
mort_2016$CON.OTMS<-NULL; mort_2016$CON.OTMS[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=67&ICD_10_1.CODE<=79)))]<-1 #Other congenital malformations and deformations of the musculoskeletal system
mort_2016$CON.OTRA<-NULL; mort_2016$CON.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=18)|(ICD_10_1.CODE>=30&ICD_10_1.CODE<=34)|
                                                                                         (ICD_10_1.CODE>=80&ICD_10_1.CODE<=89))))]<-1 #Other congenital malformations
mort_2016$CON.CROM<-NULL; mort_2016$CON.CROM[with(mort_2016, (ICD_10_1.CHAPTER=="Q" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=99)))]<-1 #Chromosomal abnormalities, not elsewhere classified


## Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified ##
mort_2016$NCL.FEVU<-NULL; mort_2016$NCL.FEVU[with(mort_2016, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==50))]<-1 #Fever of other and unknown origin
mort_2016$NCL.CAAB<-NULL; mort_2016$NCL.CAAB[with(mort_2016, (ICD_10_1.CHAPTER=="R" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=1)))]<-1 #Cardiac abnormalities
mort_2016$NCL.RAOR<-NULL; mort_2016$NCL.RAOR[with(mort_2016, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==33))]<-1 #Retention of urine
mort_2016$NCL.ABPP<-NULL; mort_2016$NCL.ABPP[with(mort_2016, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==10))]<-1 #Abdominal and pelvic pain
mort_2016$NCL.ARPD<-NULL; mort_2016$NCL.ARPD[with(mort_2016, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==54))]<-1 #Age-related physical debility
mort_2016$NCL.SIDS<-NULL; mort_2016$NCL.SIDS[with(mort_2016, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==95))]<-1 #Sudden infant death syndrome
mort_2016$NCL.REAR<-NULL; mort_2016$NCL.REAR[with(mort_2016, (ICD_10_1.CHAPTER=="R" & ICD_10_1.CODE==9 & ICD_10_1.SUB==2))]<-1 #Respiratory arrest
mort_2016$NCL.OTRA<-NULL; mort_2016$NCL.OTRA[with(mort_2016, (ICD_10_1.CHAPTER=="R" & ((ICD_10_1.CODE==9&(ICD_10_1.SUB==0|ICD_10_1.SUB==1|ICD_10_1.SUB==3|ICD_10_1.SUB==8))|
                                                                                         (ICD_10_1.CODE>=2&ICD_10_1.CODE<=8)|(ICD_10_1.CODE>=11&ICD_10_1.CODE<=32)|
                                                                                         (ICD_10_1.CODE>=34&ICD_10_1.CODE<=49)|(ICD_10_1.CODE>=51&ICD_10_1.CODE<=53)|
                                                                                         (ICD_10_1.CODE>=55&ICD_10_1.CODE<=94)|(ICD_10_1.CODE>=96&ICD_10_1.CODE<=99))))]<-1 #Other



## External causes of mortality 1: transport accidents ##
mort_2016$EX1.RAIL<-NULL; mort_2016$EX1.RAIL[with(mort_2016, (ICD_10_1.CHAPTER=="V" & ((ICD_10_1.CODE==5)|(ICD_10_1.CODE==15)|(ICD_10_1.CODE==80&ICD_10_1.SUB==6)|
                                                                                         (ICD_10_1.CODE==81&ICD_10_1.SUB!=1)) ))]<-1 #Railway accidents
mort_2016$EX1.MOTO<-NULL; mort_2016$EX1.MOTO[with(mort_2016, (ICD_10_1.CHAPTER=="V" &  (((ICD_10_1.CODE>=2&ICD_10_1.CODE<=4) & (ICD_10_1.SUB==1|ICD_10_1.SUB==9))|
                                                                                          ((ICD_10_1.CODE==9) & (ICD_10_1.SUB==2|ICD_10_1.SUB==3|ICD_10_1.SUB==9))|
                                                                                          ((ICD_10_1.CODE>=12&ICD_10_1.CODE<=14) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE==19) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=6))|
                                                                                          ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=28) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE>=29&ICD_10_1.CODE<=79) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=9))|
                                                                                          ((ICD_10_1.CODE==80) & (ICD_10_1.SUB>=3&ICD_10_1.SUB<=5))|
                                                                                          ((ICD_10_1.CODE>=81&ICD_10_1.CODE<=82) & (ICD_10_1.SUB==1))|
                                                                                          ((ICD_10_1.CODE>=83&ICD_10_1.CODE<=86) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=3))|
                                                                                          ((ICD_10_1.CODE==87) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=8))|
                                                                                          ((ICD_10_1.CODE==89) & (ICD_10_1.SUB==2|ICD_10_1.SUB==9))) ))]<-1 #Motor vehicle traffic accidents
mort_2016$EX1.LAND<-NULL; mort_2016$EX1.LAND[with(mort_2016, (ICD_10_1.CHAPTER=="V" & ((ICD_10_1.CODE==1)|(ICD_10_1.CODE==6)|(ICD_10_1.CODE==10)|(ICD_10_1.CODE==11)|
                                                                                         (ICD_10_1.CODE>=16&ICD_10_1.CODE<=18)|(ICD_10_1.CODE==19&ICD_10_1.SUB==3)|
                                                                                         ((ICD_10_1.CODE==80) & (ICD_10_1.SUB<=2|ICD_10_1.SUB>=7))|
                                                                                         ((ICD_10_1.CODE==82) & (ICD_10_1.SUB>=2&ICD_10_1.SUB<=9))|
                                                                                         ((ICD_10_1.CODE==89) & (ICD_10_1.SUB==1|ICD_10_1.SUB==3)) )))]<-1 #Other land transport accidents
mort_2016$EX1.WATE<-NULL; mort_2016$EX1.WATE[with(mort_2016, (ICD_10_1.CHAPTER=="V" & (ICD_10_1.CODE>=90&ICD_10_1.CODE<=94)))]<-1 #Water transport accidents
mort_2016$EX1.AIRS<-NULL; mort_2016$EX1.AIRS[with(mort_2016, (ICD_10_1.CHAPTER=="V" & (ICD_10_1.CODE>=95&ICD_10_1.CODE<=97)))]<-1 #Air and space transport accidents
mort_2016$EX1.OTRO<-NULL; mort_2016$EX1.OTRO[with(mort_2016, (ICD_10_1.CHAPTER=="V" & (((ICD_10_1.CODE>=2&ICD_10_1.CODE<=4) & (ICD_10_1.SUB==0))|
                                                                                         ((ICD_10_1.CODE==9) & (ICD_10_1.SUB==0|ICD_10_1.SUB==1))|
                                                                                         ((ICD_10_1.CODE>=12&ICD_10_1.CODE<=14) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=2))|
                                                                                         ((ICD_10_1.CODE==19) & (ICD_10_1.SUB<=2|ICD_10_1.SUB>=8))|
                                                                                         ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=28) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=2))|
                                                                                         ((ICD_10_1.CODE>=29&ICD_10_1.CODE<=79) & (ICD_10_1.SUB>=0&ICD_10_1.SUB<=3))|
                                                                                         ((ICD_10_1.CODE>=83&ICD_10_1.CODE<=86) & (ICD_10_1.SUB>=4&ICD_10_1.SUB<=9))|
                                                                                         (ICD_10_1.CODE==82&ICD_10_1.SUB==0)|(ICD_10_1.CODE==87&ICD_10_1.SUB==9)|
                                                                                         (ICD_10_1.CODE==88)|(ICD_10_1.CODE==89&ICD_10_1.SUB==0)|
                                                                                         (ICD_10_1.CODE>=98&ICD_10_1.CODE<=99))))]<-1 #Other



## External causes of mortality 2: falls ##
mort_2016$EX2.FALL<-NULL; mort_2016$EX2.FALL[with(mort_2016, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=19)))]<-1 #Falls


## External causes of mortality 3: other accidents ##
mort_2016$EX3.ENVI<-NULL; mort_2016$EX3.ENVI[with(mort_2016, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=53&ICD_10_1.CODE<=64)) | 
                                                    (ICD_10_1.CHAPTER=="X" & ((ICD_10_1.CODE>=10&ICD_10_1.CODE<=39)|(ICD_10_1.CODE>=50&ICD_10_1.CODE<=57))))]<-1 #Accidents caused by environmental factors
mort_2016$EX3.DROW<-NULL; mort_2016$EX3.DROW[with(mort_2016, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=65&ICD_10_1.CODE<=74)))]<-1 #Accidental non-transport drowning and submersion
mort_2016$EX3.FBNO<-NULL; mort_2016$EX3.FBNO[with(mort_2016, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE==44)))]<-1 #Foreign body entering into or through eye or natural orifice
mort_2016$EX3.MACH<-NULL; mort_2016$EX3.MACH[with(mort_2016, (ICD_10_1.CHAPTER=="W" & ((ICD_10_1.CODE>=23&ICD_10_1.CODE<=31)|ICD_10_1.CODE==35|
                                                                                         ICD_10_1.CODE==37|ICD_10_1.CODE==38|ICD_10_1.CODE==41|
                                                                                         (ICD_10_1.CODE>=45&ICD_10_1.CODE<=46))))]<-1 #Accidents caused by machinery or sharp instruments
mort_2016$EX3.FREG<-NULL; mort_2016$EX3.FREG[with(mort_2016, (ICD_10_1.CHAPTER=="W" & (ICD_10_1.CODE>=32&ICD_10_1.CODE<=34)))]<-1 #Accidents caused by firearms and guns
mort_2016$EX3.SEQA<-NULL; mort_2016$EX3.SEQA[with(mort_2016, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=85&ICD_10_1.CODE<=86)))]<-1 #Sequelae of transport accidents and other accidents

mort_2016$EX3.OTRA<-NULL; mort_2016$EX3.OTRA[with(mort_2016, ((ICD_10_1.CHAPTER=="W" & ((ICD_10_1.CODE>=20&ICD_10_1.CODE<=22)|ICD_10_1.CODE==36|ICD_10_1.CODE==39|ICD_10_1.CODE==40|ICD_10_1.CODE==42|
                                                                                          ICD_10_1.CODE==43|(ICD_10_1.CODE>=49&ICD_10_1.CODE<=52)|(ICD_10_1.CODE>=75&ICD_10_1.CODE<=99)))|
                                                                (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=58&ICD_10_1.CODE<=59)) ))]<-1 #Other



## External causes of mortality 4: exposure to smoke, fire and flames ##
mort_2016$EX4.SMFF<-NULL; mort_2016$EX4.SMFF[with(mort_2016, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=0&ICD_10_1.CODE<=9)))]<-1 #Exposure to smoke, fire and flames


## External causes of mortality 5: accidental poisoning and substance exposition ##
mort_2016$EX5.APDM<-NULL; mort_2016$EX5.APDM[with(mort_2016, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=44)))]<-1 #Accidental poisoning by drugs, medicaments and biological substances
mort_2016$EX5.APSL<-NULL; mort_2016$EX5.APSL[with(mort_2016, (ICD_10_1.CHAPTER=="X" & ((ICD_10_1.CODE>=45&ICD_10_1.CODE<=49)&(ICD_10_1.CODE!=47))))]<-1 #Accidental poisoning by other solid or liquid substances
mort_2016$EX5.APGV<-NULL; mort_2016$EX5.APGV[with(mort_2016, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE==47)))]<-1 #Accidental poisoning by other gases and vapours

## External causes of mortality 6: suicide ##
mort_2016$EX6.SUIC<-NULL; mort_2016$EX6.SUIC[with(mort_2016, (ICD_10_1.CHAPTER=="X" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=84)))]<-1 #Intentional self-harm


## External causes of mortality 7: homicide ##
mort_2016$EX7.ASSA<-NULL; mort_2016$EX7.ASSA[with(mort_2016, ((ICD_10_1.CHAPTER=="X"&ICD_10_1.CODE>=85)|(ICD_10_1.CHAPTER=="Y"&ICD_10_1.CODE<=9)))]<-1 #Assault


## External causes of mortality 8: other violent causes of death ##
mort_2016$EX8.EOUI<-NULL; mort_2016$EX8.EOUI[with(mort_2016, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=10&ICD_10_1.CODE<=34)))]<-1 #Event of undetermined intent
mort_2016$EX8.OWAR<-NULL; mort_2016$EX8.OWAR[with(mort_2016, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE==36)))]<-1 #Operations of war
mort_2016$EX8.LEGI<-NULL; mort_2016$EX8.LEGI[with(mort_2016, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE==35)))]<-1 #Legal intervention


## External causes of mortality 9: other external causes of mortality ##
mort_2016$EX9.DRUG<-NULL; mort_2016$EX9.DRUG[with(mort_2016, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=40&ICD_10_1.CODE<=59)))]<-1 #Drugs, medicaments and biological substances causing adverse effects in therapeutic use
mort_2016$EX9.MSDV<-NULL; mort_2016$EX9.MSDV[with(mort_2016, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=60&ICD_10_1.CODE<=84)))]<-1 #Misadventures to patients during surgical and medical care
mort_2016$EX9.SQEX<-NULL; mort_2016$EX9.SQEX[with(mort_2016, (ICD_10_1.CHAPTER=="Y" & (ICD_10_1.CODE>=87&ICD_10_1.CODE<=89)))]<-1 #Sequelae of external causes of morbidity and mortality


# COVID-19 #
mort_2016$COV.CONF<-NULL; mort_2016$COV.CONF[with(mort_2016, (ICD_10_1.CHAPTER=="U" & ICD_10_1.CODE==7 & ICD_10_1.SUB==1))]<-1 #Confirmed COVID-19
mort_2016$COV.SUSP<-NULL; mort_2016$COV.SUSP[with(mort_2016, (ICD_10_1.CHAPTER=="U" & ICD_10_1.CODE==7 & ICD_10_1.SUB==2))]<-1 #Suspected COVID-19


#Merge Datasets

mort_2016<-mort_2016 %>%left_join(dmu.cuadrantes.mun,by="id.mun")%>%
  rename(DMU_MUN=dmu)%>%
  rename(DMU_CAMAS_MUN=dmu_camas)%>%
  left_join(dmu.ent, by="id.ent")%>%
  rename(DMU_CAMAS_ENT=dmu_camas)%>%
  rename(DMU_ENT=dmu)%>%
  rename(MARG.ENT="marg",POP.ENT="pop")
  
mort_2016$AVOIDABLE<-NULL
mort_2016$AVOIDABLE[mort_2016$TREA.PREV==1]<-1
mort_2016$AVOIDABLE[mort_2016$TREA.PREV==2]<-1
mort_2016$AVOIDABLE[mort_2016$TREA.PREV==3]<-1
mort_2016$AVOIDABLE[mort_2016$TREA.PREV==4]<-0
  
mort_2016$CONTEXTO<-NULL
mort_2016$CONTEXTO[mort_2016$CONTEXTO_DEFUNCION %in% c(1,2,3,4,5,6,7,8,9)]<-1
mort_2016$CONTEXTO[mort_2016$CONTEXTO_DEFUNCION %in% c(10,11,12)]<-2
mort_2016$CONTEXTO[mort_2016$CONTEXTO_DEFUNCION %in% c(99)]<-3

######Datos COVID DGE ####
covid <- read.csv(unz("datos_abiertos_covid19_31.12.2020.zip", "201231COVID19MEXICO.csv"),header=TRUE,sep = ",", encoding = "UTF-8")
covid$id<-paste0(str_pad(covid$ENTIDAD_RES, 2,pad = "0"),str_pad(covid$MUNICIPIO_RES,3, pad="0"))
covid1<-covid[,c(14:15,18:30,32:35)]
covid<-covid[,-c(14:15,18:30,32:35)]
covid1[covid1==2]<-0
covid1[covid1==97]<-NA;covid1[covid1==98]<-NA;covid1[covid1==99]<-NA
covid<-as.data.frame(cbind(covid, covid1))
covid$EMBARAZO[is.na(covid$EMBARAZO)]<-0
covid$FECHA_DEF[covid$FECHA_DEF=="9999-99-99"]<-NA
covid$FECHA_DEF<-as.Date(covid$FECHA_DEF)
covid$TIPO_PACIENTE[covid$TIPO_PACIENTE==1]<-0;covid$TIPO_PACIENTE[covid$TIPO_PACIENTE==2]<-1
covid$covid<-NULL; covid$covid[covid$CLASIFICACION_FINAL==3]<-1;covid$covid[covid$CLASIFICACION_FINAL!=3]<-0
covid$edad60<-NULL;covid$edad60[covid$EDAD>=60]<-1;covid$edad60[covid$EDAD<60]<-0
covid$edad40<-NULL;covid$edad40[covid$EDAD>=40]<-0;covid$edad40[covid$EDAD<40]<-1
covid$Mortalidad<-NULL; covid$Mortalidad[is.na(covid$FECHA_DEF)]<-0;covid$Mortalidad[is.na(covid$FECHA_DEF)==FALSE]<-1
covid$FECHA_DEF[is.na(covid$FECHA_DEF)]<-as.Date(covid$FECHA_SINTOMAS)+30
covid$FU_time<-as.numeric(as.Date(covid$FECHA_DEF)-as.Date(covid$FECHA_SINTOMAS))
covid$time<-as.numeric(as.Date(covid$FECHA_INGRESO)-as.Date(covid$FECHA_SINTOMAS))
covid$FU_time[covid$FU_time<0]<-1
covid1<- covid %>% filter(covid==1)
covid1$diabetes_40<-ifelse((covid1$DIABETES+covid1$edad40)==2,1,0)
covid1$id.ent<-paste0(str_pad(covid1$ENTIDAD_RES, 2,pad = "0"))
covid1$id.mun<-paste0(str_pad(covid1$ENTIDAD_RES, 2,pad = "0"),str_pad(covid1$MUNICIPIO_RES,3, pad="0"))



######Descriptive Analysis Overall Excess (Figure1A)#####

#2016

ADJUSTED_MORTALITY_2016_OVERALL<-mort_2016%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  group_by(EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()))%>%
  left_join(Pob_edad_2016_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2016 = (DEATHS/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2016=sum(AGE_ADJUSTED_2016,na.rm = T))%>%
  dplyr::select(AGE_ADJUSTED_2016)%>%
  mutate(EV_YEAR=c("2016-2019"))

#2017
ADJUSTED_MORTALITY_2017_OVERALL<-mort_2017%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  group_by(EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()))%>%
  left_join(Pob_edad_2017_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2017 = (DEATHS/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2017=sum(AGE_ADJUSTED_2017,na.rm = T))%>%
  dplyr::select(AGE_ADJUSTED_2017)%>%
  mutate(EV_YEAR=c("2016-2019"))


#2018
ADJUSTED_MORTALITY_2018_OVERALL<-mort_2018%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  group_by(EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()))%>%
  left_join(Pob_edad_2018_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2018 = (DEATHS/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2018=sum(AGE_ADJUSTED_2018,na.rm = T))%>%
  dplyr::select(AGE_ADJUSTED_2018)%>%
  mutate(EV_YEAR=c("2016-2019"))


#2019
ADJUSTED_MORTALITY_2019_OVERALL<-mort_2019%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  group_by(EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()))%>%
  left_join(Pob_edad_2019_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2019 = (DEATHS/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2019=sum(AGE_ADJUSTED_2019,na.rm = T))%>%
  dplyr::select(AGE_ADJUSTED_2019)%>%
  mutate(EV_YEAR=c("2016-2019"))


#2020
ADJUSTED_MORTALITY_2020_OVERALL<-mort_2020%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  group_by(EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()),
            COVID=sum(COVID==1),
            NO_COVID=sum(NO_COVID==1))%>%
  left_join(Pob_edad_2020_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2020 = (DEATHS/POB)*Weight*100000,
         COVID_AGE_ADJUSTED_2020 = (COVID/POB)*Weight*100000,
         NO_COVID_AGE_ADJUSTED_2020 = (NO_COVID/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2020=sum(AGE_ADJUSTED_2020,na.rm = T),
            COVID_AGE_ADJUSTED_2020=sum(COVID_AGE_ADJUSTED_2020,na.rm = T),
            NO_COVID_AGE_ADJUSTED_2020=sum(NO_COVID_AGE_ADJUSTED_2020,na.rm = T))%>%
  dplyr::select(AGE_ADJUSTED_2020,COVID_AGE_ADJUSTED_2020,NO_COVID_AGE_ADJUSTED_2020)%>%
  mutate(EV_YEAR=c("2016-2019"))


MEAN_MORTALITY_2017_2019<-ADJUSTED_MORTALITY_2019_OVERALL%>%
  left_join(ADJUSTED_MORTALITY_2018_OVERALL,by = "EV_YEAR")%>%
  left_join(ADJUSTED_MORTALITY_2017_OVERALL,by = "EV_YEAR")%>%
  left_join(ADJUSTED_MORTALITY_2016_OVERALL,by = "EV_YEAR")%>%
  group_by(EV_YEAR)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(AGE_ADJUSTED_2019,AGE_ADJUSTED_2018,AGE_ADJUSTED_2017,AGE_ADJUSTED_2016)))%>%
  dplyr::select(EV_YEAR,AVERAGE_MORTALITY)

EXCESS_MORTALITY_OVERALL<-ADJUSTED_MORTALITY_2020_OVERALL%>%
  left_join(MEAN_MORTALITY_2017_2019,by="EV_YEAR")%>%
  mutate(EXCESS_MORTALITY=(AGE_ADJUSTED_2020-AVERAGE_MORTALITY),
         EXCESS_NON_COVID=(NO_COVID_AGE_ADJUSTED_2020-AVERAGE_MORTALITY),
         PERCENT_EXCESS_MORTALITY_COVID=(COVID_AGE_ADJUSTED_2020*100/EXCESS_MORTALITY),
         PERCENT_EXCESS_MORTALITY_NOCOVID=((NO_COVID_AGE_ADJUSTED_2020-AVERAGE_MORTALITY)*100/EXCESS_MORTALITY))

EXCESS_MORTALITY_OVERALL_2.1<-rbind(data.frame(rate=EXCESS_MORTALITY_OVERALL$AVERAGE_MORTALITY,
                                               year=c("2016-2019"),
                                               label=c("Non-COVID")))
EXCESS_MORTALITY_OVERALL_2.3<-rbind(data.frame(rate=EXCESS_MORTALITY_OVERALL$NO_COVID_AGE_ADJUSTED_2020,
                                               year=c("2020"),
                                               label=c("Non-COVID")))
EXCESS_MORTALITY_OVERALL_2.4<-rbind(data.frame(rate=EXCESS_MORTALITY_OVERALL$COVID_AGE_ADJUSTED_2020,
                                               year=c("2020"),
                                               label=c("COVID")))

EXCESS_MORTALITY_OVERALL_2<-rbind(EXCESS_MORTALITY_OVERALL_2.1,EXCESS_MORTALITY_OVERALL_2.3,EXCESS_MORTALITY_OVERALL_2.4)
EXCESS_MORTALITY_OVERALL_2$year<-factor(EXCESS_MORTALITY_OVERALL_2$year,levels = c("2016-2019","2020"))
EXCESS_MORTALITY_OVERALL_2$rate<-round(EXCESS_MORTALITY_OVERALL_2$rate,2)

Figure1A<-ggplot(EXCESS_MORTALITY_OVERALL_2,aes(year,rate,fill=label))+
  geom_col()+
  ylab("Age-Adjusted Mortality Rate \nper 100,000 Inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#7c8cc4","#84b48c"))+
  annotate("text", x = 1, y = EXCESS_MORTALITY_OVERALL_2$rate[1]+30, label = paste0(EXCESS_MORTALITY_OVERALL_2$rate[1]))+
  annotate("text", x = 2, y = EXCESS_MORTALITY_OVERALL_2$rate[2]+EXCESS_MORTALITY_OVERALL_2$rate[3]+30, label = paste0(EXCESS_MORTALITY_OVERALL_2$rate[2]+EXCESS_MORTALITY_OVERALL_2$rate[3]))+
  annotate("text", x = 2, y = EXCESS_MORTALITY_OVERALL_2$rate[2]/2, label = paste0(round(EXCESS_MORTALITY_OVERALL_2$rate[2]/(EXCESS_MORTALITY_OVERALL_2$rate[2]+EXCESS_MORTALITY_OVERALL_2$rate[3])*100,2),"%"),col="white")+
  annotate("text", x = 2, y = EXCESS_MORTALITY_OVERALL_2$rate[2]+(EXCESS_MORTALITY_OVERALL_2$rate[3]/2), label = paste0(round(EXCESS_MORTALITY_OVERALL_2$rate[3]/(EXCESS_MORTALITY_OVERALL_2$rate[2]+EXCESS_MORTALITY_OVERALL_2$rate[3])*100,2),"%"),col="white")+
  annotate("text", x = 1.5, y = 1000, label = paste0("Overall Age-Adjusted Excess Mortality","\n",EXCESS_MORTALITY_OVERALL_2$rate[2]+EXCESS_MORTALITY_OVERALL_2$rate[3]-EXCESS_MORTALITY_OVERALL_2$rate[1]))



######Excess mortality by month of occurence (Figure 1B)#####

#2016

ADJUSTED_MORTALITY_2016_ENTIDAD_MES<-mort_2016%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  mutate(MES=data.table::month(FECHA_DEFUNCION))%>%
  group_by(MES,EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE==1))%>%
  left_join(Pob_edad_2016_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2016 = (DEATHS/POB)*Weight*100000,
         AVOID_AGE_ADJUSTED_2016 = (AVOID/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2016=sum(AGE_ADJUSTED_2016,na.rm = T),
            AVOID_AGE_ADJUSTED_2016=sum(AVOID_AGE_ADJUSTED_2016,na.rm = T))%>%
  dplyr::select(MES,AGE_ADJUSTED_2016,AVOID_AGE_ADJUSTED_2016)%>%
  mutate(EV_YEAR=c("2016"))

#2017
ADJUSTED_MORTALITY_2017_ENTIDAD_MES<-mort_2017%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  mutate(MES=data.table::month(FECHA_DEFUNCION))%>%
  group_by(MES,EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE==1))%>%
  left_join(Pob_edad_2017_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2017 = (DEATHS/POB)*Weight*100000,
         AVOID_AGE_ADJUSTED_2017 = (AVOID/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2017=sum(AGE_ADJUSTED_2017,na.rm = T),
            AVOID_AGE_ADJUSTED_2017=sum(AVOID_AGE_ADJUSTED_2017,na.rm = T))%>%
  dplyr::select(MES,AGE_ADJUSTED_2017,AVOID_AGE_ADJUSTED_2017)%>%
  mutate(EV_YEAR=c("2017"))

#2018
ADJUSTED_MORTALITY_2018_ENTIDAD_MES<-mort_2018%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  mutate(MES=data.table::month(FECHA_DEFUNCION))%>%
  group_by(MES,EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE==1))%>%
  left_join(Pob_edad_2018_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2018 = (DEATHS/POB)*Weight*100000,
         AVOID_AGE_ADJUSTED_2018 = (AVOID/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2018=sum(AGE_ADJUSTED_2018,na.rm = T),
            AVOID_AGE_ADJUSTED_2018=sum(AVOID_AGE_ADJUSTED_2018,na.rm = T))%>%
  dplyr::select(MES,AGE_ADJUSTED_2018,AVOID_AGE_ADJUSTED_2018)%>%
  mutate(EV_YEAR=c("2018"))

#2019
ADJUSTED_MORTALITY_2019_ENTIDAD_MES<-mort_2019%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  mutate(MES=data.table::month(FECHA_DEFUNCION))%>%
  group_by(MES,EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE==1))%>%
  left_join(Pob_edad_2019_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2019 = (DEATHS/POB)*Weight*100000,
         AVOID_AGE_ADJUSTED_2019 = (AVOID/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2019=sum(AGE_ADJUSTED_2019,na.rm = T),
            AVOID_AGE_ADJUSTED_2019=sum(AVOID_AGE_ADJUSTED_2019,na.rm = T))%>%
  dplyr::select(MES,AGE_ADJUSTED_2019,AVOID_AGE_ADJUSTED_2019)%>%
  mutate(EV_YEAR=c("2019"))

#2020
ADJUSTED_MORTALITY_2020_ENTIDAD_MES<-mort_2020%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                                                   breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                                   right = FALSE, include.lowest = TRUE, 
                                                   labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                              "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                              "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                              "pobm_60_64", "pobm_65_mm")))%>%
  mutate(MES=data.table::month(FECHA_DEFUNCION))%>%
  group_by(MES,EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()),
            NO_COVID=sum(COVID==0),
            COVID=sum(COVID==1),
            AVOID=sum(AVOIDABLE==1))%>%
  left_join(Pob_edad_2020_entidad_total,by="EDAD_QUIN")%>%
  mutate(AGE_ADJUSTED_OVERALL_2020= (DEATHS/POB)*Weight*100000,
         AGE_ADJUSTED_COVID_2020= (COVID/POB)*Weight*100000,
         AGE_ADJUSTED_NOCOVID_2020= (NO_COVID/POB)*Weight*100000,
         AVOID_AGE_ADJUSTED_2020 = (AVOID/POB)*Weight*100000)%>%
  ungroup()%>%
  group_by(MES)%>%
  summarise(AGE_ADJUSTED_OVERALL_2020=sum(AGE_ADJUSTED_OVERALL_2020,na.rm = T),
            AGE_ADJUSTED_COVID_2020=sum(AGE_ADJUSTED_COVID_2020,na.rm = T),
            AGE_ADJUSTED_NOCOVID_2020=sum(AGE_ADJUSTED_NOCOVID_2020,na.rm = T),
            AVOID_AGE_ADJUSTED_2020=sum(AVOID_AGE_ADJUSTED_2020,na.rm = T))%>%
  dplyr::select(MES,AGE_ADJUSTED_OVERALL_2020,AGE_ADJUSTED_COVID_2020,AGE_ADJUSTED_NOCOVID_2020,AVOID_AGE_ADJUSTED_2020)%>%
  mutate(EV_YEAR=c("2020"))

MEAN_MORTALITY_2017_2019<-ADJUSTED_MORTALITY_2019_ENTIDAD_MES%>%
  left_join(ADJUSTED_MORTALITY_2018_ENTIDAD_MES,by = "MES")%>%
  left_join(ADJUSTED_MORTALITY_2017_ENTIDAD_MES,by = "MES")%>%
  left_join(ADJUSTED_MORTALITY_2016_ENTIDAD_MES,by = "MES")%>%
  group_by(MES)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(AGE_ADJUSTED_2019,AGE_ADJUSTED_2018,AGE_ADJUSTED_2017,AGE_ADJUSTED_2016)),
         AVERAGE_MORTALITY_AVOID = mean(c(AVOID_AGE_ADJUSTED_2019,AVOID_AGE_ADJUSTED_2018,AVOID_AGE_ADJUSTED_2017,AVOID_AGE_ADJUSTED_2016)))%>%
  dplyr::select(MES,AVERAGE_MORTALITY,AVERAGE_MORTALITY_AVOID)

EXCESS_MORTALITY_MES<-ADJUSTED_MORTALITY_2020_ENTIDAD_MES%>%
  left_join(MEAN_MORTALITY_2017_2019,by="MES")%>%
  mutate(EXCESS_MORTALITY=(AGE_ADJUSTED_OVERALL_2020-AVERAGE_MORTALITY),
         EXCESS_MORTALITY_AVOID=(AVOID_AGE_ADJUSTED_2020-AVERAGE_MORTALITY_AVOID),
         PERCENT_EXCESS_MORTALITY_COVID=(AGE_ADJUSTED_COVID_2020*100/EXCESS_MORTALITY),
         PERCENT_EXCESS_MORTALITY_NOCOVID=((AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY)*100/EXCESS_MORTALITY))


EXCESS_MORTALITY_MES$MES<-factor(EXCESS_MORTALITY_MES$MES,labels = c("Jan-20","Feb-20","Mar-20",
                                                                     "Apr-20","May-20","Jun-20",
                                                                     "Jul-20","Aug-20","Sep-20",
                                                                     "Oct-20","Nov-20","Dec-20"))

Figure1B<-ggplot(EXCESS_MORTALITY_MES) + 
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, group=1), col="transparent", size=2,method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_OVERALL_2020, group=1,col="2020"), size=2,method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "Average \n2016-2019",group=1),size=2,se = FALSE)


g1 <- ggplot(EXCESS_MORTALITY_MES) + 
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, colour = "min",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_OVERALL_2020, colour = "max",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "2019",group=1),se = FALSE)

g2 <- ggplot(EXCESS_MORTALITY_MES) + 
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "min",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, colour = "max",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "B",group=1),se = FALSE)

gg1 <- ggplot_build(g1)
gg2 <- ggplot_build(g2)

df2<-data.frame(x = gg1$data[[1]]$x,
           ymin = gg1$data[[1]]$y,
           ymax = gg1$data[[2]]$y)

df3<-data.frame(x = gg2$data[[1]]$x,
                ymin = gg2$data[[1]]$y,
                ymax = gg2$data[[2]]$y)

Figure1B<-Figure1B +
  geom_ribbon(data = df2, aes(x = x, ymin = ymin, ymax = ymax,fill="COVID-19"),alpha = 0.8)+
  geom_ribbon(data = df3, aes(x = x, ymin = ymin, ymax = ymax,fill="Non-COVID-19"),alpha = 0.8)+
  scale_fill_manual(values = c("#7c8cc4","#84b48c"))+
  ggsci::scale_color_jama()+
  labs(col="Year",fill="Cause of Death")+
  ylab("Age-Adjusted Mortality Rate \n per 100,000 Inhabitants")+
  xlab("Month")+
  theme_hc()+ 
  guides(col = guide_legend(nrow = 2))+
  guides(fill = guide_legend(nrow = 2))+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
  
######Specific-cause mortality (Figure 1C)#####
#2016
CAUSA_ESPECIFICA_2016<-mort_2016%>%
  filter(!is.na(EDAD))%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  summarise(EII.COLE=sum(EII.COLE==1,na.rm = T),
            EII.TIPA=sum(EII.TIPA==1,na.rm = T),
            EII.SHIG=sum(EII.SHIG==1,na.rm = T),
            EII.TOXI=sum(EII.TOXI==1,na.rm = T),
            EII.AMEB=sum(EII.AMEB==1,na.rm = T),
            EII.OTRA=sum(EII.OTRA==1,na.rm = T),
            EII.PRES=sum(EII.PRES==1,na.rm = T),
            TUB.PULM=sum(TUB.PULM==1,na.rm = T),
            TUB.RESP=sum(TUB.RESP==1,na.rm = T),
            TUB.NERV=sum(TUB.NERV==1,na.rm = T),
            TUB.IPGM=sum(TUB.IPGM==1,na.rm = T),
            TUB.BONE=sum(TUB.BONE==1,na.rm = T),
            TUB.URIN=sum(TUB.URIN==1,na.rm = T),
            TUB.OTRA=sum(TUB.OTRA==1,na.rm = T),
            BAC.PEST=sum(BAC.PEST==1,na.rm = T),
            BAC.BRUS=sum(BAC.BRUS==1,na.rm = T),
            BAC.LEPR=sum(BAC.LEPR==1,na.rm = T),
            BAC.DIFT=sum(BAC.DIFT==1,na.rm = T),
            BAC.PERT=sum(BAC.PERT==1,na.rm = T),
            BAC.PYOG=sum(BAC.PYOG==1,na.rm = T),
            BAC.MENI=sum(BAC.MENI==1,na.rm = T),
            BAC.TETA=sum(BAC.TETA==1,na.rm = T),
            BAC.SEPS=sum(BAC.SEPS==1,na.rm = T),
            BAC.OTRA=sum(BAC.OTRA==1,na.rm = T),
            ETS.SIF1=sum(ETS.SIF1==1,na.rm = T),
            ETS.SIF2=sum(ETS.SIF2==1,na.rm = T),
            ETS.SIF3=sum(ETS.SIF3==1,na.rm = T),
            ETS.GONO=sum(ETS.GONO==1,na.rm = T),
            ETS.CLAM=sum(ETS.CLAM==1,na.rm = T),
            ETS.OTRA=sum(ETS.OTRA==1,na.rm = T),
            VIR.POLI=sum(VIR.POLI==1,na.rm = T),
            VIR.VIRU=sum(VIR.VIRU==1,na.rm = T),
            VIR.SARA=sum(VIR.SARA==1,na.rm = T),
            VIR.RUBE=sum(VIR.RUBE==1,na.rm = T),
            VIR.FIAM=sum(VIR.FIAM==1,na.rm = T),
            VIR.DENG=sum(VIR.DENG==1,na.rm = T),
            VIR.DHEM=sum(VIR.DHEM==1,na.rm = T),
            VIR.VIH1=sum(VIR.VIH1==1,na.rm = T),
            VIR.EVTA=sum(VIR.EVTA==1,na.rm = T),
            VIR.HEPB=sum(VIR.HEPB==1,na.rm = T),
            VIR.HEPO=sum(VIR.HEPO==1,na.rm = T),
            VIR.RABI=sum(VIR.RABI==1,na.rm = T),
            VIR.TRAC=sum(VIR.TRAC==1,na.rm = T),
            VIR.OFAH=sum(VIR.OFAH==1,na.rm = T),
            VIR.HERP=sum(VIR.HERP==1,na.rm = T),
            VIR.VRHZ=sum(VIR.VRHZ==1,na.rm = T),
            VIR.PARO=sum(VIR.PARO==1,na.rm = T),
            VIR.OCLA=sum(VIR.OCLA==1,na.rm = T),
            VIR.OTRA=sum(VIR.OTRA==1,na.rm = T),
            RPI.TIFP=sum(RPI.TIFP==1,na.rm = T),
            RPI.OTIF=sum(RPI.OTIF==1,na.rm = T),
            RPI.ORIC=sum(RPI.ORIC==1,na.rm = T),
            RPI.PALU=sum(RPI.PALU==1,na.rm = T),
            RPI.LEIS=sum(RPI.LEIS==1,na.rm = T),
            RPI.TRIP=sum(RPI.TRIP==1,na.rm = T),
            PMO.ESPI=sum(PMO.ESPI==1,na.rm = T),
            PMO.FIRE=sum(PMO.FIRE==1,na.rm = T),
            PMO.MICO=sum(PMO.MICO==1,na.rm = T),
            PMO.SCHI=sum(PMO.SCHI==1,na.rm = T),
            PMO.TREM=sum(PMO.TREM==1,na.rm = T),
            PMO.ECHI=sum(PMO.ECHI==1,na.rm = T),
            PMO.DRAC=sum(PMO.DRAC==1,na.rm = T),
            PMO.ONCH=sum(PMO.ONCH==1,na.rm = T),
            PMO.FILA=sum(PMO.FILA==1,na.rm = T),
            PMO.ANNE=sum(PMO.ANNE==1,na.rm = T),
            PMO.HELM=sum(PMO.HELM==1,na.rm = T),
            PMO.OTRA=sum(PMO.OTRA==1,na.rm = T),
            SEI.TUBE=sum(SEI.TUBE==1,na.rm = T),
            SEI.POLI=sum(SEI.POLI==1,na.rm = T),
            SEI.LEPR=sum(SEI.LEPR==1,na.rm = T),
            SEI.OTRA=sum(SEI.OTRA==1,na.rm = T),
            NM1.LCBF=sum(NM1.LCBF==1,na.rm = T),
            NM2.ESOF=sum(NM2.ESOF==1,na.rm = T),
            NM2.STOM=sum(NM2.STOM==1,na.rm = T),
            NM2.INDE=sum(NM2.INDE==1,na.rm = T),
            NM2.COLO=sum(NM2.COLO==1,na.rm = T),
            NM2.RECT=sum(NM2.RECT==1,na.rm = T),
            NM2.HIGA=sum(NM2.HIGA==1,na.rm = T),
            NM2.PANC=sum(NM2.PANC==1,na.rm = T),
            NM2.OTRO=sum(NM2.OTRO==1,na.rm = T),
            NM3.LARI=sum(NM3.LARI==1,na.rm = T),
            NM3.TBPU=sum(NM3.TBPU==1,na.rm = T),
            NM3.OTRO=sum(NM3.OTRO==1,na.rm = T),
            NM4.BONE=sum(NM4.BONE==1,na.rm = T),
            NM4.MELA=sum(NM4.MELA==1,na.rm = T),
            NM4.SKIN=sum(NM4.SKIN==1,na.rm = T),
            NM4.MAMA=sum(NM4.MAMA==1,na.rm = T),
            NM4.SOFT=sum(NM4.SOFT==1,na.rm = T),
            NM5.CERV=sum(NM5.CERV==1,na.rm = T),
            NM5.PLAC=sum(NM5.PLAC==1,na.rm = T),
            NM5.UTER=sum(NM5.UTER==1,na.rm = T),
            NM5.OVAR=sum(NM5.OVAR==1,na.rm = T),
            NM5.VAGI=sum(NM5.VAGI==1,na.rm = T),
            NM5.OTFE=sum(NM5.OTFE==1,na.rm = T),
            NM5.PROS=sum(NM5.PROS==1,na.rm = T),
            NM5.TEST=sum(NM5.TEST==1,na.rm = T),
            NM5.OTMA=sum(NM5.OTMA==1,na.rm = T),
            NM5.VEJI=sum(NM5.VEJI==1,na.rm = T),
            NM5.OTUR=sum(NM5.OTUR==1,na.rm = T),
            NM6.ENCF=sum(NM6.ENCF==1,na.rm = T),
            NM6.MENI=sum(NM6.MENI==1,na.rm = T),
            NM6.OJOA=sum(NM6.OJOA==1,na.rm = T),
            NM6.OTRO=sum(NM6.OTRO==1,na.rm = T),
            NM7.ENHO=sum(NM7.ENHO==1,na.rm = T),
            NM7.NOHO=sum(NM7.NOHO==1,na.rm = T),
            NM7.MMCP=sum(NM7.MMCP==1,na.rm = T),
            NM7.LEUC=sum(NM7.LEUC==1,na.rm = T),
            NM7.OTRO=sum(NM7.OTRO==1,na.rm = T),
            NM8.MUPT=sum(NM8.MUPT==1,na.rm = T),
            NIS.CERV=sum(NIS.CERV==1,na.rm = T),
            NIS.OTRO=sum(NIS.OTRO==1,na.rm = T),
            NBE.SKIN=sum(NBE.SKIN==1,na.rm = T),
            NBE.MAMA=sum(NBE.MAMA==1,na.rm = T),
            NBE.LEIO=sum(NBE.LEIO==1,na.rm = T),
            NBE.OVAR=sum(NBE.OVAR==1,na.rm = T),
            NBE.URIN=sum(NBE.URIN==1,na.rm = T),
            NBE.CSNC=sum(NBE.CSNC==1,na.rm = T),
            NBE.TIRO=sum(NBE.TIRO==1,na.rm = T),
            NBE.OTRO=sum(NBE.OTRO==1,na.rm = T),
            NCI.UNCB=sum(NCI.UNCB==1,na.rm = T),
            SAN.ADFE=sum(SAN.ADFE==1,na.rm = T),
            SAN.AOTR=sum(SAN.AOTR==1,na.rm = T),
            SAN.INMU=sum(SAN.INMU==1,na.rm = T),
            SAN.OTRA=sum(SAN.OTRA==1,na.rm = T),
            END.DEYO=sum(END.DEYO==1,na.rm = T),
            END.TTOX=sum(END.TTOX==1,na.rm = T),
            END.TOTR=sum(END.TOTR==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            END.LIPO=sum(END.LIPO==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T),
            END.DEPL=sum(END.DEPL==1,na.rm = T),
            END.SQHA=sum(END.SQHA==1,na.rm = T),
            END.OTRA=sum(END.OTRA==1,na.rm = T),
            NUT.KWAS=sum(NUT.KWAS==1,na.rm = T),
            NUT.MARA=sum(NUT.MARA==1,na.rm = T),
            NUT.PROT=sum(NUT.PROT==1,na.rm = T),
            NUT.VITA=sum(NUT.VITA==1,na.rm = T),
            NUT.VITO=sum(NUT.VITO==1,na.rm = T),
            NUT.SECD=sum(NUT.SECD==1,na.rm = T),
            NUT.OTRA=sum(NUT.OTRA==1,na.rm = T),
            MEN.DEME=sum(MEN.DEME==1,na.rm = T),
            MEN.SDAL=sum(MEN.SDAL==1,na.rm = T),
            MEN.OTAL=sum(MEN.OTAL==1,na.rm = T),
            MEN.TMSP=sum(MEN.TMSP==1,na.rm = T),
            MEN.ESQU=sum(MEN.ESQU==1,na.rm = T),
            MEN.HUMO=sum(MEN.HUMO==1,na.rm = T),
            MEN.ESTR=sum(MEN.ESTR==1,na.rm = T),
            MEN.FISI=sum(MEN.FISI==1,na.rm = T),
            MEN.RETR=sum(MEN.RETR==1,na.rm = T),
            MEN.OTRO=sum(MEN.OTRO==1,na.rm = T),
            NER.MENI=sum(NER.MENI==1,na.rm = T),
            NER.ISNC=sum(NER.ISNC==1,na.rm = T),
            NER.PARK=sum(NER.PARK==1,na.rm = T),
            NER.ALZH=sum(NER.ALZH==1,na.rm = T),
            NER.ESCM=sum(NER.ESCM==1,na.rm = T),
            NER.PALS=sum(NER.PALS==1,na.rm = T),
            NER.EPIL=sum(NER.EPIL==1,na.rm = T),
            NER.MIGR=sum(NER.MIGR==1,na.rm = T),
            NER.IQCT=sum(NER.IQCT==1,na.rm = T),
            NER.SNPE=sum(NER.SNPE==1,na.rm = T),
            NER.OTRA=sum(NER.OTRA==1,na.rm = T),
            EYE.PARP=sum(EYE.PARP==1,na.rm = T),
            EYE.ESCL=sum(EYE.ESCL==1,na.rm = T),
            EYE.GLAU=sum(EYE.GLAU==1,na.rm = T),
            EYE.CATA=sum(EYE.CATA==1,na.rm = T),
            EYE.CRIS=sum(EYE.CRIS==1,na.rm = T),
            EYE.RETI=sum(EYE.RETI==1,na.rm = T),
            EYE.CEGU=sum(EYE.CEGU==1,na.rm = T),
            EYE.CONJ=sum(EYE.CONJ==1,na.rm = T),
            EYE.OTCO=sum(EYE.OTCO==1,na.rm = T),
            EYE.LAGR=sum(EYE.LAGR==1,na.rm = T),
            EYE.ESTR=sum(EYE.ESTR==1,na.rm = T),
            EYE.BINO=sum(EYE.BINO==1,na.rm = T),
            EYE.REFR=sum(EYE.REFR==1,na.rm = T),
            EYE.OTRA=sum(EYE.OTRA==1,na.rm = T),
            EAR.OMTM=sum(EAR.OMTM==1,na.rm = T),
            EAR.OTOM=sum(EAR.OTOM==1,na.rm = T),
            EAR.SORD=sum(EAR.SORD==1,na.rm = T),
            EAR.OTRA=sum(EAR.OTRA==1,na.rm = T),
            SC1.FIRE=sum(SC1.FIRE==1,na.rm = T),
            SC1.CRHD=sum(SC1.CRHD==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            SC4.EMBP=sum(SC4.EMBP==1,na.rm = T),
            SC4.CARR=sum(SC4.CARR==1,na.rm = T),
            SC4.PARO=sum(SC4.PARO==1,na.rm = T),
            SC4.HEFA=sum(SC4.HEFA==1,na.rm = T),
            SC4.OTRA=sum(SC4.OTRA==1,na.rm = T),
            SC5.HEMS=sum(SC5.HEMS==1,na.rm = T),
            SC5.HEMI=sum(SC5.HEMI==1,na.rm = T),
            SC5.ISQC=sum(SC5.ISQC==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC5.ATSC=sum(SC5.ATSC==1,na.rm = T),
            SC5.SEQC=sum(SC5.SEQC==1,na.rm = T),
            SC5.OTRA=sum(SC5.OTRA==1,na.rm = T),
            SC6.ATER=sum(SC6.ATER==1,na.rm = T),
            SC6.OEVP=sum(SC6.OEVP==1,na.rm = T),
            SC6.ETAR=sum(SC6.ETAR==1,na.rm = T),
            SC6.OTAR=sum(SC6.OTAR==1,na.rm = T),
            SC6.ETVE=sum(SC6.ETVE==1,na.rm = T),
            SC6.VARI=sum(SC6.VARI==1,na.rm = T),
            SC6.HMRR=sum(SC6.HMRR==1,na.rm = T),
            SC6.OTRA=sum(SC6.OTRA==1,na.rm = T),
            ER1.FAAG=sum(ER1.FAAG==1,na.rm = T),
            ER1.TOAG=sum(ER1.TOAG==1,na.rm = T),
            ER1.LTAG=sum(ER1.LTAG==1,na.rm = T),
            ER1.OTAG=sum(ER1.OTAG==1,na.rm = T),
            ER1.PNSD=sum(ER1.PNSD==1,na.rm = T),
            ER1.RNPC=sum(ER1.RNPC==1,na.rm = T),
            ER1.SINC=sum(ER1.SINC==1,na.rm = T),
            ER1.TADC=sum(ER1.TADC==1,na.rm = T),
            ER1.ONSN=sum(ER1.ONSN==1,na.rm = T),
            ER1.OTRA=sum(ER1.OTRA==1,na.rm = T),
            ER2.BRAG=sum(ER2.BRAG==1,na.rm = T),
            ER2.NEUM=sum(ER2.NEUM==1,na.rm = T),
            ER2.INFL=sum(ER2.INFL==1,na.rm = T),
            ER2.BCNE=sum(ER2.BCNE==1,na.rm = T),
            ER2.ASMA=sum(ER2.ASMA==1,na.rm = T),
            ER2.BREC=sum(ER2.BREC==1,na.rm = T),
            ER2.EPOC=sum(ER2.EPOC==1,na.rm = T),
            ER2.NMCS=sum(ER2.NMCS==1,na.rm = T),
            ER2.OTAE=sum(ER2.OTAE==1,na.rm = T),
            ER2.PLEU=sum(ER2.PLEU==1,na.rm = T),
            ER2.IRIN=sum(ER2.IRIN==1,na.rm = T),
            ER2.OTRA=sum(ER2.OTRA==1,na.rm = T),
            SD1.CARI=sum(SD1.CARI==1,na.rm = T),
            SD1.OTDI=sum(SD1.OTDI==1,na.rm = T),
            SD1.OTJA=sum(SD1.OTJA==1,na.rm = T),
            SD1.OTRA=sum(SD1.OTRA==1,na.rm = T),
            SD2.ESOF=sum(SD2.ESOF==1,na.rm = T),
            SD2.GDIS=sum(SD2.GDIS==1,na.rm = T),
            SD2.GDUL=sum(SD2.GDUL==1,na.rm = T),
            SD2.OTGD=sum(SD2.OTGD==1,na.rm = T),
            SD2.APEN=sum(SD2.APEN==1,na.rm = T),
            SD2.INHE=sum(SD2.INHE==1,na.rm = T),
            SD2.OTHE=sum(SD2.OTHE==1,na.rm = T),
            SD2.CRCU=sum(SD2.CRCU==1,na.rm = T),
            SD2.PIIO=sum(SD2.PIIO==1,na.rm = T),
            SD2.EDDI=sum(SD2.EDDI==1,na.rm = T),
            SD2.SIIO=sum(SD2.SIIO==1,na.rm = T),
            SD3.ALLD=sum(SD3.ALLD==1,na.rm = T),
            SD3.OTLI=sum(SD3.OTLI==1,na.rm = T),
            SD3.COLE=sum(SD3.COLE==1,na.rm = T),
            SD3.OTIP=sum(SD3.OTIP==1,na.rm = T),
            SD3.PANC=sum(SD3.PANC==1,na.rm = T),
            SD3.OTRA=sum(SD3.OTRA==1,na.rm = T),
            PTS.IPTS=sum(PTS.IPTS==1,na.rm = T),
            PTS.DEEC=sum(PTS.DEEC==1,na.rm = T),
            PTS.OTRA=sum(PTS.OTRA==1,na.rm = T),
            MOC.PAIN=sum(MOC.PAIN==1,na.rm = T),
            MOC.OSAR=sum(MOC.OSAR==1,na.rm = T),
            MOC.ADOL=sum(MOC.ADOL==1,na.rm = T),
            MOC.OTAR=sum(MOC.OTAR==1,na.rm = T),
            MOC.SCTD=sum(MOC.SCTD==1,na.rm = T),
            MOC.IVDD=sum(MOC.IVDD==1,na.rm = T),
            MOC.OTDO=sum(MOC.OTDO==1,na.rm = T),
            MOC.SOFT=sum(MOC.SOFT==1,na.rm = T),
            MOC.BONE=sum(MOC.BONE==1,na.rm = T),
            MOC.OMIE=sum(MOC.OMIE==1,na.rm = T),
            MOC.OTRA=sum(MOC.OTRA==1,na.rm = T),
            GU1.NFRI=sum(GU1.NFRI==1,na.rm = T),
            GU1.OTGL=sum(GU1.OTGL==1,na.rm = T),
            GU1.ACKF=sum(GU1.ACKF==1,na.rm = T),
            GU1.RTID=sum(GU1.RTID==1,na.rm = T),
            GU1.OTTU=sum(GU1.OTTU==1,na.rm = T),
            GU1.LITO=sum(GU1.LITO==1,na.rm = T),
            GU1.RECO=sum(GU1.RECO==1,na.rm = T),
            GU1.CIST=sum(GU1.CIST==1,na.rm = T),
            GU1.OTRA=sum(GU1.OTRA==1,na.rm = T),
            GU2.HIPR=sum(GU2.HIPR==1,na.rm = T),
            GU2.OTPR=sum(GU2.OTPR==1,na.rm = T),
            GU2.HCEC=sum(GU2.HCEC==1,na.rm = T),
            GU2.PREP=sum(GU2.PREP==1,na.rm = T),
            GU2.MINF=sum(GU2.MINF==1,na.rm = T),
            GU2.OTRA=sum(GU2.OTRA==1,na.rm = T),
            GU3.MAMA=sum(GU3.MAMA==1,na.rm = T),
            GU4.SAOO=sum(GU4.SAOO==1,na.rm = T),
            GU4.IDCU=sum(GU4.IDCU==1,na.rm = T),
            GU4.OTVV=sum(GU4.OTVV==1,na.rm = T),
            GU4.OTPI=sum(GU4.OTPI==1,na.rm = T),
            GU4.ENDM=sum(GU4.ENDM==1,na.rm = T),
            GU4.FPRO=sum(GU4.FPRO==1,na.rm = T),
            GU4.NOFB=sum(GU4.NOFB==1,na.rm = T),
            GU4.MENS=sum(GU4.MENS==1,na.rm = T),
            GU4.MNOP=sum(GU4.MNOP==1,na.rm = T),
            GU4.FINF=sum(GU4.FINF==1,na.rm = T),
            GU4.OTRA=sum(GU4.OTRA==1,na.rm = T),
            OB1.SPON=sum(OB1.SPON==1,na.rm = T),
            OB1.INDU=sum(OB1.INDU==1,na.rm = T),
            OB1.OTRA=sum(OB1.OTRA==1,na.rm = T),
            OB2.EPHD=sum(OB2.EPHD==1,na.rm = T),
            OB2.HEMP=sum(OB2.HEMP==1,na.rm = T),
            OB2.FACD=sum(OB2.FACD==1,na.rm = T),
            OB2.IGUT=sum(OB2.IGUT==1,na.rm = T),
            OB2.DMIP=sum(OB2.DMIP==1,na.rm = T),
            OB2.OBSL=sum(OB2.OBSL==1,na.rm = T),
            OB2.PPHE=sum(OB2.PPHE==1,na.rm = T),
            OB2.SOPI=sum(OB2.SOPI==1,na.rm = T),
            OB2.PUER=sum(OB2.PUER==1,na.rm = T),
            OB2.OTPL=sum(OB2.OTPL==1,na.rm = T),
            OB2.OBTE=sum(OB2.OBTE==1,na.rm = T),
            OB2.BEPU=sum(OB2.BEPU==1,na.rm = T),
            OB2.OMLC=sum(OB2.OMLC==1,na.rm = T),
            OB2.OTDC=sum(OB2.OTDC==1,na.rm = T),
            OB2.ODUC=sum(OB2.ODUC==1,na.rm = T),
            OB3.SSDE=sum(OB3.SSDE==1,na.rm = T),
            OB3.OTDE=sum(OB3.OTDE==1,na.rm = T),
            OB4.INOC=sum(OB4.INOC==1,na.rm = T),
            NEO.NAMC=sum(NEO.NAMC==1,na.rm = T),
            NEO.NAOC=sum(NEO.NAOC==1,na.rm = T),
            NEO.GMGW=sum(NEO.GMGW==1,na.rm = T),
            NEO.BITR=sum(NEO.BITR==1,na.rm = T),
            NEO.HIAS=sum(NEO.HIAS==1,na.rm = T),
            NEO.SDRN=sum(NEO.SDRN==1,na.rm = T),
            NEO.INFE=sum(NEO.INFE==1,na.rm = T),
            NEO.OTIN=sum(NEO.OTIN==1,na.rm = T),
            NEO.HDNB=sum(NEO.HDNB==1,na.rm = T),
            NEO.TENE=sum(NEO.TENE==1,na.rm = T),
            NEO.OTRA=sum(NEO.OTRA==1,na.rm = T),
            CON.ANEN=sum(CON.ANEN==1,na.rm = T),
            CON.HIDR=sum(CON.HIDR==1,na.rm = T),
            CON.SBIF=sum(CON.SBIF==1,na.rm = T),
            CON.OTNS=sum(CON.OTNS==1,na.rm = T),
            CON.CIRC=sum(CON.CIRC==1,na.rm = T),
            CON.CLCP=sum(CON.CLCP==1,na.rm = T),
            CON.CINT=sum(CON.CINT==1,na.rm = T),
            CON.OTDS=sum(CON.OTDS==1,na.rm = T),
            CON.TEST=sum(CON.TEST==1,na.rm = T),
            CON.OTGU=sum(CON.OTGU==1,na.rm = T),
            CON.DHIP=sum(CON.DHIP==1,na.rm = T),
            CON.FEET=sum(CON.FEET==1,na.rm = T),
            CON.OTMS=sum(CON.OTMS==1,na.rm = T),
            CON.OTRA=sum(CON.OTRA==1,na.rm = T),
            CON.CROM=sum(CON.CROM==1,na.rm = T),
            NCL.FEVU=sum(NCL.FEVU==1,na.rm = T),
            NCL.CAAB=sum(NCL.CAAB==1,na.rm = T),
            NCL.RAOR=sum(NCL.RAOR==1,na.rm = T),
            NCL.ABPP=sum(NCL.ABPP==1,na.rm = T),
            NCL.ARPD=sum(NCL.ARPD==1,na.rm = T),
            NCL.SIDS=sum(NCL.SIDS==1,na.rm = T),
            NCL.REAR=sum(NCL.REAR==1,na.rm = T),
            NCL.OTRA=sum(NCL.OTRA==1,na.rm = T),
            EX1.RAIL=sum(EX1.RAIL==1,na.rm = T),
            EX1.MOTO=sum(EX1.MOTO==1,na.rm = T),
            EX1.LAND=sum(EX1.LAND==1,na.rm = T),
            EX1.WATE=sum(EX1.WATE==1,na.rm = T),
            EX1.AIRS=sum(EX1.AIRS==1,na.rm = T),
            EX1.OTRO=sum(EX1.OTRO==1,na.rm = T),
            EX2.FALL=sum(EX2.FALL==1,na.rm = T),
            EX3.ENVI=sum(EX3.ENVI==1,na.rm = T),
            EX3.DROW=sum(EX3.DROW==1,na.rm = T),
            EX3.FBNO=sum(EX3.FBNO==1,na.rm = T),
            EX3.MACH=sum(EX3.MACH==1,na.rm = T),
            EX3.FREG=sum(EX3.FREG==1,na.rm = T),
            EX3.SEQA=sum(EX3.SEQA==1,na.rm = T),
            EX3.OTRA=sum(EX3.OTRA==1,na.rm = T),
            EX4.SMFF=sum(EX4.SMFF==1,na.rm = T),
            EX5.APDM=sum(EX5.APDM==1,na.rm = T),
            EX5.APSL=sum(EX5.APSL==1,na.rm = T),
            EX5.APGV=sum(EX5.APGV==1,na.rm = T),
            EX6.SUIC=sum(EX6.SUIC==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            EX8.EOUI=sum(EX8.EOUI==1,na.rm = T),
            EX8.OWAR=sum(EX8.OWAR==1,na.rm = T),
            EX8.LEGI=sum(EX8.LEGI==1,na.rm = T),
            EX9.DRUG=sum(EX9.DRUG==1,na.rm = T),
            EX9.MSDV=sum(EX9.MSDV==1,na.rm = T),
            EX9.SQEX=sum(EX9.SQEX==1,na.rm = T),
            COV.CONF=sum(COV.CONF==1,na.rm = T),
            COV.SUSP=sum(COV.SUSP==1,na.rm = T),
  )%>%
  left_join(Pob_edad_2016_entidad_total,by="EDAD_QUIN")%>%
  summarise(EII.COLE=(EII.COLE/POB)*Weight*100000,
            EII.TIPA=(EII.TIPA/POB)*Weight*100000,
            EII.SHIG=(EII.SHIG/POB)*Weight*100000,
            EII.TOXI=(EII.TOXI/POB)*Weight*100000,
            EII.AMEB=(EII.AMEB/POB)*Weight*100000,
            EII.OTRA=(EII.OTRA/POB)*Weight*100000,
            EII.PRES=(EII.PRES/POB)*Weight*100000,
            TUB.PULM=(TUB.PULM/POB)*Weight*100000,
            TUB.RESP=(TUB.RESP/POB)*Weight*100000,
            TUB.NERV=(TUB.NERV/POB)*Weight*100000,
            TUB.IPGM=(TUB.IPGM/POB)*Weight*100000,
            TUB.BONE=(TUB.BONE/POB)*Weight*100000,
            TUB.URIN=(TUB.URIN/POB)*Weight*100000,
            TUB.OTRA=(TUB.OTRA/POB)*Weight*100000,
            BAC.PEST=(BAC.PEST/POB)*Weight*100000,
            BAC.BRUS=(BAC.BRUS/POB)*Weight*100000,
            BAC.LEPR=(BAC.LEPR/POB)*Weight*100000,
            BAC.DIFT=(BAC.DIFT/POB)*Weight*100000,
            BAC.PERT=(BAC.PERT/POB)*Weight*100000,
            BAC.PYOG=(BAC.PYOG/POB)*Weight*100000,
            BAC.MENI=(BAC.MENI/POB)*Weight*100000,
            BAC.TETA=(BAC.TETA/POB)*Weight*100000,
            BAC.SEPS=(BAC.SEPS/POB)*Weight*100000,
            BAC.OTRA=(BAC.OTRA/POB)*Weight*100000,
            ETS.SIF1=(ETS.SIF1/POB)*Weight*100000,
            ETS.SIF2=(ETS.SIF2/POB)*Weight*100000,
            ETS.SIF3=(ETS.SIF3/POB)*Weight*100000,
            ETS.GONO=(ETS.GONO/POB)*Weight*100000,
            ETS.CLAM=(ETS.CLAM/POB)*Weight*100000,
            ETS.OTRA=(ETS.OTRA/POB)*Weight*100000,
            VIR.POLI=(VIR.POLI/POB)*Weight*100000,
            VIR.VIRU=(VIR.VIRU/POB)*Weight*100000,
            VIR.SARA=(VIR.SARA/POB)*Weight*100000,
            VIR.RUBE=(VIR.RUBE/POB)*Weight*100000,
            VIR.FIAM=(VIR.FIAM/POB)*Weight*100000,
            VIR.DENG=(VIR.DENG/POB)*Weight*100000,
            VIR.DHEM=(VIR.DHEM/POB)*Weight*100000,
            VIR.VIH1=(VIR.VIH1/POB)*Weight*100000,
            VIR.EVTA=(VIR.EVTA/POB)*Weight*100000,
            VIR.HEPB=(VIR.HEPB/POB)*Weight*100000,
            VIR.HEPO=(VIR.HEPO/POB)*Weight*100000,
            VIR.RABI=(VIR.RABI/POB)*Weight*100000,
            VIR.TRAC=(VIR.TRAC/POB)*Weight*100000,
            VIR.OFAH=(VIR.OFAH/POB)*Weight*100000,
            VIR.HERP=(VIR.HERP/POB)*Weight*100000,
            VIR.VRHZ=(VIR.VRHZ/POB)*Weight*100000,
            VIR.PARO=(VIR.PARO/POB)*Weight*100000,
            VIR.OCLA=(VIR.OCLA/POB)*Weight*100000,
            VIR.OTRA=(VIR.OTRA/POB)*Weight*100000,
            RPI.TIFP=(RPI.TIFP/POB)*Weight*100000,
            RPI.OTIF=(RPI.OTIF/POB)*Weight*100000,
            RPI.ORIC=(RPI.ORIC/POB)*Weight*100000,
            RPI.PALU=(RPI.PALU/POB)*Weight*100000,
            RPI.LEIS=(RPI.LEIS/POB)*Weight*100000,
            RPI.TRIP=(RPI.TRIP/POB)*Weight*100000,
            PMO.ESPI=(PMO.ESPI/POB)*Weight*100000,
            PMO.FIRE=(PMO.FIRE/POB)*Weight*100000,
            PMO.MICO=(PMO.MICO/POB)*Weight*100000,
            PMO.SCHI=(PMO.SCHI/POB)*Weight*100000,
            PMO.TREM=(PMO.TREM/POB)*Weight*100000,
            PMO.ECHI=(PMO.ECHI/POB)*Weight*100000,
            PMO.DRAC=(PMO.DRAC/POB)*Weight*100000,
            PMO.ONCH=(PMO.ONCH/POB)*Weight*100000,
            PMO.FILA=(PMO.FILA/POB)*Weight*100000,
            PMO.ANNE=(PMO.ANNE/POB)*Weight*100000,
            PMO.HELM=(PMO.HELM/POB)*Weight*100000,
            PMO.OTRA=(PMO.OTRA/POB)*Weight*100000,
            SEI.TUBE=(SEI.TUBE/POB)*Weight*100000,
            SEI.POLI=(SEI.POLI/POB)*Weight*100000,
            SEI.LEPR=(SEI.LEPR/POB)*Weight*100000,
            SEI.OTRA=(SEI.OTRA/POB)*Weight*100000,
            NM1.LCBF=(NM1.LCBF/POB)*Weight*100000,
            NM2.ESOF=(NM2.ESOF/POB)*Weight*100000,
            NM2.STOM=(NM2.STOM/POB)*Weight*100000,
            NM2.INDE=(NM2.INDE/POB)*Weight*100000,
            NM2.COLO=(NM2.COLO/POB)*Weight*100000,
            NM2.RECT=(NM2.RECT/POB)*Weight*100000,
            NM2.HIGA=(NM2.HIGA/POB)*Weight*100000,
            NM2.PANC=(NM2.PANC/POB)*Weight*100000,
            NM2.OTRO=(NM2.OTRO/POB)*Weight*100000,
            NM3.LARI=(NM3.LARI/POB)*Weight*100000,
            NM3.TBPU=(NM3.TBPU/POB)*Weight*100000,
            NM3.OTRO=(NM3.OTRO/POB)*Weight*100000,
            NM4.BONE=(NM4.BONE/POB)*Weight*100000,
            NM4.MELA=(NM4.MELA/POB)*Weight*100000,
            NM4.SKIN=(NM4.SKIN/POB)*Weight*100000,
            NM4.MAMA=(NM4.MAMA/POB)*Weight*100000,
            NM4.SOFT=(NM4.SOFT/POB)*Weight*100000,
            NM5.CERV=(NM5.CERV/POB)*Weight*100000,
            NM5.PLAC=(NM5.PLAC/POB)*Weight*100000,
            NM5.UTER=(NM5.UTER/POB)*Weight*100000,
            NM5.OVAR=(NM5.OVAR/POB)*Weight*100000,
            NM5.VAGI=(NM5.VAGI/POB)*Weight*100000,
            NM5.OTFE=(NM5.OTFE/POB)*Weight*100000,
            NM5.PROS=(NM5.PROS/POB)*Weight*100000,
            NM5.TEST=(NM5.TEST/POB)*Weight*100000,
            NM5.OTMA=(NM5.OTMA/POB)*Weight*100000,
            NM5.VEJI=(NM5.VEJI/POB)*Weight*100000,
            NM5.OTUR=(NM5.OTUR/POB)*Weight*100000,
            NM6.ENCF=(NM6.ENCF/POB)*Weight*100000,
            NM6.MENI=(NM6.MENI/POB)*Weight*100000,
            NM6.OJOA=(NM6.OJOA/POB)*Weight*100000,
            NM6.OTRO=(NM6.OTRO/POB)*Weight*100000,
            NM7.ENHO=(NM7.ENHO/POB)*Weight*100000,
            NM7.NOHO=(NM7.NOHO/POB)*Weight*100000,
            NM7.MMCP=(NM7.MMCP/POB)*Weight*100000,
            NM7.LEUC=(NM7.LEUC/POB)*Weight*100000,
            NM7.OTRO=(NM7.OTRO/POB)*Weight*100000,
            NM8.MUPT=(NM8.MUPT/POB)*Weight*100000,
            NIS.CERV=(NIS.CERV/POB)*Weight*100000,
            NIS.OTRO=(NIS.OTRO/POB)*Weight*100000,
            NBE.SKIN=(NBE.SKIN/POB)*Weight*100000,
            NBE.MAMA=(NBE.MAMA/POB)*Weight*100000,
            NBE.LEIO=(NBE.LEIO/POB)*Weight*100000,
            NBE.OVAR=(NBE.OVAR/POB)*Weight*100000,
            NBE.URIN=(NBE.URIN/POB)*Weight*100000,
            NBE.CSNC=(NBE.CSNC/POB)*Weight*100000,
            NBE.TIRO=(NBE.TIRO/POB)*Weight*100000,
            NBE.OTRO=(NBE.OTRO/POB)*Weight*100000,
            NCI.UNCB=(NCI.UNCB/POB)*Weight*100000,
            SAN.ADFE=(SAN.ADFE/POB)*Weight*100000,
            SAN.AOTR=(SAN.AOTR/POB)*Weight*100000,
            SAN.INMU=(SAN.INMU/POB)*Weight*100000,
            SAN.OTRA=(SAN.OTRA/POB)*Weight*100000,
            END.DEYO=(END.DEYO/POB)*Weight*100000,
            END.TTOX=(END.TTOX/POB)*Weight*100000,
            END.TOTR=(END.TOTR/POB)*Weight*100000,
            END.DIAB=(END.DIAB/POB)*Weight*100000,
            END.LIPO=(END.LIPO/POB)*Weight*100000,
            END.OBES=(END.OBES/POB)*Weight*100000,
            END.DEPL=(END.DEPL/POB)*Weight*100000,
            END.SQHA=(END.SQHA/POB)*Weight*100000,
            END.OTRA=(END.OTRA/POB)*Weight*100000,
            NUT.KWAS=(NUT.KWAS/POB)*Weight*100000,
            NUT.MARA=(NUT.MARA/POB)*Weight*100000,
            NUT.PROT=(NUT.PROT/POB)*Weight*100000,
            NUT.VITA=(NUT.VITA/POB)*Weight*100000,
            NUT.VITO=(NUT.VITO/POB)*Weight*100000,
            NUT.SECD=(NUT.SECD/POB)*Weight*100000,
            NUT.OTRA=(NUT.OTRA/POB)*Weight*100000,
            MEN.DEME=(MEN.DEME/POB)*Weight*100000,
            MEN.SDAL=(MEN.SDAL/POB)*Weight*100000,
            MEN.OTAL=(MEN.OTAL/POB)*Weight*100000,
            MEN.TMSP=(MEN.TMSP/POB)*Weight*100000,
            MEN.ESQU=(MEN.ESQU/POB)*Weight*100000,
            MEN.HUMO=(MEN.HUMO/POB)*Weight*100000,
            MEN.ESTR=(MEN.ESTR/POB)*Weight*100000,
            MEN.FISI=(MEN.FISI/POB)*Weight*100000,
            MEN.RETR=(MEN.RETR/POB)*Weight*100000,
            MEN.OTRO=(MEN.OTRO/POB)*Weight*100000,
            NER.MENI=(NER.MENI/POB)*Weight*100000,
            NER.ISNC=(NER.ISNC/POB)*Weight*100000,
            NER.PARK=(NER.PARK/POB)*Weight*100000,
            NER.ALZH=(NER.ALZH/POB)*Weight*100000,
            NER.ESCM=(NER.ESCM/POB)*Weight*100000,
            NER.PALS=(NER.PALS/POB)*Weight*100000,
            NER.EPIL=(NER.EPIL/POB)*Weight*100000,
            NER.MIGR=(NER.MIGR/POB)*Weight*100000,
            NER.IQCT=(NER.IQCT/POB)*Weight*100000,
            NER.SNPE=(NER.SNPE/POB)*Weight*100000,
            NER.OTRA=(NER.OTRA/POB)*Weight*100000,
            EYE.PARP=(EYE.PARP/POB)*Weight*100000,
            EYE.ESCL=(EYE.ESCL/POB)*Weight*100000,
            EYE.GLAU=(EYE.GLAU/POB)*Weight*100000,
            EYE.CATA=(EYE.CATA/POB)*Weight*100000,
            EYE.CRIS=(EYE.CRIS/POB)*Weight*100000,
            EYE.RETI=(EYE.RETI/POB)*Weight*100000,
            EYE.CEGU=(EYE.CEGU/POB)*Weight*100000,
            EYE.CONJ=(EYE.CONJ/POB)*Weight*100000,
            EYE.OTCO=(EYE.OTCO/POB)*Weight*100000,
            EYE.LAGR=(EYE.LAGR/POB)*Weight*100000,
            EYE.ESTR=(EYE.ESTR/POB)*Weight*100000,
            EYE.BINO=(EYE.BINO/POB)*Weight*100000,
            EYE.REFR=(EYE.REFR/POB)*Weight*100000,
            EYE.OTRA=(EYE.OTRA/POB)*Weight*100000,
            EAR.OMTM=(EAR.OMTM/POB)*Weight*100000,
            EAR.OTOM=(EAR.OTOM/POB)*Weight*100000,
            EAR.SORD=(EAR.SORD/POB)*Weight*100000,
            EAR.OTRA=(EAR.OTRA/POB)*Weight*100000,
            SC1.FIRE=(SC1.FIRE/POB)*Weight*100000,
            SC1.CRHD=(SC1.CRHD/POB)*Weight*100000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*100000,
            SC2.HTES=(SC2.HTES/POB)*Weight*100000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*100000,
            SC3.IAMC=(SC3.IAMC/POB)*Weight*100000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*100000,
            SC4.EMBP=(SC4.EMBP/POB)*Weight*100000,
            SC4.CARR=(SC4.CARR/POB)*Weight*100000,
            SC4.PARO=(SC4.PARO/POB)*Weight*100000,
            SC4.HEFA=(SC4.HEFA/POB)*Weight*100000,
            SC4.OTRA=(SC4.OTRA/POB)*Weight*100000,
            SC5.HEMS=(SC5.HEMS/POB)*Weight*100000,
            SC5.HEMI=(SC5.HEMI/POB)*Weight*100000,
            SC5.ISQC=(SC5.ISQC/POB)*Weight*100000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*100000,
            SC5.ATSC=(SC5.ATSC/POB)*Weight*100000,
            SC5.SEQC=(SC5.SEQC/POB)*Weight*100000,
            SC5.OTRA=(SC5.OTRA/POB)*Weight*100000,
            SC6.ATER=(SC6.ATER/POB)*Weight*100000,
            SC6.OEVP=(SC6.OEVP/POB)*Weight*100000,
            SC6.ETAR=(SC6.ETAR/POB)*Weight*100000,
            SC6.OTAR=(SC6.OTAR/POB)*Weight*100000,
            SC6.ETVE=(SC6.ETVE/POB)*Weight*100000,
            SC6.VARI=(SC6.VARI/POB)*Weight*100000,
            SC6.HMRR=(SC6.HMRR/POB)*Weight*100000,
            SC6.OTRA=(SC6.OTRA/POB)*Weight*100000,
            ER1.FAAG=(ER1.FAAG/POB)*Weight*100000,
            ER1.TOAG=(ER1.TOAG/POB)*Weight*100000,
            ER1.LTAG=(ER1.LTAG/POB)*Weight*100000,
            ER1.OTAG=(ER1.OTAG/POB)*Weight*100000,
            ER1.PNSD=(ER1.PNSD/POB)*Weight*100000,
            ER1.RNPC=(ER1.RNPC/POB)*Weight*100000,
            ER1.SINC=(ER1.SINC/POB)*Weight*100000,
            ER1.TADC=(ER1.TADC/POB)*Weight*100000,
            ER1.ONSN=(ER1.ONSN/POB)*Weight*100000,
            ER1.OTRA=(ER1.OTRA/POB)*Weight*100000,
            ER2.BRAG=(ER2.BRAG/POB)*Weight*100000,
            ER2.NEUM=(ER2.NEUM/POB)*Weight*100000,
            ER2.INFL=(ER2.INFL/POB)*Weight*100000,
            ER2.BCNE=(ER2.BCNE/POB)*Weight*100000,
            ER2.ASMA=(ER2.ASMA/POB)*Weight*100000,
            ER2.BREC=(ER2.BREC/POB)*Weight*100000,
            ER2.EPOC=(ER2.EPOC/POB)*Weight*100000,
            ER2.NMCS=(ER2.NMCS/POB)*Weight*100000,
            ER2.OTAE=(ER2.OTAE/POB)*Weight*100000,
            ER2.PLEU=(ER2.PLEU/POB)*Weight*100000,
            ER2.IRIN=(ER2.IRIN/POB)*Weight*100000,
            ER2.OTRA=(ER2.OTRA/POB)*Weight*100000,
            SD1.CARI=(SD1.CARI/POB)*Weight*100000,
            SD1.OTDI=(SD1.OTDI/POB)*Weight*100000,
            SD1.OTJA=(SD1.OTJA/POB)*Weight*100000,
            SD1.OTRA=(SD1.OTRA/POB)*Weight*100000,
            SD2.ESOF=(SD2.ESOF/POB)*Weight*100000,
            SD2.GDIS=(SD2.GDIS/POB)*Weight*100000,
            SD2.GDUL=(SD2.GDUL/POB)*Weight*100000,
            SD2.OTGD=(SD2.OTGD/POB)*Weight*100000,
            SD2.APEN=(SD2.APEN/POB)*Weight*100000,
            SD2.INHE=(SD2.INHE/POB)*Weight*100000,
            SD2.OTHE=(SD2.OTHE/POB)*Weight*100000,
            SD2.CRCU=(SD2.CRCU/POB)*Weight*100000,
            SD2.PIIO=(SD2.PIIO/POB)*Weight*100000,
            SD2.EDDI=(SD2.EDDI/POB)*Weight*100000,
            SD2.SIIO=(SD2.SIIO/POB)*Weight*100000,
            SD3.ALLD=(SD3.ALLD/POB)*Weight*100000,
            SD3.OTLI=(SD3.OTLI/POB)*Weight*100000,
            SD3.COLE=(SD3.COLE/POB)*Weight*100000,
            SD3.OTIP=(SD3.OTIP/POB)*Weight*100000,
            SD3.PANC=(SD3.PANC/POB)*Weight*100000,
            SD3.OTRA=(SD3.OTRA/POB)*Weight*100000,
            PTS.IPTS=(PTS.IPTS/POB)*Weight*100000,
            PTS.DEEC=(PTS.DEEC/POB)*Weight*100000,
            PTS.OTRA=(PTS.OTRA/POB)*Weight*100000,
            MOC.PAIN=(MOC.PAIN/POB)*Weight*100000,
            MOC.OSAR=(MOC.OSAR/POB)*Weight*100000,
            MOC.ADOL=(MOC.ADOL/POB)*Weight*100000,
            MOC.OTAR=(MOC.OTAR/POB)*Weight*100000,
            MOC.SCTD=(MOC.SCTD/POB)*Weight*100000,
            MOC.IVDD=(MOC.IVDD/POB)*Weight*100000,
            MOC.OTDO=(MOC.OTDO/POB)*Weight*100000,
            MOC.SOFT=(MOC.SOFT/POB)*Weight*100000,
            MOC.BONE=(MOC.BONE/POB)*Weight*100000,
            MOC.OMIE=(MOC.OMIE/POB)*Weight*100000,
            MOC.OTRA=(MOC.OTRA/POB)*Weight*100000,
            GU1.NFRI=(GU1.NFRI/POB)*Weight*100000,
            GU1.OTGL=(GU1.OTGL/POB)*Weight*100000,
            GU1.ACKF=(GU1.ACKF/POB)*Weight*100000,
            GU1.RTID=(GU1.RTID/POB)*Weight*100000,
            GU1.OTTU=(GU1.OTTU/POB)*Weight*100000,
            GU1.LITO=(GU1.LITO/POB)*Weight*100000,
            GU1.RECO=(GU1.RECO/POB)*Weight*100000,
            GU1.CIST=(GU1.CIST/POB)*Weight*100000,
            GU1.OTRA=(GU1.OTRA/POB)*Weight*100000,
            GU2.HIPR=(GU2.HIPR/POB)*Weight*100000,
            GU2.OTPR=(GU2.OTPR/POB)*Weight*100000,
            GU2.HCEC=(GU2.HCEC/POB)*Weight*100000,
            GU2.PREP=(GU2.PREP/POB)*Weight*100000,
            GU2.MINF=(GU2.MINF/POB)*Weight*100000,
            GU2.OTRA=(GU2.OTRA/POB)*Weight*100000,
            GU3.MAMA=(GU3.MAMA/POB)*Weight*100000,
            GU4.SAOO=(GU4.SAOO/POB)*Weight*100000,
            GU4.IDCU=(GU4.IDCU/POB)*Weight*100000,
            GU4.OTVV=(GU4.OTVV/POB)*Weight*100000,
            GU4.OTPI=(GU4.OTPI/POB)*Weight*100000,
            GU4.ENDM=(GU4.ENDM/POB)*Weight*100000,
            GU4.FPRO=(GU4.FPRO/POB)*Weight*100000,
            GU4.NOFB=(GU4.NOFB/POB)*Weight*100000,
            GU4.MENS=(GU4.MENS/POB)*Weight*100000,
            GU4.MNOP=(GU4.MNOP/POB)*Weight*100000,
            GU4.FINF=(GU4.FINF/POB)*Weight*100000,
            GU4.OTRA=(GU4.OTRA/POB)*Weight*100000,
            OB1.SPON=(OB1.SPON/POB)*Weight*100000,
            OB1.INDU=(OB1.INDU/POB)*Weight*100000,
            OB1.OTRA=(OB1.OTRA/POB)*Weight*100000,
            OB2.EPHD=(OB2.EPHD/POB)*Weight*100000,
            OB2.HEMP=(OB2.HEMP/POB)*Weight*100000,
            OB2.FACD=(OB2.FACD/POB)*Weight*100000,
            OB2.IGUT=(OB2.IGUT/POB)*Weight*100000,
            OB2.DMIP=(OB2.DMIP/POB)*Weight*100000,
            OB2.OBSL=(OB2.OBSL/POB)*Weight*100000,
            OB2.PPHE=(OB2.PPHE/POB)*Weight*100000,
            OB2.SOPI=(OB2.SOPI/POB)*Weight*100000,
            OB2.PUER=(OB2.PUER/POB)*Weight*100000,
            OB2.OTPL=(OB2.OTPL/POB)*Weight*100000,
            OB2.OBTE=(OB2.OBTE/POB)*Weight*100000,
            OB2.BEPU=(OB2.BEPU/POB)*Weight*100000,
            OB2.OMLC=(OB2.OMLC/POB)*Weight*100000,
            OB2.OTDC=(OB2.OTDC/POB)*Weight*100000,
            OB2.ODUC=(OB2.ODUC/POB)*Weight*100000,
            OB3.SSDE=(OB3.SSDE/POB)*Weight*100000,
            OB3.OTDE=(OB3.OTDE/POB)*Weight*100000,
            OB4.INOC=(OB4.INOC/POB)*Weight*100000,
            NEO.NAMC=(NEO.NAMC/POB)*Weight*100000,
            NEO.NAOC=(NEO.NAOC/POB)*Weight*100000,
            NEO.GMGW=(NEO.GMGW/POB)*Weight*100000,
            NEO.BITR=(NEO.BITR/POB)*Weight*100000,
            NEO.HIAS=(NEO.HIAS/POB)*Weight*100000,
            NEO.SDRN=(NEO.SDRN/POB)*Weight*100000,
            NEO.INFE=(NEO.INFE/POB)*Weight*100000,
            NEO.OTIN=(NEO.OTIN/POB)*Weight*100000,
            NEO.HDNB=(NEO.HDNB/POB)*Weight*100000,
            NEO.TENE=(NEO.TENE/POB)*Weight*100000,
            NEO.OTRA=(NEO.OTRA/POB)*Weight*100000,
            CON.ANEN=(CON.ANEN/POB)*Weight*100000,
            CON.HIDR=(CON.HIDR/POB)*Weight*100000,
            CON.SBIF=(CON.SBIF/POB)*Weight*100000,
            CON.OTNS=(CON.OTNS/POB)*Weight*100000,
            CON.CIRC=(CON.CIRC/POB)*Weight*100000,
            CON.CLCP=(CON.CLCP/POB)*Weight*100000,
            CON.CINT=(CON.CINT/POB)*Weight*100000,
            CON.OTDS=(CON.OTDS/POB)*Weight*100000,
            CON.TEST=(CON.TEST/POB)*Weight*100000,
            CON.OTGU=(CON.OTGU/POB)*Weight*100000,
            CON.DHIP=(CON.DHIP/POB)*Weight*100000,
            CON.FEET=(CON.FEET/POB)*Weight*100000,
            CON.OTMS=(CON.OTMS/POB)*Weight*100000,
            CON.OTRA=(CON.OTRA/POB)*Weight*100000,
            CON.CROM=(CON.CROM/POB)*Weight*100000,
            NCL.FEVU=(NCL.FEVU/POB)*Weight*100000,
            NCL.CAAB=(NCL.CAAB/POB)*Weight*100000,
            NCL.RAOR=(NCL.RAOR/POB)*Weight*100000,
            NCL.ABPP=(NCL.ABPP/POB)*Weight*100000,
            NCL.ARPD=(NCL.ARPD/POB)*Weight*100000,
            NCL.SIDS=(NCL.SIDS/POB)*Weight*100000,
            NCL.REAR=(NCL.REAR/POB)*Weight*100000,
            NCL.OTRA=(NCL.OTRA/POB)*Weight*100000,
            EX1.RAIL=(EX1.RAIL/POB)*Weight*100000,
            EX1.MOTO=(EX1.MOTO/POB)*Weight*100000,
            EX1.LAND=(EX1.LAND/POB)*Weight*100000,
            EX1.WATE=(EX1.WATE/POB)*Weight*100000,
            EX1.AIRS=(EX1.AIRS/POB)*Weight*100000,
            EX1.OTRO=(EX1.OTRO/POB)*Weight*100000,
            EX2.FALL=(EX2.FALL/POB)*Weight*100000,
            EX3.ENVI=(EX3.ENVI/POB)*Weight*100000,
            EX3.DROW=(EX3.DROW/POB)*Weight*100000,
            EX3.FBNO=(EX3.FBNO/POB)*Weight*100000,
            EX3.MACH=(EX3.MACH/POB)*Weight*100000,
            EX3.FREG=(EX3.FREG/POB)*Weight*100000,
            EX3.SEQA=(EX3.SEQA/POB)*Weight*100000,
            EX3.OTRA=(EX3.OTRA/POB)*Weight*100000,
            EX4.SMFF=(EX4.SMFF/POB)*Weight*100000,
            EX5.APDM=(EX5.APDM/POB)*Weight*100000,
            EX5.APSL=(EX5.APSL/POB)*Weight*100000,
            EX5.APGV=(EX5.APGV/POB)*Weight*100000,
            EX6.SUIC=(EX6.SUIC/POB)*Weight*100000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*100000,
            EX8.EOUI=(EX8.EOUI/POB)*Weight*100000,
            EX8.OWAR=(EX8.OWAR/POB)*Weight*100000,
            EX8.LEGI=(EX8.LEGI/POB)*Weight*100000,
            EX9.DRUG=(EX9.DRUG/POB)*Weight*100000,
            EX9.MSDV=(EX9.MSDV/POB)*Weight*100000,
            EX9.SQEX=(EX9.SQEX/POB)*Weight*100000,
            COV.CONF=(COV.CONF/POB)*Weight*100000,
            COV.SUSP=(COV.SUSP))%>%
  summarise("Cholera"=sum(EII.COLE),
            "Typhoid and paratyphoid fever"=sum(EII.TIPA),
            "Shigellosis"=sum(EII.SHIG),
            "Food poisoning"=sum(EII.TOXI),
            "Amebiasis"=sum(EII.AMEB),
            "Other GI infection"=sum(EII.OTRA),
            "Presumed GI infection"=sum(EII.PRES),
            "Pulmonary Tb"=sum(TUB.PULM),
            "Other respiratory Tb"=sum(TUB.RESP),
            "Other respiratory Tb"=sum(TUB.NERV),
            "Nervous System Tb"=sum(TUB.IPGM),
            "Intestinal/peritoneal Tb"=sum(TUB.BONE),
            "Bone and joint Tb"=sum(TUB.URIN),
            "Other variety of Tb"=sum(TUB.OTRA),
            "Plague (peste)"=sum(BAC.PEST),
            "Brusellosis"=sum(BAC.BRUS),
            "Leprosy"=sum(BAC.LEPR),
            "Diphtheria"=sum(BAC.DIFT),
            "Pertussis"=sum(BAC.PERT),
            "Scarlet fever, erysipelas"=sum(BAC.PYOG),
            "Meningococcal disease"=sum(BAC.MENI),
            "Tetanus"=sum(BAC.TETA),
            "Sepsis"=sum(BAC.SEPS),
            "Other bacterial diseases"=sum(BAC.OTRA),
            "Congenital syphilis"=sum(ETS.SIF1),
            "Early syphilis"=sum(ETS.SIF2),
            "Other syphilis"=sum(ETS.SIF3),
            "Gonorrhea"=sum(ETS.GONO),
            "Chlamydia"=sum(ETS.CLAM),
            "Other STD"=sum(ETS.OTRA),
            "Acute Poliomyelitis"=sum(VIR.POLI),
            "Smallpox (viruela)"=sum(VIR.VIRU),
            "Measles"=sum(VIR.SARA),
            "Rubella"=sum(VIR.RUBE),
            "Yellow fever"=sum(VIR.FIAM),
            "Dengue fever"=sum(VIR.DENG),
            "Dengue hemorragic fever"=sum(VIR.DHEM),
            "HIV infection"=sum(VIR.VIH1),
            "Arthropod-Borne Viral Encephalitis"=sum(VIR.EVTA),
            "Acute Hepatitis B"=sum(VIR.HEPB),
            "Other viral hepatitis"=sum(VIR.HEPO),
            "Rabies"=sum(VIR.RABI),
            "Trachoma"=sum(VIR.TRAC),
            "Other viral infections"=sum(VIR.OFAH),
            "Herpes simplex infections"=sum(VIR.HERP),
            "Chickenpox or herpes zoster"=sum(VIR.VRHZ),
            "Mumps"=sum(VIR.PARO),
            "Other chlamydia infections"=sum(VIR.OCLA),
            "Other viral diseases"=sum(VIR.OTRA),
            "Louse-borne epidemic thypus"=sum(RPI.TIFP),
            "Other thypus"=sum(RPI.OTIF),
            "Other rickettsiosis"=sum(RPI.ORIC),
            "Malaria"=sum(RPI.PALU),
            "Leishmaniasis"=sum(RPI.LEIS),
            "Trypanosomiasis"=sum(RPI.TRIP),
            "Other spirochetal diseases (Not syphilis)"=sum(PMO.ESPI),
            "Relapsing fevers"=sum(PMO.FIRE),
            "Mycosis"=sum(PMO.MICO),
            "Schistosomiasis"=sum(PMO.SCHI),
            "Other fluke (trematoda) infections"=sum(PMO.TREM),
            "Echinococcosis"=sum(PMO.ECHI),
            "Dracunculiasis"=sum(PMO.DRAC),
            "Onchocerciasis"=sum(PMO.ONCH),
            "Filariasis"=sum(PMO.FILA),
            "Ancylostomiasis or Necatoriasis"=sum(PMO.ANNE),
            "Other Helminthiases"=sum(PMO.HELM),
            "Other infectious/parasitic disease"=sum(PMO.OTRA),
            "Tuberculosis sequelae"=sum(SEI.TUBE),
            "Poliomyelitis sequelae"=sum(SEI.POLI),
            "Leprosy sequelae"=sum(SEI.LEPR),
            "Sequelae from other infections"=sum(SEI.OTRA),
            "Lip, oral cavity and pharynx cancer"=sum(NM1.LCBF),
            "Esophagus cancer"=sum(NM2.ESOF),
            "Stomach cancer"=sum(NM2.STOM),
            "Small intestine cancer"=sum(NM2.INDE),
            "Colon cancer"=sum(NM2.COLO),
            "Rectosigmoid junction, rectum and anal canal cancer"=sum(NM2.RECT),
            "Liver and intrahepatic bile ducts cancer"=sum(NM2.HIGA),
            "Pancreas cancer"=sum(NM2.PANC),
            "Other types of digestive organs cancer"=sum(NM2.OTRO),
            "Larynx cancer"=sum(NM3.LARI),
            "Trachea, bronchus and lung cancer"=sum(NM3.TBPU),
            "Other respiratory and intrathoracic organs cancer"=sum(NM3.OTRO),
            "Bone and articular cartilage cancer"=sum(NM4.BONE),
            "Malignant melanoma of skin cancer"=sum(NM4.MELA),
            "Other malignant neoplasm of skin cancer"=sum(NM4.SKIN),
            "Breast cancer"=sum(NM4.MAMA),
            "Mesothelial and soft tissue cancer"=sum(NM4.SOFT),
            "Cervix uteri cancer"=sum(NM5.CERV),
            "Placenta cancer"=sum(NM5.PLAC),
            "Uterus cancer"=sum(NM5.UTER),
            "Ovary cancer"=sum(NM5.OVAR),
            "Vulva and vagina cancer"=sum(NM5.VAGI),
            "Other and unspecified genitourinary (female) organs cancer"=sum(NM5.OTFE),
            "Prostate cancer"=sum(NM5.PROS),
            "Testis cancer"=sum(NM5.TEST),
            "Other and unspecified genitourinary (male) organs cancer"=sum(NM5.OTMA),
            "Bladder cancer"=sum(NM5.VEJI),
            "Other urinary tract cancer"=sum(NM5.OTUR),
            "Brain cancer"=sum(NM6.ENCF),
            "Meninges and other SNC cancer"=sum(NM6.MENI),
            "Eyes and adnexa cancer"=sum(NM6.OJOA),
            "Other and unspecified cancer in other organs and unspecified sites"=sum(NM6.OTRO),
            "Hodgkin lymphoma"=sum(NM7.ENHO),
            "Non-Hodgkin lymphoma"=sum(NM7.NOHO),
            "Multiple myeloma and plasmatic cell neoplasms"=sum(NM7.MMCP),
            "Leukemias"=sum(NM7.LEUC),
            "Other lymphoid, hematopoietic and related tissue"=sum(NM7.OTRO),
            "Multiple primary tumors"=sum(NM8.MUPT),
            "In-situ cervix uteri"=sum(NIS.CERV),
            "Other in situ neoplasms"=sum(NIS.OTRO),
            "Benign skin neoplasms"=sum(NBE.SKIN),
            "Benign breast neoplasms"=sum(NBE.MAMA),
            "Leiomyoma of uterus neoplasms"=sum(NBE.LEIO),
            "Benign ovary neoplasms"=sum(NBE.OVAR),
            "Bening urinary tract neoplasms"=sum(NBE.URIN),
            "Bening brain and other CNS sites neoplasms"=sum(NBE.CSNC),
            "Benign thyroid neoplasms"=sum(NBE.TIRO),
            "Other benign neoplasms"=sum(NBE.OTRO),
            "Neoplasms of uncertain behaviour"=sum(NCI.UNCB),
            "Iron deficiency anemia"=sum(SAN.ADFE),
            "Other anemias"=sum(SAN.AOTR),
            "Immunity disorders"=sum(SAN.INMU),
            "Other diseases of the blood and blood-forming organs"=sum(SAN.OTRA),
            "Iodine deficiency thyroid disorders"=sum(END.DEYO),
            "Thyrotoxicosis"=sum(END.TTOX),
            "Other thyroid disorders"=sum(END.TOTR),
            "Type 2 diabetes mellitus"=sum(END.DIAB),
            "Metabolism disorders and dyslipidemia"=sum(END.LIPO),
            "Obesity"=sum(END.OBES),
            "Volume depletion"=sum(END.DEPL),
            "Sequelae of hyperalimentation"=sum(END.SQHA),
            "Other endocrine and metabolic diseases"=sum(END.OTRA),
            "Kwashiorkor"=sum(NUT.KWAS),
            "Nutritional marasmus"=sum(NUT.MARA),
            "Other protein-calorie malnutrition"=sum(NUT.PROT),
            "Vitamin A deficiency"=sum(NUT.VITA),
            "Other vitamin deficiencies"=sum(NUT.VITO),
            "Sequelae of malnutrition"=sum(NUT.SECD),
            "Other nutritional deficiencies"=sum(NUT.OTRA),
            "Dementia"=sum(MEN.DEME),
            "Alcohol dependence syndrome"=sum(MEN.SDAL),
            "Other alcohol related disorders"=sum(MEN.OTAL),
            "Mental and behavioral disorders due to other psychoactive substances use"=sum(MEN.TMSP),
            "Schizophrenia, schizotypal, delusional, and other non-mood psychotic disorders"=sum(MEN.ESQU),
            "Mood [affective] disorders"=sum(MEN.HUMO),
            "Anxiety, dissociative, stress-related, somatoform and other nonpsychotic mental disorders"=sum(MEN.ESTR),
            "Behavioral syndromes associated with physiological disturbances and physical factors"=sum(MEN.FISI),
            "Intellectual disabilities"=sum(MEN.RETR),
            "Other mental and behavioral disorders"=sum(MEN.OTRO),
            "Meningitis"=sum(NER.MENI),
            "Other inflammatory diseases of the central nervous system"=sum(NER.ISNC),
            "Parkinson's disease"=sum(NER.PARK),
            "Alzheimer's disease"=sum(NER.ALZH),
            "Multiple sclerosis"=sum(NER.ESCM),
            "Cerebral palsy and other paralytic syndromes"=sum(NER.PALS),
            "Epilepsy and recurrent seizures"=sum(NER.EPIL),
            "Migraine and other headache syndromes"=sum(NER.MIGR),
            "Transient cerebral ischemic attacks and related syndromes"=sum(NER.IQCT),
            "Nerve, nerve root and plexus disorders"=sum(NER.SNPE),
            "Other diseases of the nervous system"=sum(NER.OTRA),
            "Eyelid inflammation"=sum(EYE.PARP),
            "Disorders of sclera and cornea"=sum(EYE.ESCL),
            "Glaucoma"=sum(EYE.GLAU),
            "Cataracts"=sum(EYE.CATA),
            "Other disorders of lens"=sum(EYE.CRIS),
            "Retinal detachments and breaks"=sum(EYE.RETI),
            "Blindness and low vision"=sum(EYE.CEGU),
            "Conjunctivitis"=sum(EYE.CONJ),
            "Other disorders of conjunctiva"=sum(EYE.OTCO),
            "Disorders of lacrimal system"=sum(EYE.LAGR),
            "Strabismus"=sum(EYE.ESTR),
            "Other disorders of binocular movement"=sum(EYE.BINO),
            "Disorders of refraction and accommodation"=sum(EYE.REFR),
            "Other diseases of the eye and adnexa"=sum(EYE.OTRA),
            "Otitis media, disorders of Eustachian tube and mastoiditis"=sum(EAR.OMTM),
            "Other middle ear disorders"=sum(EAR.OTOM),
            "Hearing loss"=sum(EAR.SORD),
            "Other diseases of the ear and mastoid process"=sum(EAR.OTRA),
            "Acute rheumatic fever"=sum(SC1.FIRE),
            "Chronic rheumatic heart diseases"=sum(SC1.CRHD),
            "Hypertensive heart disease"=sum(SC2.ECHI),
            "Essential (primary) hypertension"=sum(SC2.HTES),
            "Other hypertensive diseases"=sum(SC2.OTRA),
            "Acute myocardial infarction"=sum(SC3.IAMC),
            "Other ischemic heart diseases"=sum(SC3.OTRA),
            "Pulmonary embolism"=sum(SC4.EMBP),
            "Conduction disorders and arrhythmia"=sum(SC4.CARR),
            "Cardiac arrest"=sum(SC4.PARO),
            "Heart failure"=sum(SC4.HEFA),
            "Other diseases of pulmonary circulation and other heart diseases"=sum(SC4.OTRA),
            "Subarachnoid hemorrhage"=sum(SC5.HEMS),
            "Intracerebral and other intracranial hemorrhage"=sum(SC5.HEMI),
            "Cerebral infarction"=sum(SC5.ISQC),
            "Unspecified (hemorrhagic vs isquemic)"=sum(SC5.EVCN),
            "Cerebral atherosclerosis"=sum(SC5.ATSC),
            "Sequelae of cerebrovascular disease"=sum(SC5.SEQC),
            "Other cerebrovascular diseases"=sum(SC5.OTRA),
            "Atherosclerosis"=sum(SC6.ATER),
            "Other peripheral vascular diseases"=sum(SC6.OEVP),
            "Arterial embolism and thrombosis"=sum(SC6.ETAR),
            "Other diseases of arteries, arterioles and capillaries"=sum(SC6.OTAR),
            "Phlebitis, trombophlebitis, other venous embolism and thrombosis"=sum(SC6.ETVE),
            "Varicose veins of lower extremities"=sum(SC6.VARI),
            "Hemorrhoids"=sum(SC6.HMRR),
            "Other diseases of the circulatory system"=sum(SC6.OTRA),
            "Acute pharyngitis"=sum(ER1.FAAG),
            "Acute tonsillitis"=sum(ER1.TOAG),
            "Acute laryngitis and tracheitis"=sum(ER1.LTAG),
            "Other acute upper respiratory infections"=sum(ER1.OTAG),
            "Nasal polyp and deviated nasal septum"=sum(ER1.PNSD),
            "Chronic rhinitis, nasopharyngitis and pharyngitis"=sum(ER1.RNPC),
            "Chronic sinusitis"=sum(ER1.SINC),
            "Chronic diseases of tonsils and adenoids"=sum(ER1.TADC),
            "Other disorders of nose and nasal sinuses"=sum(ER1.ONSN),
            "Other acute upper respiratory infections"=sum(ER1.OTRA),
            "Acute bronchitis and bronchiolitis"=sum(ER2.BRAG),
            "Pneumonia"=sum(ER2.NEUM),
            "Influenza"=sum(ER2.INFL),
            "Chronic and unspecified bronchitis or emphysema"=sum(ER2.BCNE),
            "Asthma"=sum(ER2.ASMA),
            "Bronchiectasis"=sum(ER2.BREC),
            "Chronic obstructive pulmonary disease"=sum(ER2.EPOC),
            "Pneumoconiosis"=sum(ER2.NMCS),
            "Other pulmonary diseases due to external agents"=sum(ER2.OTAE),
            "Pleural conditions"=sum(ER2.PLEU),
            "Unspecified acute lower respiratory infection"=sum(ER2.IRIN),
            "Other respiratory tract diseases"=sum(ER2.OTRA),
            "Dental caries"=sum(SD1.CARI),
            "Other disorders of teeth and supporting structures"=sum(SD1.OTDI),
            "Other diseases of jaw"=sum(SD1.OTJA),
            "Other oral cavity and salivary glands"=sum(SD1.OTRA),
            "Diseases of esophagus"=sum(SD2.ESOF),
            "Gastritis and duodenitis"=sum(SD2.GDIS),
            "Gastric and duodenal ulcer"=sum(SD2.GDUL),
            "Other diseases of stomach and duodenum"=sum(SD2.OTGD),
            "Diseases of appendix"=sum(SD2.APEN),
            "Inguinal hernia"=sum(SD2.INHE),
            "Other hernias"=sum(SD2.OTHE),
            "Crohn's disease and ulcerative colitis"=sum(SD2.CRCU),
            "Paralytic ileus and intestinal obstruction without hernia"=sum(SD2.PIIO),
            "Diverticular disease of intestine"=sum(SD2.EDDI),
            "Irritable bowel syndrome and other functional intestinal disorders"=sum(SD2.SIIO),
            "Alcoholic liver disease"=sum(SD3.ALLD),
            "Other diseases of liver"=sum(SD3.OTLI),
            "Cholelithiasis and cholecystitis"=sum(SD3.COLE),
            "Other diseases of intestines and peritoneum"=sum(SD3.OTIP),
            "Acute pancreatitis and other diseases of pancreas"=sum(SD3.PANC),
            "Other diseases of digestive system"=sum(SD3.OTRA),
            "Infections of the skin and subcutaneous tissue"=sum(PTS.IPTS),
            "Dermatitis and eczema"=sum(PTS.DEEC),
            "Other diseases of the skin and subcutaneous tissue"=sum(PTS.OTRA),
            "Inflammatory polyarthropathies"=sum(MOC.PAIN),
            "Osteoarthritis"=sum(MOC.OSAR),
            "Acquired deformities of limbs"=sum(MOC.ADOL),
            "Other joint disorders"=sum(MOC.OTAR),
            "Systemic connective tissue disorders"=sum(MOC.SCTD),
            "Intervertebral disc disorders"=sum(MOC.IVDD),
            "Other dorsopathies"=sum(MOC.OTDO),
            "Soft tissue disorders"=sum(MOC.SOFT),
            "Disorders of bone density and structure"=sum(MOC.BONE),
            "Osteomyelitis"=sum(MOC.OMIE),
            "Other diseases of the musculoskeletal system and connective tissue"=sum(MOC.OTRA),
            "Acute and rapidly progressive nephritic syndrome"=sum(GU1.NFRI),
            "Other glomerular diseases"=sum(GU1.OTGL),
            "Acute kidney failure and chronic kidney disease"=sum(GU1.ACKF),
            "Renal tubulo-interstitial diseases"=sum(GU1.RTID),
            "Other renal tubulo-interstitial diseases"=sum(GU1.OTTU),
            "Urolithiasis"=sum(GU1.LITO),
            "Unspecified renal colic"=sum(GU1.RECO),
            "Cystitis"=sum(GU1.CIST),
            "Other diseases of urinary system"=sum(GU1.OTRA),
            "Benign prostatic hyperplasia"=sum(GU2.HIPR),
            "Other disorders of prostate"=sum(GU2.OTPR),
            "Hydrocele and spermatocele"=sum(GU2.HCEC),
            "Disorders of prepuce"=sum(GU2.PREP),
            "Male infertility"=sum(GU2.MINF),
            "Other male genital organs diseases"=sum(GU2.OTRA),
            "Disorders of breast"=sum(GU3.MAMA),
            "Salpingitis and oophoritis"=sum(GU4.SAOO),
            "Inflammatory disease of cervix uteri"=sum(GU4.IDCU),
            "Other diseases of uterus, vagina and vulva"=sum(GU4.OTVV),
            "Other female pelvic inflammatory diseases"=sum(GU4.OTPI),
            "Endometriosis"=sum(GU4.ENDM),
            "Female genital prolapse"=sum(GU4.FPRO),
            "Noninflammatory disorders of ovary, fallopian tube and broad ligament"=sum(GU4.NOFB),
            "Disorders of menstruation"=sum(GU4.MENS),
            "Menopausal and other perimenopausal disorders"=sum(GU4.MNOP),
            "Female infertility"=sum(GU4.FINF),
            "Other female genital organs diseases"=sum(GU4.OTRA),
            "Spontaneous abortion"=sum(OB1.SPON),
            "Complications following (induced) termination of pregnancy"=sum(OB1.INDU),
            "Other abortion"=sum(OB1.OTRA),
            "Edema, proteinuria and hypertensive disorders in pregnancy, childbirth and the puerperium"=sum(OB2.EPHD),
            "Hemorrhage in early pregnancy, placenta previa, abruptio placentae, antepartum hemorrhage"=sum(OB2.HEMP),
            "Maternal care related to the fetus and amniotic cavity and possible delivery problems"=sum(OB2.FACD),
            "Infections of genitourinary tract in pregnancy"=sum(OB2.IGUT),
            "Diabetes mellitus in pregnancy"=sum(OB2.DMIP),
            "Obstructed labor"=sum(OB2.OBSL),
            "Postpartum hemorrhage"=sum(OB2.PPHE),
            "Sepsis and other puerperal infections"=sum(OB2.SOPI),
            "Other complications of the puerperium"=sum(OB2.PUER),
            "Other complications of pregnancy and labor"=sum(OB2.OTPL),
            "Obstetrical tetanus"=sum(OB2.OBTE),
            "Mental and behavioral disorders associated with the puerperium"=sum(OB2.BEPU),
            "Puerperal osteomalacia"=sum(OB2.OMLC),
            "Other direct obstetric causes"=sum(OB2.OTDC),
            "Obstetric death of unspecified cause"=sum(OB2.ODUC),
            "Single spontaneous delivery"=sum(OB3.SSDE),
            "Other delivery"=sum(OB3.OTDE),
            "Indirect obstetric causes"=sum(OB4.INOC),
            "Newborn affected by maternal conditions"=sum(NEO.NAMC),
            "Newborn affected by obstetric complications"=sum(NEO.NAOC),
            "Slow fetal growth, fetal malnutrition, short gestation and low birth weight"=sum(NEO.GMGW),
            "Birth trauma"=sum(NEO.BITR),
            "Intrauterine hypoxia and birth asphyxia "=sum(NEO.HIAS),
            "Respiratory distress of newborn and other perinatal respiratory disorders"=sum(NEO.SDRN),
            "Congenital viral, bacterial and parasitic diseases"=sum(NEO.INFE),
            "Other infections specific to the perinatal period"=sum(NEO.OTIN),
            "Hemolytic disease of newborn"=sum(NEO.HDNB),
            "Tetanus neonatorum"=sum(NEO.TENE),
            "Other conditions originating in the perinatal period"=sum(NEO.OTRA),
            "Anencephaly and similar malformations"=sum(CON.ANEN),
            "Congenital hydrocephalus"=sum(CON.HIDR),
            "Spina bifida"=sum(CON.SBIF),
            "Other congenital malformations of the nervous system"=sum(CON.OTNS),
            "Congenital malformations of the circulatory system"=sum(CON.CIRC),
            "Cleft lip and cleft palate"=sum(CON.CLCP),
            "Congenital absence, atresia and stenosis of small intestine"=sum(CON.CINT),
            "Other congenital malformations of the digestive system"=sum(CON.OTDS),
            "Undescended and ectopic testicle"=sum(CON.TEST),
            "Other congenital malformations of genitourinary system"=sum(CON.OTGU),
            "Congenital deformities of hip"=sum(CON.DHIP),
            "Congenital deformities of feet"=sum(CON.FEET),
            "Other congenital malformations and deformations of the musculoskeletal system"=sum(CON.OTMS),
            "Other congenital malformations"=sum(CON.OTRA),
            "Chromosomal abnormalities, not elsewhere classified"=sum(CON.CROM),
            "Fever of other and unknown origin"=sum(NCL.FEVU),
            "Cardiac abnormalities"=sum(NCL.CAAB),
            "Retention of urine"=sum(NCL.RAOR),
            "Abdominal and pelvic pain"=sum(NCL.ABPP),
            "Age-related physical debility"=sum(NCL.ARPD),
            "Sudden infant death syndrome"=sum(NCL.SIDS),
            "Respiratory arrest"=sum(NCL.REAR),
            "Other symptoms, signs and abnormal clinical and laboratory findings"=sum(NCL.OTRA),
            "Railway accidents"=sum(EX1.RAIL),
            "Motor vehicle traffic accidents"=sum(EX1.MOTO),
            "Other land transport accidents"=sum(EX1.LAND),
            "Water transport accidents"=sum(EX1.WATE),
            "Air and space transport accidents"=sum(EX1.AIRS),
            "Other transport accidents"=sum(EX1.OTRO),
            "Falls"=sum(EX2.FALL),
            "Accidents caused by environmental factors"=sum(EX3.ENVI),
            "Accidental non-transport drowning and submersion"=sum(EX3.DROW),
            "Foreign body entering into or through eye or natural orifice"=sum(EX3.FBNO),
            "Accidents caused by machinery or sharp instruments"=sum(EX3.MACH),
            "Accidents caused by firearms and guns"=sum(EX3.FREG),
            "Sequelae of transport accidents and other accidents"=sum(EX3.SEQA),
            "Other accidents"=sum(EX3.OTRA),
            "Exposure to smoke, fire and flames"=sum(EX4.SMFF),
            "Accidental poisoning by drugs, medicaments and biological substances"=sum(EX5.APDM),
            "Accidental poisoning by other solid or liquid substances"=sum(EX5.APSL),
            "Accidental poisoning by other gases and vapours"=sum(EX5.APGV),
            "Intentional self-harm"=sum(EX6.SUIC),
            "Assault"=sum(EX7.ASSA),
            "Event of undetermined intent"=sum(EX8.EOUI),
            "Operations of war"=sum(EX8.OWAR),
            "Legal intervention"=sum(EX8.LEGI),
            "Drugs, medicaments and biological substances causing adverse effects in therapeutic use"=sum(EX9.DRUG),
            "Misadventures to patients during surgical and medical care"=sum(EX9.MSDV),
            "Sequelae of external causes of morbidity and mortality"=sum(EX9.SQEX),
            "Confirmed COVID-19"=sum(COV.CONF),
            "Suspected COVID-19"=sum(COV.SUSP))%>%
  mutate(EV_YEAR=c("2016"))

#2017
CAUSA_ESPECIFICA_2017<-mort_2017%>%
  filter(!is.na(EDAD))%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  summarise(EII.COLE=sum(EII.COLE==1,na.rm = T),
            EII.TIPA=sum(EII.TIPA==1,na.rm = T),
            EII.SHIG=sum(EII.SHIG==1,na.rm = T),
            EII.TOXI=sum(EII.TOXI==1,na.rm = T),
            EII.AMEB=sum(EII.AMEB==1,na.rm = T),
            EII.OTRA=sum(EII.OTRA==1,na.rm = T),
            EII.PRES=sum(EII.PRES==1,na.rm = T),
            TUB.PULM=sum(TUB.PULM==1,na.rm = T),
            TUB.RESP=sum(TUB.RESP==1,na.rm = T),
            TUB.NERV=sum(TUB.NERV==1,na.rm = T),
            TUB.IPGM=sum(TUB.IPGM==1,na.rm = T),
            TUB.BONE=sum(TUB.BONE==1,na.rm = T),
            TUB.URIN=sum(TUB.URIN==1,na.rm = T),
            TUB.OTRA=sum(TUB.OTRA==1,na.rm = T),
            BAC.PEST=sum(BAC.PEST==1,na.rm = T),
            BAC.BRUS=sum(BAC.BRUS==1,na.rm = T),
            BAC.LEPR=sum(BAC.LEPR==1,na.rm = T),
            BAC.DIFT=sum(BAC.DIFT==1,na.rm = T),
            BAC.PERT=sum(BAC.PERT==1,na.rm = T),
            BAC.PYOG=sum(BAC.PYOG==1,na.rm = T),
            BAC.MENI=sum(BAC.MENI==1,na.rm = T),
            BAC.TETA=sum(BAC.TETA==1,na.rm = T),
            BAC.SEPS=sum(BAC.SEPS==1,na.rm = T),
            BAC.OTRA=sum(BAC.OTRA==1,na.rm = T),
            ETS.SIF1=sum(ETS.SIF1==1,na.rm = T),
            ETS.SIF2=sum(ETS.SIF2==1,na.rm = T),
            ETS.SIF3=sum(ETS.SIF3==1,na.rm = T),
            ETS.GONO=sum(ETS.GONO==1,na.rm = T),
            ETS.CLAM=sum(ETS.CLAM==1,na.rm = T),
            ETS.OTRA=sum(ETS.OTRA==1,na.rm = T),
            VIR.POLI=sum(VIR.POLI==1,na.rm = T),
            VIR.VIRU=sum(VIR.VIRU==1,na.rm = T),
            VIR.SARA=sum(VIR.SARA==1,na.rm = T),
            VIR.RUBE=sum(VIR.RUBE==1,na.rm = T),
            VIR.FIAM=sum(VIR.FIAM==1,na.rm = T),
            VIR.DENG=sum(VIR.DENG==1,na.rm = T),
            VIR.DHEM=sum(VIR.DHEM==1,na.rm = T),
            VIR.VIH1=sum(VIR.VIH1==1,na.rm = T),
            VIR.EVTA=sum(VIR.EVTA==1,na.rm = T),
            VIR.HEPB=sum(VIR.HEPB==1,na.rm = T),
            VIR.HEPO=sum(VIR.HEPO==1,na.rm = T),
            VIR.RABI=sum(VIR.RABI==1,na.rm = T),
            VIR.TRAC=sum(VIR.TRAC==1,na.rm = T),
            VIR.OFAH=sum(VIR.OFAH==1,na.rm = T),
            VIR.HERP=sum(VIR.HERP==1,na.rm = T),
            VIR.VRHZ=sum(VIR.VRHZ==1,na.rm = T),
            VIR.PARO=sum(VIR.PARO==1,na.rm = T),
            VIR.OCLA=sum(VIR.OCLA==1,na.rm = T),
            VIR.OTRA=sum(VIR.OTRA==1,na.rm = T),
            RPI.TIFP=sum(RPI.TIFP==1,na.rm = T),
            RPI.OTIF=sum(RPI.OTIF==1,na.rm = T),
            RPI.ORIC=sum(RPI.ORIC==1,na.rm = T),
            RPI.PALU=sum(RPI.PALU==1,na.rm = T),
            RPI.LEIS=sum(RPI.LEIS==1,na.rm = T),
            RPI.TRIP=sum(RPI.TRIP==1,na.rm = T),
            PMO.ESPI=sum(PMO.ESPI==1,na.rm = T),
            PMO.FIRE=sum(PMO.FIRE==1,na.rm = T),
            PMO.MICO=sum(PMO.MICO==1,na.rm = T),
            PMO.SCHI=sum(PMO.SCHI==1,na.rm = T),
            PMO.TREM=sum(PMO.TREM==1,na.rm = T),
            PMO.ECHI=sum(PMO.ECHI==1,na.rm = T),
            PMO.DRAC=sum(PMO.DRAC==1,na.rm = T),
            PMO.ONCH=sum(PMO.ONCH==1,na.rm = T),
            PMO.FILA=sum(PMO.FILA==1,na.rm = T),
            PMO.ANNE=sum(PMO.ANNE==1,na.rm = T),
            PMO.HELM=sum(PMO.HELM==1,na.rm = T),
            PMO.OTRA=sum(PMO.OTRA==1,na.rm = T),
            SEI.TUBE=sum(SEI.TUBE==1,na.rm = T),
            SEI.POLI=sum(SEI.POLI==1,na.rm = T),
            SEI.LEPR=sum(SEI.LEPR==1,na.rm = T),
            SEI.OTRA=sum(SEI.OTRA==1,na.rm = T),
            NM1.LCBF=sum(NM1.LCBF==1,na.rm = T),
            NM2.ESOF=sum(NM2.ESOF==1,na.rm = T),
            NM2.STOM=sum(NM2.STOM==1,na.rm = T),
            NM2.INDE=sum(NM2.INDE==1,na.rm = T),
            NM2.COLO=sum(NM2.COLO==1,na.rm = T),
            NM2.RECT=sum(NM2.RECT==1,na.rm = T),
            NM2.HIGA=sum(NM2.HIGA==1,na.rm = T),
            NM2.PANC=sum(NM2.PANC==1,na.rm = T),
            NM2.OTRO=sum(NM2.OTRO==1,na.rm = T),
            NM3.LARI=sum(NM3.LARI==1,na.rm = T),
            NM3.TBPU=sum(NM3.TBPU==1,na.rm = T),
            NM3.OTRO=sum(NM3.OTRO==1,na.rm = T),
            NM4.BONE=sum(NM4.BONE==1,na.rm = T),
            NM4.MELA=sum(NM4.MELA==1,na.rm = T),
            NM4.SKIN=sum(NM4.SKIN==1,na.rm = T),
            NM4.MAMA=sum(NM4.MAMA==1,na.rm = T),
            NM4.SOFT=sum(NM4.SOFT==1,na.rm = T),
            NM5.CERV=sum(NM5.CERV==1,na.rm = T),
            NM5.PLAC=sum(NM5.PLAC==1,na.rm = T),
            NM5.UTER=sum(NM5.UTER==1,na.rm = T),
            NM5.OVAR=sum(NM5.OVAR==1,na.rm = T),
            NM5.VAGI=sum(NM5.VAGI==1,na.rm = T),
            NM5.OTFE=sum(NM5.OTFE==1,na.rm = T),
            NM5.PROS=sum(NM5.PROS==1,na.rm = T),
            NM5.TEST=sum(NM5.TEST==1,na.rm = T),
            NM5.OTMA=sum(NM5.OTMA==1,na.rm = T),
            NM5.VEJI=sum(NM5.VEJI==1,na.rm = T),
            NM5.OTUR=sum(NM5.OTUR==1,na.rm = T),
            NM6.ENCF=sum(NM6.ENCF==1,na.rm = T),
            NM6.MENI=sum(NM6.MENI==1,na.rm = T),
            NM6.OJOA=sum(NM6.OJOA==1,na.rm = T),
            NM6.OTRO=sum(NM6.OTRO==1,na.rm = T),
            NM7.ENHO=sum(NM7.ENHO==1,na.rm = T),
            NM7.NOHO=sum(NM7.NOHO==1,na.rm = T),
            NM7.MMCP=sum(NM7.MMCP==1,na.rm = T),
            NM7.LEUC=sum(NM7.LEUC==1,na.rm = T),
            NM7.OTRO=sum(NM7.OTRO==1,na.rm = T),
            NM8.MUPT=sum(NM8.MUPT==1,na.rm = T),
            NIS.CERV=sum(NIS.CERV==1,na.rm = T),
            NIS.OTRO=sum(NIS.OTRO==1,na.rm = T),
            NBE.SKIN=sum(NBE.SKIN==1,na.rm = T),
            NBE.MAMA=sum(NBE.MAMA==1,na.rm = T),
            NBE.LEIO=sum(NBE.LEIO==1,na.rm = T),
            NBE.OVAR=sum(NBE.OVAR==1,na.rm = T),
            NBE.URIN=sum(NBE.URIN==1,na.rm = T),
            NBE.CSNC=sum(NBE.CSNC==1,na.rm = T),
            NBE.TIRO=sum(NBE.TIRO==1,na.rm = T),
            NBE.OTRO=sum(NBE.OTRO==1,na.rm = T),
            NCI.UNCB=sum(NCI.UNCB==1,na.rm = T),
            SAN.ADFE=sum(SAN.ADFE==1,na.rm = T),
            SAN.AOTR=sum(SAN.AOTR==1,na.rm = T),
            SAN.INMU=sum(SAN.INMU==1,na.rm = T),
            SAN.OTRA=sum(SAN.OTRA==1,na.rm = T),
            END.DEYO=sum(END.DEYO==1,na.rm = T),
            END.TTOX=sum(END.TTOX==1,na.rm = T),
            END.TOTR=sum(END.TOTR==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            END.LIPO=sum(END.LIPO==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T),
            END.DEPL=sum(END.DEPL==1,na.rm = T),
            END.SQHA=sum(END.SQHA==1,na.rm = T),
            END.OTRA=sum(END.OTRA==1,na.rm = T),
            NUT.KWAS=sum(NUT.KWAS==1,na.rm = T),
            NUT.MARA=sum(NUT.MARA==1,na.rm = T),
            NUT.PROT=sum(NUT.PROT==1,na.rm = T),
            NUT.VITA=sum(NUT.VITA==1,na.rm = T),
            NUT.VITO=sum(NUT.VITO==1,na.rm = T),
            NUT.SECD=sum(NUT.SECD==1,na.rm = T),
            NUT.OTRA=sum(NUT.OTRA==1,na.rm = T),
            MEN.DEME=sum(MEN.DEME==1,na.rm = T),
            MEN.SDAL=sum(MEN.SDAL==1,na.rm = T),
            MEN.OTAL=sum(MEN.OTAL==1,na.rm = T),
            MEN.TMSP=sum(MEN.TMSP==1,na.rm = T),
            MEN.ESQU=sum(MEN.ESQU==1,na.rm = T),
            MEN.HUMO=sum(MEN.HUMO==1,na.rm = T),
            MEN.ESTR=sum(MEN.ESTR==1,na.rm = T),
            MEN.FISI=sum(MEN.FISI==1,na.rm = T),
            MEN.RETR=sum(MEN.RETR==1,na.rm = T),
            MEN.OTRO=sum(MEN.OTRO==1,na.rm = T),
            NER.MENI=sum(NER.MENI==1,na.rm = T),
            NER.ISNC=sum(NER.ISNC==1,na.rm = T),
            NER.PARK=sum(NER.PARK==1,na.rm = T),
            NER.ALZH=sum(NER.ALZH==1,na.rm = T),
            NER.ESCM=sum(NER.ESCM==1,na.rm = T),
            NER.PALS=sum(NER.PALS==1,na.rm = T),
            NER.EPIL=sum(NER.EPIL==1,na.rm = T),
            NER.MIGR=sum(NER.MIGR==1,na.rm = T),
            NER.IQCT=sum(NER.IQCT==1,na.rm = T),
            NER.SNPE=sum(NER.SNPE==1,na.rm = T),
            NER.OTRA=sum(NER.OTRA==1,na.rm = T),
            EYE.PARP=sum(EYE.PARP==1,na.rm = T),
            EYE.ESCL=sum(EYE.ESCL==1,na.rm = T),
            EYE.GLAU=sum(EYE.GLAU==1,na.rm = T),
            EYE.CATA=sum(EYE.CATA==1,na.rm = T),
            EYE.CRIS=sum(EYE.CRIS==1,na.rm = T),
            EYE.RETI=sum(EYE.RETI==1,na.rm = T),
            EYE.CEGU=sum(EYE.CEGU==1,na.rm = T),
            EYE.CONJ=sum(EYE.CONJ==1,na.rm = T),
            EYE.OTCO=sum(EYE.OTCO==1,na.rm = T),
            EYE.LAGR=sum(EYE.LAGR==1,na.rm = T),
            EYE.ESTR=sum(EYE.ESTR==1,na.rm = T),
            EYE.BINO=sum(EYE.BINO==1,na.rm = T),
            EYE.REFR=sum(EYE.REFR==1,na.rm = T),
            EYE.OTRA=sum(EYE.OTRA==1,na.rm = T),
            EAR.OMTM=sum(EAR.OMTM==1,na.rm = T),
            EAR.OTOM=sum(EAR.OTOM==1,na.rm = T),
            EAR.SORD=sum(EAR.SORD==1,na.rm = T),
            EAR.OTRA=sum(EAR.OTRA==1,na.rm = T),
            SC1.FIRE=sum(SC1.FIRE==1,na.rm = T),
            SC1.CRHD=sum(SC1.CRHD==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            SC4.EMBP=sum(SC4.EMBP==1,na.rm = T),
            SC4.CARR=sum(SC4.CARR==1,na.rm = T),
            SC4.PARO=sum(SC4.PARO==1,na.rm = T),
            SC4.HEFA=sum(SC4.HEFA==1,na.rm = T),
            SC4.OTRA=sum(SC4.OTRA==1,na.rm = T),
            SC5.HEMS=sum(SC5.HEMS==1,na.rm = T),
            SC5.HEMI=sum(SC5.HEMI==1,na.rm = T),
            SC5.ISQC=sum(SC5.ISQC==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC5.ATSC=sum(SC5.ATSC==1,na.rm = T),
            SC5.SEQC=sum(SC5.SEQC==1,na.rm = T),
            SC5.OTRA=sum(SC5.OTRA==1,na.rm = T),
            SC6.ATER=sum(SC6.ATER==1,na.rm = T),
            SC6.OEVP=sum(SC6.OEVP==1,na.rm = T),
            SC6.ETAR=sum(SC6.ETAR==1,na.rm = T),
            SC6.OTAR=sum(SC6.OTAR==1,na.rm = T),
            SC6.ETVE=sum(SC6.ETVE==1,na.rm = T),
            SC6.VARI=sum(SC6.VARI==1,na.rm = T),
            SC6.HMRR=sum(SC6.HMRR==1,na.rm = T),
            SC6.OTRA=sum(SC6.OTRA==1,na.rm = T),
            ER1.FAAG=sum(ER1.FAAG==1,na.rm = T),
            ER1.TOAG=sum(ER1.TOAG==1,na.rm = T),
            ER1.LTAG=sum(ER1.LTAG==1,na.rm = T),
            ER1.OTAG=sum(ER1.OTAG==1,na.rm = T),
            ER1.PNSD=sum(ER1.PNSD==1,na.rm = T),
            ER1.RNPC=sum(ER1.RNPC==1,na.rm = T),
            ER1.SINC=sum(ER1.SINC==1,na.rm = T),
            ER1.TADC=sum(ER1.TADC==1,na.rm = T),
            ER1.ONSN=sum(ER1.ONSN==1,na.rm = T),
            ER1.OTRA=sum(ER1.OTRA==1,na.rm = T),
            ER2.BRAG=sum(ER2.BRAG==1,na.rm = T),
            ER2.NEUM=sum(ER2.NEUM==1,na.rm = T),
            ER2.INFL=sum(ER2.INFL==1,na.rm = T),
            ER2.BCNE=sum(ER2.BCNE==1,na.rm = T),
            ER2.ASMA=sum(ER2.ASMA==1,na.rm = T),
            ER2.BREC=sum(ER2.BREC==1,na.rm = T),
            ER2.EPOC=sum(ER2.EPOC==1,na.rm = T),
            ER2.NMCS=sum(ER2.NMCS==1,na.rm = T),
            ER2.OTAE=sum(ER2.OTAE==1,na.rm = T),
            ER2.PLEU=sum(ER2.PLEU==1,na.rm = T),
            ER2.IRIN=sum(ER2.IRIN==1,na.rm = T),
            ER2.OTRA=sum(ER2.OTRA==1,na.rm = T),
            SD1.CARI=sum(SD1.CARI==1,na.rm = T),
            SD1.OTDI=sum(SD1.OTDI==1,na.rm = T),
            SD1.OTJA=sum(SD1.OTJA==1,na.rm = T),
            SD1.OTRA=sum(SD1.OTRA==1,na.rm = T),
            SD2.ESOF=sum(SD2.ESOF==1,na.rm = T),
            SD2.GDIS=sum(SD2.GDIS==1,na.rm = T),
            SD2.GDUL=sum(SD2.GDUL==1,na.rm = T),
            SD2.OTGD=sum(SD2.OTGD==1,na.rm = T),
            SD2.APEN=sum(SD2.APEN==1,na.rm = T),
            SD2.INHE=sum(SD2.INHE==1,na.rm = T),
            SD2.OTHE=sum(SD2.OTHE==1,na.rm = T),
            SD2.CRCU=sum(SD2.CRCU==1,na.rm = T),
            SD2.PIIO=sum(SD2.PIIO==1,na.rm = T),
            SD2.EDDI=sum(SD2.EDDI==1,na.rm = T),
            SD2.SIIO=sum(SD2.SIIO==1,na.rm = T),
            SD3.ALLD=sum(SD3.ALLD==1,na.rm = T),
            SD3.OTLI=sum(SD3.OTLI==1,na.rm = T),
            SD3.COLE=sum(SD3.COLE==1,na.rm = T),
            SD3.OTIP=sum(SD3.OTIP==1,na.rm = T),
            SD3.PANC=sum(SD3.PANC==1,na.rm = T),
            SD3.OTRA=sum(SD3.OTRA==1,na.rm = T),
            PTS.IPTS=sum(PTS.IPTS==1,na.rm = T),
            PTS.DEEC=sum(PTS.DEEC==1,na.rm = T),
            PTS.OTRA=sum(PTS.OTRA==1,na.rm = T),
            MOC.PAIN=sum(MOC.PAIN==1,na.rm = T),
            MOC.OSAR=sum(MOC.OSAR==1,na.rm = T),
            MOC.ADOL=sum(MOC.ADOL==1,na.rm = T),
            MOC.OTAR=sum(MOC.OTAR==1,na.rm = T),
            MOC.SCTD=sum(MOC.SCTD==1,na.rm = T),
            MOC.IVDD=sum(MOC.IVDD==1,na.rm = T),
            MOC.OTDO=sum(MOC.OTDO==1,na.rm = T),
            MOC.SOFT=sum(MOC.SOFT==1,na.rm = T),
            MOC.BONE=sum(MOC.BONE==1,na.rm = T),
            MOC.OMIE=sum(MOC.OMIE==1,na.rm = T),
            MOC.OTRA=sum(MOC.OTRA==1,na.rm = T),
            GU1.NFRI=sum(GU1.NFRI==1,na.rm = T),
            GU1.OTGL=sum(GU1.OTGL==1,na.rm = T),
            GU1.ACKF=sum(GU1.ACKF==1,na.rm = T),
            GU1.RTID=sum(GU1.RTID==1,na.rm = T),
            GU1.OTTU=sum(GU1.OTTU==1,na.rm = T),
            GU1.LITO=sum(GU1.LITO==1,na.rm = T),
            GU1.RECO=sum(GU1.RECO==1,na.rm = T),
            GU1.CIST=sum(GU1.CIST==1,na.rm = T),
            GU1.OTRA=sum(GU1.OTRA==1,na.rm = T),
            GU2.HIPR=sum(GU2.HIPR==1,na.rm = T),
            GU2.OTPR=sum(GU2.OTPR==1,na.rm = T),
            GU2.HCEC=sum(GU2.HCEC==1,na.rm = T),
            GU2.PREP=sum(GU2.PREP==1,na.rm = T),
            GU2.MINF=sum(GU2.MINF==1,na.rm = T),
            GU2.OTRA=sum(GU2.OTRA==1,na.rm = T),
            GU3.MAMA=sum(GU3.MAMA==1,na.rm = T),
            GU4.SAOO=sum(GU4.SAOO==1,na.rm = T),
            GU4.IDCU=sum(GU4.IDCU==1,na.rm = T),
            GU4.OTVV=sum(GU4.OTVV==1,na.rm = T),
            GU4.OTPI=sum(GU4.OTPI==1,na.rm = T),
            GU4.ENDM=sum(GU4.ENDM==1,na.rm = T),
            GU4.FPRO=sum(GU4.FPRO==1,na.rm = T),
            GU4.NOFB=sum(GU4.NOFB==1,na.rm = T),
            GU4.MENS=sum(GU4.MENS==1,na.rm = T),
            GU4.MNOP=sum(GU4.MNOP==1,na.rm = T),
            GU4.FINF=sum(GU4.FINF==1,na.rm = T),
            GU4.OTRA=sum(GU4.OTRA==1,na.rm = T),
            OB1.SPON=sum(OB1.SPON==1,na.rm = T),
            OB1.INDU=sum(OB1.INDU==1,na.rm = T),
            OB1.OTRA=sum(OB1.OTRA==1,na.rm = T),
            OB2.EPHD=sum(OB2.EPHD==1,na.rm = T),
            OB2.HEMP=sum(OB2.HEMP==1,na.rm = T),
            OB2.FACD=sum(OB2.FACD==1,na.rm = T),
            OB2.IGUT=sum(OB2.IGUT==1,na.rm = T),
            OB2.DMIP=sum(OB2.DMIP==1,na.rm = T),
            OB2.OBSL=sum(OB2.OBSL==1,na.rm = T),
            OB2.PPHE=sum(OB2.PPHE==1,na.rm = T),
            OB2.SOPI=sum(OB2.SOPI==1,na.rm = T),
            OB2.PUER=sum(OB2.PUER==1,na.rm = T),
            OB2.OTPL=sum(OB2.OTPL==1,na.rm = T),
            OB2.OBTE=sum(OB2.OBTE==1,na.rm = T),
            OB2.BEPU=sum(OB2.BEPU==1,na.rm = T),
            OB2.OMLC=sum(OB2.OMLC==1,na.rm = T),
            OB2.OTDC=sum(OB2.OTDC==1,na.rm = T),
            OB2.ODUC=sum(OB2.ODUC==1,na.rm = T),
            OB3.SSDE=sum(OB3.SSDE==1,na.rm = T),
            OB3.OTDE=sum(OB3.OTDE==1,na.rm = T),
            OB4.INOC=sum(OB4.INOC==1,na.rm = T),
            NEO.NAMC=sum(NEO.NAMC==1,na.rm = T),
            NEO.NAOC=sum(NEO.NAOC==1,na.rm = T),
            NEO.GMGW=sum(NEO.GMGW==1,na.rm = T),
            NEO.BITR=sum(NEO.BITR==1,na.rm = T),
            NEO.HIAS=sum(NEO.HIAS==1,na.rm = T),
            NEO.SDRN=sum(NEO.SDRN==1,na.rm = T),
            NEO.INFE=sum(NEO.INFE==1,na.rm = T),
            NEO.OTIN=sum(NEO.OTIN==1,na.rm = T),
            NEO.HDNB=sum(NEO.HDNB==1,na.rm = T),
            NEO.TENE=sum(NEO.TENE==1,na.rm = T),
            NEO.OTRA=sum(NEO.OTRA==1,na.rm = T),
            CON.ANEN=sum(CON.ANEN==1,na.rm = T),
            CON.HIDR=sum(CON.HIDR==1,na.rm = T),
            CON.SBIF=sum(CON.SBIF==1,na.rm = T),
            CON.OTNS=sum(CON.OTNS==1,na.rm = T),
            CON.CIRC=sum(CON.CIRC==1,na.rm = T),
            CON.CLCP=sum(CON.CLCP==1,na.rm = T),
            CON.CINT=sum(CON.CINT==1,na.rm = T),
            CON.OTDS=sum(CON.OTDS==1,na.rm = T),
            CON.TEST=sum(CON.TEST==1,na.rm = T),
            CON.OTGU=sum(CON.OTGU==1,na.rm = T),
            CON.DHIP=sum(CON.DHIP==1,na.rm = T),
            CON.FEET=sum(CON.FEET==1,na.rm = T),
            CON.OTMS=sum(CON.OTMS==1,na.rm = T),
            CON.OTRA=sum(CON.OTRA==1,na.rm = T),
            CON.CROM=sum(CON.CROM==1,na.rm = T),
            NCL.FEVU=sum(NCL.FEVU==1,na.rm = T),
            NCL.CAAB=sum(NCL.CAAB==1,na.rm = T),
            NCL.RAOR=sum(NCL.RAOR==1,na.rm = T),
            NCL.ABPP=sum(NCL.ABPP==1,na.rm = T),
            NCL.ARPD=sum(NCL.ARPD==1,na.rm = T),
            NCL.SIDS=sum(NCL.SIDS==1,na.rm = T),
            NCL.REAR=sum(NCL.REAR==1,na.rm = T),
            NCL.OTRA=sum(NCL.OTRA==1,na.rm = T),
            EX1.RAIL=sum(EX1.RAIL==1,na.rm = T),
            EX1.MOTO=sum(EX1.MOTO==1,na.rm = T),
            EX1.LAND=sum(EX1.LAND==1,na.rm = T),
            EX1.WATE=sum(EX1.WATE==1,na.rm = T),
            EX1.AIRS=sum(EX1.AIRS==1,na.rm = T),
            EX1.OTRO=sum(EX1.OTRO==1,na.rm = T),
            EX2.FALL=sum(EX2.FALL==1,na.rm = T),
            EX3.ENVI=sum(EX3.ENVI==1,na.rm = T),
            EX3.DROW=sum(EX3.DROW==1,na.rm = T),
            EX3.FBNO=sum(EX3.FBNO==1,na.rm = T),
            EX3.MACH=sum(EX3.MACH==1,na.rm = T),
            EX3.FREG=sum(EX3.FREG==1,na.rm = T),
            EX3.SEQA=sum(EX3.SEQA==1,na.rm = T),
            EX3.OTRA=sum(EX3.OTRA==1,na.rm = T),
            EX4.SMFF=sum(EX4.SMFF==1,na.rm = T),
            EX5.APDM=sum(EX5.APDM==1,na.rm = T),
            EX5.APSL=sum(EX5.APSL==1,na.rm = T),
            EX5.APGV=sum(EX5.APGV==1,na.rm = T),
            EX6.SUIC=sum(EX6.SUIC==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            EX8.EOUI=sum(EX8.EOUI==1,na.rm = T),
            EX8.OWAR=sum(EX8.OWAR==1,na.rm = T),
            EX8.LEGI=sum(EX8.LEGI==1,na.rm = T),
            EX9.DRUG=sum(EX9.DRUG==1,na.rm = T),
            EX9.MSDV=sum(EX9.MSDV==1,na.rm = T),
            EX9.SQEX=sum(EX9.SQEX==1,na.rm = T),
            COV.CONF=sum(COV.CONF==1,na.rm = T),
            COV.SUSP=sum(COV.SUSP==1,na.rm = T),
  )%>%
  left_join(Pob_edad_2017_entidad_total,by="EDAD_QUIN")%>%
  summarise(EII.COLE=(EII.COLE/POB)*Weight*100000,
            EII.TIPA=(EII.TIPA/POB)*Weight*100000,
            EII.SHIG=(EII.SHIG/POB)*Weight*100000,
            EII.TOXI=(EII.TOXI/POB)*Weight*100000,
            EII.AMEB=(EII.AMEB/POB)*Weight*100000,
            EII.OTRA=(EII.OTRA/POB)*Weight*100000,
            EII.PRES=(EII.PRES/POB)*Weight*100000,
            TUB.PULM=(TUB.PULM/POB)*Weight*100000,
            TUB.RESP=(TUB.RESP/POB)*Weight*100000,
            TUB.NERV=(TUB.NERV/POB)*Weight*100000,
            TUB.IPGM=(TUB.IPGM/POB)*Weight*100000,
            TUB.BONE=(TUB.BONE/POB)*Weight*100000,
            TUB.URIN=(TUB.URIN/POB)*Weight*100000,
            TUB.OTRA=(TUB.OTRA/POB)*Weight*100000,
            BAC.PEST=(BAC.PEST/POB)*Weight*100000,
            BAC.BRUS=(BAC.BRUS/POB)*Weight*100000,
            BAC.LEPR=(BAC.LEPR/POB)*Weight*100000,
            BAC.DIFT=(BAC.DIFT/POB)*Weight*100000,
            BAC.PERT=(BAC.PERT/POB)*Weight*100000,
            BAC.PYOG=(BAC.PYOG/POB)*Weight*100000,
            BAC.MENI=(BAC.MENI/POB)*Weight*100000,
            BAC.TETA=(BAC.TETA/POB)*Weight*100000,
            BAC.SEPS=(BAC.SEPS/POB)*Weight*100000,
            BAC.OTRA=(BAC.OTRA/POB)*Weight*100000,
            ETS.SIF1=(ETS.SIF1/POB)*Weight*100000,
            ETS.SIF2=(ETS.SIF2/POB)*Weight*100000,
            ETS.SIF3=(ETS.SIF3/POB)*Weight*100000,
            ETS.GONO=(ETS.GONO/POB)*Weight*100000,
            ETS.CLAM=(ETS.CLAM/POB)*Weight*100000,
            ETS.OTRA=(ETS.OTRA/POB)*Weight*100000,
            VIR.POLI=(VIR.POLI/POB)*Weight*100000,
            VIR.VIRU=(VIR.VIRU/POB)*Weight*100000,
            VIR.SARA=(VIR.SARA/POB)*Weight*100000,
            VIR.RUBE=(VIR.RUBE/POB)*Weight*100000,
            VIR.FIAM=(VIR.FIAM/POB)*Weight*100000,
            VIR.DENG=(VIR.DENG/POB)*Weight*100000,
            VIR.DHEM=(VIR.DHEM/POB)*Weight*100000,
            VIR.VIH1=(VIR.VIH1/POB)*Weight*100000,
            VIR.EVTA=(VIR.EVTA/POB)*Weight*100000,
            VIR.HEPB=(VIR.HEPB/POB)*Weight*100000,
            VIR.HEPO=(VIR.HEPO/POB)*Weight*100000,
            VIR.RABI=(VIR.RABI/POB)*Weight*100000,
            VIR.TRAC=(VIR.TRAC/POB)*Weight*100000,
            VIR.OFAH=(VIR.OFAH/POB)*Weight*100000,
            VIR.HERP=(VIR.HERP/POB)*Weight*100000,
            VIR.VRHZ=(VIR.VRHZ/POB)*Weight*100000,
            VIR.PARO=(VIR.PARO/POB)*Weight*100000,
            VIR.OCLA=(VIR.OCLA/POB)*Weight*100000,
            VIR.OTRA=(VIR.OTRA/POB)*Weight*100000,
            RPI.TIFP=(RPI.TIFP/POB)*Weight*100000,
            RPI.OTIF=(RPI.OTIF/POB)*Weight*100000,
            RPI.ORIC=(RPI.ORIC/POB)*Weight*100000,
            RPI.PALU=(RPI.PALU/POB)*Weight*100000,
            RPI.LEIS=(RPI.LEIS/POB)*Weight*100000,
            RPI.TRIP=(RPI.TRIP/POB)*Weight*100000,
            PMO.ESPI=(PMO.ESPI/POB)*Weight*100000,
            PMO.FIRE=(PMO.FIRE/POB)*Weight*100000,
            PMO.MICO=(PMO.MICO/POB)*Weight*100000,
            PMO.SCHI=(PMO.SCHI/POB)*Weight*100000,
            PMO.TREM=(PMO.TREM/POB)*Weight*100000,
            PMO.ECHI=(PMO.ECHI/POB)*Weight*100000,
            PMO.DRAC=(PMO.DRAC/POB)*Weight*100000,
            PMO.ONCH=(PMO.ONCH/POB)*Weight*100000,
            PMO.FILA=(PMO.FILA/POB)*Weight*100000,
            PMO.ANNE=(PMO.ANNE/POB)*Weight*100000,
            PMO.HELM=(PMO.HELM/POB)*Weight*100000,
            PMO.OTRA=(PMO.OTRA/POB)*Weight*100000,
            SEI.TUBE=(SEI.TUBE/POB)*Weight*100000,
            SEI.POLI=(SEI.POLI/POB)*Weight*100000,
            SEI.LEPR=(SEI.LEPR/POB)*Weight*100000,
            SEI.OTRA=(SEI.OTRA/POB)*Weight*100000,
            NM1.LCBF=(NM1.LCBF/POB)*Weight*100000,
            NM2.ESOF=(NM2.ESOF/POB)*Weight*100000,
            NM2.STOM=(NM2.STOM/POB)*Weight*100000,
            NM2.INDE=(NM2.INDE/POB)*Weight*100000,
            NM2.COLO=(NM2.COLO/POB)*Weight*100000,
            NM2.RECT=(NM2.RECT/POB)*Weight*100000,
            NM2.HIGA=(NM2.HIGA/POB)*Weight*100000,
            NM2.PANC=(NM2.PANC/POB)*Weight*100000,
            NM2.OTRO=(NM2.OTRO/POB)*Weight*100000,
            NM3.LARI=(NM3.LARI/POB)*Weight*100000,
            NM3.TBPU=(NM3.TBPU/POB)*Weight*100000,
            NM3.OTRO=(NM3.OTRO/POB)*Weight*100000,
            NM4.BONE=(NM4.BONE/POB)*Weight*100000,
            NM4.MELA=(NM4.MELA/POB)*Weight*100000,
            NM4.SKIN=(NM4.SKIN/POB)*Weight*100000,
            NM4.MAMA=(NM4.MAMA/POB)*Weight*100000,
            NM4.SOFT=(NM4.SOFT/POB)*Weight*100000,
            NM5.CERV=(NM5.CERV/POB)*Weight*100000,
            NM5.PLAC=(NM5.PLAC/POB)*Weight*100000,
            NM5.UTER=(NM5.UTER/POB)*Weight*100000,
            NM5.OVAR=(NM5.OVAR/POB)*Weight*100000,
            NM5.VAGI=(NM5.VAGI/POB)*Weight*100000,
            NM5.OTFE=(NM5.OTFE/POB)*Weight*100000,
            NM5.PROS=(NM5.PROS/POB)*Weight*100000,
            NM5.TEST=(NM5.TEST/POB)*Weight*100000,
            NM5.OTMA=(NM5.OTMA/POB)*Weight*100000,
            NM5.VEJI=(NM5.VEJI/POB)*Weight*100000,
            NM5.OTUR=(NM5.OTUR/POB)*Weight*100000,
            NM6.ENCF=(NM6.ENCF/POB)*Weight*100000,
            NM6.MENI=(NM6.MENI/POB)*Weight*100000,
            NM6.OJOA=(NM6.OJOA/POB)*Weight*100000,
            NM6.OTRO=(NM6.OTRO/POB)*Weight*100000,
            NM7.ENHO=(NM7.ENHO/POB)*Weight*100000,
            NM7.NOHO=(NM7.NOHO/POB)*Weight*100000,
            NM7.MMCP=(NM7.MMCP/POB)*Weight*100000,
            NM7.LEUC=(NM7.LEUC/POB)*Weight*100000,
            NM7.OTRO=(NM7.OTRO/POB)*Weight*100000,
            NM8.MUPT=(NM8.MUPT/POB)*Weight*100000,
            NIS.CERV=(NIS.CERV/POB)*Weight*100000,
            NIS.OTRO=(NIS.OTRO/POB)*Weight*100000,
            NBE.SKIN=(NBE.SKIN/POB)*Weight*100000,
            NBE.MAMA=(NBE.MAMA/POB)*Weight*100000,
            NBE.LEIO=(NBE.LEIO/POB)*Weight*100000,
            NBE.OVAR=(NBE.OVAR/POB)*Weight*100000,
            NBE.URIN=(NBE.URIN/POB)*Weight*100000,
            NBE.CSNC=(NBE.CSNC/POB)*Weight*100000,
            NBE.TIRO=(NBE.TIRO/POB)*Weight*100000,
            NBE.OTRO=(NBE.OTRO/POB)*Weight*100000,
            NCI.UNCB=(NCI.UNCB/POB)*Weight*100000,
            SAN.ADFE=(SAN.ADFE/POB)*Weight*100000,
            SAN.AOTR=(SAN.AOTR/POB)*Weight*100000,
            SAN.INMU=(SAN.INMU/POB)*Weight*100000,
            SAN.OTRA=(SAN.OTRA/POB)*Weight*100000,
            END.DEYO=(END.DEYO/POB)*Weight*100000,
            END.TTOX=(END.TTOX/POB)*Weight*100000,
            END.TOTR=(END.TOTR/POB)*Weight*100000,
            END.DIAB=(END.DIAB/POB)*Weight*100000,
            END.LIPO=(END.LIPO/POB)*Weight*100000,
            END.OBES=(END.OBES/POB)*Weight*100000,
            END.DEPL=(END.DEPL/POB)*Weight*100000,
            END.SQHA=(END.SQHA/POB)*Weight*100000,
            END.OTRA=(END.OTRA/POB)*Weight*100000,
            NUT.KWAS=(NUT.KWAS/POB)*Weight*100000,
            NUT.MARA=(NUT.MARA/POB)*Weight*100000,
            NUT.PROT=(NUT.PROT/POB)*Weight*100000,
            NUT.VITA=(NUT.VITA/POB)*Weight*100000,
            NUT.VITO=(NUT.VITO/POB)*Weight*100000,
            NUT.SECD=(NUT.SECD/POB)*Weight*100000,
            NUT.OTRA=(NUT.OTRA/POB)*Weight*100000,
            MEN.DEME=(MEN.DEME/POB)*Weight*100000,
            MEN.SDAL=(MEN.SDAL/POB)*Weight*100000,
            MEN.OTAL=(MEN.OTAL/POB)*Weight*100000,
            MEN.TMSP=(MEN.TMSP/POB)*Weight*100000,
            MEN.ESQU=(MEN.ESQU/POB)*Weight*100000,
            MEN.HUMO=(MEN.HUMO/POB)*Weight*100000,
            MEN.ESTR=(MEN.ESTR/POB)*Weight*100000,
            MEN.FISI=(MEN.FISI/POB)*Weight*100000,
            MEN.RETR=(MEN.RETR/POB)*Weight*100000,
            MEN.OTRO=(MEN.OTRO/POB)*Weight*100000,
            NER.MENI=(NER.MENI/POB)*Weight*100000,
            NER.ISNC=(NER.ISNC/POB)*Weight*100000,
            NER.PARK=(NER.PARK/POB)*Weight*100000,
            NER.ALZH=(NER.ALZH/POB)*Weight*100000,
            NER.ESCM=(NER.ESCM/POB)*Weight*100000,
            NER.PALS=(NER.PALS/POB)*Weight*100000,
            NER.EPIL=(NER.EPIL/POB)*Weight*100000,
            NER.MIGR=(NER.MIGR/POB)*Weight*100000,
            NER.IQCT=(NER.IQCT/POB)*Weight*100000,
            NER.SNPE=(NER.SNPE/POB)*Weight*100000,
            NER.OTRA=(NER.OTRA/POB)*Weight*100000,
            EYE.PARP=(EYE.PARP/POB)*Weight*100000,
            EYE.ESCL=(EYE.ESCL/POB)*Weight*100000,
            EYE.GLAU=(EYE.GLAU/POB)*Weight*100000,
            EYE.CATA=(EYE.CATA/POB)*Weight*100000,
            EYE.CRIS=(EYE.CRIS/POB)*Weight*100000,
            EYE.RETI=(EYE.RETI/POB)*Weight*100000,
            EYE.CEGU=(EYE.CEGU/POB)*Weight*100000,
            EYE.CONJ=(EYE.CONJ/POB)*Weight*100000,
            EYE.OTCO=(EYE.OTCO/POB)*Weight*100000,
            EYE.LAGR=(EYE.LAGR/POB)*Weight*100000,
            EYE.ESTR=(EYE.ESTR/POB)*Weight*100000,
            EYE.BINO=(EYE.BINO/POB)*Weight*100000,
            EYE.REFR=(EYE.REFR/POB)*Weight*100000,
            EYE.OTRA=(EYE.OTRA/POB)*Weight*100000,
            EAR.OMTM=(EAR.OMTM/POB)*Weight*100000,
            EAR.OTOM=(EAR.OTOM/POB)*Weight*100000,
            EAR.SORD=(EAR.SORD/POB)*Weight*100000,
            EAR.OTRA=(EAR.OTRA/POB)*Weight*100000,
            SC1.FIRE=(SC1.FIRE/POB)*Weight*100000,
            SC1.CRHD=(SC1.CRHD/POB)*Weight*100000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*100000,
            SC2.HTES=(SC2.HTES/POB)*Weight*100000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*100000,
            SC3.IAMC=(SC3.IAMC/POB)*Weight*100000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*100000,
            SC4.EMBP=(SC4.EMBP/POB)*Weight*100000,
            SC4.CARR=(SC4.CARR/POB)*Weight*100000,
            SC4.PARO=(SC4.PARO/POB)*Weight*100000,
            SC4.HEFA=(SC4.HEFA/POB)*Weight*100000,
            SC4.OTRA=(SC4.OTRA/POB)*Weight*100000,
            SC5.HEMS=(SC5.HEMS/POB)*Weight*100000,
            SC5.HEMI=(SC5.HEMI/POB)*Weight*100000,
            SC5.ISQC=(SC5.ISQC/POB)*Weight*100000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*100000,
            SC5.ATSC=(SC5.ATSC/POB)*Weight*100000,
            SC5.SEQC=(SC5.SEQC/POB)*Weight*100000,
            SC5.OTRA=(SC5.OTRA/POB)*Weight*100000,
            SC6.ATER=(SC6.ATER/POB)*Weight*100000,
            SC6.OEVP=(SC6.OEVP/POB)*Weight*100000,
            SC6.ETAR=(SC6.ETAR/POB)*Weight*100000,
            SC6.OTAR=(SC6.OTAR/POB)*Weight*100000,
            SC6.ETVE=(SC6.ETVE/POB)*Weight*100000,
            SC6.VARI=(SC6.VARI/POB)*Weight*100000,
            SC6.HMRR=(SC6.HMRR/POB)*Weight*100000,
            SC6.OTRA=(SC6.OTRA/POB)*Weight*100000,
            ER1.FAAG=(ER1.FAAG/POB)*Weight*100000,
            ER1.TOAG=(ER1.TOAG/POB)*Weight*100000,
            ER1.LTAG=(ER1.LTAG/POB)*Weight*100000,
            ER1.OTAG=(ER1.OTAG/POB)*Weight*100000,
            ER1.PNSD=(ER1.PNSD/POB)*Weight*100000,
            ER1.RNPC=(ER1.RNPC/POB)*Weight*100000,
            ER1.SINC=(ER1.SINC/POB)*Weight*100000,
            ER1.TADC=(ER1.TADC/POB)*Weight*100000,
            ER1.ONSN=(ER1.ONSN/POB)*Weight*100000,
            ER1.OTRA=(ER1.OTRA/POB)*Weight*100000,
            ER2.BRAG=(ER2.BRAG/POB)*Weight*100000,
            ER2.NEUM=(ER2.NEUM/POB)*Weight*100000,
            ER2.INFL=(ER2.INFL/POB)*Weight*100000,
            ER2.BCNE=(ER2.BCNE/POB)*Weight*100000,
            ER2.ASMA=(ER2.ASMA/POB)*Weight*100000,
            ER2.BREC=(ER2.BREC/POB)*Weight*100000,
            ER2.EPOC=(ER2.EPOC/POB)*Weight*100000,
            ER2.NMCS=(ER2.NMCS/POB)*Weight*100000,
            ER2.OTAE=(ER2.OTAE/POB)*Weight*100000,
            ER2.PLEU=(ER2.PLEU/POB)*Weight*100000,
            ER2.IRIN=(ER2.IRIN/POB)*Weight*100000,
            ER2.OTRA=(ER2.OTRA/POB)*Weight*100000,
            SD1.CARI=(SD1.CARI/POB)*Weight*100000,
            SD1.OTDI=(SD1.OTDI/POB)*Weight*100000,
            SD1.OTJA=(SD1.OTJA/POB)*Weight*100000,
            SD1.OTRA=(SD1.OTRA/POB)*Weight*100000,
            SD2.ESOF=(SD2.ESOF/POB)*Weight*100000,
            SD2.GDIS=(SD2.GDIS/POB)*Weight*100000,
            SD2.GDUL=(SD2.GDUL/POB)*Weight*100000,
            SD2.OTGD=(SD2.OTGD/POB)*Weight*100000,
            SD2.APEN=(SD2.APEN/POB)*Weight*100000,
            SD2.INHE=(SD2.INHE/POB)*Weight*100000,
            SD2.OTHE=(SD2.OTHE/POB)*Weight*100000,
            SD2.CRCU=(SD2.CRCU/POB)*Weight*100000,
            SD2.PIIO=(SD2.PIIO/POB)*Weight*100000,
            SD2.EDDI=(SD2.EDDI/POB)*Weight*100000,
            SD2.SIIO=(SD2.SIIO/POB)*Weight*100000,
            SD3.ALLD=(SD3.ALLD/POB)*Weight*100000,
            SD3.OTLI=(SD3.OTLI/POB)*Weight*100000,
            SD3.COLE=(SD3.COLE/POB)*Weight*100000,
            SD3.OTIP=(SD3.OTIP/POB)*Weight*100000,
            SD3.PANC=(SD3.PANC/POB)*Weight*100000,
            SD3.OTRA=(SD3.OTRA/POB)*Weight*100000,
            PTS.IPTS=(PTS.IPTS/POB)*Weight*100000,
            PTS.DEEC=(PTS.DEEC/POB)*Weight*100000,
            PTS.OTRA=(PTS.OTRA/POB)*Weight*100000,
            MOC.PAIN=(MOC.PAIN/POB)*Weight*100000,
            MOC.OSAR=(MOC.OSAR/POB)*Weight*100000,
            MOC.ADOL=(MOC.ADOL/POB)*Weight*100000,
            MOC.OTAR=(MOC.OTAR/POB)*Weight*100000,
            MOC.SCTD=(MOC.SCTD/POB)*Weight*100000,
            MOC.IVDD=(MOC.IVDD/POB)*Weight*100000,
            MOC.OTDO=(MOC.OTDO/POB)*Weight*100000,
            MOC.SOFT=(MOC.SOFT/POB)*Weight*100000,
            MOC.BONE=(MOC.BONE/POB)*Weight*100000,
            MOC.OMIE=(MOC.OMIE/POB)*Weight*100000,
            MOC.OTRA=(MOC.OTRA/POB)*Weight*100000,
            GU1.NFRI=(GU1.NFRI/POB)*Weight*100000,
            GU1.OTGL=(GU1.OTGL/POB)*Weight*100000,
            GU1.ACKF=(GU1.ACKF/POB)*Weight*100000,
            GU1.RTID=(GU1.RTID/POB)*Weight*100000,
            GU1.OTTU=(GU1.OTTU/POB)*Weight*100000,
            GU1.LITO=(GU1.LITO/POB)*Weight*100000,
            GU1.RECO=(GU1.RECO/POB)*Weight*100000,
            GU1.CIST=(GU1.CIST/POB)*Weight*100000,
            GU1.OTRA=(GU1.OTRA/POB)*Weight*100000,
            GU2.HIPR=(GU2.HIPR/POB)*Weight*100000,
            GU2.OTPR=(GU2.OTPR/POB)*Weight*100000,
            GU2.HCEC=(GU2.HCEC/POB)*Weight*100000,
            GU2.PREP=(GU2.PREP/POB)*Weight*100000,
            GU2.MINF=(GU2.MINF/POB)*Weight*100000,
            GU2.OTRA=(GU2.OTRA/POB)*Weight*100000,
            GU3.MAMA=(GU3.MAMA/POB)*Weight*100000,
            GU4.SAOO=(GU4.SAOO/POB)*Weight*100000,
            GU4.IDCU=(GU4.IDCU/POB)*Weight*100000,
            GU4.OTVV=(GU4.OTVV/POB)*Weight*100000,
            GU4.OTPI=(GU4.OTPI/POB)*Weight*100000,
            GU4.ENDM=(GU4.ENDM/POB)*Weight*100000,
            GU4.FPRO=(GU4.FPRO/POB)*Weight*100000,
            GU4.NOFB=(GU4.NOFB/POB)*Weight*100000,
            GU4.MENS=(GU4.MENS/POB)*Weight*100000,
            GU4.MNOP=(GU4.MNOP/POB)*Weight*100000,
            GU4.FINF=(GU4.FINF/POB)*Weight*100000,
            GU4.OTRA=(GU4.OTRA/POB)*Weight*100000,
            OB1.SPON=(OB1.SPON/POB)*Weight*100000,
            OB1.INDU=(OB1.INDU/POB)*Weight*100000,
            OB1.OTRA=(OB1.OTRA/POB)*Weight*100000,
            OB2.EPHD=(OB2.EPHD/POB)*Weight*100000,
            OB2.HEMP=(OB2.HEMP/POB)*Weight*100000,
            OB2.FACD=(OB2.FACD/POB)*Weight*100000,
            OB2.IGUT=(OB2.IGUT/POB)*Weight*100000,
            OB2.DMIP=(OB2.DMIP/POB)*Weight*100000,
            OB2.OBSL=(OB2.OBSL/POB)*Weight*100000,
            OB2.PPHE=(OB2.PPHE/POB)*Weight*100000,
            OB2.SOPI=(OB2.SOPI/POB)*Weight*100000,
            OB2.PUER=(OB2.PUER/POB)*Weight*100000,
            OB2.OTPL=(OB2.OTPL/POB)*Weight*100000,
            OB2.OBTE=(OB2.OBTE/POB)*Weight*100000,
            OB2.BEPU=(OB2.BEPU/POB)*Weight*100000,
            OB2.OMLC=(OB2.OMLC/POB)*Weight*100000,
            OB2.OTDC=(OB2.OTDC/POB)*Weight*100000,
            OB2.ODUC=(OB2.ODUC/POB)*Weight*100000,
            OB3.SSDE=(OB3.SSDE/POB)*Weight*100000,
            OB3.OTDE=(OB3.OTDE/POB)*Weight*100000,
            OB4.INOC=(OB4.INOC/POB)*Weight*100000,
            NEO.NAMC=(NEO.NAMC/POB)*Weight*100000,
            NEO.NAOC=(NEO.NAOC/POB)*Weight*100000,
            NEO.GMGW=(NEO.GMGW/POB)*Weight*100000,
            NEO.BITR=(NEO.BITR/POB)*Weight*100000,
            NEO.HIAS=(NEO.HIAS/POB)*Weight*100000,
            NEO.SDRN=(NEO.SDRN/POB)*Weight*100000,
            NEO.INFE=(NEO.INFE/POB)*Weight*100000,
            NEO.OTIN=(NEO.OTIN/POB)*Weight*100000,
            NEO.HDNB=(NEO.HDNB/POB)*Weight*100000,
            NEO.TENE=(NEO.TENE/POB)*Weight*100000,
            NEO.OTRA=(NEO.OTRA/POB)*Weight*100000,
            CON.ANEN=(CON.ANEN/POB)*Weight*100000,
            CON.HIDR=(CON.HIDR/POB)*Weight*100000,
            CON.SBIF=(CON.SBIF/POB)*Weight*100000,
            CON.OTNS=(CON.OTNS/POB)*Weight*100000,
            CON.CIRC=(CON.CIRC/POB)*Weight*100000,
            CON.CLCP=(CON.CLCP/POB)*Weight*100000,
            CON.CINT=(CON.CINT/POB)*Weight*100000,
            CON.OTDS=(CON.OTDS/POB)*Weight*100000,
            CON.TEST=(CON.TEST/POB)*Weight*100000,
            CON.OTGU=(CON.OTGU/POB)*Weight*100000,
            CON.DHIP=(CON.DHIP/POB)*Weight*100000,
            CON.FEET=(CON.FEET/POB)*Weight*100000,
            CON.OTMS=(CON.OTMS/POB)*Weight*100000,
            CON.OTRA=(CON.OTRA/POB)*Weight*100000,
            CON.CROM=(CON.CROM/POB)*Weight*100000,
            NCL.FEVU=(NCL.FEVU/POB)*Weight*100000,
            NCL.CAAB=(NCL.CAAB/POB)*Weight*100000,
            NCL.RAOR=(NCL.RAOR/POB)*Weight*100000,
            NCL.ABPP=(NCL.ABPP/POB)*Weight*100000,
            NCL.ARPD=(NCL.ARPD/POB)*Weight*100000,
            NCL.SIDS=(NCL.SIDS/POB)*Weight*100000,
            NCL.REAR=(NCL.REAR/POB)*Weight*100000,
            NCL.OTRA=(NCL.OTRA/POB)*Weight*100000,
            EX1.RAIL=(EX1.RAIL/POB)*Weight*100000,
            EX1.MOTO=(EX1.MOTO/POB)*Weight*100000,
            EX1.LAND=(EX1.LAND/POB)*Weight*100000,
            EX1.WATE=(EX1.WATE/POB)*Weight*100000,
            EX1.AIRS=(EX1.AIRS/POB)*Weight*100000,
            EX1.OTRO=(EX1.OTRO/POB)*Weight*100000,
            EX2.FALL=(EX2.FALL/POB)*Weight*100000,
            EX3.ENVI=(EX3.ENVI/POB)*Weight*100000,
            EX3.DROW=(EX3.DROW/POB)*Weight*100000,
            EX3.FBNO=(EX3.FBNO/POB)*Weight*100000,
            EX3.MACH=(EX3.MACH/POB)*Weight*100000,
            EX3.FREG=(EX3.FREG/POB)*Weight*100000,
            EX3.SEQA=(EX3.SEQA/POB)*Weight*100000,
            EX3.OTRA=(EX3.OTRA/POB)*Weight*100000,
            EX4.SMFF=(EX4.SMFF/POB)*Weight*100000,
            EX5.APDM=(EX5.APDM/POB)*Weight*100000,
            EX5.APSL=(EX5.APSL/POB)*Weight*100000,
            EX5.APGV=(EX5.APGV/POB)*Weight*100000,
            EX6.SUIC=(EX6.SUIC/POB)*Weight*100000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*100000,
            EX8.EOUI=(EX8.EOUI/POB)*Weight*100000,
            EX8.OWAR=(EX8.OWAR/POB)*Weight*100000,
            EX8.LEGI=(EX8.LEGI/POB)*Weight*100000,
            EX9.DRUG=(EX9.DRUG/POB)*Weight*100000,
            EX9.MSDV=(EX9.MSDV/POB)*Weight*100000,
            EX9.SQEX=(EX9.SQEX/POB)*Weight*100000,
            COV.CONF=(COV.CONF/POB)*Weight*100000,
            COV.SUSP=(COV.SUSP))%>%
  summarise("Cholera"=sum(EII.COLE),
            "Typhoid and paratyphoid fever"=sum(EII.TIPA),
            "Shigellosis"=sum(EII.SHIG),
            "Food poisoning"=sum(EII.TOXI),
            "Amebiasis"=sum(EII.AMEB),
            "Other GI infection"=sum(EII.OTRA),
            "Presumed GI infection"=sum(EII.PRES),
            "Pulmonary Tb"=sum(TUB.PULM),
            "Other respiratory Tb"=sum(TUB.RESP),
            "Other respiratory Tb"=sum(TUB.NERV),
            "Nervous System Tb"=sum(TUB.IPGM),
            "Intestinal/peritoneal Tb"=sum(TUB.BONE),
            "Bone and joint Tb"=sum(TUB.URIN),
            "Other variety of Tb"=sum(TUB.OTRA),
            "Plague (peste)"=sum(BAC.PEST),
            "Brusellosis"=sum(BAC.BRUS),
            "Leprosy"=sum(BAC.LEPR),
            "Diphtheria"=sum(BAC.DIFT),
            "Pertussis"=sum(BAC.PERT),
            "Scarlet fever, erysipelas"=sum(BAC.PYOG),
            "Meningococcal disease"=sum(BAC.MENI),
            "Tetanus"=sum(BAC.TETA),
            "Sepsis"=sum(BAC.SEPS),
            "Other bacterial diseases"=sum(BAC.OTRA),
            "Congenital syphilis"=sum(ETS.SIF1),
            "Early syphilis"=sum(ETS.SIF2),
            "Other syphilis"=sum(ETS.SIF3),
            "Gonorrhea"=sum(ETS.GONO),
            "Chlamydia"=sum(ETS.CLAM),
            "Other STD"=sum(ETS.OTRA),
            "Acute Poliomyelitis"=sum(VIR.POLI),
            "Smallpox (viruela)"=sum(VIR.VIRU),
            "Measles"=sum(VIR.SARA),
            "Rubella"=sum(VIR.RUBE),
            "Yellow fever"=sum(VIR.FIAM),
            "Dengue fever"=sum(VIR.DENG),
            "Dengue hemorragic fever"=sum(VIR.DHEM),
            "HIV infection"=sum(VIR.VIH1),
            "Arthropod-Borne Viral Encephalitis"=sum(VIR.EVTA),
            "Acute Hepatitis B"=sum(VIR.HEPB),
            "Other viral hepatitis"=sum(VIR.HEPO),
            "Rabies"=sum(VIR.RABI),
            "Trachoma"=sum(VIR.TRAC),
            "Other viral infections"=sum(VIR.OFAH),
            "Herpes simplex infections"=sum(VIR.HERP),
            "Chickenpox or herpes zoster"=sum(VIR.VRHZ),
            "Mumps"=sum(VIR.PARO),
            "Other chlamydia infections"=sum(VIR.OCLA),
            "Other viral diseases"=sum(VIR.OTRA),
            "Louse-borne epidemic thypus"=sum(RPI.TIFP),
            "Other thypus"=sum(RPI.OTIF),
            "Other rickettsiosis"=sum(RPI.ORIC),
            "Malaria"=sum(RPI.PALU),
            "Leishmaniasis"=sum(RPI.LEIS),
            "Trypanosomiasis"=sum(RPI.TRIP),
            "Other spirochetal diseases (Not syphilis)"=sum(PMO.ESPI),
            "Relapsing fevers"=sum(PMO.FIRE),
            "Mycosis"=sum(PMO.MICO),
            "Schistosomiasis"=sum(PMO.SCHI),
            "Other fluke (trematoda) infections"=sum(PMO.TREM),
            "Echinococcosis"=sum(PMO.ECHI),
            "Dracunculiasis"=sum(PMO.DRAC),
            "Onchocerciasis"=sum(PMO.ONCH),
            "Filariasis"=sum(PMO.FILA),
            "Ancylostomiasis or Necatoriasis"=sum(PMO.ANNE),
            "Other Helminthiases"=sum(PMO.HELM),
            "Other infectious/parasitic disease"=sum(PMO.OTRA),
            "Tuberculosis sequelae"=sum(SEI.TUBE),
            "Poliomyelitis sequelae"=sum(SEI.POLI),
            "Leprosy sequelae"=sum(SEI.LEPR),
            "Sequelae from other infections"=sum(SEI.OTRA),
            "Lip, oral cavity and pharynx cancer"=sum(NM1.LCBF),
            "Esophagus cancer"=sum(NM2.ESOF),
            "Stomach cancer"=sum(NM2.STOM),
            "Small intestine cancer"=sum(NM2.INDE),
            "Colon cancer"=sum(NM2.COLO),
            "Rectosigmoid junction, rectum and anal canal cancer"=sum(NM2.RECT),
            "Liver and intrahepatic bile ducts cancer"=sum(NM2.HIGA),
            "Pancreas cancer"=sum(NM2.PANC),
            "Other types of digestive organs cancer"=sum(NM2.OTRO),
            "Larynx cancer"=sum(NM3.LARI),
            "Trachea, bronchus and lung cancer"=sum(NM3.TBPU),
            "Other respiratory and intrathoracic organs cancer"=sum(NM3.OTRO),
            "Bone and articular cartilage cancer"=sum(NM4.BONE),
            "Malignant melanoma of skin cancer"=sum(NM4.MELA),
            "Other malignant neoplasm of skin cancer"=sum(NM4.SKIN),
            "Breast cancer"=sum(NM4.MAMA),
            "Mesothelial and soft tissue cancer"=sum(NM4.SOFT),
            "Cervix uteri cancer"=sum(NM5.CERV),
            "Placenta cancer"=sum(NM5.PLAC),
            "Uterus cancer"=sum(NM5.UTER),
            "Ovary cancer"=sum(NM5.OVAR),
            "Vulva and vagina cancer"=sum(NM5.VAGI),
            "Other and unspecified genitourinary (female) organs cancer"=sum(NM5.OTFE),
            "Prostate cancer"=sum(NM5.PROS),
            "Testis cancer"=sum(NM5.TEST),
            "Other and unspecified genitourinary (male) organs cancer"=sum(NM5.OTMA),
            "Bladder cancer"=sum(NM5.VEJI),
            "Other urinary tract cancer"=sum(NM5.OTUR),
            "Brain cancer"=sum(NM6.ENCF),
            "Meninges and other SNC cancer"=sum(NM6.MENI),
            "Eyes and adnexa cancer"=sum(NM6.OJOA),
            "Other and unspecified cancer in other organs and unspecified sites"=sum(NM6.OTRO),
            "Hodgkin lymphoma"=sum(NM7.ENHO),
            "Non-Hodgkin lymphoma"=sum(NM7.NOHO),
            "Multiple myeloma and plasmatic cell neoplasms"=sum(NM7.MMCP),
            "Leukemias"=sum(NM7.LEUC),
            "Other lymphoid, hematopoietic and related tissue"=sum(NM7.OTRO),
            "Multiple primary tumors"=sum(NM8.MUPT),
            "In-situ cervix uteri"=sum(NIS.CERV),
            "Other in situ neoplasms"=sum(NIS.OTRO),
            "Benign skin neoplasms"=sum(NBE.SKIN),
            "Benign breast neoplasms"=sum(NBE.MAMA),
            "Leiomyoma of uterus neoplasms"=sum(NBE.LEIO),
            "Benign ovary neoplasms"=sum(NBE.OVAR),
            "Bening urinary tract neoplasms"=sum(NBE.URIN),
            "Bening brain and other CNS sites neoplasms"=sum(NBE.CSNC),
            "Benign thyroid neoplasms"=sum(NBE.TIRO),
            "Other benign neoplasms"=sum(NBE.OTRO),
            "Neoplasms of uncertain behaviour"=sum(NCI.UNCB),
            "Iron deficiency anemia"=sum(SAN.ADFE),
            "Other anemias"=sum(SAN.AOTR),
            "Immunity disorders"=sum(SAN.INMU),
            "Other diseases of the blood and blood-forming organs"=sum(SAN.OTRA),
            "Iodine deficiency thyroid disorders"=sum(END.DEYO),
            "Thyrotoxicosis"=sum(END.TTOX),
            "Other thyroid disorders"=sum(END.TOTR),
            "Type 2 diabetes mellitus"=sum(END.DIAB),
            "Metabolism disorders and dyslipidemia"=sum(END.LIPO),
            "Obesity"=sum(END.OBES),
            "Volume depletion"=sum(END.DEPL),
            "Sequelae of hyperalimentation"=sum(END.SQHA),
            "Other endocrine and metabolic diseases"=sum(END.OTRA),
            "Kwashiorkor"=sum(NUT.KWAS),
            "Nutritional marasmus"=sum(NUT.MARA),
            "Other protein-calorie malnutrition"=sum(NUT.PROT),
            "Vitamin A deficiency"=sum(NUT.VITA),
            "Other vitamin deficiencies"=sum(NUT.VITO),
            "Sequelae of malnutrition"=sum(NUT.SECD),
            "Other nutritional deficiencies"=sum(NUT.OTRA),
            "Dementia"=sum(MEN.DEME),
            "Alcohol dependence syndrome"=sum(MEN.SDAL),
            "Other alcohol related disorders"=sum(MEN.OTAL),
            "Mental and behavioral disorders due to other psychoactive substances use"=sum(MEN.TMSP),
            "Schizophrenia, schizotypal, delusional, and other non-mood psychotic disorders"=sum(MEN.ESQU),
            "Mood [affective] disorders"=sum(MEN.HUMO),
            "Anxiety, dissociative, stress-related, somatoform and other nonpsychotic mental disorders"=sum(MEN.ESTR),
            "Behavioral syndromes associated with physiological disturbances and physical factors"=sum(MEN.FISI),
            "Intellectual disabilities"=sum(MEN.RETR),
            "Other mental and behavioral disorders"=sum(MEN.OTRO),
            "Meningitis"=sum(NER.MENI),
            "Other inflammatory diseases of the central nervous system"=sum(NER.ISNC),
            "Parkinson's disease"=sum(NER.PARK),
            "Alzheimer's disease"=sum(NER.ALZH),
            "Multiple sclerosis"=sum(NER.ESCM),
            "Cerebral palsy and other paralytic syndromes"=sum(NER.PALS),
            "Epilepsy and recurrent seizures"=sum(NER.EPIL),
            "Migraine and other headache syndromes"=sum(NER.MIGR),
            "Transient cerebral ischemic attacks and related syndromes"=sum(NER.IQCT),
            "Nerve, nerve root and plexus disorders"=sum(NER.SNPE),
            "Other diseases of the nervous system"=sum(NER.OTRA),
            "Eyelid inflammation"=sum(EYE.PARP),
            "Disorders of sclera and cornea"=sum(EYE.ESCL),
            "Glaucoma"=sum(EYE.GLAU),
            "Cataracts"=sum(EYE.CATA),
            "Other disorders of lens"=sum(EYE.CRIS),
            "Retinal detachments and breaks"=sum(EYE.RETI),
            "Blindness and low vision"=sum(EYE.CEGU),
            "Conjunctivitis"=sum(EYE.CONJ),
            "Other disorders of conjunctiva"=sum(EYE.OTCO),
            "Disorders of lacrimal system"=sum(EYE.LAGR),
            "Strabismus"=sum(EYE.ESTR),
            "Other disorders of binocular movement"=sum(EYE.BINO),
            "Disorders of refraction and accommodation"=sum(EYE.REFR),
            "Other diseases of the eye and adnexa"=sum(EYE.OTRA),
            "Otitis media, disorders of Eustachian tube and mastoiditis"=sum(EAR.OMTM),
            "Other middle ear disorders"=sum(EAR.OTOM),
            "Hearing loss"=sum(EAR.SORD),
            "Other diseases of the ear and mastoid process"=sum(EAR.OTRA),
            "Acute rheumatic fever"=sum(SC1.FIRE),
            "Chronic rheumatic heart diseases"=sum(SC1.CRHD),
            "Hypertensive heart disease"=sum(SC2.ECHI),
            "Essential (primary) hypertension"=sum(SC2.HTES),
            "Other hypertensive diseases"=sum(SC2.OTRA),
            "Acute myocardial infarction"=sum(SC3.IAMC),
            "Other ischemic heart diseases"=sum(SC3.OTRA),
            "Pulmonary embolism"=sum(SC4.EMBP),
            "Conduction disorders and arrhythmia"=sum(SC4.CARR),
            "Cardiac arrest"=sum(SC4.PARO),
            "Heart failure"=sum(SC4.HEFA),
            "Other diseases of pulmonary circulation and other heart diseases"=sum(SC4.OTRA),
            "Subarachnoid hemorrhage"=sum(SC5.HEMS),
            "Intracerebral and other intracranial hemorrhage"=sum(SC5.HEMI),
            "Cerebral infarction"=sum(SC5.ISQC),
            "Unspecified (hemorrhagic vs isquemic)"=sum(SC5.EVCN),
            "Cerebral atherosclerosis"=sum(SC5.ATSC),
            "Sequelae of cerebrovascular disease"=sum(SC5.SEQC),
            "Other cerebrovascular diseases"=sum(SC5.OTRA),
            "Atherosclerosis"=sum(SC6.ATER),
            "Other peripheral vascular diseases"=sum(SC6.OEVP),
            "Arterial embolism and thrombosis"=sum(SC6.ETAR),
            "Other diseases of arteries, arterioles and capillaries"=sum(SC6.OTAR),
            "Phlebitis, trombophlebitis, other venous embolism and thrombosis"=sum(SC6.ETVE),
            "Varicose veins of lower extremities"=sum(SC6.VARI),
            "Hemorrhoids"=sum(SC6.HMRR),
            "Other diseases of the circulatory system"=sum(SC6.OTRA),
            "Acute pharyngitis"=sum(ER1.FAAG),
            "Acute tonsillitis"=sum(ER1.TOAG),
            "Acute laryngitis and tracheitis"=sum(ER1.LTAG),
            "Other acute upper respiratory infections"=sum(ER1.OTAG),
            "Nasal polyp and deviated nasal septum"=sum(ER1.PNSD),
            "Chronic rhinitis, nasopharyngitis and pharyngitis"=sum(ER1.RNPC),
            "Chronic sinusitis"=sum(ER1.SINC),
            "Chronic diseases of tonsils and adenoids"=sum(ER1.TADC),
            "Other disorders of nose and nasal sinuses"=sum(ER1.ONSN),
            "Other acute upper respiratory infections"=sum(ER1.OTRA),
            "Acute bronchitis and bronchiolitis"=sum(ER2.BRAG),
            "Pneumonia"=sum(ER2.NEUM),
            "Influenza"=sum(ER2.INFL),
            "Chronic and unspecified bronchitis or emphysema"=sum(ER2.BCNE),
            "Asthma"=sum(ER2.ASMA),
            "Bronchiectasis"=sum(ER2.BREC),
            "Chronic obstructive pulmonary disease"=sum(ER2.EPOC),
            "Pneumoconiosis"=sum(ER2.NMCS),
            "Other pulmonary diseases due to external agents"=sum(ER2.OTAE),
            "Pleural conditions"=sum(ER2.PLEU),
            "Unspecified acute lower respiratory infection"=sum(ER2.IRIN),
            "Other respiratory tract diseases"=sum(ER2.OTRA),
            "Dental caries"=sum(SD1.CARI),
            "Other disorders of teeth and supporting structures"=sum(SD1.OTDI),
            "Other diseases of jaw"=sum(SD1.OTJA),
            "Other oral cavity and salivary glands"=sum(SD1.OTRA),
            "Diseases of esophagus"=sum(SD2.ESOF),
            "Gastritis and duodenitis"=sum(SD2.GDIS),
            "Gastric and duodenal ulcer"=sum(SD2.GDUL),
            "Other diseases of stomach and duodenum"=sum(SD2.OTGD),
            "Diseases of appendix"=sum(SD2.APEN),
            "Inguinal hernia"=sum(SD2.INHE),
            "Other hernias"=sum(SD2.OTHE),
            "Crohn's disease and ulcerative colitis"=sum(SD2.CRCU),
            "Paralytic ileus and intestinal obstruction without hernia"=sum(SD2.PIIO),
            "Diverticular disease of intestine"=sum(SD2.EDDI),
            "Irritable bowel syndrome and other functional intestinal disorders"=sum(SD2.SIIO),
            "Alcoholic liver disease"=sum(SD3.ALLD),
            "Other diseases of liver"=sum(SD3.OTLI),
            "Cholelithiasis and cholecystitis"=sum(SD3.COLE),
            "Other diseases of intestines and peritoneum"=sum(SD3.OTIP),
            "Acute pancreatitis and other diseases of pancreas"=sum(SD3.PANC),
            "Other diseases of digestive system"=sum(SD3.OTRA),
            "Infections of the skin and subcutaneous tissue"=sum(PTS.IPTS),
            "Dermatitis and eczema"=sum(PTS.DEEC),
            "Other diseases of the skin and subcutaneous tissue"=sum(PTS.OTRA),
            "Inflammatory polyarthropathies"=sum(MOC.PAIN),
            "Osteoarthritis"=sum(MOC.OSAR),
            "Acquired deformities of limbs"=sum(MOC.ADOL),
            "Other joint disorders"=sum(MOC.OTAR),
            "Systemic connective tissue disorders"=sum(MOC.SCTD),
            "Intervertebral disc disorders"=sum(MOC.IVDD),
            "Other dorsopathies"=sum(MOC.OTDO),
            "Soft tissue disorders"=sum(MOC.SOFT),
            "Disorders of bone density and structure"=sum(MOC.BONE),
            "Osteomyelitis"=sum(MOC.OMIE),
            "Other diseases of the musculoskeletal system and connective tissue"=sum(MOC.OTRA),
            "Acute and rapidly progressive nephritic syndrome"=sum(GU1.NFRI),
            "Other glomerular diseases"=sum(GU1.OTGL),
            "Acute kidney failure and chronic kidney disease"=sum(GU1.ACKF),
            "Renal tubulo-interstitial diseases"=sum(GU1.RTID),
            "Other renal tubulo-interstitial diseases"=sum(GU1.OTTU),
            "Urolithiasis"=sum(GU1.LITO),
            "Unspecified renal colic"=sum(GU1.RECO),
            "Cystitis"=sum(GU1.CIST),
            "Other diseases of urinary system"=sum(GU1.OTRA),
            "Benign prostatic hyperplasia"=sum(GU2.HIPR),
            "Other disorders of prostate"=sum(GU2.OTPR),
            "Hydrocele and spermatocele"=sum(GU2.HCEC),
            "Disorders of prepuce"=sum(GU2.PREP),
            "Male infertility"=sum(GU2.MINF),
            "Other male genital organs diseases"=sum(GU2.OTRA),
            "Disorders of breast"=sum(GU3.MAMA),
            "Salpingitis and oophoritis"=sum(GU4.SAOO),
            "Inflammatory disease of cervix uteri"=sum(GU4.IDCU),
            "Other diseases of uterus, vagina and vulva"=sum(GU4.OTVV),
            "Other female pelvic inflammatory diseases"=sum(GU4.OTPI),
            "Endometriosis"=sum(GU4.ENDM),
            "Female genital prolapse"=sum(GU4.FPRO),
            "Noninflammatory disorders of ovary, fallopian tube and broad ligament"=sum(GU4.NOFB),
            "Disorders of menstruation"=sum(GU4.MENS),
            "Menopausal and other perimenopausal disorders"=sum(GU4.MNOP),
            "Female infertility"=sum(GU4.FINF),
            "Other female genital organs diseases"=sum(GU4.OTRA),
            "Spontaneous abortion"=sum(OB1.SPON),
            "Complications following (induced) termination of pregnancy"=sum(OB1.INDU),
            "Other abortion"=sum(OB1.OTRA),
            "Edema, proteinuria and hypertensive disorders in pregnancy, childbirth and the puerperium"=sum(OB2.EPHD),
            "Hemorrhage in early pregnancy, placenta previa, abruptio placentae, antepartum hemorrhage"=sum(OB2.HEMP),
            "Maternal care related to the fetus and amniotic cavity and possible delivery problems"=sum(OB2.FACD),
            "Infections of genitourinary tract in pregnancy"=sum(OB2.IGUT),
            "Diabetes mellitus in pregnancy"=sum(OB2.DMIP),
            "Obstructed labor"=sum(OB2.OBSL),
            "Postpartum hemorrhage"=sum(OB2.PPHE),
            "Sepsis and other puerperal infections"=sum(OB2.SOPI),
            "Other complications of the puerperium"=sum(OB2.PUER),
            "Other complications of pregnancy and labor"=sum(OB2.OTPL),
            "Obstetrical tetanus"=sum(OB2.OBTE),
            "Mental and behavioral disorders associated with the puerperium"=sum(OB2.BEPU),
            "Puerperal osteomalacia"=sum(OB2.OMLC),
            "Other direct obstetric causes"=sum(OB2.OTDC),
            "Obstetric death of unspecified cause"=sum(OB2.ODUC),
            "Single spontaneous delivery"=sum(OB3.SSDE),
            "Other delivery"=sum(OB3.OTDE),
            "Indirect obstetric causes"=sum(OB4.INOC),
            "Newborn affected by maternal conditions"=sum(NEO.NAMC),
            "Newborn affected by obstetric complications"=sum(NEO.NAOC),
            "Slow fetal growth, fetal malnutrition, short gestation and low birth weight"=sum(NEO.GMGW),
            "Birth trauma"=sum(NEO.BITR),
            "Intrauterine hypoxia and birth asphyxia "=sum(NEO.HIAS),
            "Respiratory distress of newborn and other perinatal respiratory disorders"=sum(NEO.SDRN),
            "Congenital viral, bacterial and parasitic diseases"=sum(NEO.INFE),
            "Other infections specific to the perinatal period"=sum(NEO.OTIN),
            "Hemolytic disease of newborn"=sum(NEO.HDNB),
            "Tetanus neonatorum"=sum(NEO.TENE),
            "Other conditions originating in the perinatal period"=sum(NEO.OTRA),
            "Anencephaly and similar malformations"=sum(CON.ANEN),
            "Congenital hydrocephalus"=sum(CON.HIDR),
            "Spina bifida"=sum(CON.SBIF),
            "Other congenital malformations of the nervous system"=sum(CON.OTNS),
            "Congenital malformations of the circulatory system"=sum(CON.CIRC),
            "Cleft lip and cleft palate"=sum(CON.CLCP),
            "Congenital absence, atresia and stenosis of small intestine"=sum(CON.CINT),
            "Other congenital malformations of the digestive system"=sum(CON.OTDS),
            "Undescended and ectopic testicle"=sum(CON.TEST),
            "Other congenital malformations of genitourinary system"=sum(CON.OTGU),
            "Congenital deformities of hip"=sum(CON.DHIP),
            "Congenital deformities of feet"=sum(CON.FEET),
            "Other congenital malformations and deformations of the musculoskeletal system"=sum(CON.OTMS),
            "Other congenital malformations"=sum(CON.OTRA),
            "Chromosomal abnormalities, not elsewhere classified"=sum(CON.CROM),
            "Fever of other and unknown origin"=sum(NCL.FEVU),
            "Cardiac abnormalities"=sum(NCL.CAAB),
            "Retention of urine"=sum(NCL.RAOR),
            "Abdominal and pelvic pain"=sum(NCL.ABPP),
            "Age-related physical debility"=sum(NCL.ARPD),
            "Sudden infant death syndrome"=sum(NCL.SIDS),
            "Respiratory arrest"=sum(NCL.REAR),
            "Other symptoms, signs and abnormal clinical and laboratory findings"=sum(NCL.OTRA),
            "Railway accidents"=sum(EX1.RAIL),
            "Motor vehicle traffic accidents"=sum(EX1.MOTO),
            "Other land transport accidents"=sum(EX1.LAND),
            "Water transport accidents"=sum(EX1.WATE),
            "Air and space transport accidents"=sum(EX1.AIRS),
            "Other transport accidents"=sum(EX1.OTRO),
            "Falls"=sum(EX2.FALL),
            "Accidents caused by environmental factors"=sum(EX3.ENVI),
            "Accidental non-transport drowning and submersion"=sum(EX3.DROW),
            "Foreign body entering into or through eye or natural orifice"=sum(EX3.FBNO),
            "Accidents caused by machinery or sharp instruments"=sum(EX3.MACH),
            "Accidents caused by firearms and guns"=sum(EX3.FREG),
            "Sequelae of transport accidents and other accidents"=sum(EX3.SEQA),
            "Other accidents"=sum(EX3.OTRA),
            "Exposure to smoke, fire and flames"=sum(EX4.SMFF),
            "Accidental poisoning by drugs, medicaments and biological substances"=sum(EX5.APDM),
            "Accidental poisoning by other solid or liquid substances"=sum(EX5.APSL),
            "Accidental poisoning by other gases and vapours"=sum(EX5.APGV),
            "Intentional self-harm"=sum(EX6.SUIC),
            "Assault"=sum(EX7.ASSA),
            "Event of undetermined intent"=sum(EX8.EOUI),
            "Operations of war"=sum(EX8.OWAR),
            "Legal intervention"=sum(EX8.LEGI),
            "Drugs, medicaments and biological substances causing adverse effects in therapeutic use"=sum(EX9.DRUG),
            "Misadventures to patients during surgical and medical care"=sum(EX9.MSDV),
            "Sequelae of external causes of morbidity and mortality"=sum(EX9.SQEX),
            "Confirmed COVID-19"=sum(COV.CONF),
            "Suspected COVID-19"=sum(COV.SUSP))%>%
  mutate(EV_YEAR=c("2017"))

#2018
CAUSA_ESPECIFICA_2018<-mort_2018%>%
  filter(!is.na(EDAD))%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  summarise(EII.COLE=sum(EII.COLE==1,na.rm = T),
            EII.TIPA=sum(EII.TIPA==1,na.rm = T),
            EII.SHIG=sum(EII.SHIG==1,na.rm = T),
            EII.TOXI=sum(EII.TOXI==1,na.rm = T),
            EII.AMEB=sum(EII.AMEB==1,na.rm = T),
            EII.OTRA=sum(EII.OTRA==1,na.rm = T),
            EII.PRES=sum(EII.PRES==1,na.rm = T),
            TUB.PULM=sum(TUB.PULM==1,na.rm = T),
            TUB.RESP=sum(TUB.RESP==1,na.rm = T),
            TUB.NERV=sum(TUB.NERV==1,na.rm = T),
            TUB.IPGM=sum(TUB.IPGM==1,na.rm = T),
            TUB.BONE=sum(TUB.BONE==1,na.rm = T),
            TUB.URIN=sum(TUB.URIN==1,na.rm = T),
            TUB.OTRA=sum(TUB.OTRA==1,na.rm = T),
            BAC.PEST=sum(BAC.PEST==1,na.rm = T),
            BAC.BRUS=sum(BAC.BRUS==1,na.rm = T),
            BAC.LEPR=sum(BAC.LEPR==1,na.rm = T),
            BAC.DIFT=sum(BAC.DIFT==1,na.rm = T),
            BAC.PERT=sum(BAC.PERT==1,na.rm = T),
            BAC.PYOG=sum(BAC.PYOG==1,na.rm = T),
            BAC.MENI=sum(BAC.MENI==1,na.rm = T),
            BAC.TETA=sum(BAC.TETA==1,na.rm = T),
            BAC.SEPS=sum(BAC.SEPS==1,na.rm = T),
            BAC.OTRA=sum(BAC.OTRA==1,na.rm = T),
            ETS.SIF1=sum(ETS.SIF1==1,na.rm = T),
            ETS.SIF2=sum(ETS.SIF2==1,na.rm = T),
            ETS.SIF3=sum(ETS.SIF3==1,na.rm = T),
            ETS.GONO=sum(ETS.GONO==1,na.rm = T),
            ETS.CLAM=sum(ETS.CLAM==1,na.rm = T),
            ETS.OTRA=sum(ETS.OTRA==1,na.rm = T),
            VIR.POLI=sum(VIR.POLI==1,na.rm = T),
            VIR.VIRU=sum(VIR.VIRU==1,na.rm = T),
            VIR.SARA=sum(VIR.SARA==1,na.rm = T),
            VIR.RUBE=sum(VIR.RUBE==1,na.rm = T),
            VIR.FIAM=sum(VIR.FIAM==1,na.rm = T),
            VIR.DENG=sum(VIR.DENG==1,na.rm = T),
            VIR.DHEM=sum(VIR.DHEM==1,na.rm = T),
            VIR.VIH1=sum(VIR.VIH1==1,na.rm = T),
            VIR.EVTA=sum(VIR.EVTA==1,na.rm = T),
            VIR.HEPB=sum(VIR.HEPB==1,na.rm = T),
            VIR.HEPO=sum(VIR.HEPO==1,na.rm = T),
            VIR.RABI=sum(VIR.RABI==1,na.rm = T),
            VIR.TRAC=sum(VIR.TRAC==1,na.rm = T),
            VIR.OFAH=sum(VIR.OFAH==1,na.rm = T),
            VIR.HERP=sum(VIR.HERP==1,na.rm = T),
            VIR.VRHZ=sum(VIR.VRHZ==1,na.rm = T),
            VIR.PARO=sum(VIR.PARO==1,na.rm = T),
            VIR.OCLA=sum(VIR.OCLA==1,na.rm = T),
            VIR.OTRA=sum(VIR.OTRA==1,na.rm = T),
            RPI.TIFP=sum(RPI.TIFP==1,na.rm = T),
            RPI.OTIF=sum(RPI.OTIF==1,na.rm = T),
            RPI.ORIC=sum(RPI.ORIC==1,na.rm = T),
            RPI.PALU=sum(RPI.PALU==1,na.rm = T),
            RPI.LEIS=sum(RPI.LEIS==1,na.rm = T),
            RPI.TRIP=sum(RPI.TRIP==1,na.rm = T),
            PMO.ESPI=sum(PMO.ESPI==1,na.rm = T),
            PMO.FIRE=sum(PMO.FIRE==1,na.rm = T),
            PMO.MICO=sum(PMO.MICO==1,na.rm = T),
            PMO.SCHI=sum(PMO.SCHI==1,na.rm = T),
            PMO.TREM=sum(PMO.TREM==1,na.rm = T),
            PMO.ECHI=sum(PMO.ECHI==1,na.rm = T),
            PMO.DRAC=sum(PMO.DRAC==1,na.rm = T),
            PMO.ONCH=sum(PMO.ONCH==1,na.rm = T),
            PMO.FILA=sum(PMO.FILA==1,na.rm = T),
            PMO.ANNE=sum(PMO.ANNE==1,na.rm = T),
            PMO.HELM=sum(PMO.HELM==1,na.rm = T),
            PMO.OTRA=sum(PMO.OTRA==1,na.rm = T),
            SEI.TUBE=sum(SEI.TUBE==1,na.rm = T),
            SEI.POLI=sum(SEI.POLI==1,na.rm = T),
            SEI.LEPR=sum(SEI.LEPR==1,na.rm = T),
            SEI.OTRA=sum(SEI.OTRA==1,na.rm = T),
            NM1.LCBF=sum(NM1.LCBF==1,na.rm = T),
            NM2.ESOF=sum(NM2.ESOF==1,na.rm = T),
            NM2.STOM=sum(NM2.STOM==1,na.rm = T),
            NM2.INDE=sum(NM2.INDE==1,na.rm = T),
            NM2.COLO=sum(NM2.COLO==1,na.rm = T),
            NM2.RECT=sum(NM2.RECT==1,na.rm = T),
            NM2.HIGA=sum(NM2.HIGA==1,na.rm = T),
            NM2.PANC=sum(NM2.PANC==1,na.rm = T),
            NM2.OTRO=sum(NM2.OTRO==1,na.rm = T),
            NM3.LARI=sum(NM3.LARI==1,na.rm = T),
            NM3.TBPU=sum(NM3.TBPU==1,na.rm = T),
            NM3.OTRO=sum(NM3.OTRO==1,na.rm = T),
            NM4.BONE=sum(NM4.BONE==1,na.rm = T),
            NM4.MELA=sum(NM4.MELA==1,na.rm = T),
            NM4.SKIN=sum(NM4.SKIN==1,na.rm = T),
            NM4.MAMA=sum(NM4.MAMA==1,na.rm = T),
            NM4.SOFT=sum(NM4.SOFT==1,na.rm = T),
            NM5.CERV=sum(NM5.CERV==1,na.rm = T),
            NM5.PLAC=sum(NM5.PLAC==1,na.rm = T),
            NM5.UTER=sum(NM5.UTER==1,na.rm = T),
            NM5.OVAR=sum(NM5.OVAR==1,na.rm = T),
            NM5.VAGI=sum(NM5.VAGI==1,na.rm = T),
            NM5.OTFE=sum(NM5.OTFE==1,na.rm = T),
            NM5.PROS=sum(NM5.PROS==1,na.rm = T),
            NM5.TEST=sum(NM5.TEST==1,na.rm = T),
            NM5.OTMA=sum(NM5.OTMA==1,na.rm = T),
            NM5.VEJI=sum(NM5.VEJI==1,na.rm = T),
            NM5.OTUR=sum(NM5.OTUR==1,na.rm = T),
            NM6.ENCF=sum(NM6.ENCF==1,na.rm = T),
            NM6.MENI=sum(NM6.MENI==1,na.rm = T),
            NM6.OJOA=sum(NM6.OJOA==1,na.rm = T),
            NM6.OTRO=sum(NM6.OTRO==1,na.rm = T),
            NM7.ENHO=sum(NM7.ENHO==1,na.rm = T),
            NM7.NOHO=sum(NM7.NOHO==1,na.rm = T),
            NM7.MMCP=sum(NM7.MMCP==1,na.rm = T),
            NM7.LEUC=sum(NM7.LEUC==1,na.rm = T),
            NM7.OTRO=sum(NM7.OTRO==1,na.rm = T),
            NM8.MUPT=sum(NM8.MUPT==1,na.rm = T),
            NIS.CERV=sum(NIS.CERV==1,na.rm = T),
            NIS.OTRO=sum(NIS.OTRO==1,na.rm = T),
            NBE.SKIN=sum(NBE.SKIN==1,na.rm = T),
            NBE.MAMA=sum(NBE.MAMA==1,na.rm = T),
            NBE.LEIO=sum(NBE.LEIO==1,na.rm = T),
            NBE.OVAR=sum(NBE.OVAR==1,na.rm = T),
            NBE.URIN=sum(NBE.URIN==1,na.rm = T),
            NBE.CSNC=sum(NBE.CSNC==1,na.rm = T),
            NBE.TIRO=sum(NBE.TIRO==1,na.rm = T),
            NBE.OTRO=sum(NBE.OTRO==1,na.rm = T),
            NCI.UNCB=sum(NCI.UNCB==1,na.rm = T),
            SAN.ADFE=sum(SAN.ADFE==1,na.rm = T),
            SAN.AOTR=sum(SAN.AOTR==1,na.rm = T),
            SAN.INMU=sum(SAN.INMU==1,na.rm = T),
            SAN.OTRA=sum(SAN.OTRA==1,na.rm = T),
            END.DEYO=sum(END.DEYO==1,na.rm = T),
            END.TTOX=sum(END.TTOX==1,na.rm = T),
            END.TOTR=sum(END.TOTR==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            END.LIPO=sum(END.LIPO==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T),
            END.DEPL=sum(END.DEPL==1,na.rm = T),
            END.SQHA=sum(END.SQHA==1,na.rm = T),
            END.OTRA=sum(END.OTRA==1,na.rm = T),
            NUT.KWAS=sum(NUT.KWAS==1,na.rm = T),
            NUT.MARA=sum(NUT.MARA==1,na.rm = T),
            NUT.PROT=sum(NUT.PROT==1,na.rm = T),
            NUT.VITA=sum(NUT.VITA==1,na.rm = T),
            NUT.VITO=sum(NUT.VITO==1,na.rm = T),
            NUT.SECD=sum(NUT.SECD==1,na.rm = T),
            NUT.OTRA=sum(NUT.OTRA==1,na.rm = T),
            MEN.DEME=sum(MEN.DEME==1,na.rm = T),
            MEN.SDAL=sum(MEN.SDAL==1,na.rm = T),
            MEN.OTAL=sum(MEN.OTAL==1,na.rm = T),
            MEN.TMSP=sum(MEN.TMSP==1,na.rm = T),
            MEN.ESQU=sum(MEN.ESQU==1,na.rm = T),
            MEN.HUMO=sum(MEN.HUMO==1,na.rm = T),
            MEN.ESTR=sum(MEN.ESTR==1,na.rm = T),
            MEN.FISI=sum(MEN.FISI==1,na.rm = T),
            MEN.RETR=sum(MEN.RETR==1,na.rm = T),
            MEN.OTRO=sum(MEN.OTRO==1,na.rm = T),
            NER.MENI=sum(NER.MENI==1,na.rm = T),
            NER.ISNC=sum(NER.ISNC==1,na.rm = T),
            NER.PARK=sum(NER.PARK==1,na.rm = T),
            NER.ALZH=sum(NER.ALZH==1,na.rm = T),
            NER.ESCM=sum(NER.ESCM==1,na.rm = T),
            NER.PALS=sum(NER.PALS==1,na.rm = T),
            NER.EPIL=sum(NER.EPIL==1,na.rm = T),
            NER.MIGR=sum(NER.MIGR==1,na.rm = T),
            NER.IQCT=sum(NER.IQCT==1,na.rm = T),
            NER.SNPE=sum(NER.SNPE==1,na.rm = T),
            NER.OTRA=sum(NER.OTRA==1,na.rm = T),
            EYE.PARP=sum(EYE.PARP==1,na.rm = T),
            EYE.ESCL=sum(EYE.ESCL==1,na.rm = T),
            EYE.GLAU=sum(EYE.GLAU==1,na.rm = T),
            EYE.CATA=sum(EYE.CATA==1,na.rm = T),
            EYE.CRIS=sum(EYE.CRIS==1,na.rm = T),
            EYE.RETI=sum(EYE.RETI==1,na.rm = T),
            EYE.CEGU=sum(EYE.CEGU==1,na.rm = T),
            EYE.CONJ=sum(EYE.CONJ==1,na.rm = T),
            EYE.OTCO=sum(EYE.OTCO==1,na.rm = T),
            EYE.LAGR=sum(EYE.LAGR==1,na.rm = T),
            EYE.ESTR=sum(EYE.ESTR==1,na.rm = T),
            EYE.BINO=sum(EYE.BINO==1,na.rm = T),
            EYE.REFR=sum(EYE.REFR==1,na.rm = T),
            EYE.OTRA=sum(EYE.OTRA==1,na.rm = T),
            EAR.OMTM=sum(EAR.OMTM==1,na.rm = T),
            EAR.OTOM=sum(EAR.OTOM==1,na.rm = T),
            EAR.SORD=sum(EAR.SORD==1,na.rm = T),
            EAR.OTRA=sum(EAR.OTRA==1,na.rm = T),
            SC1.FIRE=sum(SC1.FIRE==1,na.rm = T),
            SC1.CRHD=sum(SC1.CRHD==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            SC4.EMBP=sum(SC4.EMBP==1,na.rm = T),
            SC4.CARR=sum(SC4.CARR==1,na.rm = T),
            SC4.PARO=sum(SC4.PARO==1,na.rm = T),
            SC4.HEFA=sum(SC4.HEFA==1,na.rm = T),
            SC4.OTRA=sum(SC4.OTRA==1,na.rm = T),
            SC5.HEMS=sum(SC5.HEMS==1,na.rm = T),
            SC5.HEMI=sum(SC5.HEMI==1,na.rm = T),
            SC5.ISQC=sum(SC5.ISQC==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC5.ATSC=sum(SC5.ATSC==1,na.rm = T),
            SC5.SEQC=sum(SC5.SEQC==1,na.rm = T),
            SC5.OTRA=sum(SC5.OTRA==1,na.rm = T),
            SC6.ATER=sum(SC6.ATER==1,na.rm = T),
            SC6.OEVP=sum(SC6.OEVP==1,na.rm = T),
            SC6.ETAR=sum(SC6.ETAR==1,na.rm = T),
            SC6.OTAR=sum(SC6.OTAR==1,na.rm = T),
            SC6.ETVE=sum(SC6.ETVE==1,na.rm = T),
            SC6.VARI=sum(SC6.VARI==1,na.rm = T),
            SC6.HMRR=sum(SC6.HMRR==1,na.rm = T),
            SC6.OTRA=sum(SC6.OTRA==1,na.rm = T),
            ER1.FAAG=sum(ER1.FAAG==1,na.rm = T),
            ER1.TOAG=sum(ER1.TOAG==1,na.rm = T),
            ER1.LTAG=sum(ER1.LTAG==1,na.rm = T),
            ER1.OTAG=sum(ER1.OTAG==1,na.rm = T),
            ER1.PNSD=sum(ER1.PNSD==1,na.rm = T),
            ER1.RNPC=sum(ER1.RNPC==1,na.rm = T),
            ER1.SINC=sum(ER1.SINC==1,na.rm = T),
            ER1.TADC=sum(ER1.TADC==1,na.rm = T),
            ER1.ONSN=sum(ER1.ONSN==1,na.rm = T),
            ER1.OTRA=sum(ER1.OTRA==1,na.rm = T),
            ER2.BRAG=sum(ER2.BRAG==1,na.rm = T),
            ER2.NEUM=sum(ER2.NEUM==1,na.rm = T),
            ER2.INFL=sum(ER2.INFL==1,na.rm = T),
            ER2.BCNE=sum(ER2.BCNE==1,na.rm = T),
            ER2.ASMA=sum(ER2.ASMA==1,na.rm = T),
            ER2.BREC=sum(ER2.BREC==1,na.rm = T),
            ER2.EPOC=sum(ER2.EPOC==1,na.rm = T),
            ER2.NMCS=sum(ER2.NMCS==1,na.rm = T),
            ER2.OTAE=sum(ER2.OTAE==1,na.rm = T),
            ER2.PLEU=sum(ER2.PLEU==1,na.rm = T),
            ER2.IRIN=sum(ER2.IRIN==1,na.rm = T),
            ER2.OTRA=sum(ER2.OTRA==1,na.rm = T),
            SD1.CARI=sum(SD1.CARI==1,na.rm = T),
            SD1.OTDI=sum(SD1.OTDI==1,na.rm = T),
            SD1.OTJA=sum(SD1.OTJA==1,na.rm = T),
            SD1.OTRA=sum(SD1.OTRA==1,na.rm = T),
            SD2.ESOF=sum(SD2.ESOF==1,na.rm = T),
            SD2.GDIS=sum(SD2.GDIS==1,na.rm = T),
            SD2.GDUL=sum(SD2.GDUL==1,na.rm = T),
            SD2.OTGD=sum(SD2.OTGD==1,na.rm = T),
            SD2.APEN=sum(SD2.APEN==1,na.rm = T),
            SD2.INHE=sum(SD2.INHE==1,na.rm = T),
            SD2.OTHE=sum(SD2.OTHE==1,na.rm = T),
            SD2.CRCU=sum(SD2.CRCU==1,na.rm = T),
            SD2.PIIO=sum(SD2.PIIO==1,na.rm = T),
            SD2.EDDI=sum(SD2.EDDI==1,na.rm = T),
            SD2.SIIO=sum(SD2.SIIO==1,na.rm = T),
            SD3.ALLD=sum(SD3.ALLD==1,na.rm = T),
            SD3.OTLI=sum(SD3.OTLI==1,na.rm = T),
            SD3.COLE=sum(SD3.COLE==1,na.rm = T),
            SD3.OTIP=sum(SD3.OTIP==1,na.rm = T),
            SD3.PANC=sum(SD3.PANC==1,na.rm = T),
            SD3.OTRA=sum(SD3.OTRA==1,na.rm = T),
            PTS.IPTS=sum(PTS.IPTS==1,na.rm = T),
            PTS.DEEC=sum(PTS.DEEC==1,na.rm = T),
            PTS.OTRA=sum(PTS.OTRA==1,na.rm = T),
            MOC.PAIN=sum(MOC.PAIN==1,na.rm = T),
            MOC.OSAR=sum(MOC.OSAR==1,na.rm = T),
            MOC.ADOL=sum(MOC.ADOL==1,na.rm = T),
            MOC.OTAR=sum(MOC.OTAR==1,na.rm = T),
            MOC.SCTD=sum(MOC.SCTD==1,na.rm = T),
            MOC.IVDD=sum(MOC.IVDD==1,na.rm = T),
            MOC.OTDO=sum(MOC.OTDO==1,na.rm = T),
            MOC.SOFT=sum(MOC.SOFT==1,na.rm = T),
            MOC.BONE=sum(MOC.BONE==1,na.rm = T),
            MOC.OMIE=sum(MOC.OMIE==1,na.rm = T),
            MOC.OTRA=sum(MOC.OTRA==1,na.rm = T),
            GU1.NFRI=sum(GU1.NFRI==1,na.rm = T),
            GU1.OTGL=sum(GU1.OTGL==1,na.rm = T),
            GU1.ACKF=sum(GU1.ACKF==1,na.rm = T),
            GU1.RTID=sum(GU1.RTID==1,na.rm = T),
            GU1.OTTU=sum(GU1.OTTU==1,na.rm = T),
            GU1.LITO=sum(GU1.LITO==1,na.rm = T),
            GU1.RECO=sum(GU1.RECO==1,na.rm = T),
            GU1.CIST=sum(GU1.CIST==1,na.rm = T),
            GU1.OTRA=sum(GU1.OTRA==1,na.rm = T),
            GU2.HIPR=sum(GU2.HIPR==1,na.rm = T),
            GU2.OTPR=sum(GU2.OTPR==1,na.rm = T),
            GU2.HCEC=sum(GU2.HCEC==1,na.rm = T),
            GU2.PREP=sum(GU2.PREP==1,na.rm = T),
            GU2.MINF=sum(GU2.MINF==1,na.rm = T),
            GU2.OTRA=sum(GU2.OTRA==1,na.rm = T),
            GU3.MAMA=sum(GU3.MAMA==1,na.rm = T),
            GU4.SAOO=sum(GU4.SAOO==1,na.rm = T),
            GU4.IDCU=sum(GU4.IDCU==1,na.rm = T),
            GU4.OTVV=sum(GU4.OTVV==1,na.rm = T),
            GU4.OTPI=sum(GU4.OTPI==1,na.rm = T),
            GU4.ENDM=sum(GU4.ENDM==1,na.rm = T),
            GU4.FPRO=sum(GU4.FPRO==1,na.rm = T),
            GU4.NOFB=sum(GU4.NOFB==1,na.rm = T),
            GU4.MENS=sum(GU4.MENS==1,na.rm = T),
            GU4.MNOP=sum(GU4.MNOP==1,na.rm = T),
            GU4.FINF=sum(GU4.FINF==1,na.rm = T),
            GU4.OTRA=sum(GU4.OTRA==1,na.rm = T),
            OB1.SPON=sum(OB1.SPON==1,na.rm = T),
            OB1.INDU=sum(OB1.INDU==1,na.rm = T),
            OB1.OTRA=sum(OB1.OTRA==1,na.rm = T),
            OB2.EPHD=sum(OB2.EPHD==1,na.rm = T),
            OB2.HEMP=sum(OB2.HEMP==1,na.rm = T),
            OB2.FACD=sum(OB2.FACD==1,na.rm = T),
            OB2.IGUT=sum(OB2.IGUT==1,na.rm = T),
            OB2.DMIP=sum(OB2.DMIP==1,na.rm = T),
            OB2.OBSL=sum(OB2.OBSL==1,na.rm = T),
            OB2.PPHE=sum(OB2.PPHE==1,na.rm = T),
            OB2.SOPI=sum(OB2.SOPI==1,na.rm = T),
            OB2.PUER=sum(OB2.PUER==1,na.rm = T),
            OB2.OTPL=sum(OB2.OTPL==1,na.rm = T),
            OB2.OBTE=sum(OB2.OBTE==1,na.rm = T),
            OB2.BEPU=sum(OB2.BEPU==1,na.rm = T),
            OB2.OMLC=sum(OB2.OMLC==1,na.rm = T),
            OB2.OTDC=sum(OB2.OTDC==1,na.rm = T),
            OB2.ODUC=sum(OB2.ODUC==1,na.rm = T),
            OB3.SSDE=sum(OB3.SSDE==1,na.rm = T),
            OB3.OTDE=sum(OB3.OTDE==1,na.rm = T),
            OB4.INOC=sum(OB4.INOC==1,na.rm = T),
            NEO.NAMC=sum(NEO.NAMC==1,na.rm = T),
            NEO.NAOC=sum(NEO.NAOC==1,na.rm = T),
            NEO.GMGW=sum(NEO.GMGW==1,na.rm = T),
            NEO.BITR=sum(NEO.BITR==1,na.rm = T),
            NEO.HIAS=sum(NEO.HIAS==1,na.rm = T),
            NEO.SDRN=sum(NEO.SDRN==1,na.rm = T),
            NEO.INFE=sum(NEO.INFE==1,na.rm = T),
            NEO.OTIN=sum(NEO.OTIN==1,na.rm = T),
            NEO.HDNB=sum(NEO.HDNB==1,na.rm = T),
            NEO.TENE=sum(NEO.TENE==1,na.rm = T),
            NEO.OTRA=sum(NEO.OTRA==1,na.rm = T),
            CON.ANEN=sum(CON.ANEN==1,na.rm = T),
            CON.HIDR=sum(CON.HIDR==1,na.rm = T),
            CON.SBIF=sum(CON.SBIF==1,na.rm = T),
            CON.OTNS=sum(CON.OTNS==1,na.rm = T),
            CON.CIRC=sum(CON.CIRC==1,na.rm = T),
            CON.CLCP=sum(CON.CLCP==1,na.rm = T),
            CON.CINT=sum(CON.CINT==1,na.rm = T),
            CON.OTDS=sum(CON.OTDS==1,na.rm = T),
            CON.TEST=sum(CON.TEST==1,na.rm = T),
            CON.OTGU=sum(CON.OTGU==1,na.rm = T),
            CON.DHIP=sum(CON.DHIP==1,na.rm = T),
            CON.FEET=sum(CON.FEET==1,na.rm = T),
            CON.OTMS=sum(CON.OTMS==1,na.rm = T),
            CON.OTRA=sum(CON.OTRA==1,na.rm = T),
            CON.CROM=sum(CON.CROM==1,na.rm = T),
            NCL.FEVU=sum(NCL.FEVU==1,na.rm = T),
            NCL.CAAB=sum(NCL.CAAB==1,na.rm = T),
            NCL.RAOR=sum(NCL.RAOR==1,na.rm = T),
            NCL.ABPP=sum(NCL.ABPP==1,na.rm = T),
            NCL.ARPD=sum(NCL.ARPD==1,na.rm = T),
            NCL.SIDS=sum(NCL.SIDS==1,na.rm = T),
            NCL.REAR=sum(NCL.REAR==1,na.rm = T),
            NCL.OTRA=sum(NCL.OTRA==1,na.rm = T),
            EX1.RAIL=sum(EX1.RAIL==1,na.rm = T),
            EX1.MOTO=sum(EX1.MOTO==1,na.rm = T),
            EX1.LAND=sum(EX1.LAND==1,na.rm = T),
            EX1.WATE=sum(EX1.WATE==1,na.rm = T),
            EX1.AIRS=sum(EX1.AIRS==1,na.rm = T),
            EX1.OTRO=sum(EX1.OTRO==1,na.rm = T),
            EX2.FALL=sum(EX2.FALL==1,na.rm = T),
            EX3.ENVI=sum(EX3.ENVI==1,na.rm = T),
            EX3.DROW=sum(EX3.DROW==1,na.rm = T),
            EX3.FBNO=sum(EX3.FBNO==1,na.rm = T),
            EX3.MACH=sum(EX3.MACH==1,na.rm = T),
            EX3.FREG=sum(EX3.FREG==1,na.rm = T),
            EX3.SEQA=sum(EX3.SEQA==1,na.rm = T),
            EX3.OTRA=sum(EX3.OTRA==1,na.rm = T),
            EX4.SMFF=sum(EX4.SMFF==1,na.rm = T),
            EX5.APDM=sum(EX5.APDM==1,na.rm = T),
            EX5.APSL=sum(EX5.APSL==1,na.rm = T),
            EX5.APGV=sum(EX5.APGV==1,na.rm = T),
            EX6.SUIC=sum(EX6.SUIC==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            EX8.EOUI=sum(EX8.EOUI==1,na.rm = T),
            EX8.OWAR=sum(EX8.OWAR==1,na.rm = T),
            EX8.LEGI=sum(EX8.LEGI==1,na.rm = T),
            EX9.DRUG=sum(EX9.DRUG==1,na.rm = T),
            EX9.MSDV=sum(EX9.MSDV==1,na.rm = T),
            EX9.SQEX=sum(EX9.SQEX==1,na.rm = T),
            COV.CONF=sum(COV.CONF==1,na.rm = T),
            COV.SUSP=sum(COV.SUSP==1,na.rm = T),
  )%>%
  left_join(Pob_edad_2018_entidad_total,by="EDAD_QUIN")%>%
  summarise(EII.COLE=(EII.COLE/POB)*Weight*100000,
            EII.TIPA=(EII.TIPA/POB)*Weight*100000,
            EII.SHIG=(EII.SHIG/POB)*Weight*100000,
            EII.TOXI=(EII.TOXI/POB)*Weight*100000,
            EII.AMEB=(EII.AMEB/POB)*Weight*100000,
            EII.OTRA=(EII.OTRA/POB)*Weight*100000,
            EII.PRES=(EII.PRES/POB)*Weight*100000,
            TUB.PULM=(TUB.PULM/POB)*Weight*100000,
            TUB.RESP=(TUB.RESP/POB)*Weight*100000,
            TUB.NERV=(TUB.NERV/POB)*Weight*100000,
            TUB.IPGM=(TUB.IPGM/POB)*Weight*100000,
            TUB.BONE=(TUB.BONE/POB)*Weight*100000,
            TUB.URIN=(TUB.URIN/POB)*Weight*100000,
            TUB.OTRA=(TUB.OTRA/POB)*Weight*100000,
            BAC.PEST=(BAC.PEST/POB)*Weight*100000,
            BAC.BRUS=(BAC.BRUS/POB)*Weight*100000,
            BAC.LEPR=(BAC.LEPR/POB)*Weight*100000,
            BAC.DIFT=(BAC.DIFT/POB)*Weight*100000,
            BAC.PERT=(BAC.PERT/POB)*Weight*100000,
            BAC.PYOG=(BAC.PYOG/POB)*Weight*100000,
            BAC.MENI=(BAC.MENI/POB)*Weight*100000,
            BAC.TETA=(BAC.TETA/POB)*Weight*100000,
            BAC.SEPS=(BAC.SEPS/POB)*Weight*100000,
            BAC.OTRA=(BAC.OTRA/POB)*Weight*100000,
            ETS.SIF1=(ETS.SIF1/POB)*Weight*100000,
            ETS.SIF2=(ETS.SIF2/POB)*Weight*100000,
            ETS.SIF3=(ETS.SIF3/POB)*Weight*100000,
            ETS.GONO=(ETS.GONO/POB)*Weight*100000,
            ETS.CLAM=(ETS.CLAM/POB)*Weight*100000,
            ETS.OTRA=(ETS.OTRA/POB)*Weight*100000,
            VIR.POLI=(VIR.POLI/POB)*Weight*100000,
            VIR.VIRU=(VIR.VIRU/POB)*Weight*100000,
            VIR.SARA=(VIR.SARA/POB)*Weight*100000,
            VIR.RUBE=(VIR.RUBE/POB)*Weight*100000,
            VIR.FIAM=(VIR.FIAM/POB)*Weight*100000,
            VIR.DENG=(VIR.DENG/POB)*Weight*100000,
            VIR.DHEM=(VIR.DHEM/POB)*Weight*100000,
            VIR.VIH1=(VIR.VIH1/POB)*Weight*100000,
            VIR.EVTA=(VIR.EVTA/POB)*Weight*100000,
            VIR.HEPB=(VIR.HEPB/POB)*Weight*100000,
            VIR.HEPO=(VIR.HEPO/POB)*Weight*100000,
            VIR.RABI=(VIR.RABI/POB)*Weight*100000,
            VIR.TRAC=(VIR.TRAC/POB)*Weight*100000,
            VIR.OFAH=(VIR.OFAH/POB)*Weight*100000,
            VIR.HERP=(VIR.HERP/POB)*Weight*100000,
            VIR.VRHZ=(VIR.VRHZ/POB)*Weight*100000,
            VIR.PARO=(VIR.PARO/POB)*Weight*100000,
            VIR.OCLA=(VIR.OCLA/POB)*Weight*100000,
            VIR.OTRA=(VIR.OTRA/POB)*Weight*100000,
            RPI.TIFP=(RPI.TIFP/POB)*Weight*100000,
            RPI.OTIF=(RPI.OTIF/POB)*Weight*100000,
            RPI.ORIC=(RPI.ORIC/POB)*Weight*100000,
            RPI.PALU=(RPI.PALU/POB)*Weight*100000,
            RPI.LEIS=(RPI.LEIS/POB)*Weight*100000,
            RPI.TRIP=(RPI.TRIP/POB)*Weight*100000,
            PMO.ESPI=(PMO.ESPI/POB)*Weight*100000,
            PMO.FIRE=(PMO.FIRE/POB)*Weight*100000,
            PMO.MICO=(PMO.MICO/POB)*Weight*100000,
            PMO.SCHI=(PMO.SCHI/POB)*Weight*100000,
            PMO.TREM=(PMO.TREM/POB)*Weight*100000,
            PMO.ECHI=(PMO.ECHI/POB)*Weight*100000,
            PMO.DRAC=(PMO.DRAC/POB)*Weight*100000,
            PMO.ONCH=(PMO.ONCH/POB)*Weight*100000,
            PMO.FILA=(PMO.FILA/POB)*Weight*100000,
            PMO.ANNE=(PMO.ANNE/POB)*Weight*100000,
            PMO.HELM=(PMO.HELM/POB)*Weight*100000,
            PMO.OTRA=(PMO.OTRA/POB)*Weight*100000,
            SEI.TUBE=(SEI.TUBE/POB)*Weight*100000,
            SEI.POLI=(SEI.POLI/POB)*Weight*100000,
            SEI.LEPR=(SEI.LEPR/POB)*Weight*100000,
            SEI.OTRA=(SEI.OTRA/POB)*Weight*100000,
            NM1.LCBF=(NM1.LCBF/POB)*Weight*100000,
            NM2.ESOF=(NM2.ESOF/POB)*Weight*100000,
            NM2.STOM=(NM2.STOM/POB)*Weight*100000,
            NM2.INDE=(NM2.INDE/POB)*Weight*100000,
            NM2.COLO=(NM2.COLO/POB)*Weight*100000,
            NM2.RECT=(NM2.RECT/POB)*Weight*100000,
            NM2.HIGA=(NM2.HIGA/POB)*Weight*100000,
            NM2.PANC=(NM2.PANC/POB)*Weight*100000,
            NM2.OTRO=(NM2.OTRO/POB)*Weight*100000,
            NM3.LARI=(NM3.LARI/POB)*Weight*100000,
            NM3.TBPU=(NM3.TBPU/POB)*Weight*100000,
            NM3.OTRO=(NM3.OTRO/POB)*Weight*100000,
            NM4.BONE=(NM4.BONE/POB)*Weight*100000,
            NM4.MELA=(NM4.MELA/POB)*Weight*100000,
            NM4.SKIN=(NM4.SKIN/POB)*Weight*100000,
            NM4.MAMA=(NM4.MAMA/POB)*Weight*100000,
            NM4.SOFT=(NM4.SOFT/POB)*Weight*100000,
            NM5.CERV=(NM5.CERV/POB)*Weight*100000,
            NM5.PLAC=(NM5.PLAC/POB)*Weight*100000,
            NM5.UTER=(NM5.UTER/POB)*Weight*100000,
            NM5.OVAR=(NM5.OVAR/POB)*Weight*100000,
            NM5.VAGI=(NM5.VAGI/POB)*Weight*100000,
            NM5.OTFE=(NM5.OTFE/POB)*Weight*100000,
            NM5.PROS=(NM5.PROS/POB)*Weight*100000,
            NM5.TEST=(NM5.TEST/POB)*Weight*100000,
            NM5.OTMA=(NM5.OTMA/POB)*Weight*100000,
            NM5.VEJI=(NM5.VEJI/POB)*Weight*100000,
            NM5.OTUR=(NM5.OTUR/POB)*Weight*100000,
            NM6.ENCF=(NM6.ENCF/POB)*Weight*100000,
            NM6.MENI=(NM6.MENI/POB)*Weight*100000,
            NM6.OJOA=(NM6.OJOA/POB)*Weight*100000,
            NM6.OTRO=(NM6.OTRO/POB)*Weight*100000,
            NM7.ENHO=(NM7.ENHO/POB)*Weight*100000,
            NM7.NOHO=(NM7.NOHO/POB)*Weight*100000,
            NM7.MMCP=(NM7.MMCP/POB)*Weight*100000,
            NM7.LEUC=(NM7.LEUC/POB)*Weight*100000,
            NM7.OTRO=(NM7.OTRO/POB)*Weight*100000,
            NM8.MUPT=(NM8.MUPT/POB)*Weight*100000,
            NIS.CERV=(NIS.CERV/POB)*Weight*100000,
            NIS.OTRO=(NIS.OTRO/POB)*Weight*100000,
            NBE.SKIN=(NBE.SKIN/POB)*Weight*100000,
            NBE.MAMA=(NBE.MAMA/POB)*Weight*100000,
            NBE.LEIO=(NBE.LEIO/POB)*Weight*100000,
            NBE.OVAR=(NBE.OVAR/POB)*Weight*100000,
            NBE.URIN=(NBE.URIN/POB)*Weight*100000,
            NBE.CSNC=(NBE.CSNC/POB)*Weight*100000,
            NBE.TIRO=(NBE.TIRO/POB)*Weight*100000,
            NBE.OTRO=(NBE.OTRO/POB)*Weight*100000,
            NCI.UNCB=(NCI.UNCB/POB)*Weight*100000,
            SAN.ADFE=(SAN.ADFE/POB)*Weight*100000,
            SAN.AOTR=(SAN.AOTR/POB)*Weight*100000,
            SAN.INMU=(SAN.INMU/POB)*Weight*100000,
            SAN.OTRA=(SAN.OTRA/POB)*Weight*100000,
            END.DEYO=(END.DEYO/POB)*Weight*100000,
            END.TTOX=(END.TTOX/POB)*Weight*100000,
            END.TOTR=(END.TOTR/POB)*Weight*100000,
            END.DIAB=(END.DIAB/POB)*Weight*100000,
            END.LIPO=(END.LIPO/POB)*Weight*100000,
            END.OBES=(END.OBES/POB)*Weight*100000,
            END.DEPL=(END.DEPL/POB)*Weight*100000,
            END.SQHA=(END.SQHA/POB)*Weight*100000,
            END.OTRA=(END.OTRA/POB)*Weight*100000,
            NUT.KWAS=(NUT.KWAS/POB)*Weight*100000,
            NUT.MARA=(NUT.MARA/POB)*Weight*100000,
            NUT.PROT=(NUT.PROT/POB)*Weight*100000,
            NUT.VITA=(NUT.VITA/POB)*Weight*100000,
            NUT.VITO=(NUT.VITO/POB)*Weight*100000,
            NUT.SECD=(NUT.SECD/POB)*Weight*100000,
            NUT.OTRA=(NUT.OTRA/POB)*Weight*100000,
            MEN.DEME=(MEN.DEME/POB)*Weight*100000,
            MEN.SDAL=(MEN.SDAL/POB)*Weight*100000,
            MEN.OTAL=(MEN.OTAL/POB)*Weight*100000,
            MEN.TMSP=(MEN.TMSP/POB)*Weight*100000,
            MEN.ESQU=(MEN.ESQU/POB)*Weight*100000,
            MEN.HUMO=(MEN.HUMO/POB)*Weight*100000,
            MEN.ESTR=(MEN.ESTR/POB)*Weight*100000,
            MEN.FISI=(MEN.FISI/POB)*Weight*100000,
            MEN.RETR=(MEN.RETR/POB)*Weight*100000,
            MEN.OTRO=(MEN.OTRO/POB)*Weight*100000,
            NER.MENI=(NER.MENI/POB)*Weight*100000,
            NER.ISNC=(NER.ISNC/POB)*Weight*100000,
            NER.PARK=(NER.PARK/POB)*Weight*100000,
            NER.ALZH=(NER.ALZH/POB)*Weight*100000,
            NER.ESCM=(NER.ESCM/POB)*Weight*100000,
            NER.PALS=(NER.PALS/POB)*Weight*100000,
            NER.EPIL=(NER.EPIL/POB)*Weight*100000,
            NER.MIGR=(NER.MIGR/POB)*Weight*100000,
            NER.IQCT=(NER.IQCT/POB)*Weight*100000,
            NER.SNPE=(NER.SNPE/POB)*Weight*100000,
            NER.OTRA=(NER.OTRA/POB)*Weight*100000,
            EYE.PARP=(EYE.PARP/POB)*Weight*100000,
            EYE.ESCL=(EYE.ESCL/POB)*Weight*100000,
            EYE.GLAU=(EYE.GLAU/POB)*Weight*100000,
            EYE.CATA=(EYE.CATA/POB)*Weight*100000,
            EYE.CRIS=(EYE.CRIS/POB)*Weight*100000,
            EYE.RETI=(EYE.RETI/POB)*Weight*100000,
            EYE.CEGU=(EYE.CEGU/POB)*Weight*100000,
            EYE.CONJ=(EYE.CONJ/POB)*Weight*100000,
            EYE.OTCO=(EYE.OTCO/POB)*Weight*100000,
            EYE.LAGR=(EYE.LAGR/POB)*Weight*100000,
            EYE.ESTR=(EYE.ESTR/POB)*Weight*100000,
            EYE.BINO=(EYE.BINO/POB)*Weight*100000,
            EYE.REFR=(EYE.REFR/POB)*Weight*100000,
            EYE.OTRA=(EYE.OTRA/POB)*Weight*100000,
            EAR.OMTM=(EAR.OMTM/POB)*Weight*100000,
            EAR.OTOM=(EAR.OTOM/POB)*Weight*100000,
            EAR.SORD=(EAR.SORD/POB)*Weight*100000,
            EAR.OTRA=(EAR.OTRA/POB)*Weight*100000,
            SC1.FIRE=(SC1.FIRE/POB)*Weight*100000,
            SC1.CRHD=(SC1.CRHD/POB)*Weight*100000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*100000,
            SC2.HTES=(SC2.HTES/POB)*Weight*100000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*100000,
            SC3.IAMC=(SC3.IAMC/POB)*Weight*100000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*100000,
            SC4.EMBP=(SC4.EMBP/POB)*Weight*100000,
            SC4.CARR=(SC4.CARR/POB)*Weight*100000,
            SC4.PARO=(SC4.PARO/POB)*Weight*100000,
            SC4.HEFA=(SC4.HEFA/POB)*Weight*100000,
            SC4.OTRA=(SC4.OTRA/POB)*Weight*100000,
            SC5.HEMS=(SC5.HEMS/POB)*Weight*100000,
            SC5.HEMI=(SC5.HEMI/POB)*Weight*100000,
            SC5.ISQC=(SC5.ISQC/POB)*Weight*100000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*100000,
            SC5.ATSC=(SC5.ATSC/POB)*Weight*100000,
            SC5.SEQC=(SC5.SEQC/POB)*Weight*100000,
            SC5.OTRA=(SC5.OTRA/POB)*Weight*100000,
            SC6.ATER=(SC6.ATER/POB)*Weight*100000,
            SC6.OEVP=(SC6.OEVP/POB)*Weight*100000,
            SC6.ETAR=(SC6.ETAR/POB)*Weight*100000,
            SC6.OTAR=(SC6.OTAR/POB)*Weight*100000,
            SC6.ETVE=(SC6.ETVE/POB)*Weight*100000,
            SC6.VARI=(SC6.VARI/POB)*Weight*100000,
            SC6.HMRR=(SC6.HMRR/POB)*Weight*100000,
            SC6.OTRA=(SC6.OTRA/POB)*Weight*100000,
            ER1.FAAG=(ER1.FAAG/POB)*Weight*100000,
            ER1.TOAG=(ER1.TOAG/POB)*Weight*100000,
            ER1.LTAG=(ER1.LTAG/POB)*Weight*100000,
            ER1.OTAG=(ER1.OTAG/POB)*Weight*100000,
            ER1.PNSD=(ER1.PNSD/POB)*Weight*100000,
            ER1.RNPC=(ER1.RNPC/POB)*Weight*100000,
            ER1.SINC=(ER1.SINC/POB)*Weight*100000,
            ER1.TADC=(ER1.TADC/POB)*Weight*100000,
            ER1.ONSN=(ER1.ONSN/POB)*Weight*100000,
            ER1.OTRA=(ER1.OTRA/POB)*Weight*100000,
            ER2.BRAG=(ER2.BRAG/POB)*Weight*100000,
            ER2.NEUM=(ER2.NEUM/POB)*Weight*100000,
            ER2.INFL=(ER2.INFL/POB)*Weight*100000,
            ER2.BCNE=(ER2.BCNE/POB)*Weight*100000,
            ER2.ASMA=(ER2.ASMA/POB)*Weight*100000,
            ER2.BREC=(ER2.BREC/POB)*Weight*100000,
            ER2.EPOC=(ER2.EPOC/POB)*Weight*100000,
            ER2.NMCS=(ER2.NMCS/POB)*Weight*100000,
            ER2.OTAE=(ER2.OTAE/POB)*Weight*100000,
            ER2.PLEU=(ER2.PLEU/POB)*Weight*100000,
            ER2.IRIN=(ER2.IRIN/POB)*Weight*100000,
            ER2.OTRA=(ER2.OTRA/POB)*Weight*100000,
            SD1.CARI=(SD1.CARI/POB)*Weight*100000,
            SD1.OTDI=(SD1.OTDI/POB)*Weight*100000,
            SD1.OTJA=(SD1.OTJA/POB)*Weight*100000,
            SD1.OTRA=(SD1.OTRA/POB)*Weight*100000,
            SD2.ESOF=(SD2.ESOF/POB)*Weight*100000,
            SD2.GDIS=(SD2.GDIS/POB)*Weight*100000,
            SD2.GDUL=(SD2.GDUL/POB)*Weight*100000,
            SD2.OTGD=(SD2.OTGD/POB)*Weight*100000,
            SD2.APEN=(SD2.APEN/POB)*Weight*100000,
            SD2.INHE=(SD2.INHE/POB)*Weight*100000,
            SD2.OTHE=(SD2.OTHE/POB)*Weight*100000,
            SD2.CRCU=(SD2.CRCU/POB)*Weight*100000,
            SD2.PIIO=(SD2.PIIO/POB)*Weight*100000,
            SD2.EDDI=(SD2.EDDI/POB)*Weight*100000,
            SD2.SIIO=(SD2.SIIO/POB)*Weight*100000,
            SD3.ALLD=(SD3.ALLD/POB)*Weight*100000,
            SD3.OTLI=(SD3.OTLI/POB)*Weight*100000,
            SD3.COLE=(SD3.COLE/POB)*Weight*100000,
            SD3.OTIP=(SD3.OTIP/POB)*Weight*100000,
            SD3.PANC=(SD3.PANC/POB)*Weight*100000,
            SD3.OTRA=(SD3.OTRA/POB)*Weight*100000,
            PTS.IPTS=(PTS.IPTS/POB)*Weight*100000,
            PTS.DEEC=(PTS.DEEC/POB)*Weight*100000,
            PTS.OTRA=(PTS.OTRA/POB)*Weight*100000,
            MOC.PAIN=(MOC.PAIN/POB)*Weight*100000,
            MOC.OSAR=(MOC.OSAR/POB)*Weight*100000,
            MOC.ADOL=(MOC.ADOL/POB)*Weight*100000,
            MOC.OTAR=(MOC.OTAR/POB)*Weight*100000,
            MOC.SCTD=(MOC.SCTD/POB)*Weight*100000,
            MOC.IVDD=(MOC.IVDD/POB)*Weight*100000,
            MOC.OTDO=(MOC.OTDO/POB)*Weight*100000,
            MOC.SOFT=(MOC.SOFT/POB)*Weight*100000,
            MOC.BONE=(MOC.BONE/POB)*Weight*100000,
            MOC.OMIE=(MOC.OMIE/POB)*Weight*100000,
            MOC.OTRA=(MOC.OTRA/POB)*Weight*100000,
            GU1.NFRI=(GU1.NFRI/POB)*Weight*100000,
            GU1.OTGL=(GU1.OTGL/POB)*Weight*100000,
            GU1.ACKF=(GU1.ACKF/POB)*Weight*100000,
            GU1.RTID=(GU1.RTID/POB)*Weight*100000,
            GU1.OTTU=(GU1.OTTU/POB)*Weight*100000,
            GU1.LITO=(GU1.LITO/POB)*Weight*100000,
            GU1.RECO=(GU1.RECO/POB)*Weight*100000,
            GU1.CIST=(GU1.CIST/POB)*Weight*100000,
            GU1.OTRA=(GU1.OTRA/POB)*Weight*100000,
            GU2.HIPR=(GU2.HIPR/POB)*Weight*100000,
            GU2.OTPR=(GU2.OTPR/POB)*Weight*100000,
            GU2.HCEC=(GU2.HCEC/POB)*Weight*100000,
            GU2.PREP=(GU2.PREP/POB)*Weight*100000,
            GU2.MINF=(GU2.MINF/POB)*Weight*100000,
            GU2.OTRA=(GU2.OTRA/POB)*Weight*100000,
            GU3.MAMA=(GU3.MAMA/POB)*Weight*100000,
            GU4.SAOO=(GU4.SAOO/POB)*Weight*100000,
            GU4.IDCU=(GU4.IDCU/POB)*Weight*100000,
            GU4.OTVV=(GU4.OTVV/POB)*Weight*100000,
            GU4.OTPI=(GU4.OTPI/POB)*Weight*100000,
            GU4.ENDM=(GU4.ENDM/POB)*Weight*100000,
            GU4.FPRO=(GU4.FPRO/POB)*Weight*100000,
            GU4.NOFB=(GU4.NOFB/POB)*Weight*100000,
            GU4.MENS=(GU4.MENS/POB)*Weight*100000,
            GU4.MNOP=(GU4.MNOP/POB)*Weight*100000,
            GU4.FINF=(GU4.FINF/POB)*Weight*100000,
            GU4.OTRA=(GU4.OTRA/POB)*Weight*100000,
            OB1.SPON=(OB1.SPON/POB)*Weight*100000,
            OB1.INDU=(OB1.INDU/POB)*Weight*100000,
            OB1.OTRA=(OB1.OTRA/POB)*Weight*100000,
            OB2.EPHD=(OB2.EPHD/POB)*Weight*100000,
            OB2.HEMP=(OB2.HEMP/POB)*Weight*100000,
            OB2.FACD=(OB2.FACD/POB)*Weight*100000,
            OB2.IGUT=(OB2.IGUT/POB)*Weight*100000,
            OB2.DMIP=(OB2.DMIP/POB)*Weight*100000,
            OB2.OBSL=(OB2.OBSL/POB)*Weight*100000,
            OB2.PPHE=(OB2.PPHE/POB)*Weight*100000,
            OB2.SOPI=(OB2.SOPI/POB)*Weight*100000,
            OB2.PUER=(OB2.PUER/POB)*Weight*100000,
            OB2.OTPL=(OB2.OTPL/POB)*Weight*100000,
            OB2.OBTE=(OB2.OBTE/POB)*Weight*100000,
            OB2.BEPU=(OB2.BEPU/POB)*Weight*100000,
            OB2.OMLC=(OB2.OMLC/POB)*Weight*100000,
            OB2.OTDC=(OB2.OTDC/POB)*Weight*100000,
            OB2.ODUC=(OB2.ODUC/POB)*Weight*100000,
            OB3.SSDE=(OB3.SSDE/POB)*Weight*100000,
            OB3.OTDE=(OB3.OTDE/POB)*Weight*100000,
            OB4.INOC=(OB4.INOC/POB)*Weight*100000,
            NEO.NAMC=(NEO.NAMC/POB)*Weight*100000,
            NEO.NAOC=(NEO.NAOC/POB)*Weight*100000,
            NEO.GMGW=(NEO.GMGW/POB)*Weight*100000,
            NEO.BITR=(NEO.BITR/POB)*Weight*100000,
            NEO.HIAS=(NEO.HIAS/POB)*Weight*100000,
            NEO.SDRN=(NEO.SDRN/POB)*Weight*100000,
            NEO.INFE=(NEO.INFE/POB)*Weight*100000,
            NEO.OTIN=(NEO.OTIN/POB)*Weight*100000,
            NEO.HDNB=(NEO.HDNB/POB)*Weight*100000,
            NEO.TENE=(NEO.TENE/POB)*Weight*100000,
            NEO.OTRA=(NEO.OTRA/POB)*Weight*100000,
            CON.ANEN=(CON.ANEN/POB)*Weight*100000,
            CON.HIDR=(CON.HIDR/POB)*Weight*100000,
            CON.SBIF=(CON.SBIF/POB)*Weight*100000,
            CON.OTNS=(CON.OTNS/POB)*Weight*100000,
            CON.CIRC=(CON.CIRC/POB)*Weight*100000,
            CON.CLCP=(CON.CLCP/POB)*Weight*100000,
            CON.CINT=(CON.CINT/POB)*Weight*100000,
            CON.OTDS=(CON.OTDS/POB)*Weight*100000,
            CON.TEST=(CON.TEST/POB)*Weight*100000,
            CON.OTGU=(CON.OTGU/POB)*Weight*100000,
            CON.DHIP=(CON.DHIP/POB)*Weight*100000,
            CON.FEET=(CON.FEET/POB)*Weight*100000,
            CON.OTMS=(CON.OTMS/POB)*Weight*100000,
            CON.OTRA=(CON.OTRA/POB)*Weight*100000,
            CON.CROM=(CON.CROM/POB)*Weight*100000,
            NCL.FEVU=(NCL.FEVU/POB)*Weight*100000,
            NCL.CAAB=(NCL.CAAB/POB)*Weight*100000,
            NCL.RAOR=(NCL.RAOR/POB)*Weight*100000,
            NCL.ABPP=(NCL.ABPP/POB)*Weight*100000,
            NCL.ARPD=(NCL.ARPD/POB)*Weight*100000,
            NCL.SIDS=(NCL.SIDS/POB)*Weight*100000,
            NCL.REAR=(NCL.REAR/POB)*Weight*100000,
            NCL.OTRA=(NCL.OTRA/POB)*Weight*100000,
            EX1.RAIL=(EX1.RAIL/POB)*Weight*100000,
            EX1.MOTO=(EX1.MOTO/POB)*Weight*100000,
            EX1.LAND=(EX1.LAND/POB)*Weight*100000,
            EX1.WATE=(EX1.WATE/POB)*Weight*100000,
            EX1.AIRS=(EX1.AIRS/POB)*Weight*100000,
            EX1.OTRO=(EX1.OTRO/POB)*Weight*100000,
            EX2.FALL=(EX2.FALL/POB)*Weight*100000,
            EX3.ENVI=(EX3.ENVI/POB)*Weight*100000,
            EX3.DROW=(EX3.DROW/POB)*Weight*100000,
            EX3.FBNO=(EX3.FBNO/POB)*Weight*100000,
            EX3.MACH=(EX3.MACH/POB)*Weight*100000,
            EX3.FREG=(EX3.FREG/POB)*Weight*100000,
            EX3.SEQA=(EX3.SEQA/POB)*Weight*100000,
            EX3.OTRA=(EX3.OTRA/POB)*Weight*100000,
            EX4.SMFF=(EX4.SMFF/POB)*Weight*100000,
            EX5.APDM=(EX5.APDM/POB)*Weight*100000,
            EX5.APSL=(EX5.APSL/POB)*Weight*100000,
            EX5.APGV=(EX5.APGV/POB)*Weight*100000,
            EX6.SUIC=(EX6.SUIC/POB)*Weight*100000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*100000,
            EX8.EOUI=(EX8.EOUI/POB)*Weight*100000,
            EX8.OWAR=(EX8.OWAR/POB)*Weight*100000,
            EX8.LEGI=(EX8.LEGI/POB)*Weight*100000,
            EX9.DRUG=(EX9.DRUG/POB)*Weight*100000,
            EX9.MSDV=(EX9.MSDV/POB)*Weight*100000,
            EX9.SQEX=(EX9.SQEX/POB)*Weight*100000,
            COV.CONF=(COV.CONF/POB)*Weight*100000,
            COV.SUSP=(COV.SUSP))%>%
  summarise("Cholera"=sum(EII.COLE),
            "Typhoid and paratyphoid fever"=sum(EII.TIPA),
            "Shigellosis"=sum(EII.SHIG),
            "Food poisoning"=sum(EII.TOXI),
            "Amebiasis"=sum(EII.AMEB),
            "Other GI infection"=sum(EII.OTRA),
            "Presumed GI infection"=sum(EII.PRES),
            "Pulmonary Tb"=sum(TUB.PULM),
            "Other respiratory Tb"=sum(TUB.RESP),
            "Other respiratory Tb"=sum(TUB.NERV),
            "Nervous System Tb"=sum(TUB.IPGM),
            "Intestinal/peritoneal Tb"=sum(TUB.BONE),
            "Bone and joint Tb"=sum(TUB.URIN),
            "Other variety of Tb"=sum(TUB.OTRA),
            "Plague (peste)"=sum(BAC.PEST),
            "Brusellosis"=sum(BAC.BRUS),
            "Leprosy"=sum(BAC.LEPR),
            "Diphtheria"=sum(BAC.DIFT),
            "Pertussis"=sum(BAC.PERT),
            "Scarlet fever, erysipelas"=sum(BAC.PYOG),
            "Meningococcal disease"=sum(BAC.MENI),
            "Tetanus"=sum(BAC.TETA),
            "Sepsis"=sum(BAC.SEPS),
            "Other bacterial diseases"=sum(BAC.OTRA),
            "Congenital syphilis"=sum(ETS.SIF1),
            "Early syphilis"=sum(ETS.SIF2),
            "Other syphilis"=sum(ETS.SIF3),
            "Gonorrhea"=sum(ETS.GONO),
            "Chlamydia"=sum(ETS.CLAM),
            "Other STD"=sum(ETS.OTRA),
            "Acute Poliomyelitis"=sum(VIR.POLI),
            "Smallpox (viruela)"=sum(VIR.VIRU),
            "Measles"=sum(VIR.SARA),
            "Rubella"=sum(VIR.RUBE),
            "Yellow fever"=sum(VIR.FIAM),
            "Dengue fever"=sum(VIR.DENG),
            "Dengue hemorragic fever"=sum(VIR.DHEM),
            "HIV infection"=sum(VIR.VIH1),
            "Arthropod-Borne Viral Encephalitis"=sum(VIR.EVTA),
            "Acute Hepatitis B"=sum(VIR.HEPB),
            "Other viral hepatitis"=sum(VIR.HEPO),
            "Rabies"=sum(VIR.RABI),
            "Trachoma"=sum(VIR.TRAC),
            "Other viral infections"=sum(VIR.OFAH),
            "Herpes simplex infections"=sum(VIR.HERP),
            "Chickenpox or herpes zoster"=sum(VIR.VRHZ),
            "Mumps"=sum(VIR.PARO),
            "Other chlamydia infections"=sum(VIR.OCLA),
            "Other viral diseases"=sum(VIR.OTRA),
            "Louse-borne epidemic thypus"=sum(RPI.TIFP),
            "Other thypus"=sum(RPI.OTIF),
            "Other rickettsiosis"=sum(RPI.ORIC),
            "Malaria"=sum(RPI.PALU),
            "Leishmaniasis"=sum(RPI.LEIS),
            "Trypanosomiasis"=sum(RPI.TRIP),
            "Other spirochetal diseases (Not syphilis)"=sum(PMO.ESPI),
            "Relapsing fevers"=sum(PMO.FIRE),
            "Mycosis"=sum(PMO.MICO),
            "Schistosomiasis"=sum(PMO.SCHI),
            "Other fluke (trematoda) infections"=sum(PMO.TREM),
            "Echinococcosis"=sum(PMO.ECHI),
            "Dracunculiasis"=sum(PMO.DRAC),
            "Onchocerciasis"=sum(PMO.ONCH),
            "Filariasis"=sum(PMO.FILA),
            "Ancylostomiasis or Necatoriasis"=sum(PMO.ANNE),
            "Other Helminthiases"=sum(PMO.HELM),
            "Other infectious/parasitic disease"=sum(PMO.OTRA),
            "Tuberculosis sequelae"=sum(SEI.TUBE),
            "Poliomyelitis sequelae"=sum(SEI.POLI),
            "Leprosy sequelae"=sum(SEI.LEPR),
            "Sequelae from other infections"=sum(SEI.OTRA),
            "Lip, oral cavity and pharynx cancer"=sum(NM1.LCBF),
            "Esophagus cancer"=sum(NM2.ESOF),
            "Stomach cancer"=sum(NM2.STOM),
            "Small intestine cancer"=sum(NM2.INDE),
            "Colon cancer"=sum(NM2.COLO),
            "Rectosigmoid junction, rectum and anal canal cancer"=sum(NM2.RECT),
            "Liver and intrahepatic bile ducts cancer"=sum(NM2.HIGA),
            "Pancreas cancer"=sum(NM2.PANC),
            "Other types of digestive organs cancer"=sum(NM2.OTRO),
            "Larynx cancer"=sum(NM3.LARI),
            "Trachea, bronchus and lung cancer"=sum(NM3.TBPU),
            "Other respiratory and intrathoracic organs cancer"=sum(NM3.OTRO),
            "Bone and articular cartilage cancer"=sum(NM4.BONE),
            "Malignant melanoma of skin cancer"=sum(NM4.MELA),
            "Other malignant neoplasm of skin cancer"=sum(NM4.SKIN),
            "Breast cancer"=sum(NM4.MAMA),
            "Mesothelial and soft tissue cancer"=sum(NM4.SOFT),
            "Cervix uteri cancer"=sum(NM5.CERV),
            "Placenta cancer"=sum(NM5.PLAC),
            "Uterus cancer"=sum(NM5.UTER),
            "Ovary cancer"=sum(NM5.OVAR),
            "Vulva and vagina cancer"=sum(NM5.VAGI),
            "Other and unspecified genitourinary (female) organs cancer"=sum(NM5.OTFE),
            "Prostate cancer"=sum(NM5.PROS),
            "Testis cancer"=sum(NM5.TEST),
            "Other and unspecified genitourinary (male) organs cancer"=sum(NM5.OTMA),
            "Bladder cancer"=sum(NM5.VEJI),
            "Other urinary tract cancer"=sum(NM5.OTUR),
            "Brain cancer"=sum(NM6.ENCF),
            "Meninges and other SNC cancer"=sum(NM6.MENI),
            "Eyes and adnexa cancer"=sum(NM6.OJOA),
            "Other and unspecified cancer in other organs and unspecified sites"=sum(NM6.OTRO),
            "Hodgkin lymphoma"=sum(NM7.ENHO),
            "Non-Hodgkin lymphoma"=sum(NM7.NOHO),
            "Multiple myeloma and plasmatic cell neoplasms"=sum(NM7.MMCP),
            "Leukemias"=sum(NM7.LEUC),
            "Other lymphoid, hematopoietic and related tissue"=sum(NM7.OTRO),
            "Multiple primary tumors"=sum(NM8.MUPT),
            "In-situ cervix uteri"=sum(NIS.CERV),
            "Other in situ neoplasms"=sum(NIS.OTRO),
            "Benign skin neoplasms"=sum(NBE.SKIN),
            "Benign breast neoplasms"=sum(NBE.MAMA),
            "Leiomyoma of uterus neoplasms"=sum(NBE.LEIO),
            "Benign ovary neoplasms"=sum(NBE.OVAR),
            "Bening urinary tract neoplasms"=sum(NBE.URIN),
            "Bening brain and other CNS sites neoplasms"=sum(NBE.CSNC),
            "Benign thyroid neoplasms"=sum(NBE.TIRO),
            "Other benign neoplasms"=sum(NBE.OTRO),
            "Neoplasms of uncertain behaviour"=sum(NCI.UNCB),
            "Iron deficiency anemia"=sum(SAN.ADFE),
            "Other anemias"=sum(SAN.AOTR),
            "Immunity disorders"=sum(SAN.INMU),
            "Other diseases of the blood and blood-forming organs"=sum(SAN.OTRA),
            "Iodine deficiency thyroid disorders"=sum(END.DEYO),
            "Thyrotoxicosis"=sum(END.TTOX),
            "Other thyroid disorders"=sum(END.TOTR),
            "Type 2 diabetes mellitus"=sum(END.DIAB),
            "Metabolism disorders and dyslipidemia"=sum(END.LIPO),
            "Obesity"=sum(END.OBES),
            "Volume depletion"=sum(END.DEPL),
            "Sequelae of hyperalimentation"=sum(END.SQHA),
            "Other endocrine and metabolic diseases"=sum(END.OTRA),
            "Kwashiorkor"=sum(NUT.KWAS),
            "Nutritional marasmus"=sum(NUT.MARA),
            "Other protein-calorie malnutrition"=sum(NUT.PROT),
            "Vitamin A deficiency"=sum(NUT.VITA),
            "Other vitamin deficiencies"=sum(NUT.VITO),
            "Sequelae of malnutrition"=sum(NUT.SECD),
            "Other nutritional deficiencies"=sum(NUT.OTRA),
            "Dementia"=sum(MEN.DEME),
            "Alcohol dependence syndrome"=sum(MEN.SDAL),
            "Other alcohol related disorders"=sum(MEN.OTAL),
            "Mental and behavioral disorders due to other psychoactive substances use"=sum(MEN.TMSP),
            "Schizophrenia, schizotypal, delusional, and other non-mood psychotic disorders"=sum(MEN.ESQU),
            "Mood [affective] disorders"=sum(MEN.HUMO),
            "Anxiety, dissociative, stress-related, somatoform and other nonpsychotic mental disorders"=sum(MEN.ESTR),
            "Behavioral syndromes associated with physiological disturbances and physical factors"=sum(MEN.FISI),
            "Intellectual disabilities"=sum(MEN.RETR),
            "Other mental and behavioral disorders"=sum(MEN.OTRO),
            "Meningitis"=sum(NER.MENI),
            "Other inflammatory diseases of the central nervous system"=sum(NER.ISNC),
            "Parkinson's disease"=sum(NER.PARK),
            "Alzheimer's disease"=sum(NER.ALZH),
            "Multiple sclerosis"=sum(NER.ESCM),
            "Cerebral palsy and other paralytic syndromes"=sum(NER.PALS),
            "Epilepsy and recurrent seizures"=sum(NER.EPIL),
            "Migraine and other headache syndromes"=sum(NER.MIGR),
            "Transient cerebral ischemic attacks and related syndromes"=sum(NER.IQCT),
            "Nerve, nerve root and plexus disorders"=sum(NER.SNPE),
            "Other diseases of the nervous system"=sum(NER.OTRA),
            "Eyelid inflammation"=sum(EYE.PARP),
            "Disorders of sclera and cornea"=sum(EYE.ESCL),
            "Glaucoma"=sum(EYE.GLAU),
            "Cataracts"=sum(EYE.CATA),
            "Other disorders of lens"=sum(EYE.CRIS),
            "Retinal detachments and breaks"=sum(EYE.RETI),
            "Blindness and low vision"=sum(EYE.CEGU),
            "Conjunctivitis"=sum(EYE.CONJ),
            "Other disorders of conjunctiva"=sum(EYE.OTCO),
            "Disorders of lacrimal system"=sum(EYE.LAGR),
            "Strabismus"=sum(EYE.ESTR),
            "Other disorders of binocular movement"=sum(EYE.BINO),
            "Disorders of refraction and accommodation"=sum(EYE.REFR),
            "Other diseases of the eye and adnexa"=sum(EYE.OTRA),
            "Otitis media, disorders of Eustachian tube and mastoiditis"=sum(EAR.OMTM),
            "Other middle ear disorders"=sum(EAR.OTOM),
            "Hearing loss"=sum(EAR.SORD),
            "Other diseases of the ear and mastoid process"=sum(EAR.OTRA),
            "Acute rheumatic fever"=sum(SC1.FIRE),
            "Chronic rheumatic heart diseases"=sum(SC1.CRHD),
            "Hypertensive heart disease"=sum(SC2.ECHI),
            "Essential (primary) hypertension"=sum(SC2.HTES),
            "Other hypertensive diseases"=sum(SC2.OTRA),
            "Acute myocardial infarction"=sum(SC3.IAMC),
            "Other ischemic heart diseases"=sum(SC3.OTRA),
            "Pulmonary embolism"=sum(SC4.EMBP),
            "Conduction disorders and arrhythmia"=sum(SC4.CARR),
            "Cardiac arrest"=sum(SC4.PARO),
            "Heart failure"=sum(SC4.HEFA),
            "Other diseases of pulmonary circulation and other heart diseases"=sum(SC4.OTRA),
            "Subarachnoid hemorrhage"=sum(SC5.HEMS),
            "Intracerebral and other intracranial hemorrhage"=sum(SC5.HEMI),
            "Cerebral infarction"=sum(SC5.ISQC),
            "Unspecified (hemorrhagic vs isquemic)"=sum(SC5.EVCN),
            "Cerebral atherosclerosis"=sum(SC5.ATSC),
            "Sequelae of cerebrovascular disease"=sum(SC5.SEQC),
            "Other cerebrovascular diseases"=sum(SC5.OTRA),
            "Atherosclerosis"=sum(SC6.ATER),
            "Other peripheral vascular diseases"=sum(SC6.OEVP),
            "Arterial embolism and thrombosis"=sum(SC6.ETAR),
            "Other diseases of arteries, arterioles and capillaries"=sum(SC6.OTAR),
            "Phlebitis, trombophlebitis, other venous embolism and thrombosis"=sum(SC6.ETVE),
            "Varicose veins of lower extremities"=sum(SC6.VARI),
            "Hemorrhoids"=sum(SC6.HMRR),
            "Other diseases of the circulatory system"=sum(SC6.OTRA),
            "Acute pharyngitis"=sum(ER1.FAAG),
            "Acute tonsillitis"=sum(ER1.TOAG),
            "Acute laryngitis and tracheitis"=sum(ER1.LTAG),
            "Other acute upper respiratory infections"=sum(ER1.OTAG),
            "Nasal polyp and deviated nasal septum"=sum(ER1.PNSD),
            "Chronic rhinitis, nasopharyngitis and pharyngitis"=sum(ER1.RNPC),
            "Chronic sinusitis"=sum(ER1.SINC),
            "Chronic diseases of tonsils and adenoids"=sum(ER1.TADC),
            "Other disorders of nose and nasal sinuses"=sum(ER1.ONSN),
            "Other acute upper respiratory infections"=sum(ER1.OTRA),
            "Acute bronchitis and bronchiolitis"=sum(ER2.BRAG),
            "Pneumonia"=sum(ER2.NEUM),
            "Influenza"=sum(ER2.INFL),
            "Chronic and unspecified bronchitis or emphysema"=sum(ER2.BCNE),
            "Asthma"=sum(ER2.ASMA),
            "Bronchiectasis"=sum(ER2.BREC),
            "Chronic obstructive pulmonary disease"=sum(ER2.EPOC),
            "Pneumoconiosis"=sum(ER2.NMCS),
            "Other pulmonary diseases due to external agents"=sum(ER2.OTAE),
            "Pleural conditions"=sum(ER2.PLEU),
            "Unspecified acute lower respiratory infection"=sum(ER2.IRIN),
            "Other respiratory tract diseases"=sum(ER2.OTRA),
            "Dental caries"=sum(SD1.CARI),
            "Other disorders of teeth and supporting structures"=sum(SD1.OTDI),
            "Other diseases of jaw"=sum(SD1.OTJA),
            "Other oral cavity and salivary glands"=sum(SD1.OTRA),
            "Diseases of esophagus"=sum(SD2.ESOF),
            "Gastritis and duodenitis"=sum(SD2.GDIS),
            "Gastric and duodenal ulcer"=sum(SD2.GDUL),
            "Other diseases of stomach and duodenum"=sum(SD2.OTGD),
            "Diseases of appendix"=sum(SD2.APEN),
            "Inguinal hernia"=sum(SD2.INHE),
            "Other hernias"=sum(SD2.OTHE),
            "Crohn's disease and ulcerative colitis"=sum(SD2.CRCU),
            "Paralytic ileus and intestinal obstruction without hernia"=sum(SD2.PIIO),
            "Diverticular disease of intestine"=sum(SD2.EDDI),
            "Irritable bowel syndrome and other functional intestinal disorders"=sum(SD2.SIIO),
            "Alcoholic liver disease"=sum(SD3.ALLD),
            "Other diseases of liver"=sum(SD3.OTLI),
            "Cholelithiasis and cholecystitis"=sum(SD3.COLE),
            "Other diseases of intestines and peritoneum"=sum(SD3.OTIP),
            "Acute pancreatitis and other diseases of pancreas"=sum(SD3.PANC),
            "Other diseases of digestive system"=sum(SD3.OTRA),
            "Infections of the skin and subcutaneous tissue"=sum(PTS.IPTS),
            "Dermatitis and eczema"=sum(PTS.DEEC),
            "Other diseases of the skin and subcutaneous tissue"=sum(PTS.OTRA),
            "Inflammatory polyarthropathies"=sum(MOC.PAIN),
            "Osteoarthritis"=sum(MOC.OSAR),
            "Acquired deformities of limbs"=sum(MOC.ADOL),
            "Other joint disorders"=sum(MOC.OTAR),
            "Systemic connective tissue disorders"=sum(MOC.SCTD),
            "Intervertebral disc disorders"=sum(MOC.IVDD),
            "Other dorsopathies"=sum(MOC.OTDO),
            "Soft tissue disorders"=sum(MOC.SOFT),
            "Disorders of bone density and structure"=sum(MOC.BONE),
            "Osteomyelitis"=sum(MOC.OMIE),
            "Other diseases of the musculoskeletal system and connective tissue"=sum(MOC.OTRA),
            "Acute and rapidly progressive nephritic syndrome"=sum(GU1.NFRI),
            "Other glomerular diseases"=sum(GU1.OTGL),
            "Acute kidney failure and chronic kidney disease"=sum(GU1.ACKF),
            "Renal tubulo-interstitial diseases"=sum(GU1.RTID),
            "Other renal tubulo-interstitial diseases"=sum(GU1.OTTU),
            "Urolithiasis"=sum(GU1.LITO),
            "Unspecified renal colic"=sum(GU1.RECO),
            "Cystitis"=sum(GU1.CIST),
            "Other diseases of urinary system"=sum(GU1.OTRA),
            "Benign prostatic hyperplasia"=sum(GU2.HIPR),
            "Other disorders of prostate"=sum(GU2.OTPR),
            "Hydrocele and spermatocele"=sum(GU2.HCEC),
            "Disorders of prepuce"=sum(GU2.PREP),
            "Male infertility"=sum(GU2.MINF),
            "Other male genital organs diseases"=sum(GU2.OTRA),
            "Disorders of breast"=sum(GU3.MAMA),
            "Salpingitis and oophoritis"=sum(GU4.SAOO),
            "Inflammatory disease of cervix uteri"=sum(GU4.IDCU),
            "Other diseases of uterus, vagina and vulva"=sum(GU4.OTVV),
            "Other female pelvic inflammatory diseases"=sum(GU4.OTPI),
            "Endometriosis"=sum(GU4.ENDM),
            "Female genital prolapse"=sum(GU4.FPRO),
            "Noninflammatory disorders of ovary, fallopian tube and broad ligament"=sum(GU4.NOFB),
            "Disorders of menstruation"=sum(GU4.MENS),
            "Menopausal and other perimenopausal disorders"=sum(GU4.MNOP),
            "Female infertility"=sum(GU4.FINF),
            "Other female genital organs diseases"=sum(GU4.OTRA),
            "Spontaneous abortion"=sum(OB1.SPON),
            "Complications following (induced) termination of pregnancy"=sum(OB1.INDU),
            "Other abortion"=sum(OB1.OTRA),
            "Edema, proteinuria and hypertensive disorders in pregnancy, childbirth and the puerperium"=sum(OB2.EPHD),
            "Hemorrhage in early pregnancy, placenta previa, abruptio placentae, antepartum hemorrhage"=sum(OB2.HEMP),
            "Maternal care related to the fetus and amniotic cavity and possible delivery problems"=sum(OB2.FACD),
            "Infections of genitourinary tract in pregnancy"=sum(OB2.IGUT),
            "Diabetes mellitus in pregnancy"=sum(OB2.DMIP),
            "Obstructed labor"=sum(OB2.OBSL),
            "Postpartum hemorrhage"=sum(OB2.PPHE),
            "Sepsis and other puerperal infections"=sum(OB2.SOPI),
            "Other complications of the puerperium"=sum(OB2.PUER),
            "Other complications of pregnancy and labor"=sum(OB2.OTPL),
            "Obstetrical tetanus"=sum(OB2.OBTE),
            "Mental and behavioral disorders associated with the puerperium"=sum(OB2.BEPU),
            "Puerperal osteomalacia"=sum(OB2.OMLC),
            "Other direct obstetric causes"=sum(OB2.OTDC),
            "Obstetric death of unspecified cause"=sum(OB2.ODUC),
            "Single spontaneous delivery"=sum(OB3.SSDE),
            "Other delivery"=sum(OB3.OTDE),
            "Indirect obstetric causes"=sum(OB4.INOC),
            "Newborn affected by maternal conditions"=sum(NEO.NAMC),
            "Newborn affected by obstetric complications"=sum(NEO.NAOC),
            "Slow fetal growth, fetal malnutrition, short gestation and low birth weight"=sum(NEO.GMGW),
            "Birth trauma"=sum(NEO.BITR),
            "Intrauterine hypoxia and birth asphyxia "=sum(NEO.HIAS),
            "Respiratory distress of newborn and other perinatal respiratory disorders"=sum(NEO.SDRN),
            "Congenital viral, bacterial and parasitic diseases"=sum(NEO.INFE),
            "Other infections specific to the perinatal period"=sum(NEO.OTIN),
            "Hemolytic disease of newborn"=sum(NEO.HDNB),
            "Tetanus neonatorum"=sum(NEO.TENE),
            "Other conditions originating in the perinatal period"=sum(NEO.OTRA),
            "Anencephaly and similar malformations"=sum(CON.ANEN),
            "Congenital hydrocephalus"=sum(CON.HIDR),
            "Spina bifida"=sum(CON.SBIF),
            "Other congenital malformations of the nervous system"=sum(CON.OTNS),
            "Congenital malformations of the circulatory system"=sum(CON.CIRC),
            "Cleft lip and cleft palate"=sum(CON.CLCP),
            "Congenital absence, atresia and stenosis of small intestine"=sum(CON.CINT),
            "Other congenital malformations of the digestive system"=sum(CON.OTDS),
            "Undescended and ectopic testicle"=sum(CON.TEST),
            "Other congenital malformations of genitourinary system"=sum(CON.OTGU),
            "Congenital deformities of hip"=sum(CON.DHIP),
            "Congenital deformities of feet"=sum(CON.FEET),
            "Other congenital malformations and deformations of the musculoskeletal system"=sum(CON.OTMS),
            "Other congenital malformations"=sum(CON.OTRA),
            "Chromosomal abnormalities, not elsewhere classified"=sum(CON.CROM),
            "Fever of other and unknown origin"=sum(NCL.FEVU),
            "Cardiac abnormalities"=sum(NCL.CAAB),
            "Retention of urine"=sum(NCL.RAOR),
            "Abdominal and pelvic pain"=sum(NCL.ABPP),
            "Age-related physical debility"=sum(NCL.ARPD),
            "Sudden infant death syndrome"=sum(NCL.SIDS),
            "Respiratory arrest"=sum(NCL.REAR),
            "Other symptoms, signs and abnormal clinical and laboratory findings"=sum(NCL.OTRA),
            "Railway accidents"=sum(EX1.RAIL),
            "Motor vehicle traffic accidents"=sum(EX1.MOTO),
            "Other land transport accidents"=sum(EX1.LAND),
            "Water transport accidents"=sum(EX1.WATE),
            "Air and space transport accidents"=sum(EX1.AIRS),
            "Other transport accidents"=sum(EX1.OTRO),
            "Falls"=sum(EX2.FALL),
            "Accidents caused by environmental factors"=sum(EX3.ENVI),
            "Accidental non-transport drowning and submersion"=sum(EX3.DROW),
            "Foreign body entering into or through eye or natural orifice"=sum(EX3.FBNO),
            "Accidents caused by machinery or sharp instruments"=sum(EX3.MACH),
            "Accidents caused by firearms and guns"=sum(EX3.FREG),
            "Sequelae of transport accidents and other accidents"=sum(EX3.SEQA),
            "Other accidents"=sum(EX3.OTRA),
            "Exposure to smoke, fire and flames"=sum(EX4.SMFF),
            "Accidental poisoning by drugs, medicaments and biological substances"=sum(EX5.APDM),
            "Accidental poisoning by other solid or liquid substances"=sum(EX5.APSL),
            "Accidental poisoning by other gases and vapours"=sum(EX5.APGV),
            "Intentional self-harm"=sum(EX6.SUIC),
            "Assault"=sum(EX7.ASSA),
            "Event of undetermined intent"=sum(EX8.EOUI),
            "Operations of war"=sum(EX8.OWAR),
            "Legal intervention"=sum(EX8.LEGI),
            "Drugs, medicaments and biological substances causing adverse effects in therapeutic use"=sum(EX9.DRUG),
            "Misadventures to patients during surgical and medical care"=sum(EX9.MSDV),
            "Sequelae of external causes of morbidity and mortality"=sum(EX9.SQEX),
            "Confirmed COVID-19"=sum(COV.CONF),
            "Suspected COVID-19"=sum(COV.SUSP))%>%
  mutate(EV_YEAR=c("2018"))

#2019
CAUSA_ESPECIFICA_2019<-mort_2019%>%
  filter(!is.na(EDAD))%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  summarise(EII.COLE=sum(EII.COLE==1,na.rm = T),
            EII.TIPA=sum(EII.TIPA==1,na.rm = T),
            EII.SHIG=sum(EII.SHIG==1,na.rm = T),
            EII.TOXI=sum(EII.TOXI==1,na.rm = T),
            EII.AMEB=sum(EII.AMEB==1,na.rm = T),
            EII.OTRA=sum(EII.OTRA==1,na.rm = T),
            EII.PRES=sum(EII.PRES==1,na.rm = T),
            TUB.PULM=sum(TUB.PULM==1,na.rm = T),
            TUB.RESP=sum(TUB.RESP==1,na.rm = T),
            TUB.NERV=sum(TUB.NERV==1,na.rm = T),
            TUB.IPGM=sum(TUB.IPGM==1,na.rm = T),
            TUB.BONE=sum(TUB.BONE==1,na.rm = T),
            TUB.URIN=sum(TUB.URIN==1,na.rm = T),
            TUB.OTRA=sum(TUB.OTRA==1,na.rm = T),
            BAC.PEST=sum(BAC.PEST==1,na.rm = T),
            BAC.BRUS=sum(BAC.BRUS==1,na.rm = T),
            BAC.LEPR=sum(BAC.LEPR==1,na.rm = T),
            BAC.DIFT=sum(BAC.DIFT==1,na.rm = T),
            BAC.PERT=sum(BAC.PERT==1,na.rm = T),
            BAC.PYOG=sum(BAC.PYOG==1,na.rm = T),
            BAC.MENI=sum(BAC.MENI==1,na.rm = T),
            BAC.TETA=sum(BAC.TETA==1,na.rm = T),
            BAC.SEPS=sum(BAC.SEPS==1,na.rm = T),
            BAC.OTRA=sum(BAC.OTRA==1,na.rm = T),
            ETS.SIF1=sum(ETS.SIF1==1,na.rm = T),
            ETS.SIF2=sum(ETS.SIF2==1,na.rm = T),
            ETS.SIF3=sum(ETS.SIF3==1,na.rm = T),
            ETS.GONO=sum(ETS.GONO==1,na.rm = T),
            ETS.CLAM=sum(ETS.CLAM==1,na.rm = T),
            ETS.OTRA=sum(ETS.OTRA==1,na.rm = T),
            VIR.POLI=sum(VIR.POLI==1,na.rm = T),
            VIR.VIRU=sum(VIR.VIRU==1,na.rm = T),
            VIR.SARA=sum(VIR.SARA==1,na.rm = T),
            VIR.RUBE=sum(VIR.RUBE==1,na.rm = T),
            VIR.FIAM=sum(VIR.FIAM==1,na.rm = T),
            VIR.DENG=sum(VIR.DENG==1,na.rm = T),
            VIR.DHEM=sum(VIR.DHEM==1,na.rm = T),
            VIR.VIH1=sum(VIR.VIH1==1,na.rm = T),
            VIR.EVTA=sum(VIR.EVTA==1,na.rm = T),
            VIR.HEPB=sum(VIR.HEPB==1,na.rm = T),
            VIR.HEPO=sum(VIR.HEPO==1,na.rm = T),
            VIR.RABI=sum(VIR.RABI==1,na.rm = T),
            VIR.TRAC=sum(VIR.TRAC==1,na.rm = T),
            VIR.OFAH=sum(VIR.OFAH==1,na.rm = T),
            VIR.HERP=sum(VIR.HERP==1,na.rm = T),
            VIR.VRHZ=sum(VIR.VRHZ==1,na.rm = T),
            VIR.PARO=sum(VIR.PARO==1,na.rm = T),
            VIR.OCLA=sum(VIR.OCLA==1,na.rm = T),
            VIR.OTRA=sum(VIR.OTRA==1,na.rm = T),
            RPI.TIFP=sum(RPI.TIFP==1,na.rm = T),
            RPI.OTIF=sum(RPI.OTIF==1,na.rm = T),
            RPI.ORIC=sum(RPI.ORIC==1,na.rm = T),
            RPI.PALU=sum(RPI.PALU==1,na.rm = T),
            RPI.LEIS=sum(RPI.LEIS==1,na.rm = T),
            RPI.TRIP=sum(RPI.TRIP==1,na.rm = T),
            PMO.ESPI=sum(PMO.ESPI==1,na.rm = T),
            PMO.FIRE=sum(PMO.FIRE==1,na.rm = T),
            PMO.MICO=sum(PMO.MICO==1,na.rm = T),
            PMO.SCHI=sum(PMO.SCHI==1,na.rm = T),
            PMO.TREM=sum(PMO.TREM==1,na.rm = T),
            PMO.ECHI=sum(PMO.ECHI==1,na.rm = T),
            PMO.DRAC=sum(PMO.DRAC==1,na.rm = T),
            PMO.ONCH=sum(PMO.ONCH==1,na.rm = T),
            PMO.FILA=sum(PMO.FILA==1,na.rm = T),
            PMO.ANNE=sum(PMO.ANNE==1,na.rm = T),
            PMO.HELM=sum(PMO.HELM==1,na.rm = T),
            PMO.OTRA=sum(PMO.OTRA==1,na.rm = T),
            SEI.TUBE=sum(SEI.TUBE==1,na.rm = T),
            SEI.POLI=sum(SEI.POLI==1,na.rm = T),
            SEI.LEPR=sum(SEI.LEPR==1,na.rm = T),
            SEI.OTRA=sum(SEI.OTRA==1,na.rm = T),
            NM1.LCBF=sum(NM1.LCBF==1,na.rm = T),
            NM2.ESOF=sum(NM2.ESOF==1,na.rm = T),
            NM2.STOM=sum(NM2.STOM==1,na.rm = T),
            NM2.INDE=sum(NM2.INDE==1,na.rm = T),
            NM2.COLO=sum(NM2.COLO==1,na.rm = T),
            NM2.RECT=sum(NM2.RECT==1,na.rm = T),
            NM2.HIGA=sum(NM2.HIGA==1,na.rm = T),
            NM2.PANC=sum(NM2.PANC==1,na.rm = T),
            NM2.OTRO=sum(NM2.OTRO==1,na.rm = T),
            NM3.LARI=sum(NM3.LARI==1,na.rm = T),
            NM3.TBPU=sum(NM3.TBPU==1,na.rm = T),
            NM3.OTRO=sum(NM3.OTRO==1,na.rm = T),
            NM4.BONE=sum(NM4.BONE==1,na.rm = T),
            NM4.MELA=sum(NM4.MELA==1,na.rm = T),
            NM4.SKIN=sum(NM4.SKIN==1,na.rm = T),
            NM4.MAMA=sum(NM4.MAMA==1,na.rm = T),
            NM4.SOFT=sum(NM4.SOFT==1,na.rm = T),
            NM5.CERV=sum(NM5.CERV==1,na.rm = T),
            NM5.PLAC=sum(NM5.PLAC==1,na.rm = T),
            NM5.UTER=sum(NM5.UTER==1,na.rm = T),
            NM5.OVAR=sum(NM5.OVAR==1,na.rm = T),
            NM5.VAGI=sum(NM5.VAGI==1,na.rm = T),
            NM5.OTFE=sum(NM5.OTFE==1,na.rm = T),
            NM5.PROS=sum(NM5.PROS==1,na.rm = T),
            NM5.TEST=sum(NM5.TEST==1,na.rm = T),
            NM5.OTMA=sum(NM5.OTMA==1,na.rm = T),
            NM5.VEJI=sum(NM5.VEJI==1,na.rm = T),
            NM5.OTUR=sum(NM5.OTUR==1,na.rm = T),
            NM6.ENCF=sum(NM6.ENCF==1,na.rm = T),
            NM6.MENI=sum(NM6.MENI==1,na.rm = T),
            NM6.OJOA=sum(NM6.OJOA==1,na.rm = T),
            NM6.OTRO=sum(NM6.OTRO==1,na.rm = T),
            NM7.ENHO=sum(NM7.ENHO==1,na.rm = T),
            NM7.NOHO=sum(NM7.NOHO==1,na.rm = T),
            NM7.MMCP=sum(NM7.MMCP==1,na.rm = T),
            NM7.LEUC=sum(NM7.LEUC==1,na.rm = T),
            NM7.OTRO=sum(NM7.OTRO==1,na.rm = T),
            NM8.MUPT=sum(NM8.MUPT==1,na.rm = T),
            NIS.CERV=sum(NIS.CERV==1,na.rm = T),
            NIS.OTRO=sum(NIS.OTRO==1,na.rm = T),
            NBE.SKIN=sum(NBE.SKIN==1,na.rm = T),
            NBE.MAMA=sum(NBE.MAMA==1,na.rm = T),
            NBE.LEIO=sum(NBE.LEIO==1,na.rm = T),
            NBE.OVAR=sum(NBE.OVAR==1,na.rm = T),
            NBE.URIN=sum(NBE.URIN==1,na.rm = T),
            NBE.CSNC=sum(NBE.CSNC==1,na.rm = T),
            NBE.TIRO=sum(NBE.TIRO==1,na.rm = T),
            NBE.OTRO=sum(NBE.OTRO==1,na.rm = T),
            NCI.UNCB=sum(NCI.UNCB==1,na.rm = T),
            SAN.ADFE=sum(SAN.ADFE==1,na.rm = T),
            SAN.AOTR=sum(SAN.AOTR==1,na.rm = T),
            SAN.INMU=sum(SAN.INMU==1,na.rm = T),
            SAN.OTRA=sum(SAN.OTRA==1,na.rm = T),
            END.DEYO=sum(END.DEYO==1,na.rm = T),
            END.TTOX=sum(END.TTOX==1,na.rm = T),
            END.TOTR=sum(END.TOTR==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            END.LIPO=sum(END.LIPO==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T),
            END.DEPL=sum(END.DEPL==1,na.rm = T),
            END.SQHA=sum(END.SQHA==1,na.rm = T),
            END.OTRA=sum(END.OTRA==1,na.rm = T),
            NUT.KWAS=sum(NUT.KWAS==1,na.rm = T),
            NUT.MARA=sum(NUT.MARA==1,na.rm = T),
            NUT.PROT=sum(NUT.PROT==1,na.rm = T),
            NUT.VITA=sum(NUT.VITA==1,na.rm = T),
            NUT.VITO=sum(NUT.VITO==1,na.rm = T),
            NUT.SECD=sum(NUT.SECD==1,na.rm = T),
            NUT.OTRA=sum(NUT.OTRA==1,na.rm = T),
            MEN.DEME=sum(MEN.DEME==1,na.rm = T),
            MEN.SDAL=sum(MEN.SDAL==1,na.rm = T),
            MEN.OTAL=sum(MEN.OTAL==1,na.rm = T),
            MEN.TMSP=sum(MEN.TMSP==1,na.rm = T),
            MEN.ESQU=sum(MEN.ESQU==1,na.rm = T),
            MEN.HUMO=sum(MEN.HUMO==1,na.rm = T),
            MEN.ESTR=sum(MEN.ESTR==1,na.rm = T),
            MEN.FISI=sum(MEN.FISI==1,na.rm = T),
            MEN.RETR=sum(MEN.RETR==1,na.rm = T),
            MEN.OTRO=sum(MEN.OTRO==1,na.rm = T),
            NER.MENI=sum(NER.MENI==1,na.rm = T),
            NER.ISNC=sum(NER.ISNC==1,na.rm = T),
            NER.PARK=sum(NER.PARK==1,na.rm = T),
            NER.ALZH=sum(NER.ALZH==1,na.rm = T),
            NER.ESCM=sum(NER.ESCM==1,na.rm = T),
            NER.PALS=sum(NER.PALS==1,na.rm = T),
            NER.EPIL=sum(NER.EPIL==1,na.rm = T),
            NER.MIGR=sum(NER.MIGR==1,na.rm = T),
            NER.IQCT=sum(NER.IQCT==1,na.rm = T),
            NER.SNPE=sum(NER.SNPE==1,na.rm = T),
            NER.OTRA=sum(NER.OTRA==1,na.rm = T),
            EYE.PARP=sum(EYE.PARP==1,na.rm = T),
            EYE.ESCL=sum(EYE.ESCL==1,na.rm = T),
            EYE.GLAU=sum(EYE.GLAU==1,na.rm = T),
            EYE.CATA=sum(EYE.CATA==1,na.rm = T),
            EYE.CRIS=sum(EYE.CRIS==1,na.rm = T),
            EYE.RETI=sum(EYE.RETI==1,na.rm = T),
            EYE.CEGU=sum(EYE.CEGU==1,na.rm = T),
            EYE.CONJ=sum(EYE.CONJ==1,na.rm = T),
            EYE.OTCO=sum(EYE.OTCO==1,na.rm = T),
            EYE.LAGR=sum(EYE.LAGR==1,na.rm = T),
            EYE.ESTR=sum(EYE.ESTR==1,na.rm = T),
            EYE.BINO=sum(EYE.BINO==1,na.rm = T),
            EYE.REFR=sum(EYE.REFR==1,na.rm = T),
            EYE.OTRA=sum(EYE.OTRA==1,na.rm = T),
            EAR.OMTM=sum(EAR.OMTM==1,na.rm = T),
            EAR.OTOM=sum(EAR.OTOM==1,na.rm = T),
            EAR.SORD=sum(EAR.SORD==1,na.rm = T),
            EAR.OTRA=sum(EAR.OTRA==1,na.rm = T),
            SC1.FIRE=sum(SC1.FIRE==1,na.rm = T),
            SC1.CRHD=sum(SC1.CRHD==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            SC4.EMBP=sum(SC4.EMBP==1,na.rm = T),
            SC4.CARR=sum(SC4.CARR==1,na.rm = T),
            SC4.PARO=sum(SC4.PARO==1,na.rm = T),
            SC4.HEFA=sum(SC4.HEFA==1,na.rm = T),
            SC4.OTRA=sum(SC4.OTRA==1,na.rm = T),
            SC5.HEMS=sum(SC5.HEMS==1,na.rm = T),
            SC5.HEMI=sum(SC5.HEMI==1,na.rm = T),
            SC5.ISQC=sum(SC5.ISQC==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC5.ATSC=sum(SC5.ATSC==1,na.rm = T),
            SC5.SEQC=sum(SC5.SEQC==1,na.rm = T),
            SC5.OTRA=sum(SC5.OTRA==1,na.rm = T),
            SC6.ATER=sum(SC6.ATER==1,na.rm = T),
            SC6.OEVP=sum(SC6.OEVP==1,na.rm = T),
            SC6.ETAR=sum(SC6.ETAR==1,na.rm = T),
            SC6.OTAR=sum(SC6.OTAR==1,na.rm = T),
            SC6.ETVE=sum(SC6.ETVE==1,na.rm = T),
            SC6.VARI=sum(SC6.VARI==1,na.rm = T),
            SC6.HMRR=sum(SC6.HMRR==1,na.rm = T),
            SC6.OTRA=sum(SC6.OTRA==1,na.rm = T),
            ER1.FAAG=sum(ER1.FAAG==1,na.rm = T),
            ER1.TOAG=sum(ER1.TOAG==1,na.rm = T),
            ER1.LTAG=sum(ER1.LTAG==1,na.rm = T),
            ER1.OTAG=sum(ER1.OTAG==1,na.rm = T),
            ER1.PNSD=sum(ER1.PNSD==1,na.rm = T),
            ER1.RNPC=sum(ER1.RNPC==1,na.rm = T),
            ER1.SINC=sum(ER1.SINC==1,na.rm = T),
            ER1.TADC=sum(ER1.TADC==1,na.rm = T),
            ER1.ONSN=sum(ER1.ONSN==1,na.rm = T),
            ER1.OTRA=sum(ER1.OTRA==1,na.rm = T),
            ER2.BRAG=sum(ER2.BRAG==1,na.rm = T),
            ER2.NEUM=sum(ER2.NEUM==1,na.rm = T),
            ER2.INFL=sum(ER2.INFL==1,na.rm = T),
            ER2.BCNE=sum(ER2.BCNE==1,na.rm = T),
            ER2.ASMA=sum(ER2.ASMA==1,na.rm = T),
            ER2.BREC=sum(ER2.BREC==1,na.rm = T),
            ER2.EPOC=sum(ER2.EPOC==1,na.rm = T),
            ER2.NMCS=sum(ER2.NMCS==1,na.rm = T),
            ER2.OTAE=sum(ER2.OTAE==1,na.rm = T),
            ER2.PLEU=sum(ER2.PLEU==1,na.rm = T),
            ER2.IRIN=sum(ER2.IRIN==1,na.rm = T),
            ER2.OTRA=sum(ER2.OTRA==1,na.rm = T),
            SD1.CARI=sum(SD1.CARI==1,na.rm = T),
            SD1.OTDI=sum(SD1.OTDI==1,na.rm = T),
            SD1.OTJA=sum(SD1.OTJA==1,na.rm = T),
            SD1.OTRA=sum(SD1.OTRA==1,na.rm = T),
            SD2.ESOF=sum(SD2.ESOF==1,na.rm = T),
            SD2.GDIS=sum(SD2.GDIS==1,na.rm = T),
            SD2.GDUL=sum(SD2.GDUL==1,na.rm = T),
            SD2.OTGD=sum(SD2.OTGD==1,na.rm = T),
            SD2.APEN=sum(SD2.APEN==1,na.rm = T),
            SD2.INHE=sum(SD2.INHE==1,na.rm = T),
            SD2.OTHE=sum(SD2.OTHE==1,na.rm = T),
            SD2.CRCU=sum(SD2.CRCU==1,na.rm = T),
            SD2.PIIO=sum(SD2.PIIO==1,na.rm = T),
            SD2.EDDI=sum(SD2.EDDI==1,na.rm = T),
            SD2.SIIO=sum(SD2.SIIO==1,na.rm = T),
            SD3.ALLD=sum(SD3.ALLD==1,na.rm = T),
            SD3.OTLI=sum(SD3.OTLI==1,na.rm = T),
            SD3.COLE=sum(SD3.COLE==1,na.rm = T),
            SD3.OTIP=sum(SD3.OTIP==1,na.rm = T),
            SD3.PANC=sum(SD3.PANC==1,na.rm = T),
            SD3.OTRA=sum(SD3.OTRA==1,na.rm = T),
            PTS.IPTS=sum(PTS.IPTS==1,na.rm = T),
            PTS.DEEC=sum(PTS.DEEC==1,na.rm = T),
            PTS.OTRA=sum(PTS.OTRA==1,na.rm = T),
            MOC.PAIN=sum(MOC.PAIN==1,na.rm = T),
            MOC.OSAR=sum(MOC.OSAR==1,na.rm = T),
            MOC.ADOL=sum(MOC.ADOL==1,na.rm = T),
            MOC.OTAR=sum(MOC.OTAR==1,na.rm = T),
            MOC.SCTD=sum(MOC.SCTD==1,na.rm = T),
            MOC.IVDD=sum(MOC.IVDD==1,na.rm = T),
            MOC.OTDO=sum(MOC.OTDO==1,na.rm = T),
            MOC.SOFT=sum(MOC.SOFT==1,na.rm = T),
            MOC.BONE=sum(MOC.BONE==1,na.rm = T),
            MOC.OMIE=sum(MOC.OMIE==1,na.rm = T),
            MOC.OTRA=sum(MOC.OTRA==1,na.rm = T),
            GU1.NFRI=sum(GU1.NFRI==1,na.rm = T),
            GU1.OTGL=sum(GU1.OTGL==1,na.rm = T),
            GU1.ACKF=sum(GU1.ACKF==1,na.rm = T),
            GU1.RTID=sum(GU1.RTID==1,na.rm = T),
            GU1.OTTU=sum(GU1.OTTU==1,na.rm = T),
            GU1.LITO=sum(GU1.LITO==1,na.rm = T),
            GU1.RECO=sum(GU1.RECO==1,na.rm = T),
            GU1.CIST=sum(GU1.CIST==1,na.rm = T),
            GU1.OTRA=sum(GU1.OTRA==1,na.rm = T),
            GU2.HIPR=sum(GU2.HIPR==1,na.rm = T),
            GU2.OTPR=sum(GU2.OTPR==1,na.rm = T),
            GU2.HCEC=sum(GU2.HCEC==1,na.rm = T),
            GU2.PREP=sum(GU2.PREP==1,na.rm = T),
            GU2.MINF=sum(GU2.MINF==1,na.rm = T),
            GU2.OTRA=sum(GU2.OTRA==1,na.rm = T),
            GU3.MAMA=sum(GU3.MAMA==1,na.rm = T),
            GU4.SAOO=sum(GU4.SAOO==1,na.rm = T),
            GU4.IDCU=sum(GU4.IDCU==1,na.rm = T),
            GU4.OTVV=sum(GU4.OTVV==1,na.rm = T),
            GU4.OTPI=sum(GU4.OTPI==1,na.rm = T),
            GU4.ENDM=sum(GU4.ENDM==1,na.rm = T),
            GU4.FPRO=sum(GU4.FPRO==1,na.rm = T),
            GU4.NOFB=sum(GU4.NOFB==1,na.rm = T),
            GU4.MENS=sum(GU4.MENS==1,na.rm = T),
            GU4.MNOP=sum(GU4.MNOP==1,na.rm = T),
            GU4.FINF=sum(GU4.FINF==1,na.rm = T),
            GU4.OTRA=sum(GU4.OTRA==1,na.rm = T),
            OB1.SPON=sum(OB1.SPON==1,na.rm = T),
            OB1.INDU=sum(OB1.INDU==1,na.rm = T),
            OB1.OTRA=sum(OB1.OTRA==1,na.rm = T),
            OB2.EPHD=sum(OB2.EPHD==1,na.rm = T),
            OB2.HEMP=sum(OB2.HEMP==1,na.rm = T),
            OB2.FACD=sum(OB2.FACD==1,na.rm = T),
            OB2.IGUT=sum(OB2.IGUT==1,na.rm = T),
            OB2.DMIP=sum(OB2.DMIP==1,na.rm = T),
            OB2.OBSL=sum(OB2.OBSL==1,na.rm = T),
            OB2.PPHE=sum(OB2.PPHE==1,na.rm = T),
            OB2.SOPI=sum(OB2.SOPI==1,na.rm = T),
            OB2.PUER=sum(OB2.PUER==1,na.rm = T),
            OB2.OTPL=sum(OB2.OTPL==1,na.rm = T),
            OB2.OBTE=sum(OB2.OBTE==1,na.rm = T),
            OB2.BEPU=sum(OB2.BEPU==1,na.rm = T),
            OB2.OMLC=sum(OB2.OMLC==1,na.rm = T),
            OB2.OTDC=sum(OB2.OTDC==1,na.rm = T),
            OB2.ODUC=sum(OB2.ODUC==1,na.rm = T),
            OB3.SSDE=sum(OB3.SSDE==1,na.rm = T),
            OB3.OTDE=sum(OB3.OTDE==1,na.rm = T),
            OB4.INOC=sum(OB4.INOC==1,na.rm = T),
            NEO.NAMC=sum(NEO.NAMC==1,na.rm = T),
            NEO.NAOC=sum(NEO.NAOC==1,na.rm = T),
            NEO.GMGW=sum(NEO.GMGW==1,na.rm = T),
            NEO.BITR=sum(NEO.BITR==1,na.rm = T),
            NEO.HIAS=sum(NEO.HIAS==1,na.rm = T),
            NEO.SDRN=sum(NEO.SDRN==1,na.rm = T),
            NEO.INFE=sum(NEO.INFE==1,na.rm = T),
            NEO.OTIN=sum(NEO.OTIN==1,na.rm = T),
            NEO.HDNB=sum(NEO.HDNB==1,na.rm = T),
            NEO.TENE=sum(NEO.TENE==1,na.rm = T),
            NEO.OTRA=sum(NEO.OTRA==1,na.rm = T),
            CON.ANEN=sum(CON.ANEN==1,na.rm = T),
            CON.HIDR=sum(CON.HIDR==1,na.rm = T),
            CON.SBIF=sum(CON.SBIF==1,na.rm = T),
            CON.OTNS=sum(CON.OTNS==1,na.rm = T),
            CON.CIRC=sum(CON.CIRC==1,na.rm = T),
            CON.CLCP=sum(CON.CLCP==1,na.rm = T),
            CON.CINT=sum(CON.CINT==1,na.rm = T),
            CON.OTDS=sum(CON.OTDS==1,na.rm = T),
            CON.TEST=sum(CON.TEST==1,na.rm = T),
            CON.OTGU=sum(CON.OTGU==1,na.rm = T),
            CON.DHIP=sum(CON.DHIP==1,na.rm = T),
            CON.FEET=sum(CON.FEET==1,na.rm = T),
            CON.OTMS=sum(CON.OTMS==1,na.rm = T),
            CON.OTRA=sum(CON.OTRA==1,na.rm = T),
            CON.CROM=sum(CON.CROM==1,na.rm = T),
            NCL.FEVU=sum(NCL.FEVU==1,na.rm = T),
            NCL.CAAB=sum(NCL.CAAB==1,na.rm = T),
            NCL.RAOR=sum(NCL.RAOR==1,na.rm = T),
            NCL.ABPP=sum(NCL.ABPP==1,na.rm = T),
            NCL.ARPD=sum(NCL.ARPD==1,na.rm = T),
            NCL.SIDS=sum(NCL.SIDS==1,na.rm = T),
            NCL.REAR=sum(NCL.REAR==1,na.rm = T),
            NCL.OTRA=sum(NCL.OTRA==1,na.rm = T),
            EX1.RAIL=sum(EX1.RAIL==1,na.rm = T),
            EX1.MOTO=sum(EX1.MOTO==1,na.rm = T),
            EX1.LAND=sum(EX1.LAND==1,na.rm = T),
            EX1.WATE=sum(EX1.WATE==1,na.rm = T),
            EX1.AIRS=sum(EX1.AIRS==1,na.rm = T),
            EX1.OTRO=sum(EX1.OTRO==1,na.rm = T),
            EX2.FALL=sum(EX2.FALL==1,na.rm = T),
            EX3.ENVI=sum(EX3.ENVI==1,na.rm = T),
            EX3.DROW=sum(EX3.DROW==1,na.rm = T),
            EX3.FBNO=sum(EX3.FBNO==1,na.rm = T),
            EX3.MACH=sum(EX3.MACH==1,na.rm = T),
            EX3.FREG=sum(EX3.FREG==1,na.rm = T),
            EX3.SEQA=sum(EX3.SEQA==1,na.rm = T),
            EX3.OTRA=sum(EX3.OTRA==1,na.rm = T),
            EX4.SMFF=sum(EX4.SMFF==1,na.rm = T),
            EX5.APDM=sum(EX5.APDM==1,na.rm = T),
            EX5.APSL=sum(EX5.APSL==1,na.rm = T),
            EX5.APGV=sum(EX5.APGV==1,na.rm = T),
            EX6.SUIC=sum(EX6.SUIC==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            EX8.EOUI=sum(EX8.EOUI==1,na.rm = T),
            EX8.OWAR=sum(EX8.OWAR==1,na.rm = T),
            EX8.LEGI=sum(EX8.LEGI==1,na.rm = T),
            EX9.DRUG=sum(EX9.DRUG==1,na.rm = T),
            EX9.MSDV=sum(EX9.MSDV==1,na.rm = T),
            EX9.SQEX=sum(EX9.SQEX==1,na.rm = T),
            COV.CONF=sum(COV.CONF==1,na.rm = T),
            COV.SUSP=sum(COV.SUSP==1,na.rm = T),
  )%>%
  left_join(Pob_edad_2019_entidad_total,by="EDAD_QUIN")%>%
  summarise(EII.COLE=(EII.COLE/POB)*Weight*100000,
            EII.TIPA=(EII.TIPA/POB)*Weight*100000,
            EII.SHIG=(EII.SHIG/POB)*Weight*100000,
            EII.TOXI=(EII.TOXI/POB)*Weight*100000,
            EII.AMEB=(EII.AMEB/POB)*Weight*100000,
            EII.OTRA=(EII.OTRA/POB)*Weight*100000,
            EII.PRES=(EII.PRES/POB)*Weight*100000,
            TUB.PULM=(TUB.PULM/POB)*Weight*100000,
            TUB.RESP=(TUB.RESP/POB)*Weight*100000,
            TUB.NERV=(TUB.NERV/POB)*Weight*100000,
            TUB.IPGM=(TUB.IPGM/POB)*Weight*100000,
            TUB.BONE=(TUB.BONE/POB)*Weight*100000,
            TUB.URIN=(TUB.URIN/POB)*Weight*100000,
            TUB.OTRA=(TUB.OTRA/POB)*Weight*100000,
            BAC.PEST=(BAC.PEST/POB)*Weight*100000,
            BAC.BRUS=(BAC.BRUS/POB)*Weight*100000,
            BAC.LEPR=(BAC.LEPR/POB)*Weight*100000,
            BAC.DIFT=(BAC.DIFT/POB)*Weight*100000,
            BAC.PERT=(BAC.PERT/POB)*Weight*100000,
            BAC.PYOG=(BAC.PYOG/POB)*Weight*100000,
            BAC.MENI=(BAC.MENI/POB)*Weight*100000,
            BAC.TETA=(BAC.TETA/POB)*Weight*100000,
            BAC.SEPS=(BAC.SEPS/POB)*Weight*100000,
            BAC.OTRA=(BAC.OTRA/POB)*Weight*100000,
            ETS.SIF1=(ETS.SIF1/POB)*Weight*100000,
            ETS.SIF2=(ETS.SIF2/POB)*Weight*100000,
            ETS.SIF3=(ETS.SIF3/POB)*Weight*100000,
            ETS.GONO=(ETS.GONO/POB)*Weight*100000,
            ETS.CLAM=(ETS.CLAM/POB)*Weight*100000,
            ETS.OTRA=(ETS.OTRA/POB)*Weight*100000,
            VIR.POLI=(VIR.POLI/POB)*Weight*100000,
            VIR.VIRU=(VIR.VIRU/POB)*Weight*100000,
            VIR.SARA=(VIR.SARA/POB)*Weight*100000,
            VIR.RUBE=(VIR.RUBE/POB)*Weight*100000,
            VIR.FIAM=(VIR.FIAM/POB)*Weight*100000,
            VIR.DENG=(VIR.DENG/POB)*Weight*100000,
            VIR.DHEM=(VIR.DHEM/POB)*Weight*100000,
            VIR.VIH1=(VIR.VIH1/POB)*Weight*100000,
            VIR.EVTA=(VIR.EVTA/POB)*Weight*100000,
            VIR.HEPB=(VIR.HEPB/POB)*Weight*100000,
            VIR.HEPO=(VIR.HEPO/POB)*Weight*100000,
            VIR.RABI=(VIR.RABI/POB)*Weight*100000,
            VIR.TRAC=(VIR.TRAC/POB)*Weight*100000,
            VIR.OFAH=(VIR.OFAH/POB)*Weight*100000,
            VIR.HERP=(VIR.HERP/POB)*Weight*100000,
            VIR.VRHZ=(VIR.VRHZ/POB)*Weight*100000,
            VIR.PARO=(VIR.PARO/POB)*Weight*100000,
            VIR.OCLA=(VIR.OCLA/POB)*Weight*100000,
            VIR.OTRA=(VIR.OTRA/POB)*Weight*100000,
            RPI.TIFP=(RPI.TIFP/POB)*Weight*100000,
            RPI.OTIF=(RPI.OTIF/POB)*Weight*100000,
            RPI.ORIC=(RPI.ORIC/POB)*Weight*100000,
            RPI.PALU=(RPI.PALU/POB)*Weight*100000,
            RPI.LEIS=(RPI.LEIS/POB)*Weight*100000,
            RPI.TRIP=(RPI.TRIP/POB)*Weight*100000,
            PMO.ESPI=(PMO.ESPI/POB)*Weight*100000,
            PMO.FIRE=(PMO.FIRE/POB)*Weight*100000,
            PMO.MICO=(PMO.MICO/POB)*Weight*100000,
            PMO.SCHI=(PMO.SCHI/POB)*Weight*100000,
            PMO.TREM=(PMO.TREM/POB)*Weight*100000,
            PMO.ECHI=(PMO.ECHI/POB)*Weight*100000,
            PMO.DRAC=(PMO.DRAC/POB)*Weight*100000,
            PMO.ONCH=(PMO.ONCH/POB)*Weight*100000,
            PMO.FILA=(PMO.FILA/POB)*Weight*100000,
            PMO.ANNE=(PMO.ANNE/POB)*Weight*100000,
            PMO.HELM=(PMO.HELM/POB)*Weight*100000,
            PMO.OTRA=(PMO.OTRA/POB)*Weight*100000,
            SEI.TUBE=(SEI.TUBE/POB)*Weight*100000,
            SEI.POLI=(SEI.POLI/POB)*Weight*100000,
            SEI.LEPR=(SEI.LEPR/POB)*Weight*100000,
            SEI.OTRA=(SEI.OTRA/POB)*Weight*100000,
            NM1.LCBF=(NM1.LCBF/POB)*Weight*100000,
            NM2.ESOF=(NM2.ESOF/POB)*Weight*100000,
            NM2.STOM=(NM2.STOM/POB)*Weight*100000,
            NM2.INDE=(NM2.INDE/POB)*Weight*100000,
            NM2.COLO=(NM2.COLO/POB)*Weight*100000,
            NM2.RECT=(NM2.RECT/POB)*Weight*100000,
            NM2.HIGA=(NM2.HIGA/POB)*Weight*100000,
            NM2.PANC=(NM2.PANC/POB)*Weight*100000,
            NM2.OTRO=(NM2.OTRO/POB)*Weight*100000,
            NM3.LARI=(NM3.LARI/POB)*Weight*100000,
            NM3.TBPU=(NM3.TBPU/POB)*Weight*100000,
            NM3.OTRO=(NM3.OTRO/POB)*Weight*100000,
            NM4.BONE=(NM4.BONE/POB)*Weight*100000,
            NM4.MELA=(NM4.MELA/POB)*Weight*100000,
            NM4.SKIN=(NM4.SKIN/POB)*Weight*100000,
            NM4.MAMA=(NM4.MAMA/POB)*Weight*100000,
            NM4.SOFT=(NM4.SOFT/POB)*Weight*100000,
            NM5.CERV=(NM5.CERV/POB)*Weight*100000,
            NM5.PLAC=(NM5.PLAC/POB)*Weight*100000,
            NM5.UTER=(NM5.UTER/POB)*Weight*100000,
            NM5.OVAR=(NM5.OVAR/POB)*Weight*100000,
            NM5.VAGI=(NM5.VAGI/POB)*Weight*100000,
            NM5.OTFE=(NM5.OTFE/POB)*Weight*100000,
            NM5.PROS=(NM5.PROS/POB)*Weight*100000,
            NM5.TEST=(NM5.TEST/POB)*Weight*100000,
            NM5.OTMA=(NM5.OTMA/POB)*Weight*100000,
            NM5.VEJI=(NM5.VEJI/POB)*Weight*100000,
            NM5.OTUR=(NM5.OTUR/POB)*Weight*100000,
            NM6.ENCF=(NM6.ENCF/POB)*Weight*100000,
            NM6.MENI=(NM6.MENI/POB)*Weight*100000,
            NM6.OJOA=(NM6.OJOA/POB)*Weight*100000,
            NM6.OTRO=(NM6.OTRO/POB)*Weight*100000,
            NM7.ENHO=(NM7.ENHO/POB)*Weight*100000,
            NM7.NOHO=(NM7.NOHO/POB)*Weight*100000,
            NM7.MMCP=(NM7.MMCP/POB)*Weight*100000,
            NM7.LEUC=(NM7.LEUC/POB)*Weight*100000,
            NM7.OTRO=(NM7.OTRO/POB)*Weight*100000,
            NM8.MUPT=(NM8.MUPT/POB)*Weight*100000,
            NIS.CERV=(NIS.CERV/POB)*Weight*100000,
            NIS.OTRO=(NIS.OTRO/POB)*Weight*100000,
            NBE.SKIN=(NBE.SKIN/POB)*Weight*100000,
            NBE.MAMA=(NBE.MAMA/POB)*Weight*100000,
            NBE.LEIO=(NBE.LEIO/POB)*Weight*100000,
            NBE.OVAR=(NBE.OVAR/POB)*Weight*100000,
            NBE.URIN=(NBE.URIN/POB)*Weight*100000,
            NBE.CSNC=(NBE.CSNC/POB)*Weight*100000,
            NBE.TIRO=(NBE.TIRO/POB)*Weight*100000,
            NBE.OTRO=(NBE.OTRO/POB)*Weight*100000,
            NCI.UNCB=(NCI.UNCB/POB)*Weight*100000,
            SAN.ADFE=(SAN.ADFE/POB)*Weight*100000,
            SAN.AOTR=(SAN.AOTR/POB)*Weight*100000,
            SAN.INMU=(SAN.INMU/POB)*Weight*100000,
            SAN.OTRA=(SAN.OTRA/POB)*Weight*100000,
            END.DEYO=(END.DEYO/POB)*Weight*100000,
            END.TTOX=(END.TTOX/POB)*Weight*100000,
            END.TOTR=(END.TOTR/POB)*Weight*100000,
            END.DIAB=(END.DIAB/POB)*Weight*100000,
            END.LIPO=(END.LIPO/POB)*Weight*100000,
            END.OBES=(END.OBES/POB)*Weight*100000,
            END.DEPL=(END.DEPL/POB)*Weight*100000,
            END.SQHA=(END.SQHA/POB)*Weight*100000,
            END.OTRA=(END.OTRA/POB)*Weight*100000,
            NUT.KWAS=(NUT.KWAS/POB)*Weight*100000,
            NUT.MARA=(NUT.MARA/POB)*Weight*100000,
            NUT.PROT=(NUT.PROT/POB)*Weight*100000,
            NUT.VITA=(NUT.VITA/POB)*Weight*100000,
            NUT.VITO=(NUT.VITO/POB)*Weight*100000,
            NUT.SECD=(NUT.SECD/POB)*Weight*100000,
            NUT.OTRA=(NUT.OTRA/POB)*Weight*100000,
            MEN.DEME=(MEN.DEME/POB)*Weight*100000,
            MEN.SDAL=(MEN.SDAL/POB)*Weight*100000,
            MEN.OTAL=(MEN.OTAL/POB)*Weight*100000,
            MEN.TMSP=(MEN.TMSP/POB)*Weight*100000,
            MEN.ESQU=(MEN.ESQU/POB)*Weight*100000,
            MEN.HUMO=(MEN.HUMO/POB)*Weight*100000,
            MEN.ESTR=(MEN.ESTR/POB)*Weight*100000,
            MEN.FISI=(MEN.FISI/POB)*Weight*100000,
            MEN.RETR=(MEN.RETR/POB)*Weight*100000,
            MEN.OTRO=(MEN.OTRO/POB)*Weight*100000,
            NER.MENI=(NER.MENI/POB)*Weight*100000,
            NER.ISNC=(NER.ISNC/POB)*Weight*100000,
            NER.PARK=(NER.PARK/POB)*Weight*100000,
            NER.ALZH=(NER.ALZH/POB)*Weight*100000,
            NER.ESCM=(NER.ESCM/POB)*Weight*100000,
            NER.PALS=(NER.PALS/POB)*Weight*100000,
            NER.EPIL=(NER.EPIL/POB)*Weight*100000,
            NER.MIGR=(NER.MIGR/POB)*Weight*100000,
            NER.IQCT=(NER.IQCT/POB)*Weight*100000,
            NER.SNPE=(NER.SNPE/POB)*Weight*100000,
            NER.OTRA=(NER.OTRA/POB)*Weight*100000,
            EYE.PARP=(EYE.PARP/POB)*Weight*100000,
            EYE.ESCL=(EYE.ESCL/POB)*Weight*100000,
            EYE.GLAU=(EYE.GLAU/POB)*Weight*100000,
            EYE.CATA=(EYE.CATA/POB)*Weight*100000,
            EYE.CRIS=(EYE.CRIS/POB)*Weight*100000,
            EYE.RETI=(EYE.RETI/POB)*Weight*100000,
            EYE.CEGU=(EYE.CEGU/POB)*Weight*100000,
            EYE.CONJ=(EYE.CONJ/POB)*Weight*100000,
            EYE.OTCO=(EYE.OTCO/POB)*Weight*100000,
            EYE.LAGR=(EYE.LAGR/POB)*Weight*100000,
            EYE.ESTR=(EYE.ESTR/POB)*Weight*100000,
            EYE.BINO=(EYE.BINO/POB)*Weight*100000,
            EYE.REFR=(EYE.REFR/POB)*Weight*100000,
            EYE.OTRA=(EYE.OTRA/POB)*Weight*100000,
            EAR.OMTM=(EAR.OMTM/POB)*Weight*100000,
            EAR.OTOM=(EAR.OTOM/POB)*Weight*100000,
            EAR.SORD=(EAR.SORD/POB)*Weight*100000,
            EAR.OTRA=(EAR.OTRA/POB)*Weight*100000,
            SC1.FIRE=(SC1.FIRE/POB)*Weight*100000,
            SC1.CRHD=(SC1.CRHD/POB)*Weight*100000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*100000,
            SC2.HTES=(SC2.HTES/POB)*Weight*100000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*100000,
            SC3.IAMC=(SC3.IAMC/POB)*Weight*100000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*100000,
            SC4.EMBP=(SC4.EMBP/POB)*Weight*100000,
            SC4.CARR=(SC4.CARR/POB)*Weight*100000,
            SC4.PARO=(SC4.PARO/POB)*Weight*100000,
            SC4.HEFA=(SC4.HEFA/POB)*Weight*100000,
            SC4.OTRA=(SC4.OTRA/POB)*Weight*100000,
            SC5.HEMS=(SC5.HEMS/POB)*Weight*100000,
            SC5.HEMI=(SC5.HEMI/POB)*Weight*100000,
            SC5.ISQC=(SC5.ISQC/POB)*Weight*100000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*100000,
            SC5.ATSC=(SC5.ATSC/POB)*Weight*100000,
            SC5.SEQC=(SC5.SEQC/POB)*Weight*100000,
            SC5.OTRA=(SC5.OTRA/POB)*Weight*100000,
            SC6.ATER=(SC6.ATER/POB)*Weight*100000,
            SC6.OEVP=(SC6.OEVP/POB)*Weight*100000,
            SC6.ETAR=(SC6.ETAR/POB)*Weight*100000,
            SC6.OTAR=(SC6.OTAR/POB)*Weight*100000,
            SC6.ETVE=(SC6.ETVE/POB)*Weight*100000,
            SC6.VARI=(SC6.VARI/POB)*Weight*100000,
            SC6.HMRR=(SC6.HMRR/POB)*Weight*100000,
            SC6.OTRA=(SC6.OTRA/POB)*Weight*100000,
            ER1.FAAG=(ER1.FAAG/POB)*Weight*100000,
            ER1.TOAG=(ER1.TOAG/POB)*Weight*100000,
            ER1.LTAG=(ER1.LTAG/POB)*Weight*100000,
            ER1.OTAG=(ER1.OTAG/POB)*Weight*100000,
            ER1.PNSD=(ER1.PNSD/POB)*Weight*100000,
            ER1.RNPC=(ER1.RNPC/POB)*Weight*100000,
            ER1.SINC=(ER1.SINC/POB)*Weight*100000,
            ER1.TADC=(ER1.TADC/POB)*Weight*100000,
            ER1.ONSN=(ER1.ONSN/POB)*Weight*100000,
            ER1.OTRA=(ER1.OTRA/POB)*Weight*100000,
            ER2.BRAG=(ER2.BRAG/POB)*Weight*100000,
            ER2.NEUM=(ER2.NEUM/POB)*Weight*100000,
            ER2.INFL=(ER2.INFL/POB)*Weight*100000,
            ER2.BCNE=(ER2.BCNE/POB)*Weight*100000,
            ER2.ASMA=(ER2.ASMA/POB)*Weight*100000,
            ER2.BREC=(ER2.BREC/POB)*Weight*100000,
            ER2.EPOC=(ER2.EPOC/POB)*Weight*100000,
            ER2.NMCS=(ER2.NMCS/POB)*Weight*100000,
            ER2.OTAE=(ER2.OTAE/POB)*Weight*100000,
            ER2.PLEU=(ER2.PLEU/POB)*Weight*100000,
            ER2.IRIN=(ER2.IRIN/POB)*Weight*100000,
            ER2.OTRA=(ER2.OTRA/POB)*Weight*100000,
            SD1.CARI=(SD1.CARI/POB)*Weight*100000,
            SD1.OTDI=(SD1.OTDI/POB)*Weight*100000,
            SD1.OTJA=(SD1.OTJA/POB)*Weight*100000,
            SD1.OTRA=(SD1.OTRA/POB)*Weight*100000,
            SD2.ESOF=(SD2.ESOF/POB)*Weight*100000,
            SD2.GDIS=(SD2.GDIS/POB)*Weight*100000,
            SD2.GDUL=(SD2.GDUL/POB)*Weight*100000,
            SD2.OTGD=(SD2.OTGD/POB)*Weight*100000,
            SD2.APEN=(SD2.APEN/POB)*Weight*100000,
            SD2.INHE=(SD2.INHE/POB)*Weight*100000,
            SD2.OTHE=(SD2.OTHE/POB)*Weight*100000,
            SD2.CRCU=(SD2.CRCU/POB)*Weight*100000,
            SD2.PIIO=(SD2.PIIO/POB)*Weight*100000,
            SD2.EDDI=(SD2.EDDI/POB)*Weight*100000,
            SD2.SIIO=(SD2.SIIO/POB)*Weight*100000,
            SD3.ALLD=(SD3.ALLD/POB)*Weight*100000,
            SD3.OTLI=(SD3.OTLI/POB)*Weight*100000,
            SD3.COLE=(SD3.COLE/POB)*Weight*100000,
            SD3.OTIP=(SD3.OTIP/POB)*Weight*100000,
            SD3.PANC=(SD3.PANC/POB)*Weight*100000,
            SD3.OTRA=(SD3.OTRA/POB)*Weight*100000,
            PTS.IPTS=(PTS.IPTS/POB)*Weight*100000,
            PTS.DEEC=(PTS.DEEC/POB)*Weight*100000,
            PTS.OTRA=(PTS.OTRA/POB)*Weight*100000,
            MOC.PAIN=(MOC.PAIN/POB)*Weight*100000,
            MOC.OSAR=(MOC.OSAR/POB)*Weight*100000,
            MOC.ADOL=(MOC.ADOL/POB)*Weight*100000,
            MOC.OTAR=(MOC.OTAR/POB)*Weight*100000,
            MOC.SCTD=(MOC.SCTD/POB)*Weight*100000,
            MOC.IVDD=(MOC.IVDD/POB)*Weight*100000,
            MOC.OTDO=(MOC.OTDO/POB)*Weight*100000,
            MOC.SOFT=(MOC.SOFT/POB)*Weight*100000,
            MOC.BONE=(MOC.BONE/POB)*Weight*100000,
            MOC.OMIE=(MOC.OMIE/POB)*Weight*100000,
            MOC.OTRA=(MOC.OTRA/POB)*Weight*100000,
            GU1.NFRI=(GU1.NFRI/POB)*Weight*100000,
            GU1.OTGL=(GU1.OTGL/POB)*Weight*100000,
            GU1.ACKF=(GU1.ACKF/POB)*Weight*100000,
            GU1.RTID=(GU1.RTID/POB)*Weight*100000,
            GU1.OTTU=(GU1.OTTU/POB)*Weight*100000,
            GU1.LITO=(GU1.LITO/POB)*Weight*100000,
            GU1.RECO=(GU1.RECO/POB)*Weight*100000,
            GU1.CIST=(GU1.CIST/POB)*Weight*100000,
            GU1.OTRA=(GU1.OTRA/POB)*Weight*100000,
            GU2.HIPR=(GU2.HIPR/POB)*Weight*100000,
            GU2.OTPR=(GU2.OTPR/POB)*Weight*100000,
            GU2.HCEC=(GU2.HCEC/POB)*Weight*100000,
            GU2.PREP=(GU2.PREP/POB)*Weight*100000,
            GU2.MINF=(GU2.MINF/POB)*Weight*100000,
            GU2.OTRA=(GU2.OTRA/POB)*Weight*100000,
            GU3.MAMA=(GU3.MAMA/POB)*Weight*100000,
            GU4.SAOO=(GU4.SAOO/POB)*Weight*100000,
            GU4.IDCU=(GU4.IDCU/POB)*Weight*100000,
            GU4.OTVV=(GU4.OTVV/POB)*Weight*100000,
            GU4.OTPI=(GU4.OTPI/POB)*Weight*100000,
            GU4.ENDM=(GU4.ENDM/POB)*Weight*100000,
            GU4.FPRO=(GU4.FPRO/POB)*Weight*100000,
            GU4.NOFB=(GU4.NOFB/POB)*Weight*100000,
            GU4.MENS=(GU4.MENS/POB)*Weight*100000,
            GU4.MNOP=(GU4.MNOP/POB)*Weight*100000,
            GU4.FINF=(GU4.FINF/POB)*Weight*100000,
            GU4.OTRA=(GU4.OTRA/POB)*Weight*100000,
            OB1.SPON=(OB1.SPON/POB)*Weight*100000,
            OB1.INDU=(OB1.INDU/POB)*Weight*100000,
            OB1.OTRA=(OB1.OTRA/POB)*Weight*100000,
            OB2.EPHD=(OB2.EPHD/POB)*Weight*100000,
            OB2.HEMP=(OB2.HEMP/POB)*Weight*100000,
            OB2.FACD=(OB2.FACD/POB)*Weight*100000,
            OB2.IGUT=(OB2.IGUT/POB)*Weight*100000,
            OB2.DMIP=(OB2.DMIP/POB)*Weight*100000,
            OB2.OBSL=(OB2.OBSL/POB)*Weight*100000,
            OB2.PPHE=(OB2.PPHE/POB)*Weight*100000,
            OB2.SOPI=(OB2.SOPI/POB)*Weight*100000,
            OB2.PUER=(OB2.PUER/POB)*Weight*100000,
            OB2.OTPL=(OB2.OTPL/POB)*Weight*100000,
            OB2.OBTE=(OB2.OBTE/POB)*Weight*100000,
            OB2.BEPU=(OB2.BEPU/POB)*Weight*100000,
            OB2.OMLC=(OB2.OMLC/POB)*Weight*100000,
            OB2.OTDC=(OB2.OTDC/POB)*Weight*100000,
            OB2.ODUC=(OB2.ODUC/POB)*Weight*100000,
            OB3.SSDE=(OB3.SSDE/POB)*Weight*100000,
            OB3.OTDE=(OB3.OTDE/POB)*Weight*100000,
            OB4.INOC=(OB4.INOC/POB)*Weight*100000,
            NEO.NAMC=(NEO.NAMC/POB)*Weight*100000,
            NEO.NAOC=(NEO.NAOC/POB)*Weight*100000,
            NEO.GMGW=(NEO.GMGW/POB)*Weight*100000,
            NEO.BITR=(NEO.BITR/POB)*Weight*100000,
            NEO.HIAS=(NEO.HIAS/POB)*Weight*100000,
            NEO.SDRN=(NEO.SDRN/POB)*Weight*100000,
            NEO.INFE=(NEO.INFE/POB)*Weight*100000,
            NEO.OTIN=(NEO.OTIN/POB)*Weight*100000,
            NEO.HDNB=(NEO.HDNB/POB)*Weight*100000,
            NEO.TENE=(NEO.TENE/POB)*Weight*100000,
            NEO.OTRA=(NEO.OTRA/POB)*Weight*100000,
            CON.ANEN=(CON.ANEN/POB)*Weight*100000,
            CON.HIDR=(CON.HIDR/POB)*Weight*100000,
            CON.SBIF=(CON.SBIF/POB)*Weight*100000,
            CON.OTNS=(CON.OTNS/POB)*Weight*100000,
            CON.CIRC=(CON.CIRC/POB)*Weight*100000,
            CON.CLCP=(CON.CLCP/POB)*Weight*100000,
            CON.CINT=(CON.CINT/POB)*Weight*100000,
            CON.OTDS=(CON.OTDS/POB)*Weight*100000,
            CON.TEST=(CON.TEST/POB)*Weight*100000,
            CON.OTGU=(CON.OTGU/POB)*Weight*100000,
            CON.DHIP=(CON.DHIP/POB)*Weight*100000,
            CON.FEET=(CON.FEET/POB)*Weight*100000,
            CON.OTMS=(CON.OTMS/POB)*Weight*100000,
            CON.OTRA=(CON.OTRA/POB)*Weight*100000,
            CON.CROM=(CON.CROM/POB)*Weight*100000,
            NCL.FEVU=(NCL.FEVU/POB)*Weight*100000,
            NCL.CAAB=(NCL.CAAB/POB)*Weight*100000,
            NCL.RAOR=(NCL.RAOR/POB)*Weight*100000,
            NCL.ABPP=(NCL.ABPP/POB)*Weight*100000,
            NCL.ARPD=(NCL.ARPD/POB)*Weight*100000,
            NCL.SIDS=(NCL.SIDS/POB)*Weight*100000,
            NCL.REAR=(NCL.REAR/POB)*Weight*100000,
            NCL.OTRA=(NCL.OTRA/POB)*Weight*100000,
            EX1.RAIL=(EX1.RAIL/POB)*Weight*100000,
            EX1.MOTO=(EX1.MOTO/POB)*Weight*100000,
            EX1.LAND=(EX1.LAND/POB)*Weight*100000,
            EX1.WATE=(EX1.WATE/POB)*Weight*100000,
            EX1.AIRS=(EX1.AIRS/POB)*Weight*100000,
            EX1.OTRO=(EX1.OTRO/POB)*Weight*100000,
            EX2.FALL=(EX2.FALL/POB)*Weight*100000,
            EX3.ENVI=(EX3.ENVI/POB)*Weight*100000,
            EX3.DROW=(EX3.DROW/POB)*Weight*100000,
            EX3.FBNO=(EX3.FBNO/POB)*Weight*100000,
            EX3.MACH=(EX3.MACH/POB)*Weight*100000,
            EX3.FREG=(EX3.FREG/POB)*Weight*100000,
            EX3.SEQA=(EX3.SEQA/POB)*Weight*100000,
            EX3.OTRA=(EX3.OTRA/POB)*Weight*100000,
            EX4.SMFF=(EX4.SMFF/POB)*Weight*100000,
            EX5.APDM=(EX5.APDM/POB)*Weight*100000,
            EX5.APSL=(EX5.APSL/POB)*Weight*100000,
            EX5.APGV=(EX5.APGV/POB)*Weight*100000,
            EX6.SUIC=(EX6.SUIC/POB)*Weight*100000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*100000,
            EX8.EOUI=(EX8.EOUI/POB)*Weight*100000,
            EX8.OWAR=(EX8.OWAR/POB)*Weight*100000,
            EX8.LEGI=(EX8.LEGI/POB)*Weight*100000,
            EX9.DRUG=(EX9.DRUG/POB)*Weight*100000,
            EX9.MSDV=(EX9.MSDV/POB)*Weight*100000,
            EX9.SQEX=(EX9.SQEX/POB)*Weight*100000,
            COV.CONF=(COV.CONF/POB)*Weight*100000,
            COV.SUSP=(COV.SUSP))%>%
  summarise("Cholera"=sum(EII.COLE),
            "Typhoid and paratyphoid fever"=sum(EII.TIPA),
            "Shigellosis"=sum(EII.SHIG),
            "Food poisoning"=sum(EII.TOXI),
            "Amebiasis"=sum(EII.AMEB),
            "Other GI infection"=sum(EII.OTRA),
            "Presumed GI infection"=sum(EII.PRES),
            "Pulmonary Tb"=sum(TUB.PULM),
            "Other respiratory Tb"=sum(TUB.RESP),
            "Other respiratory Tb"=sum(TUB.NERV),
            "Nervous System Tb"=sum(TUB.IPGM),
            "Intestinal/peritoneal Tb"=sum(TUB.BONE),
            "Bone and joint Tb"=sum(TUB.URIN),
            "Other variety of Tb"=sum(TUB.OTRA),
            "Plague (peste)"=sum(BAC.PEST),
            "Brusellosis"=sum(BAC.BRUS),
            "Leprosy"=sum(BAC.LEPR),
            "Diphtheria"=sum(BAC.DIFT),
            "Pertussis"=sum(BAC.PERT),
            "Scarlet fever, erysipelas"=sum(BAC.PYOG),
            "Meningococcal disease"=sum(BAC.MENI),
            "Tetanus"=sum(BAC.TETA),
            "Sepsis"=sum(BAC.SEPS),
            "Other bacterial diseases"=sum(BAC.OTRA),
            "Congenital syphilis"=sum(ETS.SIF1),
            "Early syphilis"=sum(ETS.SIF2),
            "Other syphilis"=sum(ETS.SIF3),
            "Gonorrhea"=sum(ETS.GONO),
            "Chlamydia"=sum(ETS.CLAM),
            "Other STD"=sum(ETS.OTRA),
            "Acute Poliomyelitis"=sum(VIR.POLI),
            "Smallpox (viruela)"=sum(VIR.VIRU),
            "Measles"=sum(VIR.SARA),
            "Rubella"=sum(VIR.RUBE),
            "Yellow fever"=sum(VIR.FIAM),
            "Dengue fever"=sum(VIR.DENG),
            "Dengue hemorragic fever"=sum(VIR.DHEM),
            "HIV infection"=sum(VIR.VIH1),
            "Arthropod-Borne Viral Encephalitis"=sum(VIR.EVTA),
            "Acute Hepatitis B"=sum(VIR.HEPB),
            "Other viral hepatitis"=sum(VIR.HEPO),
            "Rabies"=sum(VIR.RABI),
            "Trachoma"=sum(VIR.TRAC),
            "Other viral infections"=sum(VIR.OFAH),
            "Herpes simplex infections"=sum(VIR.HERP),
            "Chickenpox or herpes zoster"=sum(VIR.VRHZ),
            "Mumps"=sum(VIR.PARO),
            "Other chlamydia infections"=sum(VIR.OCLA),
            "Other viral diseases"=sum(VIR.OTRA),
            "Louse-borne epidemic thypus"=sum(RPI.TIFP),
            "Other thypus"=sum(RPI.OTIF),
            "Other rickettsiosis"=sum(RPI.ORIC),
            "Malaria"=sum(RPI.PALU),
            "Leishmaniasis"=sum(RPI.LEIS),
            "Trypanosomiasis"=sum(RPI.TRIP),
            "Other spirochetal diseases (Not syphilis)"=sum(PMO.ESPI),
            "Relapsing fevers"=sum(PMO.FIRE),
            "Mycosis"=sum(PMO.MICO),
            "Schistosomiasis"=sum(PMO.SCHI),
            "Other fluke (trematoda) infections"=sum(PMO.TREM),
            "Echinococcosis"=sum(PMO.ECHI),
            "Dracunculiasis"=sum(PMO.DRAC),
            "Onchocerciasis"=sum(PMO.ONCH),
            "Filariasis"=sum(PMO.FILA),
            "Ancylostomiasis or Necatoriasis"=sum(PMO.ANNE),
            "Other Helminthiases"=sum(PMO.HELM),
            "Other infectious/parasitic disease"=sum(PMO.OTRA),
            "Tuberculosis sequelae"=sum(SEI.TUBE),
            "Poliomyelitis sequelae"=sum(SEI.POLI),
            "Leprosy sequelae"=sum(SEI.LEPR),
            "Sequelae from other infections"=sum(SEI.OTRA),
            "Lip, oral cavity and pharynx cancer"=sum(NM1.LCBF),
            "Esophagus cancer"=sum(NM2.ESOF),
            "Stomach cancer"=sum(NM2.STOM),
            "Small intestine cancer"=sum(NM2.INDE),
            "Colon cancer"=sum(NM2.COLO),
            "Rectosigmoid junction, rectum and anal canal cancer"=sum(NM2.RECT),
            "Liver and intrahepatic bile ducts cancer"=sum(NM2.HIGA),
            "Pancreas cancer"=sum(NM2.PANC),
            "Other types of digestive organs cancer"=sum(NM2.OTRO),
            "Larynx cancer"=sum(NM3.LARI),
            "Trachea, bronchus and lung cancer"=sum(NM3.TBPU),
            "Other respiratory and intrathoracic organs cancer"=sum(NM3.OTRO),
            "Bone and articular cartilage cancer"=sum(NM4.BONE),
            "Malignant melanoma of skin cancer"=sum(NM4.MELA),
            "Other malignant neoplasm of skin cancer"=sum(NM4.SKIN),
            "Breast cancer"=sum(NM4.MAMA),
            "Mesothelial and soft tissue cancer"=sum(NM4.SOFT),
            "Cervix uteri cancer"=sum(NM5.CERV),
            "Placenta cancer"=sum(NM5.PLAC),
            "Uterus cancer"=sum(NM5.UTER),
            "Ovary cancer"=sum(NM5.OVAR),
            "Vulva and vagina cancer"=sum(NM5.VAGI),
            "Other and unspecified genitourinary (female) organs cancer"=sum(NM5.OTFE),
            "Prostate cancer"=sum(NM5.PROS),
            "Testis cancer"=sum(NM5.TEST),
            "Other and unspecified genitourinary (male) organs cancer"=sum(NM5.OTMA),
            "Bladder cancer"=sum(NM5.VEJI),
            "Other urinary tract cancer"=sum(NM5.OTUR),
            "Brain cancer"=sum(NM6.ENCF),
            "Meninges and other SNC cancer"=sum(NM6.MENI),
            "Eyes and adnexa cancer"=sum(NM6.OJOA),
            "Other and unspecified cancer in other organs and unspecified sites"=sum(NM6.OTRO),
            "Hodgkin lymphoma"=sum(NM7.ENHO),
            "Non-Hodgkin lymphoma"=sum(NM7.NOHO),
            "Multiple myeloma and plasmatic cell neoplasms"=sum(NM7.MMCP),
            "Leukemias"=sum(NM7.LEUC),
            "Other lymphoid, hematopoietic and related tissue"=sum(NM7.OTRO),
            "Multiple primary tumors"=sum(NM8.MUPT),
            "In-situ cervix uteri"=sum(NIS.CERV),
            "Other in situ neoplasms"=sum(NIS.OTRO),
            "Benign skin neoplasms"=sum(NBE.SKIN),
            "Benign breast neoplasms"=sum(NBE.MAMA),
            "Leiomyoma of uterus neoplasms"=sum(NBE.LEIO),
            "Benign ovary neoplasms"=sum(NBE.OVAR),
            "Bening urinary tract neoplasms"=sum(NBE.URIN),
            "Bening brain and other CNS sites neoplasms"=sum(NBE.CSNC),
            "Benign thyroid neoplasms"=sum(NBE.TIRO),
            "Other benign neoplasms"=sum(NBE.OTRO),
            "Neoplasms of uncertain behaviour"=sum(NCI.UNCB),
            "Iron deficiency anemia"=sum(SAN.ADFE),
            "Other anemias"=sum(SAN.AOTR),
            "Immunity disorders"=sum(SAN.INMU),
            "Other diseases of the blood and blood-forming organs"=sum(SAN.OTRA),
            "Iodine deficiency thyroid disorders"=sum(END.DEYO),
            "Thyrotoxicosis"=sum(END.TTOX),
            "Other thyroid disorders"=sum(END.TOTR),
            "Type 2 diabetes mellitus"=sum(END.DIAB),
            "Metabolism disorders and dyslipidemia"=sum(END.LIPO),
            "Obesity"=sum(END.OBES),
            "Volume depletion"=sum(END.DEPL),
            "Sequelae of hyperalimentation"=sum(END.SQHA),
            "Other endocrine and metabolic diseases"=sum(END.OTRA),
            "Kwashiorkor"=sum(NUT.KWAS),
            "Nutritional marasmus"=sum(NUT.MARA),
            "Other protein-calorie malnutrition"=sum(NUT.PROT),
            "Vitamin A deficiency"=sum(NUT.VITA),
            "Other vitamin deficiencies"=sum(NUT.VITO),
            "Sequelae of malnutrition"=sum(NUT.SECD),
            "Other nutritional deficiencies"=sum(NUT.OTRA),
            "Dementia"=sum(MEN.DEME),
            "Alcohol dependence syndrome"=sum(MEN.SDAL),
            "Other alcohol related disorders"=sum(MEN.OTAL),
            "Mental and behavioral disorders due to other psychoactive substances use"=sum(MEN.TMSP),
            "Schizophrenia, schizotypal, delusional, and other non-mood psychotic disorders"=sum(MEN.ESQU),
            "Mood [affective] disorders"=sum(MEN.HUMO),
            "Anxiety, dissociative, stress-related, somatoform and other nonpsychotic mental disorders"=sum(MEN.ESTR),
            "Behavioral syndromes associated with physiological disturbances and physical factors"=sum(MEN.FISI),
            "Intellectual disabilities"=sum(MEN.RETR),
            "Other mental and behavioral disorders"=sum(MEN.OTRO),
            "Meningitis"=sum(NER.MENI),
            "Other inflammatory diseases of the central nervous system"=sum(NER.ISNC),
            "Parkinson's disease"=sum(NER.PARK),
            "Alzheimer's disease"=sum(NER.ALZH),
            "Multiple sclerosis"=sum(NER.ESCM),
            "Cerebral palsy and other paralytic syndromes"=sum(NER.PALS),
            "Epilepsy and recurrent seizures"=sum(NER.EPIL),
            "Migraine and other headache syndromes"=sum(NER.MIGR),
            "Transient cerebral ischemic attacks and related syndromes"=sum(NER.IQCT),
            "Nerve, nerve root and plexus disorders"=sum(NER.SNPE),
            "Other diseases of the nervous system"=sum(NER.OTRA),
            "Eyelid inflammation"=sum(EYE.PARP),
            "Disorders of sclera and cornea"=sum(EYE.ESCL),
            "Glaucoma"=sum(EYE.GLAU),
            "Cataracts"=sum(EYE.CATA),
            "Other disorders of lens"=sum(EYE.CRIS),
            "Retinal detachments and breaks"=sum(EYE.RETI),
            "Blindness and low vision"=sum(EYE.CEGU),
            "Conjunctivitis"=sum(EYE.CONJ),
            "Other disorders of conjunctiva"=sum(EYE.OTCO),
            "Disorders of lacrimal system"=sum(EYE.LAGR),
            "Strabismus"=sum(EYE.ESTR),
            "Other disorders of binocular movement"=sum(EYE.BINO),
            "Disorders of refraction and accommodation"=sum(EYE.REFR),
            "Other diseases of the eye and adnexa"=sum(EYE.OTRA),
            "Otitis media, disorders of Eustachian tube and mastoiditis"=sum(EAR.OMTM),
            "Other middle ear disorders"=sum(EAR.OTOM),
            "Hearing loss"=sum(EAR.SORD),
            "Other diseases of the ear and mastoid process"=sum(EAR.OTRA),
            "Acute rheumatic fever"=sum(SC1.FIRE),
            "Chronic rheumatic heart diseases"=sum(SC1.CRHD),
            "Hypertensive heart disease"=sum(SC2.ECHI),
            "Essential (primary) hypertension"=sum(SC2.HTES),
            "Other hypertensive diseases"=sum(SC2.OTRA),
            "Acute myocardial infarction"=sum(SC3.IAMC),
            "Other ischemic heart diseases"=sum(SC3.OTRA),
            "Pulmonary embolism"=sum(SC4.EMBP),
            "Conduction disorders and arrhythmia"=sum(SC4.CARR),
            "Cardiac arrest"=sum(SC4.PARO),
            "Heart failure"=sum(SC4.HEFA),
            "Other diseases of pulmonary circulation and other heart diseases"=sum(SC4.OTRA),
            "Subarachnoid hemorrhage"=sum(SC5.HEMS),
            "Intracerebral and other intracranial hemorrhage"=sum(SC5.HEMI),
            "Cerebral infarction"=sum(SC5.ISQC),
            "Unspecified (hemorrhagic vs isquemic)"=sum(SC5.EVCN),
            "Cerebral atherosclerosis"=sum(SC5.ATSC),
            "Sequelae of cerebrovascular disease"=sum(SC5.SEQC),
            "Other cerebrovascular diseases"=sum(SC5.OTRA),
            "Atherosclerosis"=sum(SC6.ATER),
            "Other peripheral vascular diseases"=sum(SC6.OEVP),
            "Arterial embolism and thrombosis"=sum(SC6.ETAR),
            "Other diseases of arteries, arterioles and capillaries"=sum(SC6.OTAR),
            "Phlebitis, trombophlebitis, other venous embolism and thrombosis"=sum(SC6.ETVE),
            "Varicose veins of lower extremities"=sum(SC6.VARI),
            "Hemorrhoids"=sum(SC6.HMRR),
            "Other diseases of the circulatory system"=sum(SC6.OTRA),
            "Acute pharyngitis"=sum(ER1.FAAG),
            "Acute tonsillitis"=sum(ER1.TOAG),
            "Acute laryngitis and tracheitis"=sum(ER1.LTAG),
            "Other acute upper respiratory infections"=sum(ER1.OTAG),
            "Nasal polyp and deviated nasal septum"=sum(ER1.PNSD),
            "Chronic rhinitis, nasopharyngitis and pharyngitis"=sum(ER1.RNPC),
            "Chronic sinusitis"=sum(ER1.SINC),
            "Chronic diseases of tonsils and adenoids"=sum(ER1.TADC),
            "Other disorders of nose and nasal sinuses"=sum(ER1.ONSN),
            "Other acute upper respiratory infections"=sum(ER1.OTRA),
            "Acute bronchitis and bronchiolitis"=sum(ER2.BRAG),
            "Pneumonia"=sum(ER2.NEUM),
            "Influenza"=sum(ER2.INFL),
            "Chronic and unspecified bronchitis or emphysema"=sum(ER2.BCNE),
            "Asthma"=sum(ER2.ASMA),
            "Bronchiectasis"=sum(ER2.BREC),
            "Chronic obstructive pulmonary disease"=sum(ER2.EPOC),
            "Pneumoconiosis"=sum(ER2.NMCS),
            "Other pulmonary diseases due to external agents"=sum(ER2.OTAE),
            "Pleural conditions"=sum(ER2.PLEU),
            "Unspecified acute lower respiratory infection"=sum(ER2.IRIN),
            "Other respiratory tract diseases"=sum(ER2.OTRA),
            "Dental caries"=sum(SD1.CARI),
            "Other disorders of teeth and supporting structures"=sum(SD1.OTDI),
            "Other diseases of jaw"=sum(SD1.OTJA),
            "Other oral cavity and salivary glands"=sum(SD1.OTRA),
            "Diseases of esophagus"=sum(SD2.ESOF),
            "Gastritis and duodenitis"=sum(SD2.GDIS),
            "Gastric and duodenal ulcer"=sum(SD2.GDUL),
            "Other diseases of stomach and duodenum"=sum(SD2.OTGD),
            "Diseases of appendix"=sum(SD2.APEN),
            "Inguinal hernia"=sum(SD2.INHE),
            "Other hernias"=sum(SD2.OTHE),
            "Crohn's disease and ulcerative colitis"=sum(SD2.CRCU),
            "Paralytic ileus and intestinal obstruction without hernia"=sum(SD2.PIIO),
            "Diverticular disease of intestine"=sum(SD2.EDDI),
            "Irritable bowel syndrome and other functional intestinal disorders"=sum(SD2.SIIO),
            "Alcoholic liver disease"=sum(SD3.ALLD),
            "Other diseases of liver"=sum(SD3.OTLI),
            "Cholelithiasis and cholecystitis"=sum(SD3.COLE),
            "Other diseases of intestines and peritoneum"=sum(SD3.OTIP),
            "Acute pancreatitis and other diseases of pancreas"=sum(SD3.PANC),
            "Other diseases of digestive system"=sum(SD3.OTRA),
            "Infections of the skin and subcutaneous tissue"=sum(PTS.IPTS),
            "Dermatitis and eczema"=sum(PTS.DEEC),
            "Other diseases of the skin and subcutaneous tissue"=sum(PTS.OTRA),
            "Inflammatory polyarthropathies"=sum(MOC.PAIN),
            "Osteoarthritis"=sum(MOC.OSAR),
            "Acquired deformities of limbs"=sum(MOC.ADOL),
            "Other joint disorders"=sum(MOC.OTAR),
            "Systemic connective tissue disorders"=sum(MOC.SCTD),
            "Intervertebral disc disorders"=sum(MOC.IVDD),
            "Other dorsopathies"=sum(MOC.OTDO),
            "Soft tissue disorders"=sum(MOC.SOFT),
            "Disorders of bone density and structure"=sum(MOC.BONE),
            "Osteomyelitis"=sum(MOC.OMIE),
            "Other diseases of the musculoskeletal system and connective tissue"=sum(MOC.OTRA),
            "Acute and rapidly progressive nephritic syndrome"=sum(GU1.NFRI),
            "Other glomerular diseases"=sum(GU1.OTGL),
            "Acute kidney failure and chronic kidney disease"=sum(GU1.ACKF),
            "Renal tubulo-interstitial diseases"=sum(GU1.RTID),
            "Other renal tubulo-interstitial diseases"=sum(GU1.OTTU),
            "Urolithiasis"=sum(GU1.LITO),
            "Unspecified renal colic"=sum(GU1.RECO),
            "Cystitis"=sum(GU1.CIST),
            "Other diseases of urinary system"=sum(GU1.OTRA),
            "Benign prostatic hyperplasia"=sum(GU2.HIPR),
            "Other disorders of prostate"=sum(GU2.OTPR),
            "Hydrocele and spermatocele"=sum(GU2.HCEC),
            "Disorders of prepuce"=sum(GU2.PREP),
            "Male infertility"=sum(GU2.MINF),
            "Other male genital organs diseases"=sum(GU2.OTRA),
            "Disorders of breast"=sum(GU3.MAMA),
            "Salpingitis and oophoritis"=sum(GU4.SAOO),
            "Inflammatory disease of cervix uteri"=sum(GU4.IDCU),
            "Other diseases of uterus, vagina and vulva"=sum(GU4.OTVV),
            "Other female pelvic inflammatory diseases"=sum(GU4.OTPI),
            "Endometriosis"=sum(GU4.ENDM),
            "Female genital prolapse"=sum(GU4.FPRO),
            "Noninflammatory disorders of ovary, fallopian tube and broad ligament"=sum(GU4.NOFB),
            "Disorders of menstruation"=sum(GU4.MENS),
            "Menopausal and other perimenopausal disorders"=sum(GU4.MNOP),
            "Female infertility"=sum(GU4.FINF),
            "Other female genital organs diseases"=sum(GU4.OTRA),
            "Spontaneous abortion"=sum(OB1.SPON),
            "Complications following (induced) termination of pregnancy"=sum(OB1.INDU),
            "Other abortion"=sum(OB1.OTRA),
            "Edema, proteinuria and hypertensive disorders in pregnancy, childbirth and the puerperium"=sum(OB2.EPHD),
            "Hemorrhage in early pregnancy, placenta previa, abruptio placentae, antepartum hemorrhage"=sum(OB2.HEMP),
            "Maternal care related to the fetus and amniotic cavity and possible delivery problems"=sum(OB2.FACD),
            "Infections of genitourinary tract in pregnancy"=sum(OB2.IGUT),
            "Diabetes mellitus in pregnancy"=sum(OB2.DMIP),
            "Obstructed labor"=sum(OB2.OBSL),
            "Postpartum hemorrhage"=sum(OB2.PPHE),
            "Sepsis and other puerperal infections"=sum(OB2.SOPI),
            "Other complications of the puerperium"=sum(OB2.PUER),
            "Other complications of pregnancy and labor"=sum(OB2.OTPL),
            "Obstetrical tetanus"=sum(OB2.OBTE),
            "Mental and behavioral disorders associated with the puerperium"=sum(OB2.BEPU),
            "Puerperal osteomalacia"=sum(OB2.OMLC),
            "Other direct obstetric causes"=sum(OB2.OTDC),
            "Obstetric death of unspecified cause"=sum(OB2.ODUC),
            "Single spontaneous delivery"=sum(OB3.SSDE),
            "Other delivery"=sum(OB3.OTDE),
            "Indirect obstetric causes"=sum(OB4.INOC),
            "Newborn affected by maternal conditions"=sum(NEO.NAMC),
            "Newborn affected by obstetric complications"=sum(NEO.NAOC),
            "Slow fetal growth, fetal malnutrition, short gestation and low birth weight"=sum(NEO.GMGW),
            "Birth trauma"=sum(NEO.BITR),
            "Intrauterine hypoxia and birth asphyxia "=sum(NEO.HIAS),
            "Respiratory distress of newborn and other perinatal respiratory disorders"=sum(NEO.SDRN),
            "Congenital viral, bacterial and parasitic diseases"=sum(NEO.INFE),
            "Other infections specific to the perinatal period"=sum(NEO.OTIN),
            "Hemolytic disease of newborn"=sum(NEO.HDNB),
            "Tetanus neonatorum"=sum(NEO.TENE),
            "Other conditions originating in the perinatal period"=sum(NEO.OTRA),
            "Anencephaly and similar malformations"=sum(CON.ANEN),
            "Congenital hydrocephalus"=sum(CON.HIDR),
            "Spina bifida"=sum(CON.SBIF),
            "Other congenital malformations of the nervous system"=sum(CON.OTNS),
            "Congenital malformations of the circulatory system"=sum(CON.CIRC),
            "Cleft lip and cleft palate"=sum(CON.CLCP),
            "Congenital absence, atresia and stenosis of small intestine"=sum(CON.CINT),
            "Other congenital malformations of the digestive system"=sum(CON.OTDS),
            "Undescended and ectopic testicle"=sum(CON.TEST),
            "Other congenital malformations of genitourinary system"=sum(CON.OTGU),
            "Congenital deformities of hip"=sum(CON.DHIP),
            "Congenital deformities of feet"=sum(CON.FEET),
            "Other congenital malformations and deformations of the musculoskeletal system"=sum(CON.OTMS),
            "Other congenital malformations"=sum(CON.OTRA),
            "Chromosomal abnormalities, not elsewhere classified"=sum(CON.CROM),
            "Fever of other and unknown origin"=sum(NCL.FEVU),
            "Cardiac abnormalities"=sum(NCL.CAAB),
            "Retention of urine"=sum(NCL.RAOR),
            "Abdominal and pelvic pain"=sum(NCL.ABPP),
            "Age-related physical debility"=sum(NCL.ARPD),
            "Sudden infant death syndrome"=sum(NCL.SIDS),
            "Respiratory arrest"=sum(NCL.REAR),
            "Other symptoms, signs and abnormal clinical and laboratory findings"=sum(NCL.OTRA),
            "Railway accidents"=sum(EX1.RAIL),
            "Motor vehicle traffic accidents"=sum(EX1.MOTO),
            "Other land transport accidents"=sum(EX1.LAND),
            "Water transport accidents"=sum(EX1.WATE),
            "Air and space transport accidents"=sum(EX1.AIRS),
            "Other transport accidents"=sum(EX1.OTRO),
            "Falls"=sum(EX2.FALL),
            "Accidents caused by environmental factors"=sum(EX3.ENVI),
            "Accidental non-transport drowning and submersion"=sum(EX3.DROW),
            "Foreign body entering into or through eye or natural orifice"=sum(EX3.FBNO),
            "Accidents caused by machinery or sharp instruments"=sum(EX3.MACH),
            "Accidents caused by firearms and guns"=sum(EX3.FREG),
            "Sequelae of transport accidents and other accidents"=sum(EX3.SEQA),
            "Other accidents"=sum(EX3.OTRA),
            "Exposure to smoke, fire and flames"=sum(EX4.SMFF),
            "Accidental poisoning by drugs, medicaments and biological substances"=sum(EX5.APDM),
            "Accidental poisoning by other solid or liquid substances"=sum(EX5.APSL),
            "Accidental poisoning by other gases and vapours"=sum(EX5.APGV),
            "Intentional self-harm"=sum(EX6.SUIC),
            "Assault"=sum(EX7.ASSA),
            "Event of undetermined intent"=sum(EX8.EOUI),
            "Operations of war"=sum(EX8.OWAR),
            "Legal intervention"=sum(EX8.LEGI),
            "Drugs, medicaments and biological substances causing adverse effects in therapeutic use"=sum(EX9.DRUG),
            "Misadventures to patients during surgical and medical care"=sum(EX9.MSDV),
            "Sequelae of external causes of morbidity and mortality"=sum(EX9.SQEX),
            "Confirmed COVID-19"=sum(COV.CONF),
            "Suspected COVID-19"=sum(COV.SUSP))%>%
  mutate(EV_YEAR=c("2019"))

#2020

CAUSA_ESPECIFICA_2020<-mort_2020%>%
  filter(!is.na(EDAD))%>%
  group_by(EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  summarise(EII.COLE=sum(EII.COLE==1,na.rm = T),
            EII.TIPA=sum(EII.TIPA==1,na.rm = T),
            EII.SHIG=sum(EII.SHIG==1,na.rm = T),
            EII.TOXI=sum(EII.TOXI==1,na.rm = T),
            EII.AMEB=sum(EII.AMEB==1,na.rm = T),
            EII.OTRA=sum(EII.OTRA==1,na.rm = T),
            EII.PRES=sum(EII.PRES==1,na.rm = T),
            TUB.PULM=sum(TUB.PULM==1,na.rm = T),
            TUB.RESP=sum(TUB.RESP==1,na.rm = T),
            TUB.NERV=sum(TUB.NERV==1,na.rm = T),
            TUB.IPGM=sum(TUB.IPGM==1,na.rm = T),
            TUB.BONE=sum(TUB.BONE==1,na.rm = T),
            TUB.URIN=sum(TUB.URIN==1,na.rm = T),
            TUB.OTRA=sum(TUB.OTRA==1,na.rm = T),
            BAC.PEST=sum(BAC.PEST==1,na.rm = T),
            BAC.BRUS=sum(BAC.BRUS==1,na.rm = T),
            BAC.LEPR=sum(BAC.LEPR==1,na.rm = T),
            BAC.DIFT=sum(BAC.DIFT==1,na.rm = T),
            BAC.PERT=sum(BAC.PERT==1,na.rm = T),
            BAC.PYOG=sum(BAC.PYOG==1,na.rm = T),
            BAC.MENI=sum(BAC.MENI==1,na.rm = T),
            BAC.TETA=sum(BAC.TETA==1,na.rm = T),
            BAC.SEPS=sum(BAC.SEPS==1,na.rm = T),
            BAC.OTRA=sum(BAC.OTRA==1,na.rm = T),
            ETS.SIF1=sum(ETS.SIF1==1,na.rm = T),
            ETS.SIF2=sum(ETS.SIF2==1,na.rm = T),
            ETS.SIF3=sum(ETS.SIF3==1,na.rm = T),
            ETS.GONO=sum(ETS.GONO==1,na.rm = T),
            ETS.CLAM=sum(ETS.CLAM==1,na.rm = T),
            ETS.OTRA=sum(ETS.OTRA==1,na.rm = T),
            VIR.POLI=sum(VIR.POLI==1,na.rm = T),
            VIR.VIRU=sum(VIR.VIRU==1,na.rm = T),
            VIR.SARA=sum(VIR.SARA==1,na.rm = T),
            VIR.RUBE=sum(VIR.RUBE==1,na.rm = T),
            VIR.FIAM=sum(VIR.FIAM==1,na.rm = T),
            VIR.DENG=sum(VIR.DENG==1,na.rm = T),
            VIR.DHEM=sum(VIR.DHEM==1,na.rm = T),
            VIR.VIH1=sum(VIR.VIH1==1,na.rm = T),
            VIR.EVTA=sum(VIR.EVTA==1,na.rm = T),
            VIR.HEPB=sum(VIR.HEPB==1,na.rm = T),
            VIR.HEPO=sum(VIR.HEPO==1,na.rm = T),
            VIR.RABI=sum(VIR.RABI==1,na.rm = T),
            VIR.TRAC=sum(VIR.TRAC==1,na.rm = T),
            VIR.OFAH=sum(VIR.OFAH==1,na.rm = T),
            VIR.HERP=sum(VIR.HERP==1,na.rm = T),
            VIR.VRHZ=sum(VIR.VRHZ==1,na.rm = T),
            VIR.PARO=sum(VIR.PARO==1,na.rm = T),
            VIR.OCLA=sum(VIR.OCLA==1,na.rm = T),
            VIR.OTRA=sum(VIR.OTRA==1,na.rm = T),
            RPI.TIFP=sum(RPI.TIFP==1,na.rm = T),
            RPI.OTIF=sum(RPI.OTIF==1,na.rm = T),
            RPI.ORIC=sum(RPI.ORIC==1,na.rm = T),
            RPI.PALU=sum(RPI.PALU==1,na.rm = T),
            RPI.LEIS=sum(RPI.LEIS==1,na.rm = T),
            RPI.TRIP=sum(RPI.TRIP==1,na.rm = T),
            PMO.ESPI=sum(PMO.ESPI==1,na.rm = T),
            PMO.FIRE=sum(PMO.FIRE==1,na.rm = T),
            PMO.MICO=sum(PMO.MICO==1,na.rm = T),
            PMO.SCHI=sum(PMO.SCHI==1,na.rm = T),
            PMO.TREM=sum(PMO.TREM==1,na.rm = T),
            PMO.ECHI=sum(PMO.ECHI==1,na.rm = T),
            PMO.DRAC=sum(PMO.DRAC==1,na.rm = T),
            PMO.ONCH=sum(PMO.ONCH==1,na.rm = T),
            PMO.FILA=sum(PMO.FILA==1,na.rm = T),
            PMO.ANNE=sum(PMO.ANNE==1,na.rm = T),
            PMO.HELM=sum(PMO.HELM==1,na.rm = T),
            PMO.OTRA=sum(PMO.OTRA==1,na.rm = T),
            SEI.TUBE=sum(SEI.TUBE==1,na.rm = T),
            SEI.POLI=sum(SEI.POLI==1,na.rm = T),
            SEI.LEPR=sum(SEI.LEPR==1,na.rm = T),
            SEI.OTRA=sum(SEI.OTRA==1,na.rm = T),
            NM1.LCBF=sum(NM1.LCBF==1,na.rm = T),
            NM2.ESOF=sum(NM2.ESOF==1,na.rm = T),
            NM2.STOM=sum(NM2.STOM==1,na.rm = T),
            NM2.INDE=sum(NM2.INDE==1,na.rm = T),
            NM2.COLO=sum(NM2.COLO==1,na.rm = T),
            NM2.RECT=sum(NM2.RECT==1,na.rm = T),
            NM2.HIGA=sum(NM2.HIGA==1,na.rm = T),
            NM2.PANC=sum(NM2.PANC==1,na.rm = T),
            NM2.OTRO=sum(NM2.OTRO==1,na.rm = T),
            NM3.LARI=sum(NM3.LARI==1,na.rm = T),
            NM3.TBPU=sum(NM3.TBPU==1,na.rm = T),
            NM3.OTRO=sum(NM3.OTRO==1,na.rm = T),
            NM4.BONE=sum(NM4.BONE==1,na.rm = T),
            NM4.MELA=sum(NM4.MELA==1,na.rm = T),
            NM4.SKIN=sum(NM4.SKIN==1,na.rm = T),
            NM4.MAMA=sum(NM4.MAMA==1,na.rm = T),
            NM4.SOFT=sum(NM4.SOFT==1,na.rm = T),
            NM5.CERV=sum(NM5.CERV==1,na.rm = T),
            NM5.PLAC=sum(NM5.PLAC==1,na.rm = T),
            NM5.UTER=sum(NM5.UTER==1,na.rm = T),
            NM5.OVAR=sum(NM5.OVAR==1,na.rm = T),
            NM5.VAGI=sum(NM5.VAGI==1,na.rm = T),
            NM5.OTFE=sum(NM5.OTFE==1,na.rm = T),
            NM5.PROS=sum(NM5.PROS==1,na.rm = T),
            NM5.TEST=sum(NM5.TEST==1,na.rm = T),
            NM5.OTMA=sum(NM5.OTMA==1,na.rm = T),
            NM5.VEJI=sum(NM5.VEJI==1,na.rm = T),
            NM5.OTUR=sum(NM5.OTUR==1,na.rm = T),
            NM6.ENCF=sum(NM6.ENCF==1,na.rm = T),
            NM6.MENI=sum(NM6.MENI==1,na.rm = T),
            NM6.OJOA=sum(NM6.OJOA==1,na.rm = T),
            NM6.OTRO=sum(NM6.OTRO==1,na.rm = T),
            NM7.ENHO=sum(NM7.ENHO==1,na.rm = T),
            NM7.NOHO=sum(NM7.NOHO==1,na.rm = T),
            NM7.MMCP=sum(NM7.MMCP==1,na.rm = T),
            NM7.LEUC=sum(NM7.LEUC==1,na.rm = T),
            NM7.OTRO=sum(NM7.OTRO==1,na.rm = T),
            NM8.MUPT=sum(NM8.MUPT==1,na.rm = T),
            NIS.CERV=sum(NIS.CERV==1,na.rm = T),
            NIS.OTRO=sum(NIS.OTRO==1,na.rm = T),
            NBE.SKIN=sum(NBE.SKIN==1,na.rm = T),
            NBE.MAMA=sum(NBE.MAMA==1,na.rm = T),
            NBE.LEIO=sum(NBE.LEIO==1,na.rm = T),
            NBE.OVAR=sum(NBE.OVAR==1,na.rm = T),
            NBE.URIN=sum(NBE.URIN==1,na.rm = T),
            NBE.CSNC=sum(NBE.CSNC==1,na.rm = T),
            NBE.TIRO=sum(NBE.TIRO==1,na.rm = T),
            NBE.OTRO=sum(NBE.OTRO==1,na.rm = T),
            NCI.UNCB=sum(NCI.UNCB==1,na.rm = T),
            SAN.ADFE=sum(SAN.ADFE==1,na.rm = T),
            SAN.AOTR=sum(SAN.AOTR==1,na.rm = T),
            SAN.INMU=sum(SAN.INMU==1,na.rm = T),
            SAN.OTRA=sum(SAN.OTRA==1,na.rm = T),
            END.DEYO=sum(END.DEYO==1,na.rm = T),
            END.TTOX=sum(END.TTOX==1,na.rm = T),
            END.TOTR=sum(END.TOTR==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            END.LIPO=sum(END.LIPO==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T),
            END.DEPL=sum(END.DEPL==1,na.rm = T),
            END.SQHA=sum(END.SQHA==1,na.rm = T),
            END.OTRA=sum(END.OTRA==1,na.rm = T),
            NUT.KWAS=sum(NUT.KWAS==1,na.rm = T),
            NUT.MARA=sum(NUT.MARA==1,na.rm = T),
            NUT.PROT=sum(NUT.PROT==1,na.rm = T),
            NUT.VITA=sum(NUT.VITA==1,na.rm = T),
            NUT.VITO=sum(NUT.VITO==1,na.rm = T),
            NUT.SECD=sum(NUT.SECD==1,na.rm = T),
            NUT.OTRA=sum(NUT.OTRA==1,na.rm = T),
            MEN.DEME=sum(MEN.DEME==1,na.rm = T),
            MEN.SDAL=sum(MEN.SDAL==1,na.rm = T),
            MEN.OTAL=sum(MEN.OTAL==1,na.rm = T),
            MEN.TMSP=sum(MEN.TMSP==1,na.rm = T),
            MEN.ESQU=sum(MEN.ESQU==1,na.rm = T),
            MEN.HUMO=sum(MEN.HUMO==1,na.rm = T),
            MEN.ESTR=sum(MEN.ESTR==1,na.rm = T),
            MEN.FISI=sum(MEN.FISI==1,na.rm = T),
            MEN.RETR=sum(MEN.RETR==1,na.rm = T),
            MEN.OTRO=sum(MEN.OTRO==1,na.rm = T),
            NER.MENI=sum(NER.MENI==1,na.rm = T),
            NER.ISNC=sum(NER.ISNC==1,na.rm = T),
            NER.PARK=sum(NER.PARK==1,na.rm = T),
            NER.ALZH=sum(NER.ALZH==1,na.rm = T),
            NER.ESCM=sum(NER.ESCM==1,na.rm = T),
            NER.PALS=sum(NER.PALS==1,na.rm = T),
            NER.EPIL=sum(NER.EPIL==1,na.rm = T),
            NER.MIGR=sum(NER.MIGR==1,na.rm = T),
            NER.IQCT=sum(NER.IQCT==1,na.rm = T),
            NER.SNPE=sum(NER.SNPE==1,na.rm = T),
            NER.OTRA=sum(NER.OTRA==1,na.rm = T),
            EYE.PARP=sum(EYE.PARP==1,na.rm = T),
            EYE.ESCL=sum(EYE.ESCL==1,na.rm = T),
            EYE.GLAU=sum(EYE.GLAU==1,na.rm = T),
            EYE.CATA=sum(EYE.CATA==1,na.rm = T),
            EYE.CRIS=sum(EYE.CRIS==1,na.rm = T),
            EYE.RETI=sum(EYE.RETI==1,na.rm = T),
            EYE.CEGU=sum(EYE.CEGU==1,na.rm = T),
            EYE.CONJ=sum(EYE.CONJ==1,na.rm = T),
            EYE.OTCO=sum(EYE.OTCO==1,na.rm = T),
            EYE.LAGR=sum(EYE.LAGR==1,na.rm = T),
            EYE.ESTR=sum(EYE.ESTR==1,na.rm = T),
            EYE.BINO=sum(EYE.BINO==1,na.rm = T),
            EYE.REFR=sum(EYE.REFR==1,na.rm = T),
            EYE.OTRA=sum(EYE.OTRA==1,na.rm = T),
            EAR.OMTM=sum(EAR.OMTM==1,na.rm = T),
            EAR.OTOM=sum(EAR.OTOM==1,na.rm = T),
            EAR.SORD=sum(EAR.SORD==1,na.rm = T),
            EAR.OTRA=sum(EAR.OTRA==1,na.rm = T),
            SC1.FIRE=sum(SC1.FIRE==1,na.rm = T),
            SC1.CRHD=sum(SC1.CRHD==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            SC4.EMBP=sum(SC4.EMBP==1,na.rm = T),
            SC4.CARR=sum(SC4.CARR==1,na.rm = T),
            SC4.PARO=sum(SC4.PARO==1,na.rm = T),
            SC4.HEFA=sum(SC4.HEFA==1,na.rm = T),
            SC4.OTRA=sum(SC4.OTRA==1,na.rm = T),
            SC5.HEMS=sum(SC5.HEMS==1,na.rm = T),
            SC5.HEMI=sum(SC5.HEMI==1,na.rm = T),
            SC5.ISQC=sum(SC5.ISQC==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC5.ATSC=sum(SC5.ATSC==1,na.rm = T),
            SC5.SEQC=sum(SC5.SEQC==1,na.rm = T),
            SC5.OTRA=sum(SC5.OTRA==1,na.rm = T),
            SC6.ATER=sum(SC6.ATER==1,na.rm = T),
            SC6.OEVP=sum(SC6.OEVP==1,na.rm = T),
            SC6.ETAR=sum(SC6.ETAR==1,na.rm = T),
            SC6.OTAR=sum(SC6.OTAR==1,na.rm = T),
            SC6.ETVE=sum(SC6.ETVE==1,na.rm = T),
            SC6.VARI=sum(SC6.VARI==1,na.rm = T),
            SC6.HMRR=sum(SC6.HMRR==1,na.rm = T),
            SC6.OTRA=sum(SC6.OTRA==1,na.rm = T),
            ER1.FAAG=sum(ER1.FAAG==1,na.rm = T),
            ER1.TOAG=sum(ER1.TOAG==1,na.rm = T),
            ER1.LTAG=sum(ER1.LTAG==1,na.rm = T),
            ER1.OTAG=sum(ER1.OTAG==1,na.rm = T),
            ER1.PNSD=sum(ER1.PNSD==1,na.rm = T),
            ER1.RNPC=sum(ER1.RNPC==1,na.rm = T),
            ER1.SINC=sum(ER1.SINC==1,na.rm = T),
            ER1.TADC=sum(ER1.TADC==1,na.rm = T),
            ER1.ONSN=sum(ER1.ONSN==1,na.rm = T),
            ER1.OTRA=sum(ER1.OTRA==1,na.rm = T),
            ER2.BRAG=sum(ER2.BRAG==1,na.rm = T),
            ER2.NEUM=sum(ER2.NEUM==1,na.rm = T),
            ER2.INFL=sum(ER2.INFL==1,na.rm = T),
            ER2.BCNE=sum(ER2.BCNE==1,na.rm = T),
            ER2.ASMA=sum(ER2.ASMA==1,na.rm = T),
            ER2.BREC=sum(ER2.BREC==1,na.rm = T),
            ER2.EPOC=sum(ER2.EPOC==1,na.rm = T),
            ER2.NMCS=sum(ER2.NMCS==1,na.rm = T),
            ER2.OTAE=sum(ER2.OTAE==1,na.rm = T),
            ER2.PLEU=sum(ER2.PLEU==1,na.rm = T),
            ER2.IRIN=sum(ER2.IRIN==1,na.rm = T),
            ER2.OTRA=sum(ER2.OTRA==1,na.rm = T),
            SD1.CARI=sum(SD1.CARI==1,na.rm = T),
            SD1.OTDI=sum(SD1.OTDI==1,na.rm = T),
            SD1.OTJA=sum(SD1.OTJA==1,na.rm = T),
            SD1.OTRA=sum(SD1.OTRA==1,na.rm = T),
            SD2.ESOF=sum(SD2.ESOF==1,na.rm = T),
            SD2.GDIS=sum(SD2.GDIS==1,na.rm = T),
            SD2.GDUL=sum(SD2.GDUL==1,na.rm = T),
            SD2.OTGD=sum(SD2.OTGD==1,na.rm = T),
            SD2.APEN=sum(SD2.APEN==1,na.rm = T),
            SD2.INHE=sum(SD2.INHE==1,na.rm = T),
            SD2.OTHE=sum(SD2.OTHE==1,na.rm = T),
            SD2.CRCU=sum(SD2.CRCU==1,na.rm = T),
            SD2.PIIO=sum(SD2.PIIO==1,na.rm = T),
            SD2.EDDI=sum(SD2.EDDI==1,na.rm = T),
            SD2.SIIO=sum(SD2.SIIO==1,na.rm = T),
            SD3.ALLD=sum(SD3.ALLD==1,na.rm = T),
            SD3.OTLI=sum(SD3.OTLI==1,na.rm = T),
            SD3.COLE=sum(SD3.COLE==1,na.rm = T),
            SD3.OTIP=sum(SD3.OTIP==1,na.rm = T),
            SD3.PANC=sum(SD3.PANC==1,na.rm = T),
            SD3.OTRA=sum(SD3.OTRA==1,na.rm = T),
            PTS.IPTS=sum(PTS.IPTS==1,na.rm = T),
            PTS.DEEC=sum(PTS.DEEC==1,na.rm = T),
            PTS.OTRA=sum(PTS.OTRA==1,na.rm = T),
            MOC.PAIN=sum(MOC.PAIN==1,na.rm = T),
            MOC.OSAR=sum(MOC.OSAR==1,na.rm = T),
            MOC.ADOL=sum(MOC.ADOL==1,na.rm = T),
            MOC.OTAR=sum(MOC.OTAR==1,na.rm = T),
            MOC.SCTD=sum(MOC.SCTD==1,na.rm = T),
            MOC.IVDD=sum(MOC.IVDD==1,na.rm = T),
            MOC.OTDO=sum(MOC.OTDO==1,na.rm = T),
            MOC.SOFT=sum(MOC.SOFT==1,na.rm = T),
            MOC.BONE=sum(MOC.BONE==1,na.rm = T),
            MOC.OMIE=sum(MOC.OMIE==1,na.rm = T),
            MOC.OTRA=sum(MOC.OTRA==1,na.rm = T),
            GU1.NFRI=sum(GU1.NFRI==1,na.rm = T),
            GU1.OTGL=sum(GU1.OTGL==1,na.rm = T),
            GU1.ACKF=sum(GU1.ACKF==1,na.rm = T),
            GU1.RTID=sum(GU1.RTID==1,na.rm = T),
            GU1.OTTU=sum(GU1.OTTU==1,na.rm = T),
            GU1.LITO=sum(GU1.LITO==1,na.rm = T),
            GU1.RECO=sum(GU1.RECO==1,na.rm = T),
            GU1.CIST=sum(GU1.CIST==1,na.rm = T),
            GU1.OTRA=sum(GU1.OTRA==1,na.rm = T),
            GU2.HIPR=sum(GU2.HIPR==1,na.rm = T),
            GU2.OTPR=sum(GU2.OTPR==1,na.rm = T),
            GU2.HCEC=sum(GU2.HCEC==1,na.rm = T),
            GU2.PREP=sum(GU2.PREP==1,na.rm = T),
            GU2.MINF=sum(GU2.MINF==1,na.rm = T),
            GU2.OTRA=sum(GU2.OTRA==1,na.rm = T),
            GU3.MAMA=sum(GU3.MAMA==1,na.rm = T),
            GU4.SAOO=sum(GU4.SAOO==1,na.rm = T),
            GU4.IDCU=sum(GU4.IDCU==1,na.rm = T),
            GU4.OTVV=sum(GU4.OTVV==1,na.rm = T),
            GU4.OTPI=sum(GU4.OTPI==1,na.rm = T),
            GU4.ENDM=sum(GU4.ENDM==1,na.rm = T),
            GU4.FPRO=sum(GU4.FPRO==1,na.rm = T),
            GU4.NOFB=sum(GU4.NOFB==1,na.rm = T),
            GU4.MENS=sum(GU4.MENS==1,na.rm = T),
            GU4.MNOP=sum(GU4.MNOP==1,na.rm = T),
            GU4.FINF=sum(GU4.FINF==1,na.rm = T),
            GU4.OTRA=sum(GU4.OTRA==1,na.rm = T),
            OB1.SPON=sum(OB1.SPON==1,na.rm = T),
            OB1.INDU=sum(OB1.INDU==1,na.rm = T),
            OB1.OTRA=sum(OB1.OTRA==1,na.rm = T),
            OB2.EPHD=sum(OB2.EPHD==1,na.rm = T),
            OB2.HEMP=sum(OB2.HEMP==1,na.rm = T),
            OB2.FACD=sum(OB2.FACD==1,na.rm = T),
            OB2.IGUT=sum(OB2.IGUT==1,na.rm = T),
            OB2.DMIP=sum(OB2.DMIP==1,na.rm = T),
            OB2.OBSL=sum(OB2.OBSL==1,na.rm = T),
            OB2.PPHE=sum(OB2.PPHE==1,na.rm = T),
            OB2.SOPI=sum(OB2.SOPI==1,na.rm = T),
            OB2.PUER=sum(OB2.PUER==1,na.rm = T),
            OB2.OTPL=sum(OB2.OTPL==1,na.rm = T),
            OB2.OBTE=sum(OB2.OBTE==1,na.rm = T),
            OB2.BEPU=sum(OB2.BEPU==1,na.rm = T),
            OB2.OMLC=sum(OB2.OMLC==1,na.rm = T),
            OB2.OTDC=sum(OB2.OTDC==1,na.rm = T),
            OB2.ODUC=sum(OB2.ODUC==1,na.rm = T),
            OB3.SSDE=sum(OB3.SSDE==1,na.rm = T),
            OB3.OTDE=sum(OB3.OTDE==1,na.rm = T),
            OB4.INOC=sum(OB4.INOC==1,na.rm = T),
            NEO.NAMC=sum(NEO.NAMC==1,na.rm = T),
            NEO.NAOC=sum(NEO.NAOC==1,na.rm = T),
            NEO.GMGW=sum(NEO.GMGW==1,na.rm = T),
            NEO.BITR=sum(NEO.BITR==1,na.rm = T),
            NEO.HIAS=sum(NEO.HIAS==1,na.rm = T),
            NEO.SDRN=sum(NEO.SDRN==1,na.rm = T),
            NEO.INFE=sum(NEO.INFE==1,na.rm = T),
            NEO.OTIN=sum(NEO.OTIN==1,na.rm = T),
            NEO.HDNB=sum(NEO.HDNB==1,na.rm = T),
            NEO.TENE=sum(NEO.TENE==1,na.rm = T),
            NEO.OTRA=sum(NEO.OTRA==1,na.rm = T),
            CON.ANEN=sum(CON.ANEN==1,na.rm = T),
            CON.HIDR=sum(CON.HIDR==1,na.rm = T),
            CON.SBIF=sum(CON.SBIF==1,na.rm = T),
            CON.OTNS=sum(CON.OTNS==1,na.rm = T),
            CON.CIRC=sum(CON.CIRC==1,na.rm = T),
            CON.CLCP=sum(CON.CLCP==1,na.rm = T),
            CON.CINT=sum(CON.CINT==1,na.rm = T),
            CON.OTDS=sum(CON.OTDS==1,na.rm = T),
            CON.TEST=sum(CON.TEST==1,na.rm = T),
            CON.OTGU=sum(CON.OTGU==1,na.rm = T),
            CON.DHIP=sum(CON.DHIP==1,na.rm = T),
            CON.FEET=sum(CON.FEET==1,na.rm = T),
            CON.OTMS=sum(CON.OTMS==1,na.rm = T),
            CON.OTRA=sum(CON.OTRA==1,na.rm = T),
            CON.CROM=sum(CON.CROM==1,na.rm = T),
            NCL.FEVU=sum(NCL.FEVU==1,na.rm = T),
            NCL.CAAB=sum(NCL.CAAB==1,na.rm = T),
            NCL.RAOR=sum(NCL.RAOR==1,na.rm = T),
            NCL.ABPP=sum(NCL.ABPP==1,na.rm = T),
            NCL.ARPD=sum(NCL.ARPD==1,na.rm = T),
            NCL.SIDS=sum(NCL.SIDS==1,na.rm = T),
            NCL.REAR=sum(NCL.REAR==1,na.rm = T),
            NCL.OTRA=sum(NCL.OTRA==1,na.rm = T),
            EX1.RAIL=sum(EX1.RAIL==1,na.rm = T),
            EX1.MOTO=sum(EX1.MOTO==1,na.rm = T),
            EX1.LAND=sum(EX1.LAND==1,na.rm = T),
            EX1.WATE=sum(EX1.WATE==1,na.rm = T),
            EX1.AIRS=sum(EX1.AIRS==1,na.rm = T),
            EX1.OTRO=sum(EX1.OTRO==1,na.rm = T),
            EX2.FALL=sum(EX2.FALL==1,na.rm = T),
            EX3.ENVI=sum(EX3.ENVI==1,na.rm = T),
            EX3.DROW=sum(EX3.DROW==1,na.rm = T),
            EX3.FBNO=sum(EX3.FBNO==1,na.rm = T),
            EX3.MACH=sum(EX3.MACH==1,na.rm = T),
            EX3.FREG=sum(EX3.FREG==1,na.rm = T),
            EX3.SEQA=sum(EX3.SEQA==1,na.rm = T),
            EX3.OTRA=sum(EX3.OTRA==1,na.rm = T),
            EX4.SMFF=sum(EX4.SMFF==1,na.rm = T),
            EX5.APDM=sum(EX5.APDM==1,na.rm = T),
            EX5.APSL=sum(EX5.APSL==1,na.rm = T),
            EX5.APGV=sum(EX5.APGV==1,na.rm = T),
            EX6.SUIC=sum(EX6.SUIC==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            EX8.EOUI=sum(EX8.EOUI==1,na.rm = T),
            EX8.OWAR=sum(EX8.OWAR==1,na.rm = T),
            EX8.LEGI=sum(EX8.LEGI==1,na.rm = T),
            EX9.DRUG=sum(EX9.DRUG==1,na.rm = T),
            EX9.MSDV=sum(EX9.MSDV==1,na.rm = T),
            EX9.SQEX=sum(EX9.SQEX==1,na.rm = T),
            COVID=sum(COVID==1,na.rm = T),
  )%>%
  left_join(Pob_edad_2020_entidad_total,by="EDAD_QUIN")%>%
  summarise(EII.COLE=(EII.COLE/POB)*Weight*100000,
            EII.TIPA=(EII.TIPA/POB)*Weight*100000,
            EII.SHIG=(EII.SHIG/POB)*Weight*100000,
            EII.TOXI=(EII.TOXI/POB)*Weight*100000,
            EII.AMEB=(EII.AMEB/POB)*Weight*100000,
            EII.OTRA=(EII.OTRA/POB)*Weight*100000,
            EII.PRES=(EII.PRES/POB)*Weight*100000,
            TUB.PULM=(TUB.PULM/POB)*Weight*100000,
            TUB.RESP=(TUB.RESP/POB)*Weight*100000,
            TUB.NERV=(TUB.NERV/POB)*Weight*100000,
            TUB.IPGM=(TUB.IPGM/POB)*Weight*100000,
            TUB.BONE=(TUB.BONE/POB)*Weight*100000,
            TUB.URIN=(TUB.URIN/POB)*Weight*100000,
            TUB.OTRA=(TUB.OTRA/POB)*Weight*100000,
            BAC.PEST=(BAC.PEST/POB)*Weight*100000,
            BAC.BRUS=(BAC.BRUS/POB)*Weight*100000,
            BAC.LEPR=(BAC.LEPR/POB)*Weight*100000,
            BAC.DIFT=(BAC.DIFT/POB)*Weight*100000,
            BAC.PERT=(BAC.PERT/POB)*Weight*100000,
            BAC.PYOG=(BAC.PYOG/POB)*Weight*100000,
            BAC.MENI=(BAC.MENI/POB)*Weight*100000,
            BAC.TETA=(BAC.TETA/POB)*Weight*100000,
            BAC.SEPS=(BAC.SEPS/POB)*Weight*100000,
            BAC.OTRA=(BAC.OTRA/POB)*Weight*100000,
            ETS.SIF1=(ETS.SIF1/POB)*Weight*100000,
            ETS.SIF2=(ETS.SIF2/POB)*Weight*100000,
            ETS.SIF3=(ETS.SIF3/POB)*Weight*100000,
            ETS.GONO=(ETS.GONO/POB)*Weight*100000,
            ETS.CLAM=(ETS.CLAM/POB)*Weight*100000,
            ETS.OTRA=(ETS.OTRA/POB)*Weight*100000,
            VIR.POLI=(VIR.POLI/POB)*Weight*100000,
            VIR.VIRU=(VIR.VIRU/POB)*Weight*100000,
            VIR.SARA=(VIR.SARA/POB)*Weight*100000,
            VIR.RUBE=(VIR.RUBE/POB)*Weight*100000,
            VIR.FIAM=(VIR.FIAM/POB)*Weight*100000,
            VIR.DENG=(VIR.DENG/POB)*Weight*100000,
            VIR.DHEM=(VIR.DHEM/POB)*Weight*100000,
            VIR.VIH1=(VIR.VIH1/POB)*Weight*100000,
            VIR.EVTA=(VIR.EVTA/POB)*Weight*100000,
            VIR.HEPB=(VIR.HEPB/POB)*Weight*100000,
            VIR.HEPO=(VIR.HEPO/POB)*Weight*100000,
            VIR.RABI=(VIR.RABI/POB)*Weight*100000,
            VIR.TRAC=(VIR.TRAC/POB)*Weight*100000,
            VIR.OFAH=(VIR.OFAH/POB)*Weight*100000,
            VIR.HERP=(VIR.HERP/POB)*Weight*100000,
            VIR.VRHZ=(VIR.VRHZ/POB)*Weight*100000,
            VIR.PARO=(VIR.PARO/POB)*Weight*100000,
            VIR.OCLA=(VIR.OCLA/POB)*Weight*100000,
            VIR.OTRA=(VIR.OTRA/POB)*Weight*100000,
            RPI.TIFP=(RPI.TIFP/POB)*Weight*100000,
            RPI.OTIF=(RPI.OTIF/POB)*Weight*100000,
            RPI.ORIC=(RPI.ORIC/POB)*Weight*100000,
            RPI.PALU=(RPI.PALU/POB)*Weight*100000,
            RPI.LEIS=(RPI.LEIS/POB)*Weight*100000,
            RPI.TRIP=(RPI.TRIP/POB)*Weight*100000,
            PMO.ESPI=(PMO.ESPI/POB)*Weight*100000,
            PMO.FIRE=(PMO.FIRE/POB)*Weight*100000,
            PMO.MICO=(PMO.MICO/POB)*Weight*100000,
            PMO.SCHI=(PMO.SCHI/POB)*Weight*100000,
            PMO.TREM=(PMO.TREM/POB)*Weight*100000,
            PMO.ECHI=(PMO.ECHI/POB)*Weight*100000,
            PMO.DRAC=(PMO.DRAC/POB)*Weight*100000,
            PMO.ONCH=(PMO.ONCH/POB)*Weight*100000,
            PMO.FILA=(PMO.FILA/POB)*Weight*100000,
            PMO.ANNE=(PMO.ANNE/POB)*Weight*100000,
            PMO.HELM=(PMO.HELM/POB)*Weight*100000,
            PMO.OTRA=(PMO.OTRA/POB)*Weight*100000,
            SEI.TUBE=(SEI.TUBE/POB)*Weight*100000,
            SEI.POLI=(SEI.POLI/POB)*Weight*100000,
            SEI.LEPR=(SEI.LEPR/POB)*Weight*100000,
            SEI.OTRA=(SEI.OTRA/POB)*Weight*100000,
            NM1.LCBF=(NM1.LCBF/POB)*Weight*100000,
            NM2.ESOF=(NM2.ESOF/POB)*Weight*100000,
            NM2.STOM=(NM2.STOM/POB)*Weight*100000,
            NM2.INDE=(NM2.INDE/POB)*Weight*100000,
            NM2.COLO=(NM2.COLO/POB)*Weight*100000,
            NM2.RECT=(NM2.RECT/POB)*Weight*100000,
            NM2.HIGA=(NM2.HIGA/POB)*Weight*100000,
            NM2.PANC=(NM2.PANC/POB)*Weight*100000,
            NM2.OTRO=(NM2.OTRO/POB)*Weight*100000,
            NM3.LARI=(NM3.LARI/POB)*Weight*100000,
            NM3.TBPU=(NM3.TBPU/POB)*Weight*100000,
            NM3.OTRO=(NM3.OTRO/POB)*Weight*100000,
            NM4.BONE=(NM4.BONE/POB)*Weight*100000,
            NM4.MELA=(NM4.MELA/POB)*Weight*100000,
            NM4.SKIN=(NM4.SKIN/POB)*Weight*100000,
            NM4.MAMA=(NM4.MAMA/POB)*Weight*100000,
            NM4.SOFT=(NM4.SOFT/POB)*Weight*100000,
            NM5.CERV=(NM5.CERV/POB)*Weight*100000,
            NM5.PLAC=(NM5.PLAC/POB)*Weight*100000,
            NM5.UTER=(NM5.UTER/POB)*Weight*100000,
            NM5.OVAR=(NM5.OVAR/POB)*Weight*100000,
            NM5.VAGI=(NM5.VAGI/POB)*Weight*100000,
            NM5.OTFE=(NM5.OTFE/POB)*Weight*100000,
            NM5.PROS=(NM5.PROS/POB)*Weight*100000,
            NM5.TEST=(NM5.TEST/POB)*Weight*100000,
            NM5.OTMA=(NM5.OTMA/POB)*Weight*100000,
            NM5.VEJI=(NM5.VEJI/POB)*Weight*100000,
            NM5.OTUR=(NM5.OTUR/POB)*Weight*100000,
            NM6.ENCF=(NM6.ENCF/POB)*Weight*100000,
            NM6.MENI=(NM6.MENI/POB)*Weight*100000,
            NM6.OJOA=(NM6.OJOA/POB)*Weight*100000,
            NM6.OTRO=(NM6.OTRO/POB)*Weight*100000,
            NM7.ENHO=(NM7.ENHO/POB)*Weight*100000,
            NM7.NOHO=(NM7.NOHO/POB)*Weight*100000,
            NM7.MMCP=(NM7.MMCP/POB)*Weight*100000,
            NM7.LEUC=(NM7.LEUC/POB)*Weight*100000,
            NM7.OTRO=(NM7.OTRO/POB)*Weight*100000,
            NM8.MUPT=(NM8.MUPT/POB)*Weight*100000,
            NIS.CERV=(NIS.CERV/POB)*Weight*100000,
            NIS.OTRO=(NIS.OTRO/POB)*Weight*100000,
            NBE.SKIN=(NBE.SKIN/POB)*Weight*100000,
            NBE.MAMA=(NBE.MAMA/POB)*Weight*100000,
            NBE.LEIO=(NBE.LEIO/POB)*Weight*100000,
            NBE.OVAR=(NBE.OVAR/POB)*Weight*100000,
            NBE.URIN=(NBE.URIN/POB)*Weight*100000,
            NBE.CSNC=(NBE.CSNC/POB)*Weight*100000,
            NBE.TIRO=(NBE.TIRO/POB)*Weight*100000,
            NBE.OTRO=(NBE.OTRO/POB)*Weight*100000,
            NCI.UNCB=(NCI.UNCB/POB)*Weight*100000,
            SAN.ADFE=(SAN.ADFE/POB)*Weight*100000,
            SAN.AOTR=(SAN.AOTR/POB)*Weight*100000,
            SAN.INMU=(SAN.INMU/POB)*Weight*100000,
            SAN.OTRA=(SAN.OTRA/POB)*Weight*100000,
            END.DEYO=(END.DEYO/POB)*Weight*100000,
            END.TTOX=(END.TTOX/POB)*Weight*100000,
            END.TOTR=(END.TOTR/POB)*Weight*100000,
            END.DIAB=(END.DIAB/POB)*Weight*100000,
            END.LIPO=(END.LIPO/POB)*Weight*100000,
            END.OBES=(END.OBES/POB)*Weight*100000,
            END.DEPL=(END.DEPL/POB)*Weight*100000,
            END.SQHA=(END.SQHA/POB)*Weight*100000,
            END.OTRA=(END.OTRA/POB)*Weight*100000,
            NUT.KWAS=(NUT.KWAS/POB)*Weight*100000,
            NUT.MARA=(NUT.MARA/POB)*Weight*100000,
            NUT.PROT=(NUT.PROT/POB)*Weight*100000,
            NUT.VITA=(NUT.VITA/POB)*Weight*100000,
            NUT.VITO=(NUT.VITO/POB)*Weight*100000,
            NUT.SECD=(NUT.SECD/POB)*Weight*100000,
            NUT.OTRA=(NUT.OTRA/POB)*Weight*100000,
            MEN.DEME=(MEN.DEME/POB)*Weight*100000,
            MEN.SDAL=(MEN.SDAL/POB)*Weight*100000,
            MEN.OTAL=(MEN.OTAL/POB)*Weight*100000,
            MEN.TMSP=(MEN.TMSP/POB)*Weight*100000,
            MEN.ESQU=(MEN.ESQU/POB)*Weight*100000,
            MEN.HUMO=(MEN.HUMO/POB)*Weight*100000,
            MEN.ESTR=(MEN.ESTR/POB)*Weight*100000,
            MEN.FISI=(MEN.FISI/POB)*Weight*100000,
            MEN.RETR=(MEN.RETR/POB)*Weight*100000,
            MEN.OTRO=(MEN.OTRO/POB)*Weight*100000,
            NER.MENI=(NER.MENI/POB)*Weight*100000,
            NER.ISNC=(NER.ISNC/POB)*Weight*100000,
            NER.PARK=(NER.PARK/POB)*Weight*100000,
            NER.ALZH=(NER.ALZH/POB)*Weight*100000,
            NER.ESCM=(NER.ESCM/POB)*Weight*100000,
            NER.PALS=(NER.PALS/POB)*Weight*100000,
            NER.EPIL=(NER.EPIL/POB)*Weight*100000,
            NER.MIGR=(NER.MIGR/POB)*Weight*100000,
            NER.IQCT=(NER.IQCT/POB)*Weight*100000,
            NER.SNPE=(NER.SNPE/POB)*Weight*100000,
            NER.OTRA=(NER.OTRA/POB)*Weight*100000,
            EYE.PARP=(EYE.PARP/POB)*Weight*100000,
            EYE.ESCL=(EYE.ESCL/POB)*Weight*100000,
            EYE.GLAU=(EYE.GLAU/POB)*Weight*100000,
            EYE.CATA=(EYE.CATA/POB)*Weight*100000,
            EYE.CRIS=(EYE.CRIS/POB)*Weight*100000,
            EYE.RETI=(EYE.RETI/POB)*Weight*100000,
            EYE.CEGU=(EYE.CEGU/POB)*Weight*100000,
            EYE.CONJ=(EYE.CONJ/POB)*Weight*100000,
            EYE.OTCO=(EYE.OTCO/POB)*Weight*100000,
            EYE.LAGR=(EYE.LAGR/POB)*Weight*100000,
            EYE.ESTR=(EYE.ESTR/POB)*Weight*100000,
            EYE.BINO=(EYE.BINO/POB)*Weight*100000,
            EYE.REFR=(EYE.REFR/POB)*Weight*100000,
            EYE.OTRA=(EYE.OTRA/POB)*Weight*100000,
            EAR.OMTM=(EAR.OMTM/POB)*Weight*100000,
            EAR.OTOM=(EAR.OTOM/POB)*Weight*100000,
            EAR.SORD=(EAR.SORD/POB)*Weight*100000,
            EAR.OTRA=(EAR.OTRA/POB)*Weight*100000,
            SC1.FIRE=(SC1.FIRE/POB)*Weight*100000,
            SC1.CRHD=(SC1.CRHD/POB)*Weight*100000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*100000,
            SC2.HTES=(SC2.HTES/POB)*Weight*100000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*100000,
            SC3.IAMC=(SC3.IAMC/POB)*Weight*100000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*100000,
            SC4.EMBP=(SC4.EMBP/POB)*Weight*100000,
            SC4.CARR=(SC4.CARR/POB)*Weight*100000,
            SC4.PARO=(SC4.PARO/POB)*Weight*100000,
            SC4.HEFA=(SC4.HEFA/POB)*Weight*100000,
            SC4.OTRA=(SC4.OTRA/POB)*Weight*100000,
            SC5.HEMS=(SC5.HEMS/POB)*Weight*100000,
            SC5.HEMI=(SC5.HEMI/POB)*Weight*100000,
            SC5.ISQC=(SC5.ISQC/POB)*Weight*100000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*100000,
            SC5.ATSC=(SC5.ATSC/POB)*Weight*100000,
            SC5.SEQC=(SC5.SEQC/POB)*Weight*100000,
            SC5.OTRA=(SC5.OTRA/POB)*Weight*100000,
            SC6.ATER=(SC6.ATER/POB)*Weight*100000,
            SC6.OEVP=(SC6.OEVP/POB)*Weight*100000,
            SC6.ETAR=(SC6.ETAR/POB)*Weight*100000,
            SC6.OTAR=(SC6.OTAR/POB)*Weight*100000,
            SC6.ETVE=(SC6.ETVE/POB)*Weight*100000,
            SC6.VARI=(SC6.VARI/POB)*Weight*100000,
            SC6.HMRR=(SC6.HMRR/POB)*Weight*100000,
            SC6.OTRA=(SC6.OTRA/POB)*Weight*100000,
            ER1.FAAG=(ER1.FAAG/POB)*Weight*100000,
            ER1.TOAG=(ER1.TOAG/POB)*Weight*100000,
            ER1.LTAG=(ER1.LTAG/POB)*Weight*100000,
            ER1.OTAG=(ER1.OTAG/POB)*Weight*100000,
            ER1.PNSD=(ER1.PNSD/POB)*Weight*100000,
            ER1.RNPC=(ER1.RNPC/POB)*Weight*100000,
            ER1.SINC=(ER1.SINC/POB)*Weight*100000,
            ER1.TADC=(ER1.TADC/POB)*Weight*100000,
            ER1.ONSN=(ER1.ONSN/POB)*Weight*100000,
            ER1.OTRA=(ER1.OTRA/POB)*Weight*100000,
            ER2.BRAG=(ER2.BRAG/POB)*Weight*100000,
            ER2.NEUM=(ER2.NEUM/POB)*Weight*100000,
            ER2.INFL=(ER2.INFL/POB)*Weight*100000,
            ER2.BCNE=(ER2.BCNE/POB)*Weight*100000,
            ER2.ASMA=(ER2.ASMA/POB)*Weight*100000,
            ER2.BREC=(ER2.BREC/POB)*Weight*100000,
            ER2.EPOC=(ER2.EPOC/POB)*Weight*100000,
            ER2.NMCS=(ER2.NMCS/POB)*Weight*100000,
            ER2.OTAE=(ER2.OTAE/POB)*Weight*100000,
            ER2.PLEU=(ER2.PLEU/POB)*Weight*100000,
            ER2.IRIN=(ER2.IRIN/POB)*Weight*100000,
            ER2.OTRA=(ER2.OTRA/POB)*Weight*100000,
            SD1.CARI=(SD1.CARI/POB)*Weight*100000,
            SD1.OTDI=(SD1.OTDI/POB)*Weight*100000,
            SD1.OTJA=(SD1.OTJA/POB)*Weight*100000,
            SD1.OTRA=(SD1.OTRA/POB)*Weight*100000,
            SD2.ESOF=(SD2.ESOF/POB)*Weight*100000,
            SD2.GDIS=(SD2.GDIS/POB)*Weight*100000,
            SD2.GDUL=(SD2.GDUL/POB)*Weight*100000,
            SD2.OTGD=(SD2.OTGD/POB)*Weight*100000,
            SD2.APEN=(SD2.APEN/POB)*Weight*100000,
            SD2.INHE=(SD2.INHE/POB)*Weight*100000,
            SD2.OTHE=(SD2.OTHE/POB)*Weight*100000,
            SD2.CRCU=(SD2.CRCU/POB)*Weight*100000,
            SD2.PIIO=(SD2.PIIO/POB)*Weight*100000,
            SD2.EDDI=(SD2.EDDI/POB)*Weight*100000,
            SD2.SIIO=(SD2.SIIO/POB)*Weight*100000,
            SD3.ALLD=(SD3.ALLD/POB)*Weight*100000,
            SD3.OTLI=(SD3.OTLI/POB)*Weight*100000,
            SD3.COLE=(SD3.COLE/POB)*Weight*100000,
            SD3.OTIP=(SD3.OTIP/POB)*Weight*100000,
            SD3.PANC=(SD3.PANC/POB)*Weight*100000,
            SD3.OTRA=(SD3.OTRA/POB)*Weight*100000,
            PTS.IPTS=(PTS.IPTS/POB)*Weight*100000,
            PTS.DEEC=(PTS.DEEC/POB)*Weight*100000,
            PTS.OTRA=(PTS.OTRA/POB)*Weight*100000,
            MOC.PAIN=(MOC.PAIN/POB)*Weight*100000,
            MOC.OSAR=(MOC.OSAR/POB)*Weight*100000,
            MOC.ADOL=(MOC.ADOL/POB)*Weight*100000,
            MOC.OTAR=(MOC.OTAR/POB)*Weight*100000,
            MOC.SCTD=(MOC.SCTD/POB)*Weight*100000,
            MOC.IVDD=(MOC.IVDD/POB)*Weight*100000,
            MOC.OTDO=(MOC.OTDO/POB)*Weight*100000,
            MOC.SOFT=(MOC.SOFT/POB)*Weight*100000,
            MOC.BONE=(MOC.BONE/POB)*Weight*100000,
            MOC.OMIE=(MOC.OMIE/POB)*Weight*100000,
            MOC.OTRA=(MOC.OTRA/POB)*Weight*100000,
            GU1.NFRI=(GU1.NFRI/POB)*Weight*100000,
            GU1.OTGL=(GU1.OTGL/POB)*Weight*100000,
            GU1.ACKF=(GU1.ACKF/POB)*Weight*100000,
            GU1.RTID=(GU1.RTID/POB)*Weight*100000,
            GU1.OTTU=(GU1.OTTU/POB)*Weight*100000,
            GU1.LITO=(GU1.LITO/POB)*Weight*100000,
            GU1.RECO=(GU1.RECO/POB)*Weight*100000,
            GU1.CIST=(GU1.CIST/POB)*Weight*100000,
            GU1.OTRA=(GU1.OTRA/POB)*Weight*100000,
            GU2.HIPR=(GU2.HIPR/POB)*Weight*100000,
            GU2.OTPR=(GU2.OTPR/POB)*Weight*100000,
            GU2.HCEC=(GU2.HCEC/POB)*Weight*100000,
            GU2.PREP=(GU2.PREP/POB)*Weight*100000,
            GU2.MINF=(GU2.MINF/POB)*Weight*100000,
            GU2.OTRA=(GU2.OTRA/POB)*Weight*100000,
            GU3.MAMA=(GU3.MAMA/POB)*Weight*100000,
            GU4.SAOO=(GU4.SAOO/POB)*Weight*100000,
            GU4.IDCU=(GU4.IDCU/POB)*Weight*100000,
            GU4.OTVV=(GU4.OTVV/POB)*Weight*100000,
            GU4.OTPI=(GU4.OTPI/POB)*Weight*100000,
            GU4.ENDM=(GU4.ENDM/POB)*Weight*100000,
            GU4.FPRO=(GU4.FPRO/POB)*Weight*100000,
            GU4.NOFB=(GU4.NOFB/POB)*Weight*100000,
            GU4.MENS=(GU4.MENS/POB)*Weight*100000,
            GU4.MNOP=(GU4.MNOP/POB)*Weight*100000,
            GU4.FINF=(GU4.FINF/POB)*Weight*100000,
            GU4.OTRA=(GU4.OTRA/POB)*Weight*100000,
            OB1.SPON=(OB1.SPON/POB)*Weight*100000,
            OB1.INDU=(OB1.INDU/POB)*Weight*100000,
            OB1.OTRA=(OB1.OTRA/POB)*Weight*100000,
            OB2.EPHD=(OB2.EPHD/POB)*Weight*100000,
            OB2.HEMP=(OB2.HEMP/POB)*Weight*100000,
            OB2.FACD=(OB2.FACD/POB)*Weight*100000,
            OB2.IGUT=(OB2.IGUT/POB)*Weight*100000,
            OB2.DMIP=(OB2.DMIP/POB)*Weight*100000,
            OB2.OBSL=(OB2.OBSL/POB)*Weight*100000,
            OB2.PPHE=(OB2.PPHE/POB)*Weight*100000,
            OB2.SOPI=(OB2.SOPI/POB)*Weight*100000,
            OB2.PUER=(OB2.PUER/POB)*Weight*100000,
            OB2.OTPL=(OB2.OTPL/POB)*Weight*100000,
            OB2.OBTE=(OB2.OBTE/POB)*Weight*100000,
            OB2.BEPU=(OB2.BEPU/POB)*Weight*100000,
            OB2.OMLC=(OB2.OMLC/POB)*Weight*100000,
            OB2.OTDC=(OB2.OTDC/POB)*Weight*100000,
            OB2.ODUC=(OB2.ODUC/POB)*Weight*100000,
            OB3.SSDE=(OB3.SSDE/POB)*Weight*100000,
            OB3.OTDE=(OB3.OTDE/POB)*Weight*100000,
            OB4.INOC=(OB4.INOC/POB)*Weight*100000,
            NEO.NAMC=(NEO.NAMC/POB)*Weight*100000,
            NEO.NAOC=(NEO.NAOC/POB)*Weight*100000,
            NEO.GMGW=(NEO.GMGW/POB)*Weight*100000,
            NEO.BITR=(NEO.BITR/POB)*Weight*100000,
            NEO.HIAS=(NEO.HIAS/POB)*Weight*100000,
            NEO.SDRN=(NEO.SDRN/POB)*Weight*100000,
            NEO.INFE=(NEO.INFE/POB)*Weight*100000,
            NEO.OTIN=(NEO.OTIN/POB)*Weight*100000,
            NEO.HDNB=(NEO.HDNB/POB)*Weight*100000,
            NEO.TENE=(NEO.TENE/POB)*Weight*100000,
            NEO.OTRA=(NEO.OTRA/POB)*Weight*100000,
            CON.ANEN=(CON.ANEN/POB)*Weight*100000,
            CON.HIDR=(CON.HIDR/POB)*Weight*100000,
            CON.SBIF=(CON.SBIF/POB)*Weight*100000,
            CON.OTNS=(CON.OTNS/POB)*Weight*100000,
            CON.CIRC=(CON.CIRC/POB)*Weight*100000,
            CON.CLCP=(CON.CLCP/POB)*Weight*100000,
            CON.CINT=(CON.CINT/POB)*Weight*100000,
            CON.OTDS=(CON.OTDS/POB)*Weight*100000,
            CON.TEST=(CON.TEST/POB)*Weight*100000,
            CON.OTGU=(CON.OTGU/POB)*Weight*100000,
            CON.DHIP=(CON.DHIP/POB)*Weight*100000,
            CON.FEET=(CON.FEET/POB)*Weight*100000,
            CON.OTMS=(CON.OTMS/POB)*Weight*100000,
            CON.OTRA=(CON.OTRA/POB)*Weight*100000,
            CON.CROM=(CON.CROM/POB)*Weight*100000,
            NCL.FEVU=(NCL.FEVU/POB)*Weight*100000,
            NCL.CAAB=(NCL.CAAB/POB)*Weight*100000,
            NCL.RAOR=(NCL.RAOR/POB)*Weight*100000,
            NCL.ABPP=(NCL.ABPP/POB)*Weight*100000,
            NCL.ARPD=(NCL.ARPD/POB)*Weight*100000,
            NCL.SIDS=(NCL.SIDS/POB)*Weight*100000,
            NCL.REAR=(NCL.REAR/POB)*Weight*100000,
            NCL.OTRA=(NCL.OTRA/POB)*Weight*100000,
            EX1.RAIL=(EX1.RAIL/POB)*Weight*100000,
            EX1.MOTO=(EX1.MOTO/POB)*Weight*100000,
            EX1.LAND=(EX1.LAND/POB)*Weight*100000,
            EX1.WATE=(EX1.WATE/POB)*Weight*100000,
            EX1.AIRS=(EX1.AIRS/POB)*Weight*100000,
            EX1.OTRO=(EX1.OTRO/POB)*Weight*100000,
            EX2.FALL=(EX2.FALL/POB)*Weight*100000,
            EX3.ENVI=(EX3.ENVI/POB)*Weight*100000,
            EX3.DROW=(EX3.DROW/POB)*Weight*100000,
            EX3.FBNO=(EX3.FBNO/POB)*Weight*100000,
            EX3.MACH=(EX3.MACH/POB)*Weight*100000,
            EX3.FREG=(EX3.FREG/POB)*Weight*100000,
            EX3.SEQA=(EX3.SEQA/POB)*Weight*100000,
            EX3.OTRA=(EX3.OTRA/POB)*Weight*100000,
            EX4.SMFF=(EX4.SMFF/POB)*Weight*100000,
            EX5.APDM=(EX5.APDM/POB)*Weight*100000,
            EX5.APSL=(EX5.APSL/POB)*Weight*100000,
            EX5.APGV=(EX5.APGV/POB)*Weight*100000,
            EX6.SUIC=(EX6.SUIC/POB)*Weight*100000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*100000,
            EX8.EOUI=(EX8.EOUI/POB)*Weight*100000,
            EX8.OWAR=(EX8.OWAR/POB)*Weight*100000,
            EX8.LEGI=(EX8.LEGI/POB)*Weight*100000,
            EX9.DRUG=(EX9.DRUG/POB)*Weight*100000,
            EX9.MSDV=(EX9.MSDV/POB)*Weight*100000,
            EX9.SQEX=(EX9.SQEX/POB)*Weight*100000,
            COVID=(COVID/POB)*Weight*100000)%>%
  summarise("Cholera"=sum(EII.COLE),
            "Typhoid and paratyphoid fever"=sum(EII.TIPA),
            "Shigellosis"=sum(EII.SHIG),
            "Food poisoning"=sum(EII.TOXI),
            "Amebiasis"=sum(EII.AMEB),
            "Other GI infection"=sum(EII.OTRA),
            "Presumed GI infection"=sum(EII.PRES),
            "Pulmonary Tb"=sum(TUB.PULM),
            "Other respiratory Tb"=sum(TUB.RESP),
            "Other respiratory Tb"=sum(TUB.NERV),
            "Nervous System Tb"=sum(TUB.IPGM),
            "Intestinal/peritoneal Tb"=sum(TUB.BONE),
            "Bone and joint Tb"=sum(TUB.URIN),
            "Other variety of Tb"=sum(TUB.OTRA),
            "Plague (peste)"=sum(BAC.PEST),
            "Brusellosis"=sum(BAC.BRUS),
            "Leprosy"=sum(BAC.LEPR),
            "Diphtheria"=sum(BAC.DIFT),
            "Pertussis"=sum(BAC.PERT),
            "Scarlet fever, erysipelas"=sum(BAC.PYOG),
            "Meningococcal disease"=sum(BAC.MENI),
            "Tetanus"=sum(BAC.TETA),
            "Sepsis"=sum(BAC.SEPS),
            "Other bacterial diseases"=sum(BAC.OTRA),
            "Congenital syphilis"=sum(ETS.SIF1),
            "Early syphilis"=sum(ETS.SIF2),
            "Other syphilis"=sum(ETS.SIF3),
            "Gonorrhea"=sum(ETS.GONO),
            "Chlamydia"=sum(ETS.CLAM),
            "Other STD"=sum(ETS.OTRA),
            "Acute Poliomyelitis"=sum(VIR.POLI),
            "Smallpox (viruela)"=sum(VIR.VIRU),
            "Measles"=sum(VIR.SARA),
            "Rubella"=sum(VIR.RUBE),
            "Yellow fever"=sum(VIR.FIAM),
            "Dengue fever"=sum(VIR.DENG),
            "Dengue hemorragic fever"=sum(VIR.DHEM),
            "HIV infection"=sum(VIR.VIH1),
            "Arthropod-Borne Viral Encephalitis"=sum(VIR.EVTA),
            "Acute Hepatitis B"=sum(VIR.HEPB),
            "Other viral hepatitis"=sum(VIR.HEPO),
            "Rabies"=sum(VIR.RABI),
            "Trachoma"=sum(VIR.TRAC),
            "Other viral infections"=sum(VIR.OFAH),
            "Herpes simplex infections"=sum(VIR.HERP),
            "Chickenpox or herpes zoster"=sum(VIR.VRHZ),
            "Mumps"=sum(VIR.PARO),
            "Other chlamydia infections"=sum(VIR.OCLA),
            "Other viral diseases"=sum(VIR.OTRA),
            "Louse-borne epidemic thypus"=sum(RPI.TIFP),
            "Other thypus"=sum(RPI.OTIF),
            "Other rickettsiosis"=sum(RPI.ORIC),
            "Malaria"=sum(RPI.PALU),
            "Leishmaniasis"=sum(RPI.LEIS),
            "Trypanosomiasis"=sum(RPI.TRIP),
            "Other spirochetal diseases (Not syphilis)"=sum(PMO.ESPI),
            "Relapsing fevers"=sum(PMO.FIRE),
            "Mycosis"=sum(PMO.MICO),
            "Schistosomiasis"=sum(PMO.SCHI),
            "Other fluke (trematoda) infections"=sum(PMO.TREM),
            "Echinococcosis"=sum(PMO.ECHI),
            "Dracunculiasis"=sum(PMO.DRAC),
            "Onchocerciasis"=sum(PMO.ONCH),
            "Filariasis"=sum(PMO.FILA),
            "Ancylostomiasis or Necatoriasis"=sum(PMO.ANNE),
            "Other Helminthiases"=sum(PMO.HELM),
            "Other infectious/parasitic disease"=sum(PMO.OTRA),
            "Tuberculosis sequelae"=sum(SEI.TUBE),
            "Poliomyelitis sequelae"=sum(SEI.POLI),
            "Leprosy sequelae"=sum(SEI.LEPR),
            "Sequelae from other infections"=sum(SEI.OTRA),
            "Lip, oral cavity and pharynx cancer"=sum(NM1.LCBF),
            "Esophagus cancer"=sum(NM2.ESOF),
            "Stomach cancer"=sum(NM2.STOM),
            "Small intestine cancer"=sum(NM2.INDE),
            "Colon cancer"=sum(NM2.COLO),
            "Rectosigmoid junction, rectum and anal canal cancer"=sum(NM2.RECT),
            "Liver and intrahepatic bile ducts cancer"=sum(NM2.HIGA),
            "Pancreas cancer"=sum(NM2.PANC),
            "Other types of digestive organs cancer"=sum(NM2.OTRO),
            "Larynx cancer"=sum(NM3.LARI),
            "Trachea, bronchus and lung cancer"=sum(NM3.TBPU),
            "Other respiratory and intrathoracic organs cancer"=sum(NM3.OTRO),
            "Bone and articular cartilage cancer"=sum(NM4.BONE),
            "Malignant melanoma of skin cancer"=sum(NM4.MELA),
            "Other malignant neoplasm of skin cancer"=sum(NM4.SKIN),
            "Breast cancer"=sum(NM4.MAMA),
            "Mesothelial and soft tissue cancer"=sum(NM4.SOFT),
            "Cervix uteri cancer"=sum(NM5.CERV),
            "Placenta cancer"=sum(NM5.PLAC),
            "Uterus cancer"=sum(NM5.UTER),
            "Ovary cancer"=sum(NM5.OVAR),
            "Vulva and vagina cancer"=sum(NM5.VAGI),
            "Other and unspecified genitourinary (female) organs cancer"=sum(NM5.OTFE),
            "Prostate cancer"=sum(NM5.PROS),
            "Testis cancer"=sum(NM5.TEST),
            "Other and unspecified genitourinary (male) organs cancer"=sum(NM5.OTMA),
            "Bladder cancer"=sum(NM5.VEJI),
            "Other urinary tract cancer"=sum(NM5.OTUR),
            "Brain cancer"=sum(NM6.ENCF),
            "Meninges and other SNC cancer"=sum(NM6.MENI),
            "Eyes and adnexa cancer"=sum(NM6.OJOA),
            "Other and unspecified cancer in other organs and unspecified sites"=sum(NM6.OTRO),
            "Hodgkin lymphoma"=sum(NM7.ENHO),
            "Non-Hodgkin lymphoma"=sum(NM7.NOHO),
            "Multiple myeloma and plasmatic cell neoplasms"=sum(NM7.MMCP),
            "Leukemias"=sum(NM7.LEUC),
            "Other lymphoid, hematopoietic and related tissue"=sum(NM7.OTRO),
            "Multiple primary tumors"=sum(NM8.MUPT),
            "In-situ cervix uteri"=sum(NIS.CERV),
            "Other in situ neoplasms"=sum(NIS.OTRO),
            "Benign skin neoplasms"=sum(NBE.SKIN),
            "Benign breast neoplasms"=sum(NBE.MAMA),
            "Leiomyoma of uterus neoplasms"=sum(NBE.LEIO),
            "Benign ovary neoplasms"=sum(NBE.OVAR),
            "Bening urinary tract neoplasms"=sum(NBE.URIN),
            "Bening brain and other CNS sites neoplasms"=sum(NBE.CSNC),
            "Benign thyroid neoplasms"=sum(NBE.TIRO),
            "Other benign neoplasms"=sum(NBE.OTRO),
            "Neoplasms of uncertain behaviour"=sum(NCI.UNCB),
            "Iron deficiency anemia"=sum(SAN.ADFE),
            "Other anemias"=sum(SAN.AOTR),
            "Immunity disorders"=sum(SAN.INMU),
            "Other diseases of the blood and blood-forming organs"=sum(SAN.OTRA),
            "Iodine deficiency thyroid disorders"=sum(END.DEYO),
            "Thyrotoxicosis"=sum(END.TTOX),
            "Other thyroid disorders"=sum(END.TOTR),
            "Type 2 diabetes mellitus"=sum(END.DIAB),
            "Metabolism disorders and dyslipidemia"=sum(END.LIPO),
            "Obesity"=sum(END.OBES),
            "Volume depletion"=sum(END.DEPL),
            "Sequelae of hyperalimentation"=sum(END.SQHA),
            "Other endocrine and metabolic diseases"=sum(END.OTRA),
            "Kwashiorkor"=sum(NUT.KWAS),
            "Nutritional marasmus"=sum(NUT.MARA),
            "Other protein-calorie malnutrition"=sum(NUT.PROT),
            "Vitamin A deficiency"=sum(NUT.VITA),
            "Other vitamin deficiencies"=sum(NUT.VITO),
            "Sequelae of malnutrition"=sum(NUT.SECD),
            "Other nutritional deficiencies"=sum(NUT.OTRA),
            "Dementia"=sum(MEN.DEME),
            "Alcohol dependence syndrome"=sum(MEN.SDAL),
            "Other alcohol related disorders"=sum(MEN.OTAL),
            "Mental and behavioral disorders due to other psychoactive substances use"=sum(MEN.TMSP),
            "Schizophrenia, schizotypal, delusional, and other non-mood psychotic disorders"=sum(MEN.ESQU),
            "Mood [affective] disorders"=sum(MEN.HUMO),
            "Anxiety, dissociative, stress-related, somatoform and other nonpsychotic mental disorders"=sum(MEN.ESTR),
            "Behavioral syndromes associated with physiological disturbances and physical factors"=sum(MEN.FISI),
            "Intellectual disabilities"=sum(MEN.RETR),
            "Other mental and behavioral disorders"=sum(MEN.OTRO),
            "Meningitis"=sum(NER.MENI),
            "Other inflammatory diseases of the central nervous system"=sum(NER.ISNC),
            "Parkinson's disease"=sum(NER.PARK),
            "Alzheimer's disease"=sum(NER.ALZH),
            "Multiple sclerosis"=sum(NER.ESCM),
            "Cerebral palsy and other paralytic syndromes"=sum(NER.PALS),
            "Epilepsy and recurrent seizures"=sum(NER.EPIL),
            "Migraine and other headache syndromes"=sum(NER.MIGR),
            "Transient cerebral ischemic attacks and related syndromes"=sum(NER.IQCT),
            "Nerve, nerve root and plexus disorders"=sum(NER.SNPE),
            "Other diseases of the nervous system"=sum(NER.OTRA),
            "Eyelid inflammation"=sum(EYE.PARP),
            "Disorders of sclera and cornea"=sum(EYE.ESCL),
            "Glaucoma"=sum(EYE.GLAU),
            "Cataracts"=sum(EYE.CATA),
            "Other disorders of lens"=sum(EYE.CRIS),
            "Retinal detachments and breaks"=sum(EYE.RETI),
            "Blindness and low vision"=sum(EYE.CEGU),
            "Conjunctivitis"=sum(EYE.CONJ),
            "Other disorders of conjunctiva"=sum(EYE.OTCO),
            "Disorders of lacrimal system"=sum(EYE.LAGR),
            "Strabismus"=sum(EYE.ESTR),
            "Other disorders of binocular movement"=sum(EYE.BINO),
            "Disorders of refraction and accommodation"=sum(EYE.REFR),
            "Other diseases of the eye and adnexa"=sum(EYE.OTRA),
            "Otitis media, disorders of Eustachian tube and mastoiditis"=sum(EAR.OMTM),
            "Other middle ear disorders"=sum(EAR.OTOM),
            "Hearing loss"=sum(EAR.SORD),
            "Other diseases of the ear and mastoid process"=sum(EAR.OTRA),
            "Acute rheumatic fever"=sum(SC1.FIRE),
            "Chronic rheumatic heart diseases"=sum(SC1.CRHD),
            "Hypertensive heart disease"=sum(SC2.ECHI),
            "Essential (primary) hypertension"=sum(SC2.HTES),
            "Other hypertensive diseases"=sum(SC2.OTRA),
            "Acute myocardial infarction"=sum(SC3.IAMC),
            "Other ischemic heart diseases"=sum(SC3.OTRA),
            "Pulmonary embolism"=sum(SC4.EMBP),
            "Conduction disorders and arrhythmia"=sum(SC4.CARR),
            "Cardiac arrest"=sum(SC4.PARO),
            "Heart failure"=sum(SC4.HEFA),
            "Other diseases of pulmonary circulation and other heart diseases"=sum(SC4.OTRA),
            "Subarachnoid hemorrhage"=sum(SC5.HEMS),
            "Intracerebral and other intracranial hemorrhage"=sum(SC5.HEMI),
            "Cerebral infarction"=sum(SC5.ISQC),
            "Unspecified (hemorrhagic vs isquemic)"=sum(SC5.EVCN),
            "Cerebral atherosclerosis"=sum(SC5.ATSC),
            "Sequelae of cerebrovascular disease"=sum(SC5.SEQC),
            "Other cerebrovascular diseases"=sum(SC5.OTRA),
            "Atherosclerosis"=sum(SC6.ATER),
            "Other peripheral vascular diseases"=sum(SC6.OEVP),
            "Arterial embolism and thrombosis"=sum(SC6.ETAR),
            "Other diseases of arteries, arterioles and capillaries"=sum(SC6.OTAR),
            "Phlebitis, trombophlebitis, other venous embolism and thrombosis"=sum(SC6.ETVE),
            "Varicose veins of lower extremities"=sum(SC6.VARI),
            "Hemorrhoids"=sum(SC6.HMRR),
            "Other diseases of the circulatory system"=sum(SC6.OTRA),
            "Acute pharyngitis"=sum(ER1.FAAG),
            "Acute tonsillitis"=sum(ER1.TOAG),
            "Acute laryngitis and tracheitis"=sum(ER1.LTAG),
            "Other acute upper respiratory infections"=sum(ER1.OTAG),
            "Nasal polyp and deviated nasal septum"=sum(ER1.PNSD),
            "Chronic rhinitis, nasopharyngitis and pharyngitis"=sum(ER1.RNPC),
            "Chronic sinusitis"=sum(ER1.SINC),
            "Chronic diseases of tonsils and adenoids"=sum(ER1.TADC),
            "Other disorders of nose and nasal sinuses"=sum(ER1.ONSN),
            "Other acute upper respiratory infections"=sum(ER1.OTRA),
            "Acute bronchitis and bronchiolitis"=sum(ER2.BRAG),
            "Pneumonia"=sum(ER2.NEUM),
            "Influenza"=sum(ER2.INFL),
            "Chronic and unspecified bronchitis or emphysema"=sum(ER2.BCNE),
            "Asthma"=sum(ER2.ASMA),
            "Bronchiectasis"=sum(ER2.BREC),
            "Chronic obstructive pulmonary disease"=sum(ER2.EPOC),
            "Pneumoconiosis"=sum(ER2.NMCS),
            "Other pulmonary diseases due to external agents"=sum(ER2.OTAE),
            "Pleural conditions"=sum(ER2.PLEU),
            "Unspecified acute lower respiratory infection"=sum(ER2.IRIN),
            "Other respiratory tract diseases"=sum(ER2.OTRA),
            "Dental caries"=sum(SD1.CARI),
            "Other disorders of teeth and supporting structures"=sum(SD1.OTDI),
            "Other diseases of jaw"=sum(SD1.OTJA),
            "Other oral cavity and salivary glands"=sum(SD1.OTRA),
            "Diseases of esophagus"=sum(SD2.ESOF),
            "Gastritis and duodenitis"=sum(SD2.GDIS),
            "Gastric and duodenal ulcer"=sum(SD2.GDUL),
            "Other diseases of stomach and duodenum"=sum(SD2.OTGD),
            "Diseases of appendix"=sum(SD2.APEN),
            "Inguinal hernia"=sum(SD2.INHE),
            "Other hernias"=sum(SD2.OTHE),
            "Crohn's disease and ulcerative colitis"=sum(SD2.CRCU),
            "Paralytic ileus and intestinal obstruction without hernia"=sum(SD2.PIIO),
            "Diverticular disease of intestine"=sum(SD2.EDDI),
            "Irritable bowel syndrome and other functional intestinal disorders"=sum(SD2.SIIO),
            "Alcoholic liver disease"=sum(SD3.ALLD),
            "Other diseases of liver"=sum(SD3.OTLI),
            "Cholelithiasis and cholecystitis"=sum(SD3.COLE),
            "Other diseases of intestines and peritoneum"=sum(SD3.OTIP),
            "Acute pancreatitis and other diseases of pancreas"=sum(SD3.PANC),
            "Other diseases of digestive system"=sum(SD3.OTRA),
            "Infections of the skin and subcutaneous tissue"=sum(PTS.IPTS),
            "Dermatitis and eczema"=sum(PTS.DEEC),
            "Other diseases of the skin and subcutaneous tissue"=sum(PTS.OTRA),
            "Inflammatory polyarthropathies"=sum(MOC.PAIN),
            "Osteoarthritis"=sum(MOC.OSAR),
            "Acquired deformities of limbs"=sum(MOC.ADOL),
            "Other joint disorders"=sum(MOC.OTAR),
            "Systemic connective tissue disorders"=sum(MOC.SCTD),
            "Intervertebral disc disorders"=sum(MOC.IVDD),
            "Other dorsopathies"=sum(MOC.OTDO),
            "Soft tissue disorders"=sum(MOC.SOFT),
            "Disorders of bone density and structure"=sum(MOC.BONE),
            "Osteomyelitis"=sum(MOC.OMIE),
            "Other diseases of the musculoskeletal system and connective tissue"=sum(MOC.OTRA),
            "Acute and rapidly progressive nephritic syndrome"=sum(GU1.NFRI),
            "Other glomerular diseases"=sum(GU1.OTGL),
            "Acute kidney failure and chronic kidney disease"=sum(GU1.ACKF),
            "Renal tubulo-interstitial diseases"=sum(GU1.RTID),
            "Other renal tubulo-interstitial diseases"=sum(GU1.OTTU),
            "Urolithiasis"=sum(GU1.LITO),
            "Unspecified renal colic"=sum(GU1.RECO),
            "Cystitis"=sum(GU1.CIST),
            "Other diseases of urinary system"=sum(GU1.OTRA),
            "Benign prostatic hyperplasia"=sum(GU2.HIPR),
            "Other disorders of prostate"=sum(GU2.OTPR),
            "Hydrocele and spermatocele"=sum(GU2.HCEC),
            "Disorders of prepuce"=sum(GU2.PREP),
            "Male infertility"=sum(GU2.MINF),
            "Other male genital organs diseases"=sum(GU2.OTRA),
            "Disorders of breast"=sum(GU3.MAMA),
            "Salpingitis and oophoritis"=sum(GU4.SAOO),
            "Inflammatory disease of cervix uteri"=sum(GU4.IDCU),
            "Other diseases of uterus, vagina and vulva"=sum(GU4.OTVV),
            "Other female pelvic inflammatory diseases"=sum(GU4.OTPI),
            "Endometriosis"=sum(GU4.ENDM),
            "Female genital prolapse"=sum(GU4.FPRO),
            "Noninflammatory disorders of ovary, fallopian tube and broad ligament"=sum(GU4.NOFB),
            "Disorders of menstruation"=sum(GU4.MENS),
            "Menopausal and other perimenopausal disorders"=sum(GU4.MNOP),
            "Female infertility"=sum(GU4.FINF),
            "Other female genital organs diseases"=sum(GU4.OTRA),
            "Spontaneous abortion"=sum(OB1.SPON),
            "Complications following (induced) termination of pregnancy"=sum(OB1.INDU),
            "Other abortion"=sum(OB1.OTRA),
            "Edema, proteinuria and hypertensive disorders in pregnancy, childbirth and the puerperium"=sum(OB2.EPHD),
            "Hemorrhage in early pregnancy, placenta previa, abruptio placentae, antepartum hemorrhage"=sum(OB2.HEMP),
            "Maternal care related to the fetus and amniotic cavity and possible delivery problems"=sum(OB2.FACD),
            "Infections of genitourinary tract in pregnancy"=sum(OB2.IGUT),
            "Diabetes mellitus in pregnancy"=sum(OB2.DMIP),
            "Obstructed labor"=sum(OB2.OBSL),
            "Postpartum hemorrhage"=sum(OB2.PPHE),
            "Sepsis and other puerperal infections"=sum(OB2.SOPI),
            "Other complications of the puerperium"=sum(OB2.PUER),
            "Other complications of pregnancy and labor"=sum(OB2.OTPL),
            "Obstetrical tetanus"=sum(OB2.OBTE),
            "Mental and behavioral disorders associated with the puerperium"=sum(OB2.BEPU),
            "Puerperal osteomalacia"=sum(OB2.OMLC),
            "Other direct obstetric causes"=sum(OB2.OTDC),
            "Obstetric death of unspecified cause"=sum(OB2.ODUC),
            "Single spontaneous delivery"=sum(OB3.SSDE),
            "Other delivery"=sum(OB3.OTDE),
            "Indirect obstetric causes"=sum(OB4.INOC),
            "Newborn affected by maternal conditions"=sum(NEO.NAMC),
            "Newborn affected by obstetric complications"=sum(NEO.NAOC),
            "Slow fetal growth, fetal malnutrition, short gestation and low birth weight"=sum(NEO.GMGW),
            "Birth trauma"=sum(NEO.BITR),
            "Intrauterine hypoxia and birth asphyxia "=sum(NEO.HIAS),
            "Respiratory distress of newborn and other perinatal respiratory disorders"=sum(NEO.SDRN),
            "Congenital viral, bacterial and parasitic diseases"=sum(NEO.INFE),
            "Other infections specific to the perinatal period"=sum(NEO.OTIN),
            "Hemolytic disease of newborn"=sum(NEO.HDNB),
            "Tetanus neonatorum"=sum(NEO.TENE),
            "Other conditions originating in the perinatal period"=sum(NEO.OTRA),
            "Anencephaly and similar malformations"=sum(CON.ANEN),
            "Congenital hydrocephalus"=sum(CON.HIDR),
            "Spina bifida"=sum(CON.SBIF),
            "Other congenital malformations of the nervous system"=sum(CON.OTNS),
            "Congenital malformations of the circulatory system"=sum(CON.CIRC),
            "Cleft lip and cleft palate"=sum(CON.CLCP),
            "Congenital absence, atresia and stenosis of small intestine"=sum(CON.CINT),
            "Other congenital malformations of the digestive system"=sum(CON.OTDS),
            "Undescended and ectopic testicle"=sum(CON.TEST),
            "Other congenital malformations of genitourinary system"=sum(CON.OTGU),
            "Congenital deformities of hip"=sum(CON.DHIP),
            "Congenital deformities of feet"=sum(CON.FEET),
            "Other congenital malformations and deformations of the musculoskeletal system"=sum(CON.OTMS),
            "Other congenital malformations"=sum(CON.OTRA),
            "Chromosomal abnormalities, not elsewhere classified"=sum(CON.CROM),
            "Fever of other and unknown origin"=sum(NCL.FEVU),
            "Cardiac abnormalities"=sum(NCL.CAAB),
            "Retention of urine"=sum(NCL.RAOR),
            "Abdominal and pelvic pain"=sum(NCL.ABPP),
            "Age-related physical debility"=sum(NCL.ARPD),
            "Sudden infant death syndrome"=sum(NCL.SIDS),
            "Respiratory arrest"=sum(NCL.REAR),
            "Other symptoms, signs and abnormal clinical and laboratory findings"=sum(NCL.OTRA),
            "Railway accidents"=sum(EX1.RAIL),
            "Motor vehicle traffic accidents"=sum(EX1.MOTO),
            "Other land transport accidents"=sum(EX1.LAND),
            "Water transport accidents"=sum(EX1.WATE),
            "Air and space transport accidents"=sum(EX1.AIRS),
            "Other transport accidents"=sum(EX1.OTRO),
            "Falls"=sum(EX2.FALL),
            "Accidents caused by environmental factors"=sum(EX3.ENVI),
            "Accidental non-transport drowning and submersion"=sum(EX3.DROW),
            "Foreign body entering into or through eye or natural orifice"=sum(EX3.FBNO),
            "Accidents caused by machinery or sharp instruments"=sum(EX3.MACH),
            "Accidents caused by firearms and guns"=sum(EX3.FREG),
            "Sequelae of transport accidents and other accidents"=sum(EX3.SEQA),
            "Other accidents"=sum(EX3.OTRA),
            "Exposure to smoke, fire and flames"=sum(EX4.SMFF),
            "Accidental poisoning by drugs, medicaments and biological substances"=sum(EX5.APDM),
            "Accidental poisoning by other solid or liquid substances"=sum(EX5.APSL),
            "Accidental poisoning by other gases and vapours"=sum(EX5.APGV),
            "Intentional self-harm"=sum(EX6.SUIC),
            "Assault"=sum(EX7.ASSA),
            "Event of undetermined intent"=sum(EX8.EOUI),
            "Operations of war"=sum(EX8.OWAR),
            "Legal intervention"=sum(EX8.LEGI),
            "Drugs, medicaments and biological substances causing adverse effects in therapeutic use"=sum(EX9.DRUG),
            "Misadventures to patients during surgical and medical care"=sum(EX9.MSDV),
            "Sequelae of external causes of morbidity and mortality"=sum(EX9.SQEX),
            "Confirmed or Suspected COVID-19"=sum(COVID))%>%
  mutate(EV_YEAR=c("2020"))

CAUSA_ESPECIFICA_2016_tidy<-tidyr::gather(CAUSA_ESPECIFICA_2016, group, value, -c(EV_YEAR))
CAUSA_ESPECIFICA_2017_tidy<-tidyr::gather(CAUSA_ESPECIFICA_2017, group, value, -c(EV_YEAR))
CAUSA_ESPECIFICA_2018_tidy<-tidyr::gather(CAUSA_ESPECIFICA_2018, group, value, -c(EV_YEAR))
CAUSA_ESPECIFICA_2019_tidy<-tidyr::gather(CAUSA_ESPECIFICA_2019, group, value, -c(EV_YEAR))
CAUSA_ESPECIFICA_2020_tidy<-tidyr::gather(CAUSA_ESPECIFICA_2020, group, value, -c(EV_YEAR))

MORT_AJUSTADA_ESPECIFICA<-CAUSA_ESPECIFICA_2020_tidy%>%
  left_join(CAUSA_ESPECIFICA_2019_tidy,by="group")%>%
  left_join(CAUSA_ESPECIFICA_2018_tidy,by="group")%>% 
  left_join(CAUSA_ESPECIFICA_2017_tidy,by="group")%>% 
  left_join(CAUSA_ESPECIFICA_2016_tidy,by="group")%>% 
  group_by(group)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(value.y,value.x.x,value.y.y,value)))%>%
  mutate(AVERAGE_MORTALITY = na.replace(AVERAGE_MORTALITY,0))%>%
  mutate(EXCESS_MORTALITY=(value.x-AVERAGE_MORTALITY))%>% 
  arrange(desc(EXCESS_MORTALITY))

MORT_AJUSTADA_ESPECIFICA.2<-MORT_AJUSTADA_ESPECIFICA
MORT_AJUSTADA_ESPECIFICA.2<-MORT_AJUSTADA_ESPECIFICA.2%>%
  dplyr::select(-c(EV_YEAR.y,EV_YEAR.x.x,EV_YEAR.y.y,EV_YEAR,EV_YEAR.x))%>%
  rename("2020"="value.x",
         "2019"="value.y",
         "2018"="value.x.x",
         "2017"="value.y.y",
         "2016"="value",
         "Average Mortality (2016-2019)"="AVERAGE_MORTALITY",
         "Age Adjusted Excess Mortality"="EXCESS_MORTALITY")

MORT_AJUSTADA_ESPECIFICA.2$`2020`<-round(MORT_AJUSTADA_ESPECIFICA.2$`2020`,2)
MORT_AJUSTADA_ESPECIFICA.2$`2019`<-round(MORT_AJUSTADA_ESPECIFICA.2$`2019`,2)
MORT_AJUSTADA_ESPECIFICA.2$`2018`<-round(MORT_AJUSTADA_ESPECIFICA.2$`2018`,2)
MORT_AJUSTADA_ESPECIFICA.2$`2017`<-round(MORT_AJUSTADA_ESPECIFICA.2$`2017`,2)
MORT_AJUSTADA_ESPECIFICA.2$`2016`<-round(MORT_AJUSTADA_ESPECIFICA.2$`2016`,2)
MORT_AJUSTADA_ESPECIFICA.2$`Average Mortality (2016-2019)`<-round(MORT_AJUSTADA_ESPECIFICA.2$`Average Mortality (2016-2019)`,2)
MORT_AJUSTADA_ESPECIFICA.2$`Age Adjusted Excess Mortality`<-round(MORT_AJUSTADA_ESPECIFICA.2$`Age Adjusted Excess Mortality`,2)

#Supplementary_Table2<-flextable::align(flextable::flextable(MORT_AJUSTADA_ESPECIFICA.2,cwidth=8),align="center",part="all")%>%flextable::autofit()
#flextable::save_as_docx(Supplementary_Table2,path="Supplementary_Table2.docx")

MORT_AJUSTADA_ESPECIFICA<-MORT_AJUSTADA_ESPECIFICA[1:10,]
MORT_AJUSTADA_ESPECIFICA$EXCESS_MORTALITY<-round(MORT_AJUSTADA_ESPECIFICA$EXCESS_MORTALITY,2)
MORT_AJUSTADA_ESPECIFICA$group[MORT_AJUSTADA_ESPECIFICA$group=="Acute kidney failure and chronic kidney disease"]<-"Acute Kidney Failure \nand \nChronic Kidney Disease"
MORT_AJUSTADA_ESPECIFICA$group[MORT_AJUSTADA_ESPECIFICA$group=="Acute myocardial infarction"]<-"Acute Myocardial Infarction"
MORT_AJUSTADA_ESPECIFICA$group[MORT_AJUSTADA_ESPECIFICA$group=="Essential (primary) hypertension"]<-"Essential (Primary) Hypertension"
MORT_AJUSTADA_ESPECIFICA$group[MORT_AJUSTADA_ESPECIFICA$group=="Other hypertensive diseases"]<-"Other Hypertensive Diseases"
MORT_AJUSTADA_ESPECIFICA$group[MORT_AJUSTADA_ESPECIFICA$group=="Type 2 diabetes mellitus"]<-"Type 2 Diabetes"
MORT_AJUSTADA_ESPECIFICA$group[MORT_AJUSTADA_ESPECIFICA$group=="Unspecified (hemorrhagic vs isquemic)"]<-"Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"
MORT_AJUSTADA_ESPECIFICA$group[MORT_AJUSTADA_ESPECIFICA$group=="Hypertensive heart disease"]<-"Hypertensive Heart Disease"
MORT_AJUSTADA_ESPECIFICA$group[MORT_AJUSTADA_ESPECIFICA$group=="Other ischemic heart diseases"]<-"Other Ischemic Heart Diseases"

Figure2.df<-MORT_AJUSTADA_ESPECIFICA %>% 
  group_by(group) %>% 
  ungroup() %>% 
  arrange(desc(EXCESS_MORTALITY)) %>% 
  mutate(group = factor(group, levels = unique(group)))%>%
  dplyr::select(group,EXCESS_MORTALITY)

Figure1C<- ggplot(Figure2.df, aes(reorder(group, EXCESS_MORTALITY), EXCESS_MORTALITY)) +
  geom_col(fill="#7c8cc4",col="black") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  coord_flip()+ 
  ylab("Age-Adjusted Excess Mortality Rate \n per 100,000 inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  ggtitle("")+
  scale_y_log10()+
  geom_text(aes(label=round(EXCESS_MORTALITY,3)), vjust = 0.5,hjust = 0, color="black", size=4)+
  theme(axis.text.y = element_text(size = 13),title = element_text(size = 15))+
  gghighlight::gghighlight(group =="Confirmed or Suspected COVID-19",
                           unhighlighted_params = list(fill="#84b48c"),
                           unhighlighted_colour = "black")



######Specific-cause mortality by month (Figure 1D)#####

#2016

CAUSA_ESPECIFICA_2016_MES<-mort_2016%>%
  filter(!is.na(EDAD))%>%
  group_by(MES,EDAD_QUIN = cut(as.numeric(EDAD), 
                               breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                               right = FALSE, include.lowest = TRUE, 
                               labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                          "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                          "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                          "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2016_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*1000000,
            END.DIAB=(END.DIAB/POB)*Weight*1000000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*1000000,
            SC2.HTES=(SC2.HTES/POB)*Weight*1000000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*1000000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*1000000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*1000000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*1000000,
            END.OBES=(END.OBES/POB)*Weight*1000000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2016"))


#2017

CAUSA_ESPECIFICA_2017_MES<-mort_2017%>%
  filter(!is.na(EDAD))%>%
  group_by(MES,EDAD_QUIN = cut(as.numeric(EDAD), 
                               breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                               right = FALSE, include.lowest = TRUE, 
                               labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                          "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                          "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                          "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2017_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*1000000,
            END.DIAB=(END.DIAB/POB)*Weight*1000000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*1000000,
            SC2.HTES=(SC2.HTES/POB)*Weight*1000000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*1000000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*1000000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*1000000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*1000000,
            END.OBES=(END.OBES/POB)*Weight*1000000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2017"))

#2018

CAUSA_ESPECIFICA_2018_MES<-mort_2018%>%
  filter(!is.na(EDAD))%>%
  group_by(MES,EDAD_QUIN = cut(as.numeric(EDAD), 
                               breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                               right = FALSE, include.lowest = TRUE, 
                               labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                          "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                          "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                          "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2018_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*1000000,
            END.DIAB=(END.DIAB/POB)*Weight*1000000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*1000000,
            SC2.HTES=(SC2.HTES/POB)*Weight*1000000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*1000000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*1000000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*1000000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*1000000,
            END.OBES=(END.OBES/POB)*Weight*1000000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2018"))

#2019

CAUSA_ESPECIFICA_2019_MES<-mort_2019%>%
  filter(!is.na(EDAD))%>%
  group_by(MES,EDAD_QUIN = cut(as.numeric(EDAD), 
                               breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                               right = FALSE, include.lowest = TRUE, 
                               labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                          "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                          "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                          "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2019_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*1000000,
            END.DIAB=(END.DIAB/POB)*Weight*1000000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*1000000,
            SC2.HTES=(SC2.HTES/POB)*Weight*1000000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*1000000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*1000000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*1000000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*1000000,
            END.OBES=(END.OBES/POB)*Weight*1000000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2019"))


#2020

CAUSA_ESPECIFICA_2020_MES<-mort_2020%>%
  filter(!is.na(EDAD))%>%
  group_by(MES,EDAD_QUIN = cut(as.numeric(EDAD), 
                               breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                               right = FALSE, include.lowest = TRUE, 
                               labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                          "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                          "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                          "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T),
            COVID=sum(COVID==1,na.rm = T))%>%
  left_join(Pob_edad_2020_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*1000000,
            END.DIAB=(END.DIAB/POB)*Weight*1000000,
            END.OBES=(END.OBES/POB)*Weight*1000000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*1000000,
            SC2.HTES=(SC2.HTES/POB)*Weight*1000000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*1000000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*1000000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*1000000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*1000000,
            COVID=(COVID/POB)*Weight*1000000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Obesity"=sum(END.OBES),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Confirmed or Suspected COVID-19"=sum(COVID))%>%
  mutate(EV_YEAR=c("2020"))

#Tidy datasets
CAUSA_ESPECIFICA_2016_tidy_MES<-tidyr::gather(CAUSA_ESPECIFICA_2016_MES, group, value, -c(MES,EV_YEAR))
CAUSA_ESPECIFICA_2017_tidy_MES<-tidyr::gather(CAUSA_ESPECIFICA_2017_MES, group, value, -c(MES,EV_YEAR))
CAUSA_ESPECIFICA_2018_tidy_MES<-tidyr::gather(CAUSA_ESPECIFICA_2018_MES, group, value, -c(MES,EV_YEAR))
CAUSA_ESPECIFICA_2019_tidy_MES<-tidyr::gather(CAUSA_ESPECIFICA_2019_MES, group, value, -c(MES,EV_YEAR))
CAUSA_ESPECIFICA_2020_tidy_MES<-tidyr::gather(CAUSA_ESPECIFICA_2020_MES, group, value, -c(MES,EV_YEAR))


MORT_AJUSTADA_ESPECIFICA_MES<-CAUSA_ESPECIFICA_2020_tidy_MES%>%
  left_join(CAUSA_ESPECIFICA_2019_tidy_MES,by=c("MES","group"))%>%
  left_join(CAUSA_ESPECIFICA_2018_tidy_MES,by=c("MES","group"))%>%
  left_join(CAUSA_ESPECIFICA_2017_tidy_MES,by=c("MES","group"))%>%
  left_join(CAUSA_ESPECIFICA_2016_tidy_MES,by=c("MES","group"))%>%
  group_by(group)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(value.y,value.x.x,value.y.y,value)))%>%
  mutate(AVERAGE_MORTALITY = na.replace(AVERAGE_MORTALITY,0))%>%
  mutate(EXCESS_MORTALITY=(value.x-AVERAGE_MORTALITY))%>% 
  dplyr::select(MES,group,EXCESS_MORTALITY)

MORT_AJUSTADA_ESPECIFICA_MES$MES<-factor(MORT_AJUSTADA_ESPECIFICA_MES$MES,labels = c("Jan","Feb","Mar","Apr","May","Jun","July","Aug","Sep","Oct","Nov","Dec"))

MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY_CAT<-NULL
MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY_CAT[MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY>=0 & MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY<5]<-1
MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY_CAT[MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY>=5 & MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY<10]<-2
MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY_CAT[MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY>=10 & MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY<20]<-3
MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY_CAT[MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY>=20 & MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY<100]<-4
MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY_CAT[MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY>=100]<-5
MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY_CAT<-na.tools::na.replace(MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY_CAT,0)
MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY_CAT<-factor(MORT_AJUSTADA_ESPECIFICA_MES$EXCESS_MORTALITY_CAT,labels = c("No-Excess","1 to 5","5 to 10","10 to 20","20 to 100",">100"))

#Merge Figure 
my_breaks <- c(-5,0,10, 200)
Figure1D<-MORT_AJUSTADA_ESPECIFICA_MES%>%
  ggplot() +
  geom_tile(aes(MES, y=reorder(group, EXCESS_MORTALITY), fill = EXCESS_MORTALITY), color = 'white') +
  theme(
    text = element_text(family = 'Arial'),
    axis.text.x = element_text(angle = 45, 
                               hjust = 1,
                               vjust = 1),
    axis.text.y = element_text(size = 12),
    axis.title = element_blank(),
    plot.caption = element_text(size = 15, hjust = 0.5, vjust = 10, face = 'bold')) +
  labs(fill="Age-Adjusted \nExcess Mortality\nper 1,000,000 inhabitants'")+
  scale_fill_distiller(palette ="OrRd",direction = 1,type = "seq",
                       breaks = my_breaks, 
                       labels = my_breaks,
                       trans = scales::pseudo_log_trans(sigma = 0.8))+
  theme(legend.position = "bottom")

######Merge Figure 1 (Figure 1)#####

Figure1<-ggarrange(Figure1A,Figure1B,Figure1C,Figure1D,ncol =2,nrow = 2,labels = c("A","B","C","D"),common.legend = F)
ggsave(Figure1,
       filename = "Figure1.png", bg = "white",
       width = 70, 
       height = 35,
       units=c("cm"),
       dpi = 350,
       limitsize = FALSE) 


######Descriptive Analysis Ambulatory to In Hospital Excess (Figure2A)#####

#2016
ADJUSTED_MORTALITY_2016_CONTEXTO_OVERALL<-mort_2016%>%
  group_by(CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                    breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                    right = FALSE, include.lowest = TRUE, 
                                    labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                               "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                               "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                               "pobm_60_64", "pobm_65_mm")))%>%
  group_by(CONTEXTO,EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()))%>%
  left_join(Pob_edad_2016_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2016 = (DEATHS/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2016=sum(AGE_ADJUSTED_2016,na.rm = T))%>%
  dplyr::select(CONTEXTO,AGE_ADJUSTED_2016)%>%
  mutate(EV_YEAR=c("2016-2019"))

#2017
ADJUSTED_MORTALITY_2017_CONTEXTO_OVERALL<-mort_2017%>%
  group_by(CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                    breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                    right = FALSE, include.lowest = TRUE, 
                                    labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                               "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                               "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                               "pobm_60_64", "pobm_65_mm")))%>%
  group_by(CONTEXTO,EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()))%>%
  left_join(Pob_edad_2017_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2017 = (DEATHS/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2017=sum(AGE_ADJUSTED_2017,na.rm = T))%>%
  dplyr::select(CONTEXTO,AGE_ADJUSTED_2017)%>%
  mutate(EV_YEAR=c("2016-2019"))


#2018
ADJUSTED_MORTALITY_2018_CONTEXTO_OVERALL<-mort_2018%>%
  group_by(CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                    breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                    right = FALSE, include.lowest = TRUE, 
                                    labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                               "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                               "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                               "pobm_60_64", "pobm_65_mm")))%>%
  group_by(CONTEXTO,EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()))%>%
  left_join(Pob_edad_2018_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2018 = (DEATHS/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2018=sum(AGE_ADJUSTED_2018,na.rm = T))%>%
  dplyr::select(CONTEXTO,AGE_ADJUSTED_2018)%>%
  mutate(EV_YEAR=c("2016-2019"))


#2019
ADJUSTED_MORTALITY_2019_CONTEXTO_OVERALL<-mort_2019%>%
  group_by(CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                    breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                    right = FALSE, include.lowest = TRUE, 
                                    labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                               "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                               "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                               "pobm_60_64", "pobm_65_mm")))%>%
  group_by(CONTEXTO,EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()))%>%
  left_join(Pob_edad_2019_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2019 = (DEATHS/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2019=sum(AGE_ADJUSTED_2019,na.rm = T))%>%
  dplyr::select(CONTEXTO,AGE_ADJUSTED_2019)%>%
  mutate(EV_YEAR=c("2016-2019"))


#2020
ADJUSTED_MORTALITY_2020_CONTEXTO_OVERALL<-mort_2020%>%
  group_by(CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                    breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                    right = FALSE, include.lowest = TRUE, 
                                    labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                               "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                               "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                               "pobm_60_64", "pobm_65_mm")))%>%
  group_by(CONTEXTO,EDAD_QUIN) %>%
  summarise(DEATHS=sum(n()),
            COVID=sum(COVID==1),
            NO_COVID=sum(NO_COVID==1))%>%
  left_join(Pob_edad_2020_entidad_total,by="EDAD_QUIN")%>%
  na.omit()%>%
  mutate(AGE_ADJUSTED_2020 = (DEATHS/POB)*Weight*100000,
         COVID_AGE_ADJUSTED_2020 = (COVID/POB)*Weight*100000,
         NO_COVID_AGE_ADJUSTED_2020 = (NO_COVID/POB)*Weight*100000)%>%
  summarise(AGE_ADJUSTED_2020=sum(AGE_ADJUSTED_2020,na.rm = T),
            COVID_AGE_ADJUSTED_2020=sum(COVID_AGE_ADJUSTED_2020,na.rm = T),
            NO_COVID_AGE_ADJUSTED_2020=sum(NO_COVID_AGE_ADJUSTED_2020,na.rm = T))%>%
  dplyr::select(CONTEXTO,AGE_ADJUSTED_2020,COVID_AGE_ADJUSTED_2020,NO_COVID_AGE_ADJUSTED_2020)%>%
  mutate(EV_YEAR=c("2016-2019"))


MEAN_MORTALITY_2017_2019_CONTEXTO_OVERALL<-ADJUSTED_MORTALITY_2019_CONTEXTO_OVERALL%>%
  left_join(ADJUSTED_MORTALITY_2018_CONTEXTO_OVERALL,by = c("CONTEXTO","EV_YEAR"))%>%
  left_join(ADJUSTED_MORTALITY_2017_CONTEXTO_OVERALL,by = c("CONTEXTO","EV_YEAR"))%>%
  left_join(ADJUSTED_MORTALITY_2016_CONTEXTO_OVERALL,by = c("CONTEXTO","EV_YEAR"))%>%
  group_by(EV_YEAR)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(AGE_ADJUSTED_2019,AGE_ADJUSTED_2018,AGE_ADJUSTED_2017,AGE_ADJUSTED_2016)))%>%
  dplyr::select(EV_YEAR,CONTEXTO,AVERAGE_MORTALITY)

EXCESS_MORTALITY_CONTEXTO_OVERALL<-ADJUSTED_MORTALITY_2020_CONTEXTO_OVERALL%>%
  left_join(MEAN_MORTALITY_2017_2019_CONTEXTO_OVERALL,by=c("CONTEXTO","EV_YEAR"))%>%
  mutate(EXCESS_MORTALITY=(AGE_ADJUSTED_2020-AVERAGE_MORTALITY),
         EXCESS_MORTALITY_NO_COVID=(NO_COVID_AGE_ADJUSTED_2020-AVERAGE_MORTALITY),
         PERCENT_EXCESS_MORTALITY_COVID=(COVID_AGE_ADJUSTED_2020*100/EXCESS_MORTALITY),
         PERCENT_EXCESS_MORTALITY_NOCOVID=((NO_COVID_AGE_ADJUSTED_2020-AVERAGE_MORTALITY)*100/EXCESS_MORTALITY))

EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1<-rbind(data.frame(rate=EXCESS_MORTALITY_CONTEXTO_OVERALL$AVERAGE_MORTALITY[1:2],
                                               year=c("2016-2019"),
                                               label=c("Non-COVID-19"),
                                               context=c("In-Hospital","Ambulatory")))

EXCESS_MORTALITY_CONTEXTO_OVERALL_2.2<-rbind(data.frame(rate=EXCESS_MORTALITY_CONTEXTO_OVERALL$COVID_AGE_ADJUSTED_2020[1:2],
                                                        year=c("2020"),
                                                        label=c("COVID-19"),
                                                        context=c("In-Hospital","Ambulatory")))

EXCESS_MORTALITY_CONTEXTO_OVERALL_2.3<-rbind(data.frame(rate=EXCESS_MORTALITY_CONTEXTO_OVERALL$NO_COVID_AGE_ADJUSTED_2020[1:2],
                                                        year=c("2020"),
                                                        label=c("Non-COVID-19"),
                                                        context=c("In-Hospital","Ambulatory")))


EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1<-rbind(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1,EXCESS_MORTALITY_CONTEXTO_OVERALL_2.2,EXCESS_MORTALITY_CONTEXTO_OVERALL_2.3)
EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1$year<-factor(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1$year,levels = c("2016-2019","2020"))
EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1$rate<-round(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1$rate,2)
EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1<-EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1%>%dplyr::filter(context=="In-Hospital")
EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2<-EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1%>%dplyr::filter(context=="Ambulatory")


Figure2A.1<-ggplot(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1,aes(year,rate,fill=label))+
  geom_col()+
  ylab("Age-Adjusted Mortality Rate \nper 100,000 Inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#7c8cc4","#84b48c"))+
  ggtitle("In-Hospital Deaths")+
  annotate("text", x = 1, y = EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[1]+30, label = paste0(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[1]))+
  annotate("text", x = 2, y = EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[2]+EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[3]+30, label = paste0(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[2]+EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[3]))+
  annotate("text", x = 2, y = EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[2]/2, label = paste0(round(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[3]/(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[2]+EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[3])*100,2),"%"),col="white")+ #Non-COVID
  annotate("text", x = 2, y = EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[2]+(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[3]/2), label = paste0(round(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[2]/(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[2]+EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[3])*100,2),"%"),col="white")+
  annotate("text", x = 1.5, y = 450, label = paste0("In-Hospital Age-Adjusted Excess Mortality","\n",EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[2]+EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[3]-EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.1$rate[1]))
  
Figure2A.2<-ggplot(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2,aes(year,rate,fill=label))+
  geom_col()+
  ylab("Age-Adjusted Mortality Rate \nper 100,000 Inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#7c8cc4","#84b48c"))+
  ggtitle("Out-of-Hospital Deaths")+
  annotate("text", x = 1, y = EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[1]+30, label = paste0(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[1]))+
  annotate("text", x = 2, y = EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[2]+EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[3]+30, label = paste0(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[2]+EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[3]))+
  annotate("text", x = 2, y = EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[3]+(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[2]/2), label = paste0(round(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[2]/(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[2]+EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[3])*100,2),"%"),col="white")+
  annotate("text", x = 2, y = EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[3]/2, label = paste0(round(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[3]/(EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[2]+EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[3])*100,2),"%"),col="white")+
  annotate("text", x = 1.5, y = 500, label = paste0("Ambulatory Age-Adjusted Excess Mortality","\n",EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[2]+EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[3]-EXCESS_MORTALITY_CONTEXTO_OVERALL_2.1.2$rate[1]))

Figure2A<-ggarrange(Figure2A.1,Figure2A.2,ncol = 2,nrow = 1,labels = c("A",""),common.legend = T)


######Excess mortality by place of occurence (Figure 2B)####
#Overall
#2016

ADJUSTED_MORTALITY_2016_CONTEXTO<-mort_2016%>%
  filter(!is.na(EDAD))%>%
  group_by(MES,CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                        breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                        right = FALSE, include.lowest = TRUE, 
                                        labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                   "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                   "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                   "pobm_60_64", "pobm_65_mm")))%>%
  summarise(MUERTES=sum(n()))%>%
  left_join(Pob_edad_2016_entidad_total,by="EDAD_QUIN")%>%
  summarise(MUERTES=(MUERTES/POB)*Weight*1000000)%>%
  summarise(MUERTES=sum(MUERTES))%>%
  mutate(EV_YEAR=c("2016"))

#2017

ADJUSTED_MORTALITY_2017_CONTEXTO<-mort_2017%>%
  filter(!is.na(EDAD))%>%
  group_by(MES,CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                        breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                        right = FALSE, include.lowest = TRUE, 
                                        labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                   "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                   "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                   "pobm_60_64", "pobm_65_mm")))%>%
  summarise(MUERTES=sum(n()))%>%
  left_join(Pob_edad_2017_entidad_total,by="EDAD_QUIN")%>%
  summarise(MUERTES=(MUERTES/POB)*Weight*1000000)%>%
  summarise(MUERTES=sum(MUERTES))%>%
  mutate(EV_YEAR=c("2017"))

#2018

ADJUSTED_MORTALITY_2018_CONTEXTO<-mort_2018%>%
  filter(!is.na(EDAD))%>%
  group_by(MES,CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                        breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                        right = FALSE, include.lowest = TRUE, 
                                        labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                   "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                   "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                   "pobm_60_64", "pobm_65_mm")))%>%
  summarise(MUERTES=sum(n()))%>%
  left_join(Pob_edad_2018_entidad_total,by="EDAD_QUIN")%>%
  summarise(MUERTES=(MUERTES/POB)*Weight*1000000)%>%
  summarise(MUERTES=sum(MUERTES))%>%
  mutate(EV_YEAR=c("2018"))

#2019

ADJUSTED_MORTALITY_2019_CONTEXTO<-mort_2019%>%
  filter(!is.na(EDAD))%>%
  group_by(MES,CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                        breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                        right = FALSE, include.lowest = TRUE, 
                                        labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                   "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                   "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                   "pobm_60_64", "pobm_65_mm")))%>%
  summarise(MUERTES=sum(n()))%>%
  left_join(Pob_edad_2019_entidad_total,by="EDAD_QUIN")%>%
  summarise(MUERTES=(MUERTES/POB)*Weight*1000000)%>%
  summarise(MUERTES=sum(MUERTES))%>%
  mutate(EV_YEAR=c("2019"))

#2020

ADJUSTED_MORTALITY_2020_CONTEXTO<-mort_2020%>%
  filter(!is.na(EDAD))%>%
  group_by(MES,CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                        breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                        right = FALSE, include.lowest = TRUE, 
                                        labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                   "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                   "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                   "pobm_60_64", "pobm_65_mm")))%>%
  summarise(COVID=sum(COVID==1,na.rm = T),
            NO_COVID=sum(NO_COVID==1,na.rm = T),
            MUERTES=sum(n()))%>%
  left_join(Pob_edad_2020_entidad_total,by="EDAD_QUIN")%>%
  summarise(MUERTES=(MUERTES/POB)*Weight*1000000,
            COVID=(COVID/POB)*Weight*1000000,
            NO_COVID=(NO_COVID/POB)*Weight*1000000)%>%
  summarise(AGE_ADJUSTED_OVERALL_2020=sum(MUERTES),
            AGE_ADJUSTED_COVID_2020=sum(COVID),
            AGE_ADJUSTED_NOCOVID_2020=sum(NO_COVID))%>%
  mutate(EV_YEAR=c("2020"))

#Tidy Merge

ADJUSTED_MORTALITY_2016_CONTEXTO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2016_CONTEXTO, group, value, -c(EV_YEAR,MES,CONTEXTO))
ADJUSTED_MORTALITY_2017_CONTEXTO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2017_CONTEXTO, group, value, -c(EV_YEAR,MES,CONTEXTO))
ADJUSTED_MORTALITY_2018_CONTEXTO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2018_CONTEXTO, group, value, -c(EV_YEAR,MES,CONTEXTO))
ADJUSTED_MORTALITY_2019_CONTEXTO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2019_CONTEXTO, group, value, -c(EV_YEAR,MES,CONTEXTO))

MORT_AJUSTADA_ESPECIFICA_MES_CONTEXTO_HISTORICA<-ADJUSTED_MORTALITY_2019_CONTEXTO_tidy%>%
  left_join(ADJUSTED_MORTALITY_2018_CONTEXTO_tidy,by=c("CONTEXTO","MES","group"))%>%
  left_join(ADJUSTED_MORTALITY_2017_CONTEXTO_tidy,by=c("CONTEXTO","MES","group"))%>%
  left_join(ADJUSTED_MORTALITY_2016_CONTEXTO_tidy,by=c("CONTEXTO","MES","group"))%>%
  group_by(CONTEXTO,MES,group)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(value.x,value.y,value.x.x,value.y.y),na.rm=T))%>%
  dplyr::select(MES,AVERAGE_MORTALITY)

EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES<-ADJUSTED_MORTALITY_2020_CONTEXTO%>%
  left_join(MORT_AJUSTADA_ESPECIFICA_MES_CONTEXTO_HISTORICA,by=c("CONTEXTO","MES"))%>%
  mutate(EXCESS_MORTALITY=(AGE_ADJUSTED_OVERALL_2020-AVERAGE_MORTALITY),
         EXCESS_NON_COVID_MORTALITY=(AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY),
         PERCENT_EXCESS_MORTALITY_COVID=(AGE_ADJUSTED_COVID_2020*100/EXCESS_MORTALITY),
         PERCENT_EXCESS_MORTALITY_NOCOVID=((AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY)*100/EXCESS_MORTALITY))


EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES$CONTEXTO<-factor(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES$CONTEXTO,labels = c("In-Hospital","Ambulatory","Unnespecified"))
EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES$MES<-factor(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES$MES,labels = c("Jan-20","Feb-20","Mar-20",
                                                                                                       "Apr-20","May-20","Jun-20",
                                                                                                       "Jul-20","Aug-20","Sep-20",
                                                                                                       "Oct-20","Nov-20","Dec-20"))


Figure2B.1<-ggplot(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES%>%filter(CONTEXTO=="In-Hospital")) + 
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, group=1), col="transparent", size=3,method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_OVERALL_2020, group=1,col="2020"), size=3,method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "Average \n2016-2019",group=1),size=3,se = FALSE)


g1 <- ggplot(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES%>%filter(CONTEXTO=="In-Hospital")) + 
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, colour = "min",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_OVERALL_2020, colour = "max",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "2019",group=1),se = FALSE)

g2 <- ggplot(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES%>%filter(CONTEXTO=="In-Hospital")) + 
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "min",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, colour = "max",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "B",group=1),se = FALSE)

gg1 <- ggplot_build(g1)
gg2 <- ggplot_build(g2)

df2<-data.frame(x = gg1$data[[1]]$x,
                ymin = gg1$data[[1]]$y,
                ymax = gg1$data[[2]]$y,
                lab = gg1$data[[2]]$PANEL)

df3<-data.frame(x = gg2$data[[1]]$x,
                ymin = gg2$data[[1]]$y,
                ymax = gg2$data[[2]]$y,
                lab = gg2$data[[2]]$PANEL)

Figure2B.1<-Figure2B.1 +
  geom_ribbon(data = df2, aes(x = x, ymin = ymin, ymax = ymax,fill="COVID-19"),alpha = 0.65)+
  geom_ribbon(data = df3, aes(x = x, ymin = ymin, ymax = ymax,fill="Non-COVID-19"),alpha = 0.65)+
  scale_fill_manual(values = c("#7c8cc4","#84b48c"))+
  ggsci::scale_color_jama()+
  labs(col="Year",fill="Cause of Death")+
  ylab("Age-Adjusted Mortality Rate \n per 100,000 Inhabitants")+
  xlab("Month")+
  theme_hc()+ 
  guides(col = guide_legend(nrow = 2))+
  guides(fill = guide_legend(nrow = 2))+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+
  ggtitle("In-Hospital Deaths")

#Ambulatory

Figure2B.2<-ggplot(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES%>%filter(CONTEXTO=="Ambulatory")) + 
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, group=1), col="transparent", size=2,method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_OVERALL_2020, group=1,col="2020"), size=2,method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "Average \n2016-2019",group=1),size=2,se = FALSE)


g1 <- ggplot(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES%>%filter(CONTEXTO=="Ambulatory")) + 
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, colour = "min",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_OVERALL_2020, colour = "max",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "2019",group=1),se = FALSE)

g2 <- ggplot(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES%>%filter(CONTEXTO=="Ambulatory")) + 
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "min",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, colour = "max",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "B",group=1),se = FALSE)

gg1 <- ggplot_build(g1)
gg2 <- ggplot_build(g2)

df2<-data.frame(x = gg1$data[[1]]$x,
                ymin = gg1$data[[1]]$y,
                ymax = gg1$data[[2]]$y,
                lab = gg1$data[[2]]$PANEL)

df3<-data.frame(x = gg2$data[[1]]$x,
                ymin = gg2$data[[1]]$y,
                ymax = gg2$data[[2]]$y,
                lab = gg2$data[[2]]$PANEL)

Figure2B.2<-Figure2B.2 +
  geom_ribbon(data = df2, aes(x = x, ymin = ymin, ymax = ymax,fill="COVID-19"),alpha = 0.8)+
  geom_ribbon(data = df3, aes(x = x, ymin = ymin, ymax = ymax,fill="Non-COVID-19"),alpha = 0.8)+
  scale_fill_manual(values = c("#7c8cc4","#84b48c"))+
  ggsci::scale_color_jama()+
  labs(col="Year",fill="Cause of Death")+
  ylab("Age-Adjusted Mortality Rate \n per 100,000 Inhabitants")+
  xlab("Month")+
  theme_hc()+ 
  guides(col = guide_legend(nrow = 2))+
  guides(fill = guide_legend(nrow = 2))+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+
  ggtitle("Out-of-Hospital Deaths")

#Non-Specified
Figure2B.3<-ggplot(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES%>%filter(CONTEXTO=="Unnespecified")) + 
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, group=1), col="transparent", size=2,method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_OVERALL_2020, group=1,col="2020"), size=2,method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "Average \n2016-2019",group=1),size=2,se = FALSE)


g1 <- ggplot(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES%>%filter(CONTEXTO=="Unnespecified")) + 
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, colour = "min",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_OVERALL_2020, colour = "max",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "2019",group=1),se = FALSE)

g2 <- ggplot(EXCESS_MORTALITY_ENTIDAD_CONTEXTO_MES%>%filter(CONTEXTO=="Unnespecified")) + 
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "min",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AGE_ADJUSTED_NOCOVID_2020, colour = "max",group=1), method = "loess", se = FALSE) +
  stat_smooth(aes(x = MES, y = AVERAGE_MORTALITY, colour = "B",group=1),se = FALSE)

gg1 <- ggplot_build(g1)
gg2 <- ggplot_build(g2)

df2<-data.frame(x = gg1$data[[1]]$x,
                ymin = gg1$data[[1]]$y,
                ymax = gg1$data[[2]]$y,
                lab = gg1$data[[2]]$PANEL)

df3<-data.frame(x = gg2$data[[1]]$x,
                ymin = gg2$data[[1]]$y,
                ymax = gg2$data[[2]]$y,
                lab = gg2$data[[2]]$PANEL)

Figure2B.3<-Figure2B.3 +
  geom_ribbon(data = df2, aes(x = x, ymin = ymin, ymax = ymax,fill="COVID-19"),alpha = 0.8)+
  geom_ribbon(data = df3, aes(x = x, ymin = ymin, ymax = ymax,fill="Non-COVID-19"),alpha = 0.8)+
  scale_fill_manual(values = c("#7c8cc4","#84b48c"))+
  ggsci::scale_color_jama()+
  labs(col="Year",fill="Cause of Death")+
  ylab("Age-Adjusted Mortality Rate \n per 100,000 Inhabitants")+
  xlab("Month")+
  theme_hc()+ 
  guides(col = guide_legend(nrow = 2))+
  guides(fill = guide_legend(nrow = 2))+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))+
  ggtitle("Unnespecified Deaths")

Figure2B<-ggarrange(Figure2B.1,Figure2B.2,ncol = 2,nrow = 1,labels = c("B","C"),common.legend = T)

######Ambulatory-Hospital Excess Mortality (Figure 2C)#####

#2016

CAUSA_ESPECIFICA_2016_CONTEXTO<-mort_2016%>%
  filter(!is.na(EDAD))%>%
  group_by(CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                    breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                    right = FALSE, include.lowest = TRUE, 
                                    labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                               "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                               "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                               "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2016_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*100000,
            END.DIAB=(END.DIAB/POB)*Weight*100000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*100000,
            SC2.HTES=(SC2.HTES/POB)*Weight*100000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*100000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*100000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*100000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*100000,
            END.OBES=(END.OBES/POB)*Weight*100000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2016"))


#2017

CAUSA_ESPECIFICA_2017_CONTEXTO<-mort_2017%>%
  filter(!is.na(EDAD))%>%
  group_by(CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                    breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                    right = FALSE, include.lowest = TRUE, 
                                    labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                               "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                               "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                               "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2017_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*100000,
            END.DIAB=(END.DIAB/POB)*Weight*100000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*100000,
            SC2.HTES=(SC2.HTES/POB)*Weight*100000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*100000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*100000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*100000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*100000,
            END.OBES=(END.OBES/POB)*Weight*100000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2017"))

#2018

CAUSA_ESPECIFICA_2018_CONTEXTO<-mort_2018%>%
  filter(!is.na(EDAD))%>%
  group_by(CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                    breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                    right = FALSE, include.lowest = TRUE, 
                                    labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                               "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                               "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                               "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2018_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*100000,
            END.DIAB=(END.DIAB/POB)*Weight*100000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*100000,
            SC2.HTES=(SC2.HTES/POB)*Weight*100000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*100000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*100000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*100000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*100000,
            END.OBES=(END.OBES/POB)*Weight*100000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2018"))

#2019

CAUSA_ESPECIFICA_2019_CONTEXTO<-mort_2019%>%
  filter(!is.na(EDAD))%>%
  group_by(CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                    breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                    right = FALSE, include.lowest = TRUE, 
                                    labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                               "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                               "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                               "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2019_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*100000,
            END.DIAB=(END.DIAB/POB)*Weight*100000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*100000,
            SC2.HTES=(SC2.HTES/POB)*Weight*100000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*100000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*100000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*100000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*100000,
            END.OBES=(END.OBES/POB)*Weight*100000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2019"))


#2020

CAUSA_ESPECIFICA_2020_CONTEXTO<-mort_2020%>%
  filter(!is.na(EDAD))%>%
  group_by(CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                    breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                    right = FALSE, include.lowest = TRUE, 
                                    labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                               "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                               "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                               "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T),
            COVID=sum(COVID==1,na.rm = T))%>%
  left_join(Pob_edad_2020_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*100000,
            END.DIAB=(END.DIAB/POB)*Weight*100000,
            END.OBES=(END.OBES/POB)*Weight*100000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*100000,
            SC2.HTES=(SC2.HTES/POB)*Weight*100000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*100000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*100000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*100000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*100000,
            COVID=(COVID/POB)*Weight*100000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Obesity"=sum(END.OBES),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Confirmed or Suspected COVID-19"=sum(COVID))%>%
  mutate(EV_YEAR=c("2020"))

#Tidy datasets
CAUSA_ESPECIFICA_2016_tidy_CONTEXTO<-tidyr::gather(CAUSA_ESPECIFICA_2016_CONTEXTO, group, value, -c(CONTEXTO,EV_YEAR))
CAUSA_ESPECIFICA_2017_tidy_CONTEXTO<-tidyr::gather(CAUSA_ESPECIFICA_2017_CONTEXTO, group, value, -c(CONTEXTO,EV_YEAR))
CAUSA_ESPECIFICA_2018_tidy_CONTEXTO<-tidyr::gather(CAUSA_ESPECIFICA_2018_CONTEXTO, group, value, -c(CONTEXTO,EV_YEAR))
CAUSA_ESPECIFICA_2019_tidy_CONTEXTO<-tidyr::gather(CAUSA_ESPECIFICA_2019_CONTEXTO, group, value, -c(CONTEXTO,EV_YEAR))
CAUSA_ESPECIFICA_2020_tidy_CONTEXTO<-tidyr::gather(CAUSA_ESPECIFICA_2020_CONTEXTO, group, value, -c(CONTEXTO,EV_YEAR))


MORT_AJUSTADA_ESPECIFICA_CONTEXTO<-CAUSA_ESPECIFICA_2020_tidy_CONTEXTO%>%
  left_join(CAUSA_ESPECIFICA_2019_tidy_CONTEXTO,by=c("CONTEXTO","group"))%>%
  left_join(CAUSA_ESPECIFICA_2018_tidy_CONTEXTO,by=c("CONTEXTO","group"))%>%
  left_join(CAUSA_ESPECIFICA_2017_tidy_CONTEXTO,by=c("CONTEXTO","group"))%>%
  left_join(CAUSA_ESPECIFICA_2016_tidy_CONTEXTO,by=c("CONTEXTO","group"))%>%
  group_by(group)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(value.y,value.x.x,value.y.y,value)))%>%
  mutate(AVERAGE_MORTALITY = na.replace(AVERAGE_MORTALITY,0))%>%
  mutate(EXCESS_MORTALITY=(value.x-AVERAGE_MORTALITY))%>% 
  dplyr::select(CONTEXTO,group,EXCESS_MORTALITY)

MORT_AJUSTADA_ESPECIFICA_CONTEXTO$CONTEXTO<-factor(MORT_AJUSTADA_ESPECIFICA_CONTEXTO$CONTEXTO,labels = c("In-Hospital","Out-of-Hospital","Unspecified"))

my_colors <- c("#264e70","#cc0022","#ff9400")
weird <- scales::trans_new("signed_log",
                           transform=function(x) sign(x)*log(abs(x)),
                           inverse=function(x) sign(x)*exp(abs(x)))

Figure2C<- ggplot(MORT_AJUSTADA_ESPECIFICA_CONTEXTO%>%dplyr::filter(CONTEXTO!="Unspecified"), aes(reorder(group, EXCESS_MORTALITY), EXCESS_MORTALITY,group=CONTEXTO,fill=CONTEXTO)) +
  geom_col(col="black",position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  coord_flip()+ 
  ylab("Age-Adjusted Excess Mortality Rate \n per 100,000 inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Place of Death")+
  ggtitle("")+
  scale_fill_manual(values = my_colors)+
  geom_text(aes(label=round(EXCESS_MORTALITY,2),group = CONTEXTO), vjust = 0.5,hjust = 1, color="black", size=4,position = position_dodge(width = 1))+
  theme(axis.text.y = element_text(size = 13),title = element_text(size = 15))


######Ambulatory-Hospital by Month Excess Mortality (Figure 2D)----

#2016

CAUSA_ESPECIFICA_2016_CONTEXTO_MES<-mort_2016%>%
  filter(!is.na(EDAD))%>%
  group_by(CONTEXTO,MES,EDAD_QUIN = cut(as.numeric(EDAD), 
                                        breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                        right = FALSE, include.lowest = TRUE, 
                                        labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                   "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                   "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                   "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2016_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*1000000,
            END.DIAB=(END.DIAB/POB)*Weight*1000000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*1000000,
            SC2.HTES=(SC2.HTES/POB)*Weight*1000000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*1000000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*1000000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*1000000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*1000000,
            END.OBES=(END.OBES/POB)*Weight*1000000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2016"))


#2017

CAUSA_ESPECIFICA_2017_CONTEXTO_MES<-mort_2017%>%
  filter(!is.na(EDAD))%>%
  group_by(CONTEXTO,MES,EDAD_QUIN = cut(as.numeric(EDAD), 
                                        breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                        right = FALSE, include.lowest = TRUE, 
                                        labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                   "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                   "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                   "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2017_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*1000000,
            END.DIAB=(END.DIAB/POB)*Weight*1000000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*1000000,
            SC2.HTES=(SC2.HTES/POB)*Weight*1000000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*1000000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*1000000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*1000000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*1000000,
            END.OBES=(END.OBES/POB)*Weight*1000000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2017"))

#2018

CAUSA_ESPECIFICA_2018_CONTEXTO_MES<-mort_2018%>%
  filter(!is.na(EDAD))%>%
  group_by(CONTEXTO,MES,EDAD_QUIN = cut(as.numeric(EDAD), 
                                        breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                        right = FALSE, include.lowest = TRUE, 
                                        labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                   "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                   "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                   "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2018_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*1000000,
            END.DIAB=(END.DIAB/POB)*Weight*1000000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*1000000,
            SC2.HTES=(SC2.HTES/POB)*Weight*1000000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*1000000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*1000000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*1000000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*1000000,
            END.OBES=(END.OBES/POB)*Weight*1000000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2018"))

#2019

CAUSA_ESPECIFICA_2019_CONTEXTO_MES<-mort_2019%>%
  filter(!is.na(EDAD))%>%
  group_by(CONTEXTO,MES,EDAD_QUIN = cut(as.numeric(EDAD), 
                                        breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                        right = FALSE, include.lowest = TRUE, 
                                        labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                   "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                   "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                   "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  left_join(Pob_edad_2019_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*1000000,
            END.DIAB=(END.DIAB/POB)*Weight*1000000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*1000000,
            SC2.HTES=(SC2.HTES/POB)*Weight*1000000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*1000000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*1000000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*1000000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*1000000,
            END.OBES=(END.OBES/POB)*Weight*1000000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Obesity"=sum(END.OBES))%>%
  mutate(EV_YEAR=c("2019"))


#2020

CAUSA_ESPECIFICA_2020_CONTEXTO_MES<-mort_2020%>%
  filter(!is.na(EDAD))%>%
  group_by(CONTEXTO,MES,EDAD_QUIN = cut(as.numeric(EDAD), 
                                        breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                        right = FALSE, include.lowest = TRUE, 
                                        labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                   "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                   "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                   "pobm_60_64", "pobm_65_mm")))%>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T),
            COVID=sum(COVID==1,na.rm = T))%>%
  left_join(Pob_edad_2020_entidad_total,by="EDAD_QUIN")%>%
  summarise(SC3.IAMC=(SC3.IAMC/POB)*Weight*1000000,
            END.DIAB=(END.DIAB/POB)*Weight*1000000,
            END.OBES=(END.OBES/POB)*Weight*1000000,
            SC2.ECHI=(SC2.ECHI/POB)*Weight*1000000,
            SC2.HTES=(SC2.HTES/POB)*Weight*1000000,
            EX7.ASSA=(EX7.ASSA/POB)*Weight*1000000,
            SC2.OTRA=(SC2.OTRA/POB)*Weight*1000000,
            SC5.EVCN=(SC5.EVCN/POB)*Weight*1000000,
            SC3.OTRA=(SC3.OTRA/POB)*Weight*1000000,
            COVID=(COVID/POB)*Weight*1000000)%>%
  summarise("Acute Myocardial Infarction"=sum(SC3.IAMC),
            "Type 2 Diabetes"=sum(END.DIAB),
            "Obesity"=sum(END.OBES),
            "Hypertensive Heart Disease"=sum(SC2.ECHI),
            "Essential (Primary) Hypertension"=sum(SC2.HTES),
            "Assault"=sum(EX7.ASSA),
            "Other Hypertensive Diseases"=sum(SC2.OTRA),
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=sum(SC5.EVCN),
            "Other Ischemic Heart Diseases"=sum(SC3.OTRA),
            "Confirmed or Suspected COVID-19"=sum(COVID))%>%
  mutate(EV_YEAR=c("2020"))

#Tidy datasets

CAUSA_ESPECIFICA_2016_tidy_CONTEXTO_MES<-tidyr::gather(CAUSA_ESPECIFICA_2016_CONTEXTO_MES, group, value, -c(CONTEXTO,MES,EV_YEAR))
CAUSA_ESPECIFICA_2017_tidy_CONTEXTO_MES<-tidyr::gather(CAUSA_ESPECIFICA_2017_CONTEXTO_MES, group, value, -c(CONTEXTO,MES,EV_YEAR))
CAUSA_ESPECIFICA_2018_tidy_CONTEXTO_MES<-tidyr::gather(CAUSA_ESPECIFICA_2018_CONTEXTO_MES, group, value, -c(CONTEXTO,MES,EV_YEAR))
CAUSA_ESPECIFICA_2019_tidy_CONTEXTO_MES<-tidyr::gather(CAUSA_ESPECIFICA_2019_CONTEXTO_MES, group, value, -c(CONTEXTO,MES,EV_YEAR))
CAUSA_ESPECIFICA_2020_tidy_CONTEXTO_MES<-tidyr::gather(CAUSA_ESPECIFICA_2020_CONTEXTO_MES, group, value, -c(CONTEXTO,MES,EV_YEAR))

MORT_AJUSTADA_ESPECIFICA_CONTEXTO_MES<-CAUSA_ESPECIFICA_2020_tidy_CONTEXTO_MES%>%
  left_join(CAUSA_ESPECIFICA_2019_tidy_CONTEXTO_MES,by=c("CONTEXTO","MES","group"))%>%
  left_join(CAUSA_ESPECIFICA_2018_tidy_CONTEXTO_MES,by=c("CONTEXTO","MES","group"))%>%
  left_join(CAUSA_ESPECIFICA_2017_tidy_CONTEXTO_MES,by=c("CONTEXTO","MES","group"))%>%
  left_join(CAUSA_ESPECIFICA_2016_tidy_CONTEXTO_MES,by=c("CONTEXTO","MES","group"))%>%
  group_by(group)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(value.y,value.x.x,value.y.y,value)))%>%
  mutate(AVERAGE_MORTALITY = na.replace(AVERAGE_MORTALITY,0))%>%
  mutate(EXCESS_MORTALITY=(value.x-AVERAGE_MORTALITY))%>% 
  dplyr::select(CONTEXTO,MES,group,EXCESS_MORTALITY)

MORT_AJUSTADA_ESPECIFICA_CONTEXTO_MES$CONTEXTO<-factor(MORT_AJUSTADA_ESPECIFICA_CONTEXTO_MES$CONTEXTO,labels = c("In-Hospital","Out-of-Hospital","Unspecified"))
MORT_AJUSTADA_ESPECIFICA_CONTEXTO_MES$MES<-factor(MORT_AJUSTADA_ESPECIFICA_CONTEXTO_MES$MES,labels = c("Jan","Feb","Mar","Apr","May","Jun","July","Aug","Sep","Oct","Nov","Dec"))

#Merge Figure 

my_breaks <- c(-5,0,10, 200)

Figure2D<-MORT_AJUSTADA_ESPECIFICA_CONTEXTO_MES%>%dplyr::filter(CONTEXTO!="Unspecified")%>%
  ggplot() +
  geom_tile(aes(MES, y=reorder(group, EXCESS_MORTALITY), fill = EXCESS_MORTALITY), color = 'white') +
  facet_wrap(~CONTEXTO)+
  xlab("Month, 2020")+
  ylab("")+
  theme_hc()+
  theme(
    text = element_text(family = 'Arial'),
    axis.text.x = element_text(angle = 45, 
                               hjust = 1,
                               vjust = 1),
    axis.text.y = element_text(size = 12),
    axis.title = element_blank(),
    plot.caption = element_text(size = 15, hjust = 0.5, vjust = 10, face = 'bold')) +
  scale_fill_distiller(palette ="OrRd",direction = 1,type = "seq",
                       breaks = my_breaks, 
                       labels = my_breaks,
                       trans = scales::pseudo_log_trans(sigma = 0.8))+
  labs(fill="Age-Adjusted \nExcess Mortality\nper 1,000,000 inhabitants")


######Merge Figure 2 (Figure 2)#####

Figure2<-ggarrange(Figure2A,Figure2B,Figure2C,Figure2D,ncol = 2,nrow = 2,labels = c("","","C","D"))

ggsave(Figure2,
       filename = "Figure2.png", bg = "white",
       width = 75, 
       height = 35,
       units=c("cm"),
       dpi = 350,
       limitsize = FALSE) 


######Biplot Map of excess mortality by municipality of residency  (Figure 3A)#####

#2016
ADJUSTED_MORTALITY_2016_MUNICIPIO<-mort_2016%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2016_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2016_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2016 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2016 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2016,AVOID_AGE_ADJUSTED_2016)%>%
  mutate(EV_YEAR=c("2016"))

#2017
ADJUSTED_MORTALITY_2017_MUNICIPIO<-mort_2017%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2017_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2017_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2017 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2017 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2017,AVOID_AGE_ADJUSTED_2017)%>%
  mutate(EV_YEAR=c("2017"))

#2018
ADJUSTED_MORTALITY_2018_MUNICIPIO<-mort_2018%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2018_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2018_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2018 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2018 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2018,AVOID_AGE_ADJUSTED_2018)%>%
  mutate(EV_YEAR=c("2018"))


#2019
ADJUSTED_MORTALITY_2019_MUNICIPIO<-mort_2019%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2019_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2019_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2019 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2019 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2019,AVOID_AGE_ADJUSTED_2019)%>%
  mutate(EV_YEAR=c("2019"))

#2020

ADJUSTED_MORTALITY_2020_MUNICIPIO<-mort_2020%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            NO_COVID=sum(COVID==0),
            COVID=sum(COVID==1),
            AVOID=sum(AVOIDABLE==1))%>%
  na.omit()%>%
  left_join(Pob_edad_2020_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2020_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         DEF_ESPER_COVID = (COVID/POB.x)*POB.y,
         DEF_ESPER_NO_COVID = (NO_COVID/POB.x)*POB.y,
         DEF_ESPER_AVOID = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            DEF_ESPER_COVID=sum(DEF_ESPER_COVID,na.rm = T),
            DEF_ESPER_NO_COVID=sum(DEF_ESPER_NO_COVID,na.rm = T),
            DEF_ESPER_AVOID=sum(DEF_ESPER_AVOID,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_OVERALL_2020= (DEF_ESPER/127792286)*100000,
         AGE_ADJUSTED_COVID_2020= (DEF_ESPER_COVID/127792286)*100000,
         AGE_ADJUSTED_NOCOVID_2020= (DEF_ESPER_NO_COVID/127792286)*100000,
         AGE_ADJUSTED_AVOID_2020= (DEF_ESPER_AVOID/127792286)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_OVERALL_2020,AGE_ADJUSTED_COVID_2020,AGE_ADJUSTED_NOCOVID_2020,AGE_ADJUSTED_AVOID_2020)%>%
  mutate(EV_YEAR=c("2020"))

ADJUSTED_MORTALITY_2016_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2016_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))
ADJUSTED_MORTALITY_2017_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2017_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))
ADJUSTED_MORTALITY_2018_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2018_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))
ADJUSTED_MORTALITY_2019_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2019_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))

MORT_AJUSTADA_ESPECIFICA_MUNICIPIO<-ADJUSTED_MORTALITY_2019_MUNICIPIO%>%
  left_join(ADJUSTED_MORTALITY_2018_MUNICIPIO,by="id.mun")%>%
  left_join(ADJUSTED_MORTALITY_2017_MUNICIPIO,by="id.mun")%>% 
  left_join(ADJUSTED_MORTALITY_2016_MUNICIPIO,by="id.mun")%>% 
  group_by(id.mun)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(AGE_ADJUSTED_2019,AGE_ADJUSTED_2018,AGE_ADJUSTED_2017,AGE_ADJUSTED_2016)),
         AVOID_AVERAGE_MORTALITY = mean(c(AVOID_AGE_ADJUSTED_2019,AVOID_AGE_ADJUSTED_2018,AVOID_AGE_ADJUSTED_2017,AVOID_AGE_ADJUSTED_2016)))%>%
  dplyr::select(id.mun,AVERAGE_MORTALITY,AVOID_AVERAGE_MORTALITY)


EXCESS_MORTALITY_MUNICIPIO<-ADJUSTED_MORTALITY_2020_MUNICIPIO%>%
  left_join(MORT_AJUSTADA_ESPECIFICA_MUNICIPIO,by=c("id.mun"))%>%
  mutate(EXCESS_MORTALITY=(AGE_ADJUSTED_OVERALL_2020-AVERAGE_MORTALITY),
         EXCESS_MORTALITY_NO_COVID=(AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY),
         EXCESS_MORTALITY_AVOID=(AGE_ADJUSTED_AVOID_2020-AVOID_AVERAGE_MORTALITY),
         PERCENT_EXCESS_MORTALITY_COVID=(AGE_ADJUSTED_COVID_2020*100/EXCESS_MORTALITY),
         PERCENT_EXCESS_MORTALITY_NOCOVID=((AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY)*100/EXCESS_MORTALITY),
         PERCENT_EXCESS_MORTALITY_AVOID=((AGE_ADJUSTED_AVOID_2020-AVOID_AVERAGE_MORTALITY)*100/AGE_ADJUSTED_OVERALL_2020),
         PERCENT_EXCESS_MORTALITY_AVOID_REL=((AGE_ADJUSTED_AVOID_2020-AVOID_AVERAGE_MORTALITY)*100/(AGE_ADJUSTED_OVERALL_2020-AGE_ADJUSTED_COVID_2020)))%>%
  left_join(geom_df.mun,by="id.mun")

EXCESS_MORTALITY_MUNICIPIO$EXCESS_MORTALITY_NORMALIZED<-bestNormalize::orderNorm(EXCESS_MORTALITY_MUNICIPIO$EXCESS_MORTALITY)$x.t
EXCESS_MORTALITY_MUNICIPIO$DISLI_NORM<-bestNormalize::orderNorm(EXCESS_MORTALITY_MUNICIPIO$DISLI)$x.t
EXCESS_MORTALITY_MUNICIPIO_OVERALL_EXCESS<-bi_class(EXCESS_MORTALITY_MUNICIPIO, 
                                                    x = EXCESS_MORTALITY_NORMALIZED, 
                                                    y = DISLI_NORM, 
                                                    style = "quantile", dim = 2)

FIGURE3A<-ggdraw() +
  draw_plot(ggplot(EXCESS_MORTALITY_MUNICIPIO_OVERALL_EXCESS) +
              geom_sf(mapping = aes(fill = bi_class, geometry=geometry), size = 0, show.legend = FALSE) +
              bi_scale_fill(pal = "DkViolet", dim = 2)+ 
              theme(legend.title = element_text(hjust = 0.1),
                    legend.position = "bottom",
                    plot.title = element_text(hjust = 0.1))+
              guides(fill="none",
                     shape=guide_legend(nrow=1,byrow=T),
                     colour="none") +
              theme_map()+
              ggtitle("Overall Age-Adjusted Excess Mortality"), 0, 0, 1, 1) +
  draw_plot(bi_legend(pal = "DkViolet",
                      dim = 2,
                      xlab = "Age-Adjusted \nExcess Mortality",
                      ylab = "Adjusted Social Lag Index",
                      size = 6), 0.75, .5, 0.25, 0.25)


######Excess Mortality by SLI Cathegories (Figure 3B)#####

#2016
ADJUSTED_MORTALITY_2016_SLI_CAT<-mort_2016%>% 
  filter(id.ent!=99)%>%
  group_by(QUINTILES.DISLI.MUN, EDAD_QUIN = cut(as.numeric(EDAD), 
                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                           right = FALSE, include.lowest = TRUE, 
                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                      "pobm_60_64", "pobm_65_mm")))%>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE==1))%>%
  left_join(Pob_edad_cuadrante_2016_municipio_total,by=c("QUINTILES.DISLI.MUN","EDAD_QUIN"))%>%
  mutate(AGE_ADJUSTED_2016 = (DEATHS/POB)*Weight*100000,
         AVOID_AGE_ADJUSTED_2016 = (AVOID/POB)*Weight*100000)%>%
  summarise(MORTALITY_RATE_2016=sum(AGE_ADJUSTED_2016,na.rm = T),
            AVOID_MORTALITY_RATE_2016=sum(AVOID_AGE_ADJUSTED_2016,na.rm = T))%>%
  na.omit()%>%
  dplyr::select(QUINTILES.DISLI.MUN,MORTALITY_RATE_2016,AVOID_MORTALITY_RATE_2016)%>%
  mutate(EV_YEAR=c("2016"))

#2017
ADJUSTED_MORTALITY_2017_SLI_CAT<-mort_2017%>% 
  filter(id.ent!=99)%>%
  group_by(QUINTILES.DISLI.MUN, EDAD_QUIN = cut(as.numeric(EDAD), 
                                                breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                                right = FALSE, include.lowest = TRUE, 
                                                labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                           "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                           "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                           "pobm_60_64", "pobm_65_mm")))%>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE==1))%>%
  left_join(Pob_edad_cuadrante_2017_municipio_total,by=c("QUINTILES.DISLI.MUN","EDAD_QUIN"))%>%
  mutate(AGE_ADJUSTED_2017 = (DEATHS/POB)*Weight*100000,
         AVOID_AGE_ADJUSTED_2017 = (AVOID/POB)*Weight*100000)%>%
  summarise(MORTALITY_RATE_2017=sum(AGE_ADJUSTED_2017,na.rm = T),
            AVOID_MORTALITY_RATE_2017=sum(AVOID_AGE_ADJUSTED_2017,na.rm = T))%>%
  na.omit()%>%
  dplyr::select(QUINTILES.DISLI.MUN,MORTALITY_RATE_2017,AVOID_MORTALITY_RATE_2017)%>%
  mutate(EV_YEAR=c("2017"))

#2018
ADJUSTED_MORTALITY_2018_SLI_CAT<-mort_2018%>% 
  filter(id.ent!=99)%>%
  group_by(QUINTILES.DISLI.MUN, EDAD_QUIN = cut(as.numeric(EDAD), 
                                                breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                                right = FALSE, include.lowest = TRUE, 
                                                labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                           "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                           "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                           "pobm_60_64", "pobm_65_mm")))%>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE==1))%>%
  left_join(Pob_edad_cuadrante_2018_municipio_total,by=c("QUINTILES.DISLI.MUN","EDAD_QUIN"))%>%
  mutate(AGE_ADJUSTED_2018 = (DEATHS/POB)*Weight*100000,
         AVOID_AGE_ADJUSTED_2018 = (AVOID/POB)*Weight*100000)%>%
  summarise(MORTALITY_RATE_2018=sum(AGE_ADJUSTED_2018,na.rm = T),
            AVOID_MORTALITY_RATE_2018=sum(AVOID_AGE_ADJUSTED_2018,na.rm = T))%>%
  na.omit()%>%
  dplyr::select(QUINTILES.DISLI.MUN,MORTALITY_RATE_2018,AVOID_MORTALITY_RATE_2018)%>%
  mutate(EV_YEAR=c("2018"))

#2019
ADJUSTED_MORTALITY_2019_SLI_CAT<-mort_2019%>% 
  filter(id.ent!=99)%>%
  group_by(QUINTILES.DISLI.MUN, EDAD_QUIN = cut(as.numeric(EDAD), 
                                                breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                                right = FALSE, include.lowest = TRUE, 
                                                labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                           "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                           "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                           "pobm_60_64", "pobm_65_mm")))%>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE==1))%>%
  left_join(Pob_edad_cuadrante_2019_municipio_total,by=c("QUINTILES.DISLI.MUN","EDAD_QUIN"))%>%
  mutate(AGE_ADJUSTED_2019 = (DEATHS/POB)*Weight*100000,
         AVOID_AGE_ADJUSTED_2019 = (AVOID/POB)*Weight*100000)%>%
  summarise(MORTALITY_RATE_2019=sum(AGE_ADJUSTED_2019,na.rm = T),
            AVOID_MORTALITY_RATE_2019=sum(AVOID_AGE_ADJUSTED_2019,na.rm = T))%>%
  na.omit()%>%
  dplyr::select(QUINTILES.DISLI.MUN,MORTALITY_RATE_2019,AVOID_MORTALITY_RATE_2019)%>%
  mutate(EV_YEAR=c("2019"))


#2020
ADJUSTED_MORTALITY_2020_SLI_CAT<-mort_2020%>% 
  filter(id.ent!=99)%>%
  group_by(QUINTILES.DISLI.MUN, EDAD_QUIN = cut(as.numeric(EDAD), 
                                                breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                                right = FALSE, include.lowest = TRUE, 
                                                labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                           "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                           "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                           "pobm_60_64", "pobm_65_mm")))%>%
  summarise(DEATHS=sum(n()),
            NO_COVID_COVID=sum(COVID==0),
            COVID=sum(COVID==1),
            AVOID=sum(AVOIDABLE==1))%>%
  left_join(Pob_edad_cuadrante_2020_municipio_total,by=c("QUINTILES.DISLI.MUN","EDAD_QUIN"))%>%
  mutate(AGE_ADJUSTED_2020 = (DEATHS/POB)*Weight*100000,
         AVOID_AGE_ADJUSTED_2020 = (AVOID/POB)*Weight*100000,
         COVID_AGE_ADJUSTED_2020 = (COVID/POB)*Weight*100000,
         NO_COVID_AGE_ADJUSTED_2020 = (NO_COVID_COVID/POB)*Weight*100000)%>%
  summarise(MORTALITY_RATE_2020=sum(AGE_ADJUSTED_2020,na.rm = T),
            AVOID_MORTALITY_RATE_2020=sum(AVOID_AGE_ADJUSTED_2020,na.rm = T),
            COVID_AGE_ADJUSTED_2020=sum(COVID_AGE_ADJUSTED_2020,na.rm = T),
            NO_COVID_AGE_ADJUSTED_2020=sum(NO_COVID_AGE_ADJUSTED_2020,na.rm = T))%>%
  na.omit()%>%
  dplyr::select(QUINTILES.DISLI.MUN,MORTALITY_RATE_2020,AVOID_MORTALITY_RATE_2020,COVID_AGE_ADJUSTED_2020,NO_COVID_AGE_ADJUSTED_2020)%>%
  mutate(EV_YEAR=c("2020"))

#Average Mortality
#Tidy Merge

ADJUSTED_MORTALITY_2019_SLI_CAT_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2019_SLI_CAT%>%dplyr::select(QUINTILES.DISLI.MUN,MORTALITY_RATE_2019,EV_YEAR), group, value, -c(EV_YEAR,QUINTILES.DISLI.MUN))
ADJUSTED_MORTALITY_2018_SLI_CAT_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2018_SLI_CAT%>%dplyr::select(QUINTILES.DISLI.MUN,MORTALITY_RATE_2018,EV_YEAR), group, value, -c(EV_YEAR,QUINTILES.DISLI.MUN))
ADJUSTED_MORTALITY_2017_SLI_CAT_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2017_SLI_CAT%>%dplyr::select(QUINTILES.DISLI.MUN,MORTALITY_RATE_2017,EV_YEAR), group, value, -c(EV_YEAR,QUINTILES.DISLI.MUN))
ADJUSTED_MORTALITY_2016_SLI_CAT_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2016_SLI_CAT%>%dplyr::select(QUINTILES.DISLI.MUN,MORTALITY_RATE_2016,EV_YEAR), group, value, -c(EV_YEAR,QUINTILES.DISLI.MUN))

MORTALITY_RATE_SLI_CAT<-ADJUSTED_MORTALITY_2019_SLI_CAT_tidy%>%
  left_join(ADJUSTED_MORTALITY_2018_SLI_CAT_tidy,by=c("QUINTILES.DISLI.MUN"))%>%
  left_join(ADJUSTED_MORTALITY_2017_SLI_CAT_tidy,by=c("QUINTILES.DISLI.MUN"))%>% 
  left_join(ADJUSTED_MORTALITY_2016_SLI_CAT_tidy,by=c("QUINTILES.DISLI.MUN"))%>% 
  group_by(QUINTILES.DISLI.MUN)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(value.x,value.y,value.x.x,value.y.y)))%>%
  dplyr::select(QUINTILES.DISLI.MUN,AVERAGE_MORTALITY)%>%
  left_join(ADJUSTED_MORTALITY_2020_SLI_CAT,by="QUINTILES.DISLI.MUN")%>%
  mutate(EXCESS_MORTALITY=MORTALITY_RATE_2020-AVERAGE_MORTALITY)

MORTALITY_RATE_SLI_CAT$QUINTILES.DISLI.MUN<-factor(MORTALITY_RATE_SLI_CAT$QUINTILES.DISLI.MUN,
                                                   labels = c("Low Social Lag",
                                                              "Moderate Social Lag",
                                                              "High Social Lag",
                                                              "Very High Social Lag"))

MORTALITY_RATE_SLI_CAT_OVERALL<-MORTALITY_RATE_SLI_CAT%>%dplyr::select(QUINTILES.DISLI.MUN,AVERAGE_MORTALITY,MORTALITY_RATE_2020)
MORTALITY_RATE_SLI_CAT_OVERALL.tidyr<- tidyr::gather(MORTALITY_RATE_SLI_CAT_OVERALL, group, value, -c(QUINTILES.DISLI.MUN))
MORTALITY_RATE_SLI_CAT_OVERALL.tidyr<-as.data.frame(MORTALITY_RATE_SLI_CAT_OVERALL.tidyr)
MORTALITY_RATE_SLI_CAT_OVERALL.tidyr$group <- factor(MORTALITY_RATE_SLI_CAT_OVERALL.tidyr$group, 
                                                levels = c("AVERAGE_MORTALITY","MORTALITY_RATE_2020"),
                                                labels = c("Average Mortality Rate (2016-2019)","Overall 2020 Mortality Rate"))

FIGURE3B<-ggplot(MORTALITY_RATE_SLI_CAT_OVERALL, aes(y = QUINTILES.DISLI.MUN)) + 
  geom_dumbbell(aes(x = MORTALITY_RATE_2020, xend = AVERAGE_MORTALITY), size=3, color="#dddddd", 
                colour_x = "#208380", colour_xend = "#832023",
                dot_guide=TRUE, dot_guide_size=0.25)+
  geom_point(data = MORTALITY_RATE_SLI_CAT_OVERALL.tidyr, aes(x = value, color = group), size = 3) +
  theme_hc()+
  xlab("Age-Adjusted Mortality Rate per 100,000 Inhabitants")+
  ylab("")+
  scale_x_continuous(limits = c(400,1100))+
  guides(col=guide_legend(nrow=1,byrow=TRUE))+
  labs(colour="Year")+  
  theme(panel.grid.major.x=element_line(size=0.05),legend.position = "top",plot.title = element_text(hjust = 0.5) )+
  geom_text(data=MORTALITY_RATE_SLI_CAT_OVERALL, aes(x=round(MORTALITY_RATE_SLI_CAT_OVERALL$MORTALITY_RATE_2020,2), y=QUINTILES.DISLI.MUN, label=round(MORTALITY_RATE_SLI_CAT_OVERALL$MORTALITY_RATE_2020,2)),
            color="#208380", size=4, vjust=2.5, family="Arial")+
  geom_text(data=MORTALITY_RATE_SLI_CAT_OVERALL, color="#832023", size=4, vjust=-2.5, family="Arial",
            aes(x=round(MORTALITY_RATE_SLI_CAT_OVERALL$AVERAGE_MORTALITY,2), y=QUINTILES.DISLI.MUN, label=round(MORTALITY_RATE_SLI_CAT_OVERALL$AVERAGE_MORTALITY,2)))+
  geom_text(data=MORTALITY_RATE_SLI_CAT, aes(label=round(MORTALITY_RATE_SLI_CAT$EXCESS_MORTALITY,2), y=QUINTILES.DISLI.MUN, x=1100,vjust=-2.0), fontface="bold", size=4, family="Arial")+
  scale_color_manual(name = "", values = c("#832023","#208380") )+
  annotation_custom(grobTree(textGrob("Excess \nMortality", x=0.85,  y=0.97, hjust=0,
                                      gp=gpar(col="black", fontsize=10, fontface="italic"))))+
  ggtitle("Overall Deaths")+
  theme(axis.text.y = element_text(size = 15))    

######Merge Figure 3 #####

FIGURE3<-ggarrange(FIGURE3A,FIGURE3B,
                   ncol = 2,nrow = 1,labels = LETTERS[1:2],
                   common.legend = T)

ggsave(FIGURE3,
       filename = "Figure3.png", bg = "white",
       width = 50, 
       height = 17,
       units=c("cm"),
       dpi = 350,
       limitsize = FALSE) 


######Municipal Determinants of Increased Mortality (Figure 4A)#####

#2016
ADJUSTED_MORTALITY_2016_MUNICIPIO<-mort_2016%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2016_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2016_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2016 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2016 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2016,AVOID_AGE_ADJUSTED_2016)%>%
  mutate(EV_YEAR=c("2016"))

#2017
ADJUSTED_MORTALITY_2017_MUNICIPIO<-mort_2017%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2017_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2017_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2017 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2017 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2017,AVOID_AGE_ADJUSTED_2017)%>%
  mutate(EV_YEAR=c("2017"))

#2018
ADJUSTED_MORTALITY_2018_MUNICIPIO<-mort_2018%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2018_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2018_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2018 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2018 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2018,AVOID_AGE_ADJUSTED_2018)%>%
  mutate(EV_YEAR=c("2018"))


#2019
ADJUSTED_MORTALITY_2019_MUNICIPIO<-mort_2019%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2019_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2019_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2019 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2019 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2019,AVOID_AGE_ADJUSTED_2019)%>%
  mutate(EV_YEAR=c("2019"))

#2020

ADJUSTED_MORTALITY_2020_MUNICIPIO<-mort_2020%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            NO_COVID=sum(COVID==0),
            COVID=sum(COVID==1),
            AVOID=sum(AVOIDABLE==1))%>%
  na.omit()%>%
  left_join(Pob_edad_2020_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2020_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         DEF_ESPER_COVID = (COVID/POB.x)*POB.y,
         DEF_ESPER_NO_COVID = (NO_COVID/POB.x)*POB.y,
         DEF_ESPER_AVOID = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            DEF_ESPER_COVID=sum(DEF_ESPER_COVID,na.rm = T),
            DEF_ESPER_NO_COVID=sum(DEF_ESPER_NO_COVID,na.rm = T),
            DEF_ESPER_AVOID=sum(DEF_ESPER_AVOID,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_OVERALL_2020= (DEF_ESPER/127792286)*100000,
         AGE_ADJUSTED_COVID_2020= (DEF_ESPER_COVID/127792286)*100000,
         AGE_ADJUSTED_NOCOVID_2020= (DEF_ESPER_NO_COVID/127792286)*100000,
         AGE_ADJUSTED_AVOID_2020= (DEF_ESPER_AVOID/127792286)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_OVERALL_2020,AGE_ADJUSTED_COVID_2020,AGE_ADJUSTED_NOCOVID_2020)

ADJUSTED_MORTALITY_2016_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2016_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))
ADJUSTED_MORTALITY_2017_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2017_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))
ADJUSTED_MORTALITY_2018_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2018_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))
ADJUSTED_MORTALITY_2019_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2019_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))

MORT_AJUSTADA_ESPECIFICA_MUNICIPIO<-ADJUSTED_MORTALITY_2019_MUNICIPIO%>%
  left_join(ADJUSTED_MORTALITY_2018_MUNICIPIO,by="id.mun")%>%
  left_join(ADJUSTED_MORTALITY_2017_MUNICIPIO,by="id.mun")%>% 
  left_join(ADJUSTED_MORTALITY_2016_MUNICIPIO,by="id.mun")%>% 
  group_by(id.mun)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(AGE_ADJUSTED_2019,AGE_ADJUSTED_2018,AGE_ADJUSTED_2017,AGE_ADJUSTED_2016)),
         AVOID_AVERAGE_MORTALITY = mean(c(AVOID_AGE_ADJUSTED_2019,AVOID_AGE_ADJUSTED_2018,AVOID_AGE_ADJUSTED_2017,AVOID_AGE_ADJUSTED_2016)))%>%
  dplyr::select(id.mun,AVERAGE_MORTALITY)

#Dataset Exceso Municipio
EXCESS_MORTALITY_MUNICIPIO<-ADJUSTED_MORTALITY_2020_MUNICIPIO%>%
  left_join(MORT_AJUSTADA_ESPECIFICA_MUNICIPIO,by=c("id.mun"))%>%
  mutate(EXCESS_MORTALITY=(AGE_ADJUSTED_OVERALL_2020-AVERAGE_MORTALITY),
         NON_COVID_EXCESS_MORTALITY=(AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY))%>%
  left_join(geom_df.mun%>%dplyr::select(id.mun,dmu_camas,dmu,DISLI,QUINTILES.DISLI.MUN), by="id.mun")%>%
  dplyr::select(-c(geometry))


#Factores Base INEGI 2020

FACTORES_MORT_2020<-mort_2020%>%
  group_by(id.mun)%>%
  summarise(HOMBRES=sum(SEXO_REC=="Male",na.rm=T),
            MUJERES=sum(SEXO_REC=="Female",na.rm=T),
            SIN_ASISTENCIA=sum(asist_medi==2,na.rm=T),
            ASISTENCIA=sum(asist_medi==1,na.rm=T),
            LUGAR_HOST=sum(CONTEXTO_DEFUNCION %in% c(1,2,3,4,5,6,7,8,9),na.rm=T),
            LUGAR_AMB=sum(CONTEXTO_DEFUNCION %in% c(10,11,12,99),na.rm=T),
            AREA_URBANA=sum(area_ur==1,na.rm=T),
            AREA_RURAL=sum(area_ur==2,na.rm=T))%>%
  left_join(geom_df.mun%>%dplyr::select(id.mun,pop), by="id.mun")%>%
  mutate(RATIO_SEX=(HOMBRES/MUJERES),
         RATIO_ASISTENCIA=(SIN_ASISTENCIA/ASISTENCIA),
         RATIO_AMBULATORIO_HOST=(LUGAR_AMB/LUGAR_HOST),
         RATIO_URB_RURAL=(AREA_RURAL/AREA_URBANA))%>%
  dplyr::select(-c(geometry))%>%
  left_join(marg.mun%>%mutate(Clave2=as.character(CLAVE_MUN),
                              id.mun=str_pad(Clave2, 5,pad = "0"))%>%
              dplyr::select(-c(Clave_ENT,Nombre,CLAVE_MUN,pop,Clave2,marg,lugar_marg)), by="id.mun")

#Base de Hospitalizacion
ADJUSTED_MORTALITY_2020_ENTIDAD_MES<-covid1%>%
  mutate(MES=data.table::month(FECHA_INGRESO))%>%
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(HOSPITAL_COVID=sum(TIPO_PACIENTE==1))%>%
  na.omit()%>%
  left_join(Pob_edad_2020_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2020_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER_HOSP = (HOSPITAL_COVID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER_HOSP=sum(DEF_ESPER_HOSP,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2020_COVID_HOSP = (DEF_ESPER_HOSP/126577691)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2020_COVID_HOSP)%>%
  rename("HOSPITALIZACION_COVID"="AGE_ADJUSTED_2020_COVID_HOSP")

#Manipulation for negative binomial
GLM_EXCESS_MORTALITY_MUNICIPIO<-EXCESS_MORTALITY_MUNICIPIO%>%
  left_join(FACTORES_MORT_2020,by="id.mun")%>%
  left_join(ADJUSTED_MORTALITY_2020_ENTIDAD_MES,by="id.mun")

GLM_EXCESS_MORTALITY_MUNICIPIO$EXCESS_MORTALITY_2<-GLM_EXCESS_MORTALITY_MUNICIPIO$EXCESS_MORTALITY-(min(GLM_EXCESS_MORTALITY_MUNICIPIO$EXCESS_MORTALITY,na.rm = T))+1
GLM_EXCESS_MORTALITY_MUNICIPIO$RATIO_SEX[GLM_EXCESS_MORTALITY_MUNICIPIO$RATIO_SEX==Inf]<-NA
GLM_EXCESS_MORTALITY_MUNICIPIO$RATIO_ASISTENCIA[GLM_EXCESS_MORTALITY_MUNICIPIO$RATIO_ASISTENCIA==Inf]<-NA
GLM_EXCESS_MORTALITY_MUNICIPIO$RATIO_AMBULATORIO_HOST[GLM_EXCESS_MORTALITY_MUNICIPIO$RATIO_AMBULATORIO_HOST==Inf]<-NA
GLM_EXCESS_MORTALITY_MUNICIPIO$RATIO_URB_RURAL[GLM_EXCESS_MORTALITY_MUNICIPIO$RATIO_URB_RURAL==Inf]<-NA

#Negative Binomial Model
#Excess Non-COVID

mod1<-MASS::glm.nb(EXCESS_MORTALITY_2~scale(dmu)+scale(RATIO_SEX)+scale(RATIO_ASISTENCIA)+scale(RATIO_URB_RURAL)+scale(RATIO_AMBULATORIO_HOST)+scale(ed_basica_inc)+
                     scale(no_salud)+scale(HOSPITALIZACION_COVID)+factor(QUINTILES.DISLI.MUN),data=GLM_EXCESS_MORTALITY_MUNICIPIO)
summary(mod1)
jtools::summ(mod1, exp=T)
car::vif(mod1)
jtools::plot_summs(mod1,exp=T)

FIGURE4A<-jtools::plot_summs(mod1,
                             legend.title = "Group",coefs = c("Urban Population Density"="scale(dmu)",
                                                              "Ratio Male/Women Deaths"="scale(RATIO_SEX)",
                                                              "Ratio Medical Assistance/No-Medical Assistance Prior Death"="scale(RATIO_ASISTENCIA)",
                                                              "Ratio Urban/Rural Deaths"="scale(RATIO_URB_RURAL)",
                                                              "Ratio Ambulatory/Hospital Deaths"="scale(RATIO_AMBULATORIO_HOST)",
                                                              "Percent of Inhabitants With \n Secondary or Higher Education"="scale(ed_basica_inc)",
                                                              "Percent of Inhabitants Withouth \n Social Security"="scale(no_salud)",
                                                              "COVID-19 Hospital Occupation"="scale(HOSPITALIZACION_COVID)",
                                                              "Moderate \n Social Log Index"="factor(QUINTILES.DISLI.MUN)2",
                                                              "High \n Social Log Index"="factor(QUINTILES.DISLI.MUN)3",
                                                              "Very High \n Social Log Index"="factor(QUINTILES.DISLI.MUN)4"),
                             colors = "Qual1", exp=T)+
  xlab("Negative Binomial Regression\n Incidence Rate Ratio, 95%CI")+
  scale_x_log10()+
  theme_hc()+
  ylab("")+
  ggtitle("Associated Municipal Factors for \nExcess Mortality")


######Individual Determinants of Non-COVID-19 Mortality (Figure 4B)#####

m1<-lme4::glmer(NO_COVID~scale(EDAD)+
                  SEXO_REC+ESCOLARIDAD_REC+
                  ATENCION_MEDICA_REC+TIPO_SS+factor(QUINTILES.DISLI.MUN)+scale(DMU_MUN)+DMU_CAMAS_MUN_REC+LENGUA_IND+OCUPACION_REC + (1| id.mun),data = mort_2020,family = "binomial")
summary(m1)
jtools::summ(m1,exp=T)
Figure4B<-jtools::plot_summs(m1,coefs = c("Age (Years)"="scale(EDAD)",
                                "Female Sex"="SEXO_RECFemale",
                                "Bachellor  Only"="ESCOLARIDAD_RECBachellor  Only",
                                "High-School Only"="ESCOLARIDAD_RECHigh-School Only",
                                "Primary of None Education"="ESCOLARIDAD_RECPrimary of None Education",
                                "Without Medical Assistance"="ATENCION_MEDICA_RECWithout Medical Assistance",
                                "Public Social Security"="TIPO_SSPublic Social Security",
                                "Without Social Security"="TIPO_SSWithout Social Security",
                                "Unespecified Social Security"="TIPO_SSUnespecified",
                                "Indigenous"="LENGUA_INDIndigenous",
                                "Laboreur"="OCUPACION_RECLaboreur",
                                "Craftmen and Farmers"="OCUPACION_RECCraftmen and Farmers",
                                "Unemployed"="OCUPACION_RECUnemployed",
                                "Non-Specified Occupation"="OCUPACION_RECNon-Specified",
                                "Urban Density"="scale(DMU_MUN)",
                                "Low-Hospital Beds Available"="DMU_CAMAS_MUN_RECLow-Hospital Beds Available",
                                "Moderate Social Lag"="factor(QUINTILES.DISLI.MUN)2",
                                "High Social Lag"="factor(QUINTILES.DISLI.MUN)3",
                                "Very-High Social Lag"="factor(QUINTILES.DISLI.MUN)4"),colors = "Qual1",exp = T)+
  ylab("")+
  ggtitle("Individual Factors Related to \nNon-COVID-19 Mortality")+
  theme_hc() +
  xlab("Logistic Regression Model, \n (Odds Ratio: 95% C.I.)")+
  theme(axis.line=element_blank(),panel.grid.minor = element_blank(), axis.ticks.y = element_blank())+
  scale_x_log10()

Figure4<-ggarrange(Figure4A,Figure4B,
                   ncol = 2,nrow = 1,labels = LETTERS[1:2],
                   common.legend = T)


ggsave(Figure4,
       filename = "Figure4.png", bg = "white",
       width = 20, 
       height = 17,
       units=c("cm"),
       dpi = 350,
       limitsize = FALSE) 

######Descriptive Characteristics (Supplementary Table 1)#####

columnas<-c("Parameter", "Total Population \n (n=1,069,174)")

#Edad
nortest::ad.test(mort_2020$EDAD)
EDAD.mediana<-round(median(mort_2020$EDAD,na.rm = T),2)
EDAD.iqr1<-round(quantile(mort_2020$EDAD,0.25,na.rm = T),2)
EDAD.iqr3<-round(quantile(mort_2020$EDAD,0.75,na.rm = T),2)
EDAD.descritivo<-`names<-`(data.frame(matrix(c("Age (years)",paste(EDAD.mediana,"(",EDAD.iqr1,"-",EDAD.iqr3,")")),
                                            ncol = 2,byrow = T)),columnas)

#Sexo Masculino
sexo<-sort(table(mort_2020$SEXO_REC),decreasing = T)[c(1)]
prop.sexo<-sort(round(prop.table(table(mort_2020$SEXO_REC))[c(1)]*100,2),decreasing = T)
SEXO.descriptivo<-`names<-`(data.frame(matrix(c("Male Sex (%)",c(paste(sexo,"(",prop.sexo,"%",")"))),ncol=2,byrow=T)),columnas)

#Marital Status
edo.marital<-sort(table(mort_2020$EDO_CIVIL,useNA = "always")[c(1:4)],decreasing = T)
prop.edo.marital<-sort(round(prop.table(table(mort_2020$EDO_CIVIL,useNA = "always"))[c(1:4)]*100,2),decreasing = T)
EDO.MARITAL.descriptivo<-`names<-`(data.frame(matrix(c(c("Married or Consensual Union (%)", 
                                                       "Divorced, Widowed or Separated (%)",
                                                       "Single Status (%)", 
                                                       "Non-Specified Union (%)"),c(paste(edo.marital,"(",prop.edo.marital,"%",")"))),ncol=2,byrow=F)),columnas)



#Ocupación
ocupac<-sort(table(mort_2020$OCUPACION_REC,useNA = "always")[c(1:6)],decreasing = T)
prop.ocupac<-sort(round(prop.table(table(mort_2020$OCUPACION_REC,useNA = "always"))[c(1:6)]*100,2),decreasing = T)
OCUPACION.descriptivo<-`names<-`(data.frame(matrix(c(c("Unemployed (%)", 
                                                       "Craftmen and Farmers (%)",
                                                       "Laboreur (%)", 
                                                       "Non-Specified (%)", 
                                                       "Office and Proffesional Workers (%)",
                                                       "Non-Applicable Ocuppation (%)"),c(paste(ocupac,"(",prop.ocupac,"%",")"))),ncol=2,byrow=F)),columnas)

#Educacion
educa<-sort(table(mort_2020$ESCOLARIDAD_REC,useNA = "always")[c(1:5)],decreasing = T)
prop.educa<-sort(round(prop.table(table(mort_2020$ESCOLARIDAD_REC,useNA = "always"))[c(1:5)]*100,2),decreasing = T)
EDUCACION.descriptivo<-`names<-`(data.frame(matrix(c(c("Primary of None Education (%)",
                                                       "High-School Only (%)", 
                                                       "Collegue or Higher (%)", 
                                                       "Bachellor  Only (%)", 
                                                       "Non-Applicable Education (%)"),c(paste(educa,"(",prop.educa,"%",")"))),ncol=2,byrow=F)),columnas)

#Atención Médica
medica<-sort(table(mort_2020$ATENCION_MEDICA_REC,useNA = "always")[c(1:3)],decreasing = T)
prop.medica<-sort(round(prop.table(table(mort_2020$ATENCION_MEDICA_REC,useNA = "always"))[c(1:3)]*100,2),decreasing = T)
ED.MEDICA.descriptivo<-`names<-`(data.frame(matrix(c(c("Medical Assistance Prior to Death (%)", "Without Medical Assistance Prior to Death (%)", "Un-Specified Medical of Attention(%)"),c(paste(medica,"(",prop.medica,"%",")"))),ncol=2,byrow=F)),columnas)

#Seguro Social
social.S<-sort(table(mort_2020$TIPO_SS,useNA = "always")[c(1:4)],decreasing = T)
prop.social.S<-sort(round(prop.table(table(mort_2020$TIPO_SS,useNA = "always"))[c(1:4)]*100,2),decreasing = T)
SEGURIDAD.SOC.descriptivo<-`names<-`(data.frame(matrix(c(c("Public Social Security (%)",
                                                           "Without Social Security (%)",
                                                           "Unespecified Social Security (%)",
                                                           "Private Social Security (%)"),c(paste(social.S,"(",prop.social.S,"%",")"))),ncol=2,byrow=F)),columnas)

#Indigena
indig<-table(mort_2020$LENGUA_IND,useNA = "always")[c(2)]
prop.indig<-round(prop.table(table(mort_2020$LENGUA_IND,useNA = "always"))[c(2)]*100,2)
INDIGENA.descriptivo<-`names<-`(data.frame(matrix(c(c("Indigenous (%)"),c(paste(indig,"(",prop.indig,"%",")"))),ncol=2,byrow=F)),columnas)

#Hospital Beds
CAMAS<-sort(table(mort_2020$DMU_CAMAS_MUN_REC,useNA = "always")[c(1:2)],decreasing = T)
prop.CAMAS<-sort(round(prop.table(table(mort_2020$DMU_CAMAS_MUN_REC,useNA = "always"))[c(1:2)]*100,2),decreasing = T)
CAMAS.descriptivo<-`names<-`(data.frame(matrix(c(c("Low-Hospital Beds Available (%)",
                                                   "Adequate-Hospital Beds Available (%)"),c(paste(CAMAS,"(",prop.CAMAS,"%",")"))),ncol=2,byrow=F)),columnas)


#Social Lag Index
SLI<-table(mort_2020$QUINTILES.DISLI,useNA = "always")[c(1:5)]
prop.SLI<-round(prop.table(table(mort_2020$QUINTILES.DISLI,useNA = "always"))[c(1:5)]*100,2)
SLI.descriptivo<-`names<-`(data.frame(matrix(c(c("Very Low-Social Lag (%)", "Low-Social Lag (%)","Moderate-Social Lag (%)", "High-Social Lag (%)", "Very-High Social Lag (%)"),c(paste(SLI,"(",prop.SLI,"%",")"))),ncol=2,byrow=F)),columnas)

#EVITABLE
evitable<-table(mort_2020$TREA.PREV,useNA = "always")[c(1:4)]
prop.evitable<-round(prop.table(table(mort_2020$TREA.PREV,useNA = "always"))[c(1:4)]*100,2)
EVITABLE.descriptivo<-`names<-`(data.frame(matrix(c(c("Preventable Death (%)","Treatable Death (%)","Preventable and Treatable Death (%)", "Non-Avoidable Death (%)"),c(paste(evitable,"(",prop.evitable,"%",")"))),ncol=2,byrow=F)),columnas)


Table1_df<-rbind(SEXO.descriptivo,EDAD.descritivo,EDO.MARITAL.descriptivo,EDUCACION.descriptivo,OCUPACION.descriptivo,ED.MEDICA.descriptivo,SEGURIDAD.SOC.descriptivo,CAMAS.descriptivo,INDIGENA.descriptivo,SLI.descriptivo,EVITABLE.descriptivo)
Table1_FINAL<-cbind(Table1_df)
Table1_Flex_FINAL<-flextable::align(flextable::flextable(Table1_FINAL,cwidth=2),align="center",part="all")%>%flextable::autofit()
flextable::save_as_docx(Table1_Flex_FINAL,path="Table_1.docx")


######Excess mortality by state of residency  (Supplementary Figure 1)#####

#2016
ADJUSTED_MORTALITY_2016_ENTIDAD<-mort_2016%>% 
  group_by(id.ent,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()))%>%
  na.omit()%>%
  left_join(Pob_edad_2016_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2016_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y)%>% 
  group_by(id.ent) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T))%>%
  group_by(id.ent)%>% 
  mutate(AGE_ADJUSTED_2016 = (DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.ent,AGE_ADJUSTED_2016)%>%
  mutate(EV_YEAR=c("2016"))

#2017
ADJUSTED_MORTALITY_2017_ENTIDAD<-mort_2017%>% 
  group_by(id.ent,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()))%>%
  na.omit()%>%
  left_join(Pob_edad_2017_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2017_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y)%>% 
  group_by(id.ent) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T))%>%
  group_by(id.ent)%>% 
  mutate(AGE_ADJUSTED_2017 = (DEF_ESPER/124041731)*100000)%>%
  dplyr::select(id.ent,AGE_ADJUSTED_2017)%>%
  mutate(EV_YEAR=c("2017"))


#2018
ADJUSTED_MORTALITY_2018_ENTIDAD<-mort_2018%>% 
  group_by(id.ent,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()))%>%
  na.omit()%>%
  left_join(Pob_edad_2018_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2018_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y)%>% 
  group_by(id.ent) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T))%>%
  group_by(id.ent)%>% 
  mutate(AGE_ADJUSTED_2018 = (DEF_ESPER/125327797)*100000)%>%
  dplyr::select(id.ent,AGE_ADJUSTED_2018)%>%
  mutate(EV_YEAR=c("2018"))


#2019
ADJUSTED_MORTALITY_2019_ENTIDAD<-mort_2019%>% 
  group_by(id.ent,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()))%>%
  na.omit()%>%
  left_join(Pob_edad_2019_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2019_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y)%>% 
  group_by(id.ent) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T))%>%
  group_by(id.ent)%>% 
  mutate(AGE_ADJUSTED_2019 = (DEF_ESPER/126577691)*100000)%>%
  dplyr::select(id.ent,AGE_ADJUSTED_2019)%>%
  mutate(EV_YEAR=c("2019"))

#2020
ADJUSTED_MORTALITY_2020_ENTIDAD<-mort_2020%>% 
  group_by(id.ent,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            COVID=sum(COVID==1,na.rm = T),
            NO_COVID=sum(NO_COVID==1,na.rm = T))%>%
  na.omit()%>%
  left_join(Pob_edad_2020_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2020_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         DEF_ESPER_COVID = (COVID/POB.x)*POB.y,
         DEF_ESPER_NO_COVID = (NO_COVID/POB.x)*POB.y)%>% 
  group_by(id.ent) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            DEF_ESPER_COVID=sum(DEF_ESPER_COVID,na.rm = T),
            DEF_ESPER_NO_COVID=sum(DEF_ESPER_NO_COVID,na.rm = T))%>%
  group_by(id.ent)%>% 
  mutate(AGE_ADJUSTED_OVERALL_2020= (DEF_ESPER/127792286)*100000,
         AGE_ADJUSTED_COVID_2020= (DEF_ESPER_COVID/127792286)*100000,
         AGE_ADJUSTED_NOCOVID_2020= (DEF_ESPER_NO_COVID/127792286)*100000)%>%
  dplyr::select(id.ent,AGE_ADJUSTED_OVERALL_2020,AGE_ADJUSTED_COVID_2020,AGE_ADJUSTED_NOCOVID_2020)%>%
  mutate(EV_YEAR=c("2020"))

#Tidy Merge
ADJUSTED_MORTALITY_2016_ENTIDAD_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2016_ENTIDAD, group, value, -c(EV_YEAR,id.ent))
ADJUSTED_MORTALITY_2017_ENTIDAD_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2017_ENTIDAD, group, value, -c(EV_YEAR,id.ent))
ADJUSTED_MORTALITY_2018_ENTIDAD_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2018_ENTIDAD, group, value, -c(EV_YEAR,id.ent))
ADJUSTED_MORTALITY_2019_ENTIDAD_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2019_ENTIDAD, group, value, -c(EV_YEAR,id.ent))

MORT_AJUSTADA_ESPECIFICA_ESTADO<-ADJUSTED_MORTALITY_2019_ENTIDAD%>%
  left_join(ADJUSTED_MORTALITY_2018_ENTIDAD,by="id.ent")%>%
  left_join(ADJUSTED_MORTALITY_2017_ENTIDAD,by="id.ent")%>% 
  left_join(ADJUSTED_MORTALITY_2016_ENTIDAD,by="id.ent")%>% 
  group_by(id.ent)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(AGE_ADJUSTED_2019,AGE_ADJUSTED_2018,AGE_ADJUSTED_2017,AGE_ADJUSTED_2016)))%>%
  dplyr::select(id.ent,AVERAGE_MORTALITY)


EXCESS_MORTALITY_ENTIDAD<-ADJUSTED_MORTALITY_2020_ENTIDAD%>%
  left_join(MORT_AJUSTADA_ESPECIFICA_ESTADO,by=c("id.ent"))%>%
  mutate(EXCESS_MORTALITY=(AGE_ADJUSTED_OVERALL_2020-AVERAGE_MORTALITY),
         EXCESS_NON_COVID=(AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY),
         PERCENT_EXCESS_MORTALITY_COVID=(AGE_ADJUSTED_COVID_2020*100/EXCESS_MORTALITY),
         PERCENT_EXCESS_MORTALITY_NOCOVID=((AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY)*100/EXCESS_MORTALITY),)%>%
  left_join(geom_df.ent,by="id.ent")

EXCESS_MORTALITY_ENTIDAD<-bi_class(EXCESS_MORTALITY_ENTIDAD, 
                                   x = PERCENT_EXCESS_MORTALITY_COVID, 
                                   y = PERCENT_EXCESS_MORTALITY_NOCOVID, 
                                   style = "quantile", dim = 2)

EXCESS_MORTALITY_ENTIDAD_2.1<-rbind(data.frame(NOM_ENT=EXCESS_MORTALITY_ENTIDAD$NOM_ENT,
                                               rate=EXCESS_MORTALITY_ENTIDAD$AGE_ADJUSTED_COVID_2020,
                                               label=c("COVID-19")))

EXCESS_MORTALITY_ENTIDAD_2.2<-rbind(data.frame(NOM_ENT=EXCESS_MORTALITY_ENTIDAD$NOM_ENT,
                                               rate=EXCESS_MORTALITY_ENTIDAD$AGE_ADJUSTED_NOCOVID_2020,
                                               label=c("Non-COVID-19")))


Sup_Figure2A.1<-EXCESS_MORTALITY_ENTIDAD_2.1 %>% 
  na.omit%>%
  group_by(NOM_ENT) %>% 
  ungroup() %>% 
  arrange(desc(label), rate) %>% 
  mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
  ggplot(aes(NOM_ENT, rate, fill = label))+
  geom_col(position = "dodge") +
  coord_flip()+ 
  ylab("Age-Adjusted Mortality Rate \n per 100,000 inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#7c8cc4"))

Sup_Figure2A.2<-EXCESS_MORTALITY_ENTIDAD_2.2 %>% 
  na.omit%>%
  group_by(NOM_ENT) %>% 
  ungroup() %>% 
  arrange(desc(label), rate) %>% 
  mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
  ggplot(aes(NOM_ENT, rate, fill = label))+
  geom_col(position = "dodge") +
  coord_flip()+ 
  ylab("Age-Adjusted Mortality Rate \n per 100,000 inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#84b48c"))

#Barplots

EXCESS_MORTALITY_ENTIDAD_1<-EXCESS_MORTALITY_ENTIDAD%>%
  dplyr::select(NOM_ENT,PERCENT_EXCESS_MORTALITY_COVID)%>%
  rename("PERCENT"="PERCENT_EXCESS_MORTALITY_COVID")%>%
  mutate(label=c("COVID"))%>% 
  arrange(desc(PERCENT))

EXCESS_MORTALITY_ENTIDAD_2<-EXCESS_MORTALITY_ENTIDAD%>%
  dplyr::select(NOM_ENT,PERCENT_EXCESS_MORTALITY_NOCOVID)%>%
  rename("PERCENT"="PERCENT_EXCESS_MORTALITY_NOCOVID")%>%
  mutate(label=c("Non-COVID"))%>% 
  arrange(desc(PERCENT))

EXCESS_MORTALITY_ENTIDAD_PERCENT<-rbind(EXCESS_MORTALITY_ENTIDAD_1,EXCESS_MORTALITY_ENTIDAD_2)

Sup_Figure2B<-EXCESS_MORTALITY_ENTIDAD_PERCENT %>% 
  na.omit%>%
  group_by(NOM_ENT) %>% 
  ungroup() %>% 
  arrange(desc(label), PERCENT) %>% 
  mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
  ggplot(aes(NOM_ENT, PERCENT, fill = label)) +
  geom_col() +
  coord_flip()+ 
  ylab("Age-Adjusted Excess Mortality")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#7c8cc4","#84b48c"))


Sup_Figure2A<-ggarrange(Sup_Figure2A.1,Sup_Figure2A.2,ncol = 2,nrow = 1,labels = c("A",""))
Sup_Figure1<-ggarrange(Sup_Figure2A,Sup_Figure2B,ncol=2,nrow=1,labels=c("","","",""))

ggsave(Sup_Figure1,
       filename = "Supplementary_Figure_1.png", bg = "white",
       width = 60, 
       height = 30,
       units=c("cm"),
       dpi = 350,
       limitsize = FALSE) 


######Maps and Barplots Stratification of Main Causes of Death by State of Residency (Supplementary Figure 2)#####

#2016
CAUSA_ESPECIFICA_2016_ESTADO<-mort_2016%>% 
  group_by(id.ent,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  na.omit()%>%
  left_join(Pob_edad_2016_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2016_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(SC3.IAMC=(SC3.IAMC/POB.x)*POB.y,
         END.DIAB=(END.DIAB/POB.x)*POB.y,
         SC2.ECHI=(SC2.ECHI/POB.x)*POB.y,
         SC2.HTES=(SC2.HTES/POB.x)*POB.y,
         EX7.ASSA=(EX7.ASSA/POB.x)*POB.y,
         SC2.OTRA=(SC2.OTRA/POB.x)*POB.y,
         SC5.EVCN=(SC5.EVCN/POB.x)*POB.y,
         SC3.OTRA=(SC3.OTRA/POB.x)*POB.y,
         END.OBES=(END.OBES/POB.x)*POB.y)%>% 
  group_by(id.ent) %>% 
  summarise(SC3.IAMC=sum(SC3.IAMC,na.rm = T),
            END.DIAB=sum(END.DIAB,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI,na.rm = T),
            SC2.HTES=sum(SC2.HTES,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA,na.rm = T),
            END.OBES=sum(END.OBES,na.rm = T),)%>%
  group_by(id.ent)%>% 
  summarise("Acute Myocardial Infarction"=(SC3.IAMC/122715165)*100000,
            "Type 2 Diabetes"=(END.DIAB/122715165)*100000,
            "Hypertensive Heart Disease"=(SC2.ECHI/122715165)*100000,
            "Essential (Primary) Hypertension"=(SC2.HTES/122715165)*100000,
            "Assault"=(EX7.ASSA/122715165)*100000,
            "Other Hypertensive Diseases"=(SC2.OTRA/122715165)*100000,
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=(SC5.EVCN/122715165)*100000,
            "Other Ischemic Heart Diseases"=(SC3.OTRA/122715165)*100000,
            "Obesity"=(END.OBES/122715165)*100000)%>%
  mutate(EV_YEAR=c("2016"))

#2017
CAUSA_ESPECIFICA_2017_ESTADO<-mort_2017%>% 
  group_by(id.ent,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  na.omit()%>%
  left_join(Pob_edad_2017_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2017_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(SC3.IAMC=(SC3.IAMC/POB.x)*POB.y,
         END.DIAB=(END.DIAB/POB.x)*POB.y,
         SC2.ECHI=(SC2.ECHI/POB.x)*POB.y,
         SC2.HTES=(SC2.HTES/POB.x)*POB.y,
         EX7.ASSA=(EX7.ASSA/POB.x)*POB.y,
         SC2.OTRA=(SC2.OTRA/POB.x)*POB.y,
         SC5.EVCN=(SC5.EVCN/POB.x)*POB.y,
         SC3.OTRA=(SC3.OTRA/POB.x)*POB.y,
         END.OBES=(END.OBES/POB.x)*POB.y)%>% 
  group_by(id.ent) %>% 
  summarise(SC3.IAMC=sum(SC3.IAMC,na.rm = T),
            END.DIAB=sum(END.DIAB,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI,na.rm = T),
            SC2.HTES=sum(SC2.HTES,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA,na.rm = T),
            END.OBES=sum(END.OBES,na.rm = T),)%>%
  group_by(id.ent)%>% 
  summarise("Acute Myocardial Infarction"=(SC3.IAMC/122715165)*100000,
            "Type 2 Diabetes"=(END.DIAB/122715165)*100000,
            "Hypertensive Heart Disease"=(SC2.ECHI/122715165)*100000,
            "Essential (Primary) Hypertension"=(SC2.HTES/122715165)*100000,
            "Assault"=(EX7.ASSA/122715165)*100000,
            "Other Hypertensive Diseases"=(SC2.OTRA/122715165)*100000,
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=(SC5.EVCN/122715165)*100000,
            "Other Ischemic Heart Diseases"=(SC3.OTRA/122715165)*100000,
            "Obesity"=(END.OBES/122715165)*100000)%>%
  mutate(EV_YEAR=c("2017"))

#2018
CAUSA_ESPECIFICA_2018_ESTADO<-mort_2018%>% 
  group_by(id.ent,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  na.omit()%>%
  left_join(Pob_edad_2018_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2018_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(SC3.IAMC=(SC3.IAMC/POB.x)*POB.y,
         END.DIAB=(END.DIAB/POB.x)*POB.y,
         SC2.ECHI=(SC2.ECHI/POB.x)*POB.y,
         SC2.HTES=(SC2.HTES/POB.x)*POB.y,
         EX7.ASSA=(EX7.ASSA/POB.x)*POB.y,
         SC2.OTRA=(SC2.OTRA/POB.x)*POB.y,
         SC5.EVCN=(SC5.EVCN/POB.x)*POB.y,
         SC3.OTRA=(SC3.OTRA/POB.x)*POB.y,
         END.OBES=(END.OBES/POB.x)*POB.y)%>% 
  group_by(id.ent) %>% 
  summarise(SC3.IAMC=sum(SC3.IAMC,na.rm = T),
            END.DIAB=sum(END.DIAB,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI,na.rm = T),
            SC2.HTES=sum(SC2.HTES,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA,na.rm = T),
            END.OBES=sum(END.OBES,na.rm = T),)%>%
  group_by(id.ent)%>% 
  summarise("Acute Myocardial Infarction"=(SC3.IAMC/122715165)*100000,
            "Type 2 Diabetes"=(END.DIAB/122715165)*100000,
            "Hypertensive Heart Disease"=(SC2.ECHI/122715165)*100000,
            "Essential (Primary) Hypertension"=(SC2.HTES/122715165)*100000,
            "Assault"=(EX7.ASSA/122715165)*100000,
            "Other Hypertensive Diseases"=(SC2.OTRA/122715165)*100000,
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=(SC5.EVCN/122715165)*100000,
            "Other Ischemic Heart Diseases"=(SC3.OTRA/122715165)*100000,
            "Obesity"=(END.OBES/122715165)*100000)%>%
  mutate(EV_YEAR=c("2018"))

#2019
CAUSA_ESPECIFICA_2019_ESTADO<-mort_2019%>% 
  group_by(id.ent,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  na.omit()%>%
  left_join(Pob_edad_2019_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2019_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(SC3.IAMC=(SC3.IAMC/POB.x)*POB.y,
         END.DIAB=(END.DIAB/POB.x)*POB.y,
         SC2.ECHI=(SC2.ECHI/POB.x)*POB.y,
         SC2.HTES=(SC2.HTES/POB.x)*POB.y,
         EX7.ASSA=(EX7.ASSA/POB.x)*POB.y,
         SC2.OTRA=(SC2.OTRA/POB.x)*POB.y,
         SC5.EVCN=(SC5.EVCN/POB.x)*POB.y,
         SC3.OTRA=(SC3.OTRA/POB.x)*POB.y,
         END.OBES=(END.OBES/POB.x)*POB.y)%>% 
  group_by(id.ent) %>% 
  summarise(SC3.IAMC=sum(SC3.IAMC,na.rm = T),
            END.DIAB=sum(END.DIAB,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI,na.rm = T),
            SC2.HTES=sum(SC2.HTES,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA,na.rm = T),
            END.OBES=sum(END.OBES,na.rm = T),)%>%
  group_by(id.ent)%>% 
  summarise("Acute Myocardial Infarction"=(SC3.IAMC/122715165)*100000,
            "Type 2 Diabetes"=(END.DIAB/122715165)*100000,
            "Hypertensive Heart Disease"=(SC2.ECHI/122715165)*100000,
            "Essential (Primary) Hypertension"=(SC2.HTES/122715165)*100000,
            "Assault"=(EX7.ASSA/122715165)*100000,
            "Other Hypertensive Diseases"=(SC2.OTRA/122715165)*100000,
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=(SC5.EVCN/122715165)*100000,
            "Other Ischemic Heart Diseases"=(SC3.OTRA/122715165)*100000,
            "Obesity"=(END.OBES/122715165)*100000)%>%
  mutate(EV_YEAR=c("2019"))

#2020
CAUSA_ESPECIFICA_2020_ESTADO<-mort_2020%>% 
  group_by(id.ent,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(COVID_19=sum(COVID==1,na.rm = T),
            SC3.IAMC=sum(SC3.IAMC==1,na.rm = T),
            END.DIAB=sum(END.DIAB==1,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI==1,na.rm = T),
            SC2.HTES=sum(SC2.HTES==1,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA==1,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA==1,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN==1,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA==1,na.rm = T),
            END.OBES=sum(END.OBES==1,na.rm = T))%>%
  na.omit()%>%
  left_join(Pob_edad_2020_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2020_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(COVID_19=(COVID_19/POB.x)*POB.y,
         SC3.IAMC=(SC3.IAMC/POB.x)*POB.y,
         END.DIAB=(END.DIAB/POB.x)*POB.y,
         SC2.ECHI=(SC2.ECHI/POB.x)*POB.y,
         SC2.HTES=(SC2.HTES/POB.x)*POB.y,
         EX7.ASSA=(EX7.ASSA/POB.x)*POB.y,
         SC2.OTRA=(SC2.OTRA/POB.x)*POB.y,
         SC5.EVCN=(SC5.EVCN/POB.x)*POB.y,
         SC3.OTRA=(SC3.OTRA/POB.x)*POB.y,
         END.OBES=(END.OBES/POB.x)*POB.y)%>% 
  group_by(id.ent) %>% 
  summarise(COVID_19=sum(COVID_19,na.rm = T),
            SC3.IAMC=sum(SC3.IAMC,na.rm = T),
            END.DIAB=sum(END.DIAB,na.rm = T),
            SC2.ECHI=sum(SC2.ECHI,na.rm = T),
            SC2.HTES=sum(SC2.HTES,na.rm = T),
            EX7.ASSA=sum(EX7.ASSA,na.rm = T),
            SC2.OTRA=sum(SC2.OTRA,na.rm = T),
            SC5.EVCN=sum(SC5.EVCN,na.rm = T),
            SC3.OTRA=sum(SC3.OTRA,na.rm = T),
            END.OBES=sum(END.OBES,na.rm = T),)%>%
  group_by(id.ent)%>% 
  summarise("Confirmed or Suspected COVID-19"=(COVID_19/122715165)*100000,
            "Acute Myocardial Infarction"=(SC3.IAMC/122715165)*100000,
            "Type 2 Diabetes"=(END.DIAB/122715165)*100000,
            "Hypertensive Heart Disease"=(SC2.ECHI/122715165)*100000,
            "Essential (Primary) Hypertension"=(SC2.HTES/122715165)*100000,
            "Assault"=(EX7.ASSA/122715165)*100000,
            "Other Hypertensive Diseases"=(SC2.OTRA/122715165)*100000,
            "Unnespecified Stroke \n(Hemorrhagic vs Isquemic)"=(SC5.EVCN/122715165)*100000,
            "Other Ischemic Heart Diseases"=(SC3.OTRA/122715165)*100000,
            "Obesity"=(END.OBES/122715165)*100000)%>%
  mutate(EV_YEAR=c("2020"))

CAUSA_ESPECIFICA_2016_ESTADO_tidy<-tidyr::gather(CAUSA_ESPECIFICA_2016_ESTADO, group, value, -c(EV_YEAR,id.ent))
CAUSA_ESPECIFICA_2017_ESTADO_tidy<-tidyr::gather(CAUSA_ESPECIFICA_2017_ESTADO, group, value, -c(EV_YEAR,id.ent))
CAUSA_ESPECIFICA_2018_ESTADO_tidy<-tidyr::gather(CAUSA_ESPECIFICA_2018_ESTADO, group, value, -c(EV_YEAR,id.ent))
CAUSA_ESPECIFICA_2019_ESTADO_tidy<-tidyr::gather(CAUSA_ESPECIFICA_2019_ESTADO, group, value, -c(EV_YEAR,id.ent))
CAUSA_ESPECIFICA_2020_ESTADO_tidy<-tidyr::gather(CAUSA_ESPECIFICA_2020_ESTADO, group, value, -c(EV_YEAR,id.ent))

MORT_AJUSTADA_ESPECIFICA_ESTATAL<-CAUSA_ESPECIFICA_2020_ESTADO_tidy%>%
  left_join(CAUSA_ESPECIFICA_2019_ESTADO_tidy,by=c("id.ent","group"))%>%
  left_join(CAUSA_ESPECIFICA_2018_ESTADO_tidy,by=c("id.ent","group"))%>%
  left_join(CAUSA_ESPECIFICA_2017_ESTADO_tidy,by=c("id.ent","group"))%>%
  left_join(CAUSA_ESPECIFICA_2016_ESTADO_tidy,by=c("id.ent","group"))%>%
  group_by(group)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(value.y,value.x.x,value.y.y,value)))%>%
  mutate(AVERAGE_MORTALITY = na.replace(AVERAGE_MORTALITY,0))%>%
  mutate(EXCESS_MORTALITY=(value.x-AVERAGE_MORTALITY))%>%
  dplyr::select(id.ent,group,EXCESS_MORTALITY)%>%
  left_join(geom_df.ent%>%dplyr::select(id.ent,NOM_ENT),by="id.ent")

table(MORT_AJUSTADA_ESPECIFICA_ESTATAL$group)
#Merging Figure
Supplementary_Figure_2A<-ggdraw(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Confirmed or Suspected COVID-19",]%>%
                                  na.omit()%>%
                                  ggplot() +
                                  geom_sf(aes(fill = EXCESS_MORTALITY, geometry = geometry), size = 0.1) +
                                  scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
                                  theme_map() +
                                  theme(legend.position = "none")+
                                  labs(fill="Age-Adjusted \nMortality Rate")+
                                  ggtitle("Confirmed or Suspected COVID-19")) +
  draw_plot(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Confirmed or Suspected COVID-19",] %>% 
              na.omit()%>%
              group_by(NOM_ENT) %>% 
              ungroup() %>% 
              arrange(desc(group), EXCESS_MORTALITY) %>% 
              mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
              ggplot(aes(NOM_ENT, EXCESS_MORTALITY,fill=EXCESS_MORTALITY)) +
              scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
              geom_col() +
              coord_flip()+ 
              ylab("")+
              xlab("")+
              theme_pubclean()+
              theme(legend.position = "bottom")+
              labs(fill="Age-Adjusted \nMortality Rate"), .01, .01, .4, .45) +
  draw_plot_label(
    c("", ""),
    c(0, 0.45),
    c(1, 0.95),
    size = 12)

Supplementary_Figure_2B<-ggdraw(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Acute Myocardial Infarction",]%>%
                                  na.omit()%>%
                                  ggplot() +
                                  geom_sf(aes(fill = EXCESS_MORTALITY, geometry = geometry), size = 0.1) +
                                  scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 2))+
                                  theme_map() +
                                  theme(legend.position = "none")+
                                  labs(fill="Age-Adjusted \nMortality Rate")+
                                  ggtitle("Acute Myocardial Infarction")) +
  draw_plot(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Acute Myocardial Infarction",] %>% 
              na.omit()%>%
              group_by(NOM_ENT) %>% 
              ungroup() %>% 
              arrange(desc(group), EXCESS_MORTALITY) %>% 
              mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
              ggplot(aes(NOM_ENT, EXCESS_MORTALITY,fill=EXCESS_MORTALITY)) +
              scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 2))+
              geom_col() +
              coord_flip()+ 
              ylab("")+
              xlab("")+
              theme_pubclean()+
              theme(legend.position = "bottom")+
              labs(fill="Age-Adjusted \nMortality Rate"), .01, .01, .4, .45) +
  draw_plot_label(
    c("", ""),
    c(0, 0.45),
    c(1, 0.95),
    size = 12)

Supplementary_Figure_2C<-ggdraw(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Type 2 Diabetes",]%>%
                                  na.omit()%>%
                                  ggplot() +
                                  geom_sf(aes(fill = EXCESS_MORTALITY, geometry = geometry), size = 0.1) +
                                  scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
                                  theme_map() +
                                  theme(legend.position = "none")+
                                  labs(fill="Age-Adjusted \nMortality Rate")+
                                  ggtitle("Type 2 Diabetes")) +
  draw_plot(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Type 2 Diabetes",] %>% 
              na.omit()%>%
              group_by(NOM_ENT) %>% 
              ungroup() %>% 
              arrange(desc(group), EXCESS_MORTALITY) %>% 
              mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
              ggplot(aes(NOM_ENT, EXCESS_MORTALITY,fill=EXCESS_MORTALITY)) +
              scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
              geom_col() +
              coord_flip()+ 
              ylab("")+
              xlab("")+
              theme_pubclean()+
              theme(legend.position = "bottom")+
              labs(fill="Age-Adjusted \nMortality Rate"), .01, .01, .4, .45) +
  draw_plot_label(
    c("", ""),
    c(0, 0.45),
    c(1, 0.95),
    size = 12)

Supplementary_Figure_2D<-ggdraw(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Hypertensive Heart Disease",]%>%
                                  na.omit()%>%
                                  ggplot() +
                                  geom_sf(aes(fill = EXCESS_MORTALITY, geometry = geometry), size = 0.1) +
                                  scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
                                  theme_map() +
                                  theme(legend.position = "none")+
                                  labs(fill="Age-Adjusted \nMortality Rate")+
                                  ggtitle("Hypertensive Heart Disease")) +
  draw_plot(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Hypertensive Heart Disease",] %>% 
              na.omit()%>%
              group_by(NOM_ENT) %>% 
              ungroup() %>% 
              arrange(desc(group), EXCESS_MORTALITY) %>% 
              mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
              ggplot(aes(NOM_ENT, EXCESS_MORTALITY,fill=EXCESS_MORTALITY)) +
              scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
              geom_col() +
              coord_flip()+ 
              ylab("")+
              xlab("")+
              theme_pubclean()+
              theme(legend.position = "bottom")+
              labs(fill="Age-Adjusted \nMortality Rate"), .01, .01, .4, .45) +
  draw_plot_label(
    c("", ""),
    c(0, 0.45),
    c(1, 0.95),
    size = 12)

Supplementary_Figure_2E<-ggdraw(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Essential (Primary) Hypertension",]%>%
                                  na.omit()%>%
                                  ggplot() +
                                  geom_sf(aes(fill = EXCESS_MORTALITY, geometry = geometry), size = 0.1) +
                                  scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
                                  theme_map() +
                                  theme(legend.position = "none")+
                                  labs(fill="Age-Adjusted \nMortality Rate")+
                                  ggtitle("Essential (Primary) Hypertension")) +
  draw_plot(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Essential (Primary) Hypertension",] %>% 
              na.omit()%>%
              group_by(NOM_ENT) %>% 
              ungroup() %>% 
              arrange(desc(group), EXCESS_MORTALITY) %>% 
              mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
              ggplot(aes(NOM_ENT, EXCESS_MORTALITY,fill=EXCESS_MORTALITY)) +
              scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
              geom_col() +
              coord_flip()+ 
              ylab("")+
              xlab("")+
              theme_pubclean()+
              theme(legend.position = "bottom")+
              labs(fill="Age-Adjusted \nMortality Rate"), .01, .01, .4, .45) +
  draw_plot_label(
    c("", ""),
    c(0, 0.45),
    c(1, 0.95),
    size = 12)

Supplementary_Figure_2F<-ggdraw(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Assault",]%>%
                                  na.omit()%>%
                                  ggplot() +
                                  geom_sf(aes(fill = EXCESS_MORTALITY, geometry = geometry), size = 0.1) +
                                  scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
                                  theme_map() +
                                  theme(legend.position = "none")+
                                  labs(fill="Age-Adjusted \nMortality Rate")+
                                  ggtitle("Assault")) +
  draw_plot(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Assault",] %>% 
              na.omit()%>%
              group_by(NOM_ENT) %>% 
              ungroup() %>% 
              arrange(desc(group), EXCESS_MORTALITY) %>% 
              mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
              ggplot(aes(NOM_ENT, EXCESS_MORTALITY,fill=EXCESS_MORTALITY)) +
              scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
              geom_col() +
              coord_flip()+ 
              ylab("")+
              xlab("")+
              theme_pubclean()+
              theme(legend.position = "bottom")+
              labs(fill="Age-Adjusted \nMortality Rate"), .01, .01, .4, .45) +
  draw_plot_label(
    c("", ""),
    c(0, 0.45),
    c(1, 0.95),
    size = 12)

Supplementary_Figure_2G<-ggdraw(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Other Hypertensive Diseases",]%>%
                                  na.omit()%>%
                                  ggplot() +
                                  geom_sf(aes(fill = EXCESS_MORTALITY, geometry = geometry), size = 0.1) +
                                  scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
                                  theme_map() +
                                  theme(legend.position = "none")+
                                  labs(fill="Age-Adjusted \nMortality Rate")+
                                  ggtitle("Other Hypertensive Diseases")) +
  draw_plot(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Other Hypertensive Diseases",] %>% 
              na.omit()%>%
              group_by(NOM_ENT) %>% 
              ungroup() %>% 
              arrange(desc(group), EXCESS_MORTALITY) %>% 
              mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
              ggplot(aes(NOM_ENT, EXCESS_MORTALITY,fill=EXCESS_MORTALITY)) +
              scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
              geom_col() +
              coord_flip()+ 
              ylab("")+
              xlab("")+
              theme_pubclean()+
              theme(legend.position = "bottom")+
              labs(fill="Age-Adjusted \nMortality Rate"), .01, .01, .4, .45) +
  draw_plot_label(
    c("", ""),
    c(0, 0.45),
    c(1, 0.95),
    size = 12)

Supplementary_Figure_2H<-ggdraw(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Unnespecified Stroke \n(Hemorrhagic vs Isquemic)",]%>%
                                  na.omit()%>%
                                  ggplot() +
                                  geom_sf(aes(fill = EXCESS_MORTALITY, geometry = geometry), size = 0.1) +
                                  scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
                                  theme_map() +
                                  theme(legend.position = "none")+
                                  labs(fill="Age-Adjusted \nMortality Rate")+
                                  ggtitle("Unnespecified Stroke \n(Hemorrhagic vs Isquemic)")) +
  draw_plot(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Unnespecified Stroke \n(Hemorrhagic vs Isquemic)",] %>% 
              na.omit()%>%
              group_by(NOM_ENT) %>% 
              ungroup() %>% 
              arrange(desc(group), EXCESS_MORTALITY) %>% 
              mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
              ggplot(aes(NOM_ENT, EXCESS_MORTALITY,fill=EXCESS_MORTALITY)) +
              scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 1))+
              geom_col() +
              coord_flip()+ 
              ylab("")+
              xlab("")+
              theme_pubclean()+
              theme(legend.position = "bottom")+
              labs(fill="Age-Adjusted \nMortality Rate"), .01, .01, .4, .45) +
  draw_plot_label(
    c("", ""),
    c(0, 0.45),
    c(1, 0.95),
    size = 12)

Supplementary_Figure_2I<-ggdraw(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Other Ischemic Heart Diseases",]%>%
                                  na.omit()%>%
                                  ggplot() +
                                  geom_sf(aes(fill = EXCESS_MORTALITY, geometry = geometry), size = 0.1) +
                                  scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 0.1))+
                                  theme_map() +
                                  theme(legend.position = "none")+
                                  labs(fill="Age-Adjusted \nMortality Rate")+
                                  ggtitle("Other Ischemic Heart Diseases")) +
  draw_plot(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Other Ischemic Heart Diseases",] %>% 
              na.omit()%>%
              group_by(NOM_ENT) %>% 
              ungroup() %>% 
              arrange(desc(group), EXCESS_MORTALITY) %>% 
              mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
              ggplot(aes(NOM_ENT, EXCESS_MORTALITY,fill=EXCESS_MORTALITY)) +
              scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 0.1))+
              geom_col() +
              coord_flip()+ 
              ylab("")+
              xlab("")+
              theme_pubclean()+
              theme(legend.position = "bottom")+
              labs(fill="Age-Adjusted \nMortality Rate"), .01, .01, .4, .45) +
  draw_plot_label(
    c("", ""),
    c(0, 0.45),
    c(1, 0.95),
    size = 12)

Supplementary_Figure_2J<-ggdraw(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Obesity",]%>%
                                  na.omit()%>%
                                  ggplot() +
                                  geom_sf(aes(fill = EXCESS_MORTALITY, geometry = geometry), size = 0.1) +
                                  scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 0.1))+
                                  theme_map() +
                                  theme(legend.position = "none")+
                                  labs(fill="Age-Adjusted \nMortality Rate")+
                                  ggtitle("Obesity")) +
  draw_plot(MORT_AJUSTADA_ESPECIFICA_ESTATAL[MORT_AJUSTADA_ESPECIFICA_ESTATAL$group=="Obesity",] %>% 
              na.omit()%>%
              group_by(NOM_ENT) %>% 
              ungroup() %>% 
              arrange(desc(group), EXCESS_MORTALITY) %>% 
              mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
              ggplot(aes(NOM_ENT, EXCESS_MORTALITY,fill=EXCESS_MORTALITY)) +
              scale_fill_viridis_c(trans = scales::pseudo_log_trans(sigma = 0.1))+
              geom_col() +
              coord_flip()+ 
              ylab("")+
              xlab("")+
              theme_pubclean()+
              theme(legend.position = "bottom")+
              labs(fill="Age-Adjusted \nMortality Rate"), .01, .01, .4, .45) +
  draw_plot_label(
    c("", ""),
    c(0, 0.45),
    c(1, 0.95),
    size = 12)

Supplementary_Figure_1<-ggarrange(Supplementary_Figure_2A,
                                  Supplementary_Figure_2B,
                                  Supplementary_Figure_2C,
                                  Supplementary_Figure_2D,
                                  Supplementary_Figure_2E,
                                  Supplementary_Figure_2F,
                                  Supplementary_Figure_2G,
                                  Supplementary_Figure_2H,
                                  Supplementary_Figure_2I,
                                  Supplementary_Figure_2J,ncol = 5,nrow = 2,labels = LETTERS[1:10])


ggsave(Supplementary_Figure_1,
       filename = "Supplementary_Figure2.png", bg = "white",
       width = 150, 
       height = 55,
       units=c("cm"),
       dpi = 350,
       limitsize = FALSE) 

######Biplot Map of Excess Mortality by Municipality of Residence (Supplementary Figure 3)#####


EXCESS_MORTALITY_MUNICIPIO$COVID_EXCESS_MORTALITY_NORMALIZED<-bestNormalize::orderNorm(EXCESS_MORTALITY_MUNICIPIO$PERCENT_EXCESS_MORTALITY_COVID)$x.t
EXCESS_MORTALITY_MUNICIPIO$NON_COVID_EXCESS_MORTALITY_NORMALIZED<-bestNormalize::orderNorm(EXCESS_MORTALITY_MUNICIPIO$PERCENT_EXCESS_MORTALITY_NOCOVID)$x.t

EXCESS_MORTALITY_COVID_MUNICIPALITIES<-bi_class(EXCESS_MORTALITY_MUNICIPIO, 
                                                x = COVID_EXCESS_MORTALITY_NORMALIZED, 
                                                y = NON_COVID_EXCESS_MORTALITY_NORMALIZED, 
                                                style = "quantile", dim = 2)
Supplementary_Figure_1<-ggdraw() +
  draw_plot(ggplot(EXCESS_MORTALITY_COVID_MUNICIPALITIES) +
              geom_sf(mapping = aes(fill = bi_class, geometry=geometry), size = 0, show.legend = FALSE) +
              bi_scale_fill(pal = "DkCyan", dim = 2)+ 
              theme(legend.title = element_text(hjust = 0.1),
                    legend.position = "bottom",
                    plot.title = element_text(hjust = 0.1))+
              guides(fill="none",
                     shape=guide_legend(nrow=1,byrow=T),
                     colour="none") +
              theme_map()+
              ggtitle("Age-Adjusted Excess Mortality"), 0, 0, 1, 1) +
  draw_plot(bi_legend(pal = "DkCyan",
                      dim = 2,
                      xlab = "Higher % of COVID-19",
                      ylab = "Higher % of Non-COVID-19",
                      size = 5), 0.75, .5, 0.25, 0.25)

ggsave(Supplementary_Figure_3,
       filename = "Supplementary_Figure_3.png", bg = "white",
       width = 30, 
       height = 15,
       units=c("cm"),
       dpi = 350,
       limitsize = FALSE) 



######Excess mortality by place and state of occurrence (Supplementary Figure 4)#####

#By State

#2016
ADJUSTED_MORTALITY_2016_ENTIDAD_CONTEXTO<-mort_2016%>% 
  group_by(id.ent,CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                           right = FALSE, include.lowest = TRUE, 
                                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                      "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()))%>%
  na.omit()%>%
  left_join(Pob_edad_2016_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2016_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y)%>% 
  group_by(id.ent,CONTEXTO) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T))%>%
  group_by(id.ent,CONTEXTO)%>% 
  mutate(AGE_ADJUSTED_2016 = (DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.ent,CONTEXTO,AGE_ADJUSTED_2016)%>%
  mutate(EV_YEAR=c("2016"))

#2017
ADJUSTED_MORTALITY_2017_ENTIDAD_CONTEXTO<-mort_2017%>% 
  group_by(id.ent,CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                           right = FALSE, include.lowest = TRUE, 
                                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                      "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()))%>%
  na.omit()%>%
  left_join(Pob_edad_2017_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2017_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y)%>% 
  group_by(id.ent,CONTEXTO) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T))%>%
  group_by(id.ent,CONTEXTO)%>% 
  mutate(AGE_ADJUSTED_2017 = (DEF_ESPER/124041731)*100000)%>%
  dplyr::select(id.ent,CONTEXTO,AGE_ADJUSTED_2017)%>%
  mutate(EV_YEAR=c("2017"))


#2018
ADJUSTED_MORTALITY_2018_ENTIDAD_CONTEXTO<-mort_2018%>% 
  group_by(id.ent,CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                           right = FALSE, include.lowest = TRUE, 
                                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                      "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()))%>%
  na.omit()%>%
  left_join(Pob_edad_2018_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2018_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y)%>% 
  group_by(id.ent,CONTEXTO) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T))%>%
  group_by(id.ent,CONTEXTO)%>% 
  mutate(AGE_ADJUSTED_2018 = (DEF_ESPER/125327797)*100000)%>%
  dplyr::select(id.ent,CONTEXTO,AGE_ADJUSTED_2018)%>%
  mutate(EV_YEAR=c("2018"))


#2019
ADJUSTED_MORTALITY_2019_ENTIDAD_CONTEXTO<-mort_2019%>% 
  group_by(id.ent,CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                           right = FALSE, include.lowest = TRUE, 
                                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                      "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()))%>%
  na.omit()%>%
  left_join(Pob_edad_2019_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2019_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y)%>% 
  group_by(id.ent,CONTEXTO) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T))%>%
  group_by(id.ent,CONTEXTO)%>% 
  mutate(AGE_ADJUSTED_2019 = (DEF_ESPER/126577691)*100000)%>%
  dplyr::select(id.ent,CONTEXTO,AGE_ADJUSTED_2019)%>%
  mutate(EV_YEAR=c("2019"))

#2020
ADJUSTED_MORTALITY_2020_ENTIDAD_CONTEXTO<-mort_2020%>% 
  group_by(id.ent,CONTEXTO,EDAD_QUIN = cut(as.numeric(EDAD), 
                                           breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                           right = FALSE, include.lowest = TRUE, 
                                           labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                                      "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                                      "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                                      "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            COVID=sum(CAUSA_MUERTE_ICD_10_CATEGORIA_1=="U071" | CAUSA_MUERTE_ICD_10_CATEGORIA_1=="U072"),
            NO_COVID=sum(CAUSA_MUERTE_ICD_10_CATEGORIA_1!="U071" & CAUSA_MUERTE_ICD_10_CATEGORIA_1!="U072"))%>%
  na.omit()%>%
  left_join(Pob_edad_2020_entidad_parcial, by =c("id.ent","EDAD_QUIN"))%>%
  left_join(Pob_edad_2020_entidad_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         DEF_ESPER_COVID = (COVID/POB.x)*POB.y,
         DEF_ESPER_NO_COVID = (NO_COVID/POB.x)*POB.y)%>% 
  group_by(id.ent,CONTEXTO) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            DEF_ESPER_COVID=sum(DEF_ESPER_COVID,na.rm = T),
            DEF_ESPER_NO_COVID=sum(DEF_ESPER_NO_COVID,na.rm = T))%>%
  group_by(id.ent,CONTEXTO)%>% 
  mutate(AGE_ADJUSTED_OVERALL_2020= (DEF_ESPER/127792286)*100000,
         AGE_ADJUSTED_COVID_2020= (DEF_ESPER_COVID/127792286)*100000,
         AGE_ADJUSTED_NOCOVID_2020= (DEF_ESPER_NO_COVID/127792286)*100000)%>%
  dplyr::select(id.ent,CONTEXTO,AGE_ADJUSTED_OVERALL_2020,AGE_ADJUSTED_COVID_2020,AGE_ADJUSTED_NOCOVID_2020)%>%
  mutate(EV_YEAR=c("2020"))

#Tidy Merge
ADJUSTED_MORTALITY_2016_ENTIDAD_CONTEXTO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2016_ENTIDAD_CONTEXTO, group, value, -c(EV_YEAR,id.ent,CONTEXTO))
ADJUSTED_MORTALITY_2017_ENTIDAD_CONTEXTO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2017_ENTIDAD_CONTEXTO, group, value, -c(EV_YEAR,id.ent,CONTEXTO))
ADJUSTED_MORTALITY_2018_ENTIDAD_CONTEXTO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2018_ENTIDAD_CONTEXTO, group, value, -c(EV_YEAR,id.ent,CONTEXTO))
ADJUSTED_MORTALITY_2019_ENTIDAD_CONTEXTO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2019_ENTIDAD_CONTEXTO, group, value, -c(EV_YEAR,id.ent,CONTEXTO))

MORT_AJUSTADA_ESPECIFICA_ESTADO_CONTEXTO_HISTORICA<-ADJUSTED_MORTALITY_2019_ENTIDAD_CONTEXTO_tidy%>%
  left_join(ADJUSTED_MORTALITY_2018_ENTIDAD_CONTEXTO_tidy,by=c("CONTEXTO","id.ent"))%>%
  left_join(ADJUSTED_MORTALITY_2017_ENTIDAD_CONTEXTO_tidy,by=c("CONTEXTO","id.ent"))%>%
  left_join(ADJUSTED_MORTALITY_2016_ENTIDAD_CONTEXTO_tidy,by=c("CONTEXTO","id.ent"))%>%
  group_by(CONTEXTO,id.ent)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(value.x,value.y,value.x.x,value.y.y)))%>%
  dplyr::select(id.ent,AVERAGE_MORTALITY)

EXCESS_MORTALITY_ENTIDAD_CONTEXTO<-ADJUSTED_MORTALITY_2020_ENTIDAD_CONTEXTO%>%
  left_join(MORT_AJUSTADA_ESPECIFICA_ESTADO_CONTEXTO_HISTORICA,by=c("CONTEXTO","id.ent"))%>%
  mutate(EXCESS_MORTALITY=(AGE_ADJUSTED_OVERALL_2020-AVERAGE_MORTALITY),
         EXCESS_NON_COVID_MORTALITY=(AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY),
         PERCENT_EXCESS_MORTALITY_COVID=(AGE_ADJUSTED_COVID_2020*100/EXCESS_MORTALITY),
         PERCENT_EXCESS_MORTALITY_NOCOVID=((AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY)*100/EXCESS_MORTALITY))%>%
  left_join(geom_df.ent,by="id.ent")

EXCESS_MORTALITY_ENTIDAD_CONTEXTO$CONTEXTO<-factor(EXCESS_MORTALITY_ENTIDAD_CONTEXTO$CONTEXTO,labels = c("In-Hospital","Ambulatory","Unnespecified"))

EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%dplyr::filter(CONTEXTO=="In-Hospital")

#Rates by Excess
#In-Hospital
EXCESS_MORTALITY_ENTIDAD_CONTEXTO_2.1<-rbind(data.frame(NOM_ENT=(EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%dplyr::filter(CONTEXTO=="In-Hospital"))$NOM_ENT,
                                                        rate=(EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%dplyr::filter(CONTEXTO=="In-Hospital"))$AGE_ADJUSTED_COVID_2020,
                                                        label=c("COVID-19"),
                                                        context=c("In-Hospital")))

EXCESS_MORTALITY_ENTIDAD_CONTEXTO_2.2<-rbind(data.frame(NOM_ENT=(EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%dplyr::filter(CONTEXTO=="In-Hospital"))$NOM_ENT,
                                                        rate=(EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%dplyr::filter(CONTEXTO=="In-Hospital"))$AGE_ADJUSTED_NOCOVID_2020,
                                                        label=c("Non-COVID-19"),
                                                        context=c("In-Hospital")))


Sup_Figure2C.1<-EXCESS_MORTALITY_ENTIDAD_CONTEXTO_2.1 %>% 
  na.omit%>%
  group_by(NOM_ENT) %>% 
  ungroup() %>% 
  arrange(desc(label), rate) %>% 
  mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
  ggplot(aes(NOM_ENT, rate, fill = label))+
  geom_col(position = "dodge") +
  coord_flip()+ 
  ylab("Age-Adjusted Mortality Rate \n per 100,000 inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#7c8cc4"))+
  ggtitle("In-Hospital")

Sup_Figure2C.2<-EXCESS_MORTALITY_ENTIDAD_CONTEXTO_2.2 %>% 
  na.omit%>%
  group_by(NOM_ENT) %>% 
  ungroup() %>% 
  arrange(desc(label), rate) %>% 
  mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
  ggplot(aes(NOM_ENT, rate, fill = label))+
  geom_col(position = "dodge") +
  coord_flip()+ 
  ylab("Age-Adjusted Mortality Rate \n per 100,000 inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#84b48c"))

Sup_Figure2C.A<-ggarrange(Sup_Figure2C.1,Sup_Figure2C.2,ncol = 2,nrow = 1,labels = c("A",""))

#Ambulatory
EXCESS_MORTALITY_ENTIDAD_CONTEXTO_2.3<-rbind(data.frame(NOM_ENT=(EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%dplyr::filter(CONTEXTO=="Ambulatory"))$NOM_ENT,
                                                        rate=(EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%dplyr::filter(CONTEXTO=="Ambulatory"))$AGE_ADJUSTED_COVID_2020,
                                                        label=c("COVID-19"),
                                                        context=c("Ambulatory")))

EXCESS_MORTALITY_ENTIDAD_CONTEXTO_2.4<-rbind(data.frame(NOM_ENT=(EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%dplyr::filter(CONTEXTO=="Ambulatory"))$NOM_ENT,
                                                        rate=(EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%dplyr::filter(CONTEXTO=="Ambulatory"))$AGE_ADJUSTED_NOCOVID_2020,
                                                        label=c("Non-COVID-19"),
                                                        context=c("Ambulatory")))


Sup_Figure2C.3<-EXCESS_MORTALITY_ENTIDAD_CONTEXTO_2.3 %>% 
  na.omit%>%
  group_by(NOM_ENT) %>% 
  ungroup() %>% 
  arrange(desc(label), rate) %>% 
  mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
  ggplot(aes(NOM_ENT, rate, fill = label))+
  geom_col(position = "dodge") +
  coord_flip()+ 
  ylab("Age-Adjusted Mortality Rate \n per 100,000 inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#7c8cc4"))+
  ggtitle("Out-of-Hospital")

Sup_Figure2C.4<-EXCESS_MORTALITY_ENTIDAD_CONTEXTO_2.2 %>% 
  na.omit%>%
  group_by(NOM_ENT) %>% 
  ungroup() %>% 
  arrange(desc(label), rate) %>% 
  mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
  ggplot(aes(NOM_ENT, rate, fill = label))+
  geom_col(position = "dodge") +
  coord_flip()+ 
  ylab("Age-Adjusted Mortality Rate \n per 100,000 inhabitants")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#84b48c"))

Sup_Figure2C.B<-ggarrange(Sup_Figure2C.3,Sup_Figure2C.4,ncol = 2,nrow = 1,labels = c("",""))
Sup_Figure2C<-ggarrange(Sup_Figure2C.A,Sup_Figure2C.B,ncol = 1,nrow = 2)

#Barplots
#In-Hospital
EXCESS_MORTALITY_ENTIDAD_1<-EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%filter(CONTEXTO=="In-Hospital")%>%
  dplyr::select(NOM_ENT,PERCENT_EXCESS_MORTALITY_COVID)%>%
  rename("PERCENT"="PERCENT_EXCESS_MORTALITY_COVID")%>%
  mutate(label=c("COVID"))%>% 
  arrange(desc(PERCENT))

EXCESS_MORTALITY_ENTIDAD_2<-EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%filter(CONTEXTO=="In-Hospital")%>%
  dplyr::select(NOM_ENT,PERCENT_EXCESS_MORTALITY_NOCOVID)%>%
  rename("PERCENT"="PERCENT_EXCESS_MORTALITY_NOCOVID")%>%
  mutate(label=c("Non-COVID"))%>% 
  arrange(desc(PERCENT))

EXCESS_MORTALITY_ENTIDAD_PERCENT<-rbind(EXCESS_MORTALITY_ENTIDAD_1,EXCESS_MORTALITY_ENTIDAD_2)

Sup_Figure2D.1<-EXCESS_MORTALITY_ENTIDAD_PERCENT %>% 
  na.omit%>%
  group_by(NOM_ENT) %>% 
  ungroup() %>% 
  arrange(desc(label), PERCENT) %>% 
  mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
  ggplot(aes(NOM_ENT, PERCENT, fill = label)) +
  geom_col() +
  coord_flip()+ 
  ylab("Age-Adjusted Excess Mortality")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#7c8cc4","#84b48c"))+
  ggtitle("In-Hospital Deaths")

#Ambulatory

EXCESS_MORTALITY_ENTIDAD_1<-EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%filter(CONTEXTO=="Ambulatory")%>%
  dplyr::select(NOM_ENT,PERCENT_EXCESS_MORTALITY_COVID)%>%
  rename("PERCENT"="PERCENT_EXCESS_MORTALITY_COVID")%>%
  mutate(label=c("COVID"))%>% 
  arrange(desc(PERCENT))

EXCESS_MORTALITY_ENTIDAD_2<-EXCESS_MORTALITY_ENTIDAD_CONTEXTO%>%filter(CONTEXTO=="Ambulatory")%>%
  dplyr::select(NOM_ENT,PERCENT_EXCESS_MORTALITY_NOCOVID)%>%
  rename("PERCENT"="PERCENT_EXCESS_MORTALITY_NOCOVID")%>%
  mutate(label=c("Non-COVID"))%>% 
  arrange(desc(PERCENT))

EXCESS_MORTALITY_ENTIDAD_PERCENT<-rbind(EXCESS_MORTALITY_ENTIDAD_1,EXCESS_MORTALITY_ENTIDAD_2)

Sup_Figure2D.2<-EXCESS_MORTALITY_ENTIDAD_PERCENT %>% 
  na.omit%>%
  group_by(NOM_ENT) %>% 
  ungroup() %>% 
  arrange(desc(label), PERCENT) %>% 
  mutate(NOM_ENT = factor(NOM_ENT, levels = unique(NOM_ENT))) %>% 
  ggplot(aes(NOM_ENT, PERCENT, fill = label)) +
  geom_col() +
  coord_flip()+ 
  ylab("Age-Adjusted Excess Mortality")+
  xlab("")+
  theme_hc()+
  labs(fill="Cause of Death")+
  scale_fill_manual(values = c("#7c8cc4","#84b48c"))+
  ggtitle("Out-of-Hospital Deaths")


Sup_Figure2D<-ggarrange(Sup_Figure2D.1,Sup_Figure2D.2,ncol = 2,nrow = 1,labels = c("B",""))
Sup_Figure4<-ggarrange(Sup_Figure2C,Sup_Figure2D,ncol=2,nrow=1,labels=c("","","",""))

ggsave(Sup_Figure4,
       filename = "Supplementary_Figure_4.png", bg = "white",
       width = 60, 
       height = 30,
       units=c("cm"),
       dpi = 350,
       limitsize = FALSE) 



######Biplot Maps of Covid and Non Covid Mortality (Supplementary Figure 5)#####


EXCESS_MORTALITY_MUNICIPIO_COVID<-bi_class(EXCESS_MORTALITY_MUNICIPIO, 
                                              x = PERCENT_EXCESS_MORTALITY_COVID, 
                                              y = DISLI, 
                                              style = "quantile", dim = 2)

EXCESS_MORTALITY_MUNICIPIO_NO_COVID<-bi_class(EXCESS_MORTALITY_MUNICIPIO, 
                                           x = PERCENT_EXCESS_MORTALITY_NOCOVID, 
                                           y = DISLI, 
                                           style = "quantile", dim = 2)

Supplementary_Figure_3.1<-ggdraw() +
  draw_plot(ggplot(EXCESS_MORTALITY_MUNICIPIO_COVID) +
              geom_sf(mapping = aes(fill = bi_class, geometry=geometry), size = 0, show.legend = FALSE) +
              bi_scale_fill(pal = "DkCyan", dim = 2)+ 
              theme(legend.title = element_text(hjust = 0.1),
                    legend.position = "bottom",
                    plot.title = element_text(hjust = 0.1))+
              guides(fill="none",
                     shape=guide_legend(nrow=1,byrow=T),
                     colour="none") +
              theme_map()+
              ggtitle("Excess COVID-19 Age-Adjusted Mortality"), 0, 0, 1, 1) +
  draw_plot(bi_legend(pal = "DkCyan",
                      dim = 2,
                      xlab = "Excess COVID-19 
Age-Adjusted Mortality",
                      ylab = "Adjusted Social Lag Index",
                      size = 5), 0.75, .5, 0.25, 0.25)

Supplementary_Figure_3.2<-ggdraw() +
  draw_plot(ggplot(EXCESS_MORTALITY_MUNICIPIO_NO_COVID) +
              geom_sf(mapping = aes(fill = bi_class, geometry=geometry), size = 0, show.legend = FALSE) +
              bi_scale_fill(pal = "DkCyan", dim = 2)+ 
              theme(legend.title = element_text(hjust = 0.1),
                    legend.position = "bottom",
                    plot.title = element_text(hjust = 0.1))+
              guides(fill="none",
                     shape=guide_legend(nrow=1,byrow=T),
                     colour="none") +
              theme_map()+
              ggtitle("Excess Non-COVID-19 Age-Adjusted Mortality"), 0, 0, 1, 1) +
  draw_plot(bi_legend(pal = "DkCyan",
                      dim = 2,
                      xlab = "Excess Non-COVID-19 
Age-Adjusted Mortality",
                      ylab = "Adjusted Social Lag Index",
                      size = 5), 0.75, .5, 0.25, 0.25)

Supplementary_Figure_5<-ggarrange(Supplementary_Figure_3.1,Supplementary_Figure_3.2,ncol = 2,nrow = 1,labels  = LETTERS[1:2])

ggsave(Supplementary_Figure_5,
       filename = "Supplementary_Figure_5.png", bg = "white",
       width = 35, 
       height = 15,
       units=c("cm"),
       dpi = 350,
       limitsize = FALSE) 


######Interacction and Mediation (Supplementary Figure 4)#####


#Modelo de Interacción

mod2.1<-MASS::glm.nb(EXCESS_MORTALITY_2~scale(dmu)+scale(RATIO_SEX)+scale(RATIO_ASISTENCIA)+scale(RATIO_URB_RURAL)+scale(RATIO_AMBULATORIO_HOST)+scale(ed_basica_inc)+
                       scale(no_salud)+scale(HOSPITALIZACION_COVID)*factor(QUINTILES.DISLI.MUN)+scale(no_salud)+factor(QUINTILES.DISLI.MUN),data=GLM_EXCESS_MORTALITY_MUNICIPIO)
summary(mod2.1)
jtools::summ(mod2.1, exp=T)
car::vif(mod2.1)
jtools::plot_summs(mod2.1,exp=T)

Supplementary_Figure_4A<-jtools::plot_summs(mod2.1,
                                            legend.title = "Group",coefs = c("Higher COVID-19 Hospital Occupation \nand Moderate Social Log Index"="scale(HOSPITALIZACION_COVID):factor(QUINTILES.DISLI.MUN)2",
                                                                             "Higher COVID-19 Hospital Occupation \nand High Social Log Index"="scale(HOSPITALIZACION_COVID):factor(QUINTILES.DISLI.MUN)3",
                                                                             "Higher COVID-19 Hospital Occupation \nand Very High Social Log Index"="scale(HOSPITALIZACION_COVID):factor(QUINTILES.DISLI.MUN)4"),
                                            colors = "Qual1", exp=T)+
  xlab("Interaction Effects Negative Binomial Regression\n Incidence Rate Ratio, 95%CI")+
  scale_x_log10()+
  theme_hc()+
  ylab("")+
  ggtitle("Associated Municipal Factors for \nExcess Mortality")


mod2.2<-MASS::glm.nb(EXCESS_MORTALITY_2~scale(dmu)+scale(RATIO_SEX)+scale(RATIO_ASISTENCIA)+scale(RATIO_URB_RURAL)+scale(RATIO_AMBULATORIO_HOST)+scale(ed_basica_inc)+
                       scale(no_salud)+scale(HOSPITALIZACION_COVID)+factor(QUINTILES.DISLI.MUN)+scale(no_salud)*factor(QUINTILES.DISLI.MUN),data=GLM_EXCESS_MORTALITY_MUNICIPIO)
summary(mod2.2)
jtools::summ(mod2.2, exp=T)
car::vif(mod2.2)

Supplementary_Figure_4B<-jtools::plot_summs(mod2.2,
                                            legend.title = "Group",coefs = c("Higher Percent of Inhabitants Withouth Social Security \nand Moderate Social Log Index"="scale(no_salud):factor(QUINTILES.DISLI.MUN)2",
                                                                             "Higher Percent of Inhabitants Withouth Social Security \nand High Social Log Index"="scale(no_salud):factor(QUINTILES.DISLI.MUN)3",
                                                                             "Higher Percent of Inhabitants Withouth Social Security \nand Very High Social Log Index"="scale(no_salud):factor(QUINTILES.DISLI.MUN)4"),
                                            colors = "Qual1", exp=T)+
  xlab("Interaction Effects Negative Binomial Regression\n Incidence Rate Ratio, 95%CI")+
  scale_x_log10()+
  theme_hc()+
  ylab("")+
  ggtitle("Associated Municipal Factors for \nExcess Mortality")

Supplementary_Figure_4<-ggarrange(Supplementary_Figure_4A,Supplementary_Figure_4B,ncol = 2,nrow = 1,labels = LETTERS[1:2])

ggsave(Supplementary_Figure_4,
       filename = "Supplementary_Figure_4.png", bg = "white",
       width = 50, 
       height = 17,
       units=c("cm"),
       dpi = 350,
       limitsize = FALSE) 


######Spartial Correlation with DISLI (Supplementary Figure 5)#####

#2016
ADJUSTED_MORTALITY_2016_MUNICIPIO<-mort_2016%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2016_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2016_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2016 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2016 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2016,AVOID_AGE_ADJUSTED_2016)%>%
  mutate(EV_YEAR=c("2016"))

#2017
ADJUSTED_MORTALITY_2017_MUNICIPIO<-mort_2017%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2017_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2017_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2017 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2017 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2017,AVOID_AGE_ADJUSTED_2017)%>%
  mutate(EV_YEAR=c("2017"))

#2018
ADJUSTED_MORTALITY_2018_MUNICIPIO<-mort_2018%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2018_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2018_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2018 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2018 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2018,AVOID_AGE_ADJUSTED_2018)%>%
  mutate(EV_YEAR=c("2018"))


#2019
ADJUSTED_MORTALITY_2019_MUNICIPIO<-mort_2019%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            AVOID=sum(AVOIDABLE=1))%>%
  na.omit()%>%
  left_join(Pob_edad_2019_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2019_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         AVOID_DEF_ESPER = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            AVOID_DEF_ESPER=sum(AVOID_DEF_ESPER,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_2019 = (DEF_ESPER/122715165)*100000,
         AVOID_AGE_ADJUSTED_2019 = (AVOID_DEF_ESPER/122715165)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_2019,AVOID_AGE_ADJUSTED_2019)%>%
  mutate(EV_YEAR=c("2019"))

#2020

ADJUSTED_MORTALITY_2020_MUNICIPIO<-mort_2020%>% 
  group_by(id.mun,EDAD_QUIN = cut(as.numeric(EDAD), 
                                  breaks = c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,Inf), 
                                  right = FALSE, include.lowest = TRUE, 
                                  labels = c("pobm_00_04", "pobm_05_09", "pobm_10_14","pobm_15_19", 
                                             "pobm_20_24", "pobm_25_29", "pobm_30_34", "pobm_35_39", 
                                             "pobm_40_44", "pobm_45_49","pobm_50_54", "pobm_55_59", 
                                             "pobm_60_64", "pobm_65_mm"))) %>%
  summarise(DEATHS=sum(n()),
            NO_COVID=sum(COVID==0),
            COVID=sum(COVID==1),
            AVOID=sum(AVOIDABLE==1))%>%
  na.omit()%>%
  left_join(Pob_edad_2020_municipio_parcial, by =c("id.mun","EDAD_QUIN"))%>%
  left_join(Pob_edad_2020_municipio_total,by=c("EDAD_QUIN"))%>% 
  mutate(DEF_ESPER = (DEATHS/POB.x)*POB.y,
         DEF_ESPER_COVID = (COVID/POB.x)*POB.y,
         DEF_ESPER_NO_COVID = (NO_COVID/POB.x)*POB.y,
         DEF_ESPER_AVOID = (AVOID/POB.x)*POB.y)%>% 
  group_by(id.mun) %>% 
  summarise(DEF_ESPER=sum(DEF_ESPER,na.rm = T),
            DEF_ESPER_COVID=sum(DEF_ESPER_COVID,na.rm = T),
            DEF_ESPER_NO_COVID=sum(DEF_ESPER_NO_COVID,na.rm = T),
            DEF_ESPER_AVOID=sum(DEF_ESPER_AVOID,na.rm = T))%>%
  group_by(id.mun)%>% 
  mutate(AGE_ADJUSTED_OVERALL_2020= (DEF_ESPER/127792286)*100000,
         AGE_ADJUSTED_COVID_2020= (DEF_ESPER_COVID/127792286)*100000,
         AGE_ADJUSTED_NOCOVID_2020= (DEF_ESPER_NO_COVID/127792286)*100000,
         AGE_ADJUSTED_AVOID_2020= (DEF_ESPER_AVOID/127792286)*100000)%>%
  dplyr::select(id.mun,AGE_ADJUSTED_OVERALL_2020,AGE_ADJUSTED_COVID_2020,AGE_ADJUSTED_NOCOVID_2020)

ADJUSTED_MORTALITY_2016_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2016_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))
ADJUSTED_MORTALITY_2017_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2017_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))
ADJUSTED_MORTALITY_2018_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2018_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))
ADJUSTED_MORTALITY_2019_MUNICIPIO_tidy<-tidyr::gather(ADJUSTED_MORTALITY_2019_MUNICIPIO, group, value, -c(EV_YEAR,id.mun))

#Dataset To estimate Age Adjusted Mortality
MORT_AJUSTADA_ESPECIFICA_MUNICIPIO<-ADJUSTED_MORTALITY_2019_MUNICIPIO%>%
  left_join(ADJUSTED_MORTALITY_2018_MUNICIPIO,by="id.mun")%>%
  left_join(ADJUSTED_MORTALITY_2017_MUNICIPIO,by="id.mun")%>% 
  left_join(ADJUSTED_MORTALITY_2016_MUNICIPIO,by="id.mun")%>% 
  group_by(id.mun)%>%
  rowwise() %>%
  mutate(AVERAGE_MORTALITY = mean(c(AGE_ADJUSTED_2019,AGE_ADJUSTED_2018,AGE_ADJUSTED_2017,AGE_ADJUSTED_2016)),
         AVOID_AVERAGE_MORTALITY = mean(c(AVOID_AGE_ADJUSTED_2019,AVOID_AGE_ADJUSTED_2018,AVOID_AGE_ADJUSTED_2017,AVOID_AGE_ADJUSTED_2016)))%>%
  dplyr::select(id.mun,AVERAGE_MORTALITY)

#Dataset Excess Mortality

EXCESS_MORTALITY_MUNICIPIO<-ADJUSTED_MORTALITY_2020_MUNICIPIO%>%
  left_join(MORT_AJUSTADA_ESPECIFICA_MUNICIPIO,by=c("id.mun"))%>%
  mutate(OVERALL_EXCESS_MORTALITY=(AGE_ADJUSTED_OVERALL_2020-AVERAGE_MORTALITY),
         NO_COVID_EXCESS_MORTALITY=(AGE_ADJUSTED_NOCOVID_2020-AVERAGE_MORTALITY))%>%
  left_join(geom_df.mun%>%dplyr::select(id.mun,dmu_camas,dmu,DISLI,QUINTILES.DISLI.MUN,pop), by="id.mun")%>%
  dplyr::select(id.mun,AGE_ADJUSTED_OVERALL_2020,AVERAGE_MORTALITY,AGE_ADJUSTED_NOCOVID_2020,
                OVERALL_EXCESS_MORTALITY,AGE_ADJUSTED_COVID_2020,NO_COVID_EXCESS_MORTALITY,pop,DISLI)

#Spartial Dataset

EXCESS_MORTALITY_MUNICIPIO_MORGAN<-EXCESS_MORTALITY_MUNICIPIO%>%
  dplyr::select(id.mun,OVERALL_EXCESS_MORTALITY,NO_COVID_EXCESS_MORTALITY,AGE_ADJUSTED_NOCOVID_2020)%>%
  left_join(dmu.cuadrantes.mun%>%dplyr::select(id.mun,DISLI), by="id.mun")%>%
  left_join(geom_df_mun%>%dplyr::select(id.mun,geometry),by="id.mun")%>%
  na.omit()

#Spartial Correlation 
library(spdep)
library(ggplotify)

#Polygon Managmen
st_crs(EXCESS_MORTALITY_MUNICIPIO_MORGAN$geometry) <- "+proj=utm +zone=30 +ellps=airy +units=km"
geo_data <- poly2nb(EXCESS_MORTALITY_MUNICIPIO_MORGAN$geometry)

#Overall Excess
spdep::lee.test(EXCESS_MORTALITY_MUNICIPIO_MORGAN$OVERALL_EXCESS_MORTALITY, 
                EXCESS_MORTALITY_MUNICIPIO_MORGAN$DISLI, 
                nb2listw(geo_data,zero.policy = T),
                zero.policy = TRUE, alternative = "two.sided", na.action = na.omit)

#2020 
#Overall
Lxy <-lee(EXCESS_MORTALITY_MUNICIPIO_MORGAN$AGE_ADJUSTED_NOCOVID_2020, EXCESS_MORTALITY_MUNICIPIO_MORGAN$DISLI, 
          nb2listw(geo_data,zero.policy = T), length(EXCESS_MORTALITY_MUNICIPIO_MORGAN$AGE_ADJUSTED_NOCOVID_2020), zero.policy=TRUE, NAOK = TRUE)

LMCxy <- lee.mc(EXCESS_MORTALITY_MUNICIPIO_MORGAN$AGE_ADJUSTED_NOCOVID_2020, EXCESS_MORTALITY_MUNICIPIO_MORGAN$DISLI, 
                nsim=10000, nb2listw(geo_data,zero.policy = T), zero.policy=TRUE)

simula_lee <- function(x, y, listw, nsim = nsim, zero.policy = NULL, na.action = na.fail) {
  
  if (deparse(substitute(na.action)) == "na.pass") 
    stop ("na.pass not permitted")
  na.act <- attr(na.action(cbind(x, y)), "na.action")
  x[na.act] <- NA
  y[na.act] <- NA
  x <- na.action(x)
  y <- na.action(y)
  if (!is.null(na.act)) {
    subset <- !(1:length(listw$neighbours) %in% na.act)
    listw <- subset(listw, subset, zero.policy = zero.policy)
  }
  n <- length(listw$neighbours)
  if ((n != length(x)) | (n != length(y))) 
    stop ("objects of different length")
  gamres <- suppressWarnings(nsim > gamma(n + 1))
  if (gamres) 
    stop ("nsim too large for this number of observations")
  if (nsim < 1) 
    stop ("nsim too small")
  xy <- data.frame(x, y)
  S2 <- sum((unlist(lapply(listw$weights, sum)))^2)
  
  lee_boot <- function(var, i, ...) {
    return(spdep::lee(x = var[i, 1], y = var[i, 2], ...)$localL)
  }
  
  res <- boot::boot(xy, statistic = lee_boot, R = nsim, sim = "permutation", 
                    listw = listw, n = n, S2 = S2, zero.policy = zero.policy)
}
#Simulation for maps
local_sims <- simula_lee(EXCESS_MORTALITY_MUNICIPIO_MORGAN$AGE_ADJUSTED_NOCOVID_2020, EXCESS_MORTALITY_MUNICIPIO_MORGAN$DISLI, 
                         nb2listw(geo_data,zero.policy = T),
                         nsim = 10,
                         zero.policy = TRUE,
                         na.action = na.omit)

m_i <- Lxy[[2]]  # local values
# Identify the significant values 
alpha <- 0.05  # for a 95% confidence interval
probs <- c(alpha/2, 1-alpha/2)
intervals <- t(apply(t(local_sims[[2]]), 1, function(x) quantile(x, probs = probs)))
sig <- ( m_i < intervals[ , 1] ) | ( m_i > intervals[ , 2] )

EXCESS_MORTALITY_MUNICIPIO_MORGAN$sig <- sig

# Identify the Lee's L clusters
Xp <- scale(EXCESS_MORTALITY_MUNICIPIO_MORGAN$AGE_ADJUSTED_NOCOVID_2020)[ , 1]
Yp <- scale(EXCESS_MORTALITY_MUNICIPIO_MORGAN$DISLI)[ , 1]

patterns <- as.character(interaction(Xp > 0,  Yp > 0)) 
patterns <- patterns %>% 
  stringr::str_replace_all("TRUE","High") %>% 
  stringr::str_replace_all("FALSE","Low")
patterns[EXCESS_MORTALITY_MUNICIPIO_MORGAN$sig == 0] <- "Not significant"
EXCESS_MORTALITY_MUNICIPIO_MORGAN$patterns <- patterns

# Rename Lee's L clusters
EXCESS_MORTALITY_MUNICIPIO_MORGAN$patterns.2 <- factor(EXCESS_MORTALITY_MUNICIPIO_MORGAN$patterns,
                                                       levels = c("High.High", "High.Low", "Low.High", "Low.Low", "Not significant"),
                                                       labels = c("High Non_COVID Mortality- High DISLI", "High Non_COVID Mortality - Low DISLI", "Low Non_COVID Mortality - High DISLI","Low Non_COVID Mortality - Low DISLI", "Not significant"))

# ----------------------------------------------------- #
# Plot
ggplot() +
  geom_sf(data = EXCESS_MORTALITY_MUNICIPIO_MORGAN, aes(fill = patterns.2,geometry=geometry)) +
  theme_map()+labs(fill="Lee's L")+ggsci::scale_fill_jama()




